#??????Section, ????????!
#????freestyle??!
{<section id="bsft001_wf.description" type="s" >}
#?? a00 ??????(Version:3)
#+ Standard Version.....: SD??:0002(2025-04-01 11:20:42), PR??:
#+ Customerized Version.: SD??:0002(2025-04-16 22:30:34), PR??:
#+ Build......: 000029
#+ Filename...: bsft001_wf
#+ Description: IC????????
#+ Creator....: 17538(2023-10-19 09:24:46)
#+ Modifier...: 17538 -SD/PR-

{</section>}

{<section id="bsft001_wf.global" type="s" >}
#?? t01 ??????(Version:121)
#add-point:?????? name="global.memo" 
#Memos
#end add-point
#add-point:??????(???) name="global.memo_customerization"

#end add-point
#(ver:86) ---start---
#add-point:??????(???) name="global.memo_industry"
#230921-00006#7   2024/01/08 By fangxy  ????????????????????bom???????????????????????????????????????
#240130-00006#5   2024/01/30 By sunxfa  ????????????????????????????
#240201-00005#1   2024/03/04 By fangxy  ??????????????????????,??????????????????
#240325-00027#1   2024/03/26 By fangxy  1?????????
#                                       2????????????????????D-MFG-0052??????
#240423-00009#2   2024/05/08 By laimy   1???????????????????????????
#240430-00007#2   2024/05/15 By 16202   ??????????????
#240523-00025#1   2024/05/23 By 16320   ??????????
#240523-00030#1   2024/05/23 By 16320   ????????????
#240530-00021#1   2024/05/31 By 17539   turnkey?????? 
#240611-00019#1   2024/06/12 By 17538   ?????????????????
#240611-00019#2   2024/06/20 By 17538   ????????????????????????????=?????*????/????,???sum(??????)=sfakwf00?????????
#240704-00015#1   2024/06/20 By 17539   IC??????????
#240709-00009#1   2024/07/09 By 17538   1??aimm211_wf????????????????????????????????????????
#                                       2?????????????????????????????????????
#240725-00004#1   2024/07/25  By 17538  ???????????????????
#241016-00014#1    2024/10/15 By 17538    ?????????????
#241030-00021#1   2024/10/30  By 17539  ????????????????(?????#241030-00001#1   2024/10/30  By 17539)
#241105-16320#1   2024/11/05  By 16320  ?????????????
#241030-00021#2   2024/11/18  By 17538  ??????#241104-00004#1 ????/?????????????????????????
#241030-00021#5   2024/11/22  By 17538  ?????#241120-00001#1  bsft001_wf????????????????die?/???die?=???????????????????????asft311_wf?
#                                                 sfbcwf030????????;???????????????? 
#250106-00005#1   2025/01/06  By 17538  ?????#241212-00001#1  ????bin??????????????
#                                       ?????????????????????????????insert into???b_fill??????????insert into sfbcwf???????after insert???????
#250116-00004#2   2025/01/20  By 17538  ?????#250117-00001#1   ??????????????????????????bom??????????????????
#                                       ????#250120-00001#1   abmm210????????????????
#                                       ?????#241208-00001#1 ??????????????
#                                       ????#250114-00001#1   2024/11/14  By 17538  ??????????????????
#250220-00015#1   2025/02/20  By 17539  ##############start###############
#????? ????datecode??    
#?????????????????
#??????????
#????????bug
#????????
#?????????
#?????????????????
#qpa????
                                        ##############end###############  
#250328-00010#1   2025/03/31  By 17538  IC????????????????(???sfaa068),????????sfaa068?????????????????
#250411-00005#1   2025/05/02 By 17538   ?????#250319-00001#1   2025/03/19  By 17538  ??????????????????????qpa???qpa??;???????????????
#                                                #?????????????????????mark????????
#QTB20250618043   2025/06/18 By 17538   ??????????????????????mark;??????????


#end add-point
#(ver:86) --- end ---
 
IMPORT os
IMPORT util
IMPORT FGL lib_cl_dlg
IMPORT JAVA com.fourjs.fgl.lang.FglRecord   #(ver:87) add
#add-point:?????? name="global.import" 
IMPORT FGL sub_s_icd_wf     #230818-00019#5 add
IMPORT FGL aoo_aooi360_01   #240201-00005#1 add
#end add-point 
 
SCHEMA ds 
 
GLOBALS "../../cfg/top_global.inc"
#(ver:87) ---add start---
GLOBALS
#???excel POI??
TYPE rec_arr_type           ARRAY [] OF com.fourjs.fgl.lang.FglRecord
DEFINE g_export_tag         DYNAMIC ARRAY OF rec_arr_type                 #?????
DEFINE g_export_tabname     DYNAMIC ARRAY OF STRING                       #????
END GLOBALS
#(ver:87) --- add end ---
 
#add-point:??????? name="global.inc"
GLOBALS
TYPE type_g_icbawf_d        RECORD  #??/BIN???
       icbawfseq LIKE icbawf_t.icbawfseq, #??
       icbawfseq1 LIKE icbawf_t.icbawfseq1, #??1
       icbawfseq2 LIKE icbawf_t.icbawfseq2, #??2
       icbawf012 LIKE icbawf_t.icbawf012, #DATECODE
       icbawf013 LIKE icbawf_t.icbawf013, #????
       icbawf014 LIKE icbawf_t.icbawf014, #????
       icbawf007 LIKE icbawf_t.icbawf007, #??
       icbawf008 LIKE icbawf_t.icbawf008, #BIN
       icbawf010 LIKE icbawf_t.icbawf010, #???
       icbawf021 LIKE icbawf_t.icbawf021, #??
       icbawf022 LIKE icbawf_t.icbawf022, #??
       icbawf011 LIKE icbawf_t.icbawf011, #DIE?
       icbawf015 LIKE icbawf_t.icbawf015, #??(%)
       icbawf016 LIKE icbawf_t.icbawf016, #????
       icbawf017 LIKE icbawf_t.icbawf017, #?????
       icbawf018 LIKE icbawf_t.icbawf018, #????
       icbawf003 LIKE icbawf_t.icbawf003, #??????
       icbawf019 LIKE icbawf_t.icbawf019, #????
       icbawf020 LIKE icbawf_t.icbawf020  #????
       
END RECORD
DEFINE g_icbawf_d         DYNAMIC ARRAY OF type_g_icbawf_d 
 TYPE type_g_icbawf_d2       RECORD   #s_icd_wf_s04????
       sel        LIKE type_t.chr1,        #??
       col        LIKE type_t.num5,        #??
       incgwf036  LIKE incgwf_t.incgwf036, #??
       incgwf037  LIKE incgwf_t.incgwf037, #BIN
       incgwf038  LIKE incgwf_t.incgwf038, #DATECODE
       incgwf039  LIKE incgwf_t.incgwf039, #????
       incgwf040  LIKE incgwf_t.incgwf040, #????
       incgwf041  LIKE incgwf_t.incgwf041, #????
       incgwf003  LIKE incgwf_t.incgwf003, #??????
       incgwf008  LIKE incgwf_t.incgwf008, #????
       incgwf042  LIKE incgwf_t.incgwf042, #????DIE?
       incgwf044  LIKE incgwf_t.incgwf044, #??????
       icbawf022  LIKE icbawf_t.icbawf022, #??
       incgwf042_1  LIKE incgwf_t.incgwf042,#??DIE?
       inad014    LIKE inad_t.inad014,     #????
       incgwf019  LIKE incgwf_t.incgwf019  #???
            END RECORD
DEFINE g_icbawf_d2        DYNAMIC ARRAY OF type_g_icbawf_d2
#17538 add
END GLOBALS
#end add-point
 
#?? type ??
PRIVATE type type_g_sfajwf_m        RECORD
       sfajwfdocno LIKE sfajwf_t.sfajwfdocno, 
   oobal004 LIKE type_t.chr80, 
   sfajwfdocdt LIKE sfajwf_t.sfajwfdocdt, 
   sfajwf006 LIKE sfajwf_t.sfajwf006, 
   sfajwf006_desc LIKE pmaal_t.pmaal004, 
   sfajwf007 LIKE sfajwf_t.sfajwf007, 
   sfajwf007_desc LIKE ooibl_t.ooibl004, 
   sfajwf017 LIKE sfajwf_t.sfajwf017, 
   sfajwf019 LIKE sfajwf_t.sfajwf019, 
   sfajwf020 LIKE sfajwf_t.sfajwf020, 
   sfajwf021 LIKE sfajwf_t.sfajwf021, 
   sfajwf018 LIKE sfajwf_t.sfajwf018, 
   l_sfajwf018 LIKE type_t.chr500, 
   sfajwf022 LIKE sfajwf_t.sfajwf022, 
   sfajwf023 LIKE sfajwf_t.sfajwf023, 
   sfajwf023_desc LIKE icaal_t.icaal003, 
   sfajwf012 LIKE sfajwf_t.sfajwf012, 
   sfajwf012_desc LIKE wfakwfl_t.wfakwfl003, 
   sfajwf013 LIKE sfajwf_t.sfajwf013, 
   sfajwf014 LIKE sfajwf_t.sfajwf014, 
   sfajwf001 LIKE sfajwf_t.sfajwf001, 
   sfajwf001_desc LIKE ooag_t.ooag011, 
   sfajwf002 LIKE sfajwf_t.sfajwf002, 
   sfajwf002_desc LIKE ooefl_t.ooefl003, 
   sfajwf025 LIKE sfajwf_t.sfajwf025, 
   sfajwf025_desc LIKE ooefl_t.ooefl003, 
   sfajwf015 LIKE sfajwf_t.sfajwf015, 
   sfajwfua002 LIKE sfajwf_t.sfajwfua002, 
   sfajwf016 LIKE sfajwf_t.sfajwf016, 
   sfajwfua003 LIKE sfajwf_t.sfajwfua003, 
   sfajwf024 LIKE sfajwf_t.sfajwf024, 
   sfajwf003 LIKE sfajwf_t.sfajwf003, 
   sfajwf005 LIKE sfajwf_t.sfajwf005, 
   sfajwf004 LIKE sfajwf_t.sfajwf004, 
   sfajwf008 LIKE sfajwf_t.sfajwf008, 
   sfajwf008_desc LIKE inayl_t.inayl003, 
   sfajwf009 LIKE sfajwf_t.sfajwf009, 
   sfajwf009_desc LIKE inab_t.inab003, 
   sfajwf010 LIKE sfajwf_t.sfajwf010, 
   sfajwf010_desc LIKE inayl_t.inayl003, 
   sfajwf011 LIKE sfajwf_t.sfajwf011, 
   sfajwf011_desc LIKE inab_t.inab003, 
   sfajwfua011 LIKE sfajwf_t.sfajwfua011, 
   sfajwfua012 LIKE sfajwf_t.sfajwfua012, 
   sfajwfua013 LIKE sfajwf_t.sfajwfua013, 
   sfajwfua014 LIKE sfajwf_t.sfajwfua014, 
   sfajwfua015 LIKE sfajwf_t.sfajwfua015, 
   sfajwfstus LIKE sfajwf_t.sfajwfstus, 
   sfajwfownid LIKE sfajwf_t.sfajwfownid, 
   sfajwfownid_desc LIKE ooag_t.ooag011, 
   sfajwfowndp LIKE sfajwf_t.sfajwfowndp, 
   sfajwfowndp_desc LIKE ooefl_t.ooefl003, 
   sfajwfcrtid LIKE sfajwf_t.sfajwfcrtid, 
   sfajwfcrtid_desc LIKE ooag_t.ooag011, 
   sfajwfcrtdp LIKE sfajwf_t.sfajwfcrtdp, 
   sfajwfcrtdp_desc LIKE ooefl_t.ooefl003, 
   sfajwfcrtdt LIKE sfajwf_t.sfajwfcrtdt, 
   sfajwfmodid LIKE sfajwf_t.sfajwfmodid, 
   sfajwfmodid_desc LIKE ooag_t.ooag011, 
   sfajwfmoddt LIKE sfajwf_t.sfajwfmoddt, 
   sfajwfcnfid LIKE sfajwf_t.sfajwfcnfid, 
   sfajwfcnfid_desc LIKE ooag_t.ooag011, 
   sfajwfcnfdt LIKE sfajwf_t.sfajwfcnfdt
       END RECORD
 
#?? type ??
PRIVATE TYPE type_g_sfakwf_d        RECORD
       sfakwfseq LIKE sfakwf_t.sfakwfseq, 
   sfakwf001 LIKE sfakwf_t.sfakwf001, 
   sfakwf002 LIKE sfakwf_t.sfakwf002, 
   sfakwf001_desc LIKE imaal_t.imaal003, 
   sfakwf001_desc_1 LIKE type_t.chr500, 
   sfakwf003 LIKE sfakwf_t.sfakwf003, 
   sfakwf003_desc LIKE inaml_t.inaml004, 
   sfakwf004 LIKE sfakwf_t.sfakwf004, 
   sfakwf005 LIKE sfakwf_t.sfakwf005, 
   sfakwf006 LIKE sfakwf_t.sfakwf006, 
   sfakwf007 LIKE sfakwf_t.sfakwf007, 
   sfakwf008 LIKE sfakwf_t.sfakwf008, 
   sfakwf009 LIKE sfakwf_t.sfakwf009, 
   sfakwf010 LIKE sfakwf_t.sfakwf010, 
   sfakwf011 LIKE sfakwf_t.sfakwf011, 
   sfakwf012 LIKE sfakwf_t.sfakwf012, 
   sfakwf012_desc LIKE type_t.chr500, 
   sfakwf013 LIKE sfakwf_t.sfakwf013, 
   sfakwf014 LIKE sfakwf_t.sfakwf014, 
   sfakwf015 LIKE sfakwf_t.sfakwf015, 
   sfakwf016 LIKE sfakwf_t.sfakwf016, 
   sfakwf017 LIKE sfakwf_t.sfakwf017, 
   sfakwf017_desc LIKE type_t.chr500, 
   sfakwf018 LIKE sfakwf_t.sfakwf018, 
   sfakwf019 LIKE sfakwf_t.sfakwf019, 
   sfakwf020 LIKE sfakwf_t.sfakwf020, 
   sfakwf021 LIKE sfakwf_t.sfakwf021, 
   sfakwf022 LIKE sfakwf_t.sfakwf022, 
   sfakwf023 LIKE sfakwf_t.sfakwf023, 
   sfakwf023_desc LIKE wfajwfl_t.wfajwfl003, 
   sfakwf024 LIKE sfakwf_t.sfakwf024, 
   sfakwf025 LIKE sfakwf_t.sfakwf025, 
   sfakwf026 LIKE sfakwf_t.sfakwf026, 
   sfakwf027 LIKE sfakwf_t.sfakwf027, 
   sfakwf028 LIKE sfakwf_t.sfakwf028, 
   sfakwf029 LIKE sfakwf_t.sfakwf029, 
   sfakwf030 LIKE sfakwf_t.sfakwf030, 
   sfakwf031 LIKE sfakwf_t.sfakwf031, 
   sfakwf044 LIKE sfakwf_t.sfakwf044, 
   sfakwf032 LIKE sfakwf_t.sfakwf032, 
   sfakwf033 LIKE sfakwf_t.sfakwf033, 
   sfakwf034 LIKE sfakwf_t.sfakwf034, 
   sfakwf035 LIKE sfakwf_t.sfakwf035, 
   sfakwf036 LIKE sfakwf_t.sfakwf036, 
   sfakwf037 LIKE sfakwf_t.sfakwf037, 
   sfakwf038 LIKE sfakwf_t.sfakwf038, 
   sfakwf039 LIKE sfakwf_t.sfakwf039, 
   sfakwf040 LIKE sfakwf_t.sfakwf040, 
   sfakwf041 LIKE sfakwf_t.sfakwf041, 
   sfakwf042 LIKE sfakwf_t.sfakwf042, 
   sfakwf043 LIKE sfakwf_t.sfakwf043, 
   sfakwf045 LIKE sfakwf_t.sfakwf045, 
   sfakwf045_desc LIKE pjbal_t.pjbal003, 
   sfakwf046 LIKE sfakwf_t.sfakwf046, 
   sfakwf046_desc LIKE pjbbl_t.pjbbl004, 
   sfakwf047 LIKE sfakwf_t.sfakwf047, 
   sfakwf047_desc LIKE pjbml_t.pjbml004, 
   sfakwf048 LIKE sfakwf_t.sfakwf048, 
   sfakwf048_desc LIKE type_t.chr500, 
   sfakwf049 LIKE sfakwf_t.sfakwf049, 
   sfakwf049_desc LIKE ooefl_t.ooefl003, 
   sfakwfud001 LIKE sfakwf_t.sfakwfud001
       END RECORD
PRIVATE TYPE type_g_sfakwf2_d RECORD
       sfbcwfseq1 LIKE sfbcwf_t.sfbcwfseq1, 
   sfbcwfseq2 LIKE sfbcwf_t.sfbcwfseq2, 
   sfbcwf002 LIKE sfbcwf_t.sfbcwf002, 
   sfbcwf002_desc LIKE oocql_t.oocql004, 
   sfbcwf003 LIKE sfbcwf_t.sfbcwf003, 
   sfbcwf003_desc LIKE oocql_t.oocql004, 
   sfbcwf004 LIKE sfbcwf_t.sfbcwf004, 
   sfbcwf005 LIKE sfbcwf_t.sfbcwf005, 
   sfbcwf005_desc LIKE imaal_t.imaal003, 
   sfbcwf005_desc_1 LIKE type_t.chr500, 
   replace LIKE type_t.chr500, 
   sfbcwf022 LIKE sfbcwf_t.sfbcwf022, 
   sfbcwf006 LIKE sfbcwf_t.sfbcwf006, 
   sfbcwf006_desc LIKE imaal_t.imaal003, 
   sfbcwf006_desc_1 LIKE type_t.chr500, 
   sfbcwf033 LIKE sfbcwf_t.sfbcwf033, 
   imaf013 LIKE type_t.chr10, 
   sfbcwf021 LIKE sfbcwf_t.sfbcwf021, 
   sfbcwf021_desc LIKE inaml_t.inaml004, 
   sfbcwf007 LIKE sfbcwf_t.sfbcwf007, 
   sfbcwf008 LIKE sfbcwf_t.sfbcwf008, 
   sfbcwf009 LIKE sfbcwf_t.sfbcwf009, 
   sfbcwf010 LIKE sfbcwf_t.sfbcwf010, 
   sfbcwf011 LIKE sfbcwf_t.sfbcwf011, 
   sfbcwf012 LIKE sfbcwf_t.sfbcwf012, 
   sfbcwf023 LIKE sfbcwf_t.sfbcwf023, 
   sfbcwf024 LIKE sfbcwf_t.sfbcwf024, 
   sfbcwf013 LIKE sfbcwf_t.sfbcwf013, 
   sfbcwf047 LIKE sfbcwf_t.sfbcwf047, 
   sfbcwf048 LIKE sfbcwf_t.sfbcwf048, 
   number5 LIKE type_t.chr500, 
   number6 LIKE type_t.chr500, 
   sfbcwf014 LIKE sfbcwf_t.sfbcwf014, 
   sfbcwf014_desc LIKE oocal_t.oocal003, 
   sfbcwf015 LIKE sfbcwf_t.sfbcwf015, 
   sfbcwf016 LIKE sfbcwf_t.sfbcwf016, 
   sfbcwf025 LIKE sfbcwf_t.sfbcwf025, 
   number1 LIKE type_t.chr500, 
   number2 LIKE type_t.chr500, 
   sfbcwf017 LIKE sfbcwf_t.sfbcwf017, 
   sfbcwf018 LIKE sfbcwf_t.sfbcwf018, 
   number3 LIKE type_t.chr500, 
   number4 LIKE type_t.chr500, 
   sfbcwf019 LIKE sfbcwf_t.sfbcwf019, 
   sfbcwf019_desc LIKE inaa_t.inaa002, 
   sfbcwf020 LIKE sfbcwf_t.sfbcwf020, 
   sfbcwf020_desc LIKE inab_t.inab003, 
   sfbcwf029 LIKE sfbcwf_t.sfbcwf029, 
   sfbcwf039 LIKE sfbcwf_t.sfbcwf039, 
   sfbcwf030 LIKE sfbcwf_t.sfbcwf030, 
   sfbcwf040 LIKE sfbcwf_t.sfbcwf040, 
   sfbcwf041 LIKE sfbcwf_t.sfbcwf041, 
   sfbcwf041_desc LIKE type_t.chr500, 
   sfbcwf042 LIKE sfbcwf_t.sfbcwf042, 
   sfbcwf042_desc LIKE type_t.chr500, 
   sfbcwf028 LIKE sfbcwf_t.sfbcwf028, 
   sfbcwf001 LIKE sfbcwf_t.sfbcwf001, 
   sfbcwf001_desc LIKE imaal_t.imaal003, 
   sfbcwf001_desc_1 LIKE type_t.chr500, 
   sfbcwf026 LIKE sfbcwf_t.sfbcwf026, 
   sfbcwf027 LIKE sfbcwf_t.sfbcwf027, 
   sfbcwf034 LIKE sfbcwf_t.sfbcwf034, 
   sfbcwf035 LIKE sfbcwf_t.sfbcwf035, 
   ooff013 LIKE type_t.chr4000, 
   sfbcwf043 LIKE sfbcwf_t.sfbcwf043, 
   sfbcwf049 LIKE sfbcwf_t.sfbcwf049
       END RECORD
PRIVATE TYPE type_g_sfakwf3_d RECORD
       wfapwfseq1 LIKE wfapwf_t.wfapwfseq1, 
   wfapwf001 LIKE wfapwf_t.wfapwf001, 
   wfapwf001_desc LIKE imaal_t.imaal003, 
   wfapwf001_desc_1 LIKE type_t.chr500, 
   wfapwf002 LIKE wfapwf_t.wfapwf002, 
   wfapwf003 LIKE wfapwf_t.wfapwf003, 
   wfapwf004 LIKE wfapwf_t.wfapwf004, 
   wfapwf005 LIKE wfapwf_t.wfapwf005, 
   wfapwf006 LIKE wfapwf_t.wfapwf006, 
   wfapwf007 LIKE wfapwf_t.wfapwf007, 
   wfapwf008 LIKE wfapwf_t.wfapwf008, 
   wfapwf009 LIKE wfapwf_t.wfapwf009, 
   wfapwf010 LIKE wfapwf_t.wfapwf010, 
   wfapwf011 LIKE wfapwf_t.wfapwf011, 
   wfapwf012 LIKE wfapwf_t.wfapwf012, 
   wfapwf013 LIKE wfapwf_t.wfapwf013, 
   wfapwf014 LIKE wfapwf_t.wfapwf014, 
   wfapwf015 LIKE wfapwf_t.wfapwf015, 
   wfapwf016 LIKE wfapwf_t.wfapwf016, 
   wfapwf017 LIKE wfapwf_t.wfapwf017, 
   wfapwf018 LIKE wfapwf_t.wfapwf018, 
   wfapwf022 LIKE wfapwf_t.wfapwf022, 
   wfapwf019 LIKE wfapwf_t.wfapwf019, 
   sfakwf012 LIKE sfakwf_t.sfakwf012, 
   sfakwf013 LIKE sfakwf_t.sfakwf013, 
   sfakwf014 LIKE sfakwf_t.sfakwf014, 
   sfakwf015 LIKE sfakwf_t.sfakwf015, 
   wfapwf021 LIKE wfapwf_t.wfapwf021, 
   sfakwf017 LIKE sfakwf_t.sfakwf017, 
   sfakwf018 LIKE sfakwf_t.sfakwf018, 
   sfakwf019 LIKE sfakwf_t.sfakwf019, 
   sfakwf020 LIKE sfakwf_t.sfakwf020, 
   sfakwf021 LIKE sfakwf_t.sfakwf021, 
   wfapwf020 LIKE wfapwf_t.wfapwf020, 
   sfakwf023 LIKE sfakwf_t.sfakwf023, 
   wfapwf020_desc LIKE wfajwfl_t.wfajwfl003, 
   wfapwf023 LIKE wfapwf_t.wfapwf023, 
   sfakwf025 LIKE sfakwf_t.sfakwf025, 
   sfakwf026 LIKE sfakwf_t.sfakwf026, 
   sfakwf027 LIKE sfakwf_t.sfakwf027, 
   sfakwf028 LIKE sfakwf_t.sfakwf028, 
   wfapwf024 LIKE wfapwf_t.wfapwf024, 
   wfapwf025 LIKE wfapwf_t.wfapwf025, 
   wfapwf026 LIKE wfapwf_t.wfapwf026
       END RECORD
PRIVATE TYPE type_g_sfakwf4_d RECORD
       sfamwfseq LIKE type_t.num10, 
   sfamwf001 LIKE type_t.chr1, 
   sfamwf002 LIKE type_t.chr20, 
   sfamwf003 LIKE type_t.num10, 
   sfamwf004 LIKE type_t.num10, 
   sfamwf005 LIKE type_t.num5, 
   sfamwf006 LIKE type_t.num20_6, 
   sfamwf007 LIKE type_t.num20_6, 
   sfamwf008 LIKE type_t.chr500
       END RECORD
PRIVATE TYPE type_g_sfakwf5_d RECORD
       l_sfanwfseq1 LIKE type_t.chr500, 
   sfanwfseq LIKE type_t.num10, 
   sfanwf002 LIKE type_t.chr1, 
   sfanwf001 LIKE type_t.chr500, 
   sfanwf001_desc LIKE imaal_t.imaal003, 
   sfanwf001_desc_1 LIKE type_t.chr500, 
   sfanwf006 LIKE type_t.chr500, 
   sfanwf006_desc LIKE imecl_t.imecl005, 
   sfanwf003 LIKE type_t.num20_6, 
   sfanwf004 LIKE type_t.chr10, 
   sfanwf004_desc LIKE oocal_t.oocal003, 
   sfanwf005 LIKE type_t.num20_6
       END RECORD
 
 
PRIVATE TYPE type_browser RECORD
         b_statepic     LIKE type_t.chr50,
            b_sfajwfdocno LIKE sfajwf_t.sfajwfdocno,
      b_sfajwfdocdt LIKE sfajwf_t.sfajwfdocdt,
      b_sfajwf006 LIKE sfajwf_t.sfajwf006,
      b_sfajwf007 LIKE sfajwf_t.sfajwf007,
      b_sfajwf012 LIKE sfajwf_t.sfajwf012,
      b_sfajwf013 LIKE sfajwf_t.sfajwf013,
      b_sfajwf014 LIKE sfajwf_t.sfajwf014,
      b_sfajwf001 LIKE sfajwf_t.sfajwf001,
      b_sfajwf002 LIKE sfajwf_t.sfajwf002,
      b_sfajwf015 LIKE sfajwf_t.sfajwf015,
      b_sfajwf016 LIKE sfajwf_t.sfajwf016,
      b_sfajwf003 LIKE sfajwf_t.sfajwf003,
      b_sfajwf004 LIKE sfajwf_t.sfajwf004,
      b_sfajwf005 LIKE sfajwf_t.sfajwf005,
      b_sfajwf008 LIKE sfajwf_t.sfajwf008,
      b_sfajwf009 LIKE sfajwf_t.sfajwf009,
      b_sfajwf010 LIKE sfajwf_t.sfajwf010,
      b_sfajwf011 LIKE sfajwf_t.sfajwf011
       END RECORD
       
#add-point:???????(Module Variable) (?????????????????, ?????patch????????) name="global.variable"
DEFINE g_ooef004             LIKE ooef_t.ooef004
DEFINE g_ooef008             LIKE ooef_t.ooef008
DEFINE g_ooef009             LIKE ooef_t.ooef009
DEFINE g_ooef016             LIKE ooef_t.ooef016
DEFINE g_slip                LIKE ooba_t.ooba002
DEFINE g_docdt               LIKE type_t.dat #????
DEFINE g_ooff001_d       LIKE ooff_t.ooff001
DEFINE g_ooff002_d       LIKE ooff_t.ooff002
DEFINE g_ooff003_d       LIKE ooff_t.ooff003
DEFINE g_ooff004_d       LIKE ooff_t.ooff004
DEFINE g_ooff005_d       LIKE ooff_t.ooff005
DEFINE g_ooff006_d       LIKE ooff_t.ooff006
DEFINE g_ooff007_d       LIKE ooff_t.ooff007
DEFINE g_ooff008_d       LIKE ooff_t.ooff008
DEFINE g_ooff009_d       LIKE ooff_t.ooff009
DEFINE g_ooff010_d       LIKE ooff_t.ooff010
DEFINE g_ooff011_d       LIKE ooff_t.ooff011
DEFINE g_sfbcwf019_switch   LIKE type_t.chr1   #??        ???? Y??? N????
DEFINE g_sfbcwf020_switch   LIKE type_t.chr1   #??        ???? Y??? N????
DEFINE g_sfbcwf029_switch   LIKE type_t.chr1   #??        ???? Y??? N????
DEFINE g_sfbcwf030_switch   LIKE type_t.chr1   #?????? ???? Y??? N????
DEFINE g_para               LIKE type_t.chr80
DEFINE g_ooba002            LIKE ooba_t.ooba002  #??
DEFINE g_get_current        LIKE sfajwf_t.sfajwfcrtdt
#240709-00009#1 add--s
DEFINE g_inam                DYNAMIC ARRAY OF RECORD   #??????
           inam001           LIKE inam_t.inam001,
           inam002           LIKE inam_t.inam002,
           inam004           LIKE inam_t.inam004
                             END RECORD
DEFINE g_inam004_sum         LIKE sfaa_t.sfaa012
DEFINE g_inam1               DYNAMIC ARRAY OF RECORD   #??????
           inam001           LIKE inam_t.inam001,
           inam002           LIKE inam_t.inam002,
           inam004           LIKE inam_t.inam004
                             END RECORD
#240709-00009#1 add--e
#end add-point
       
#????(Module Variables)
DEFINE g_sfajwf_m          type_g_sfajwf_m
DEFINE g_sfajwf_m_t        type_g_sfajwf_m
DEFINE g_sfajwf_m_o        type_g_sfajwf_m
DEFINE g_sfajwf_m_mask_o   type_g_sfajwf_m #???????
DEFINE g_sfajwf_m_mask_n   type_g_sfajwf_m #???????
 
   DEFINE g_sfajwfdocno_t LIKE sfajwf_t.sfajwfdocno
 
 
DEFINE g_sfakwf_d          DYNAMIC ARRAY OF type_g_sfakwf_d
DEFINE g_sfakwf_d_t        type_g_sfakwf_d
DEFINE g_sfakwf_d_o        type_g_sfakwf_d
DEFINE g_sfakwf_d_mask_o   DYNAMIC ARRAY OF type_g_sfakwf_d #???????
DEFINE g_sfakwf_d_mask_n   DYNAMIC ARRAY OF type_g_sfakwf_d #???????
DEFINE g_sfakwf2_d          DYNAMIC ARRAY OF type_g_sfakwf2_d
DEFINE g_sfakwf2_d_t        type_g_sfakwf2_d
DEFINE g_sfakwf2_d_o        type_g_sfakwf2_d
DEFINE g_sfakwf2_d_mask_o   DYNAMIC ARRAY OF type_g_sfakwf2_d #???????
DEFINE g_sfakwf2_d_mask_n   DYNAMIC ARRAY OF type_g_sfakwf2_d #???????
DEFINE g_sfakwf3_d          DYNAMIC ARRAY OF type_g_sfakwf3_d
DEFINE g_sfakwf3_d_t        type_g_sfakwf3_d
DEFINE g_sfakwf3_d_o        type_g_sfakwf3_d
DEFINE g_sfakwf3_d_mask_o   DYNAMIC ARRAY OF type_g_sfakwf3_d #???????
DEFINE g_sfakwf3_d_mask_n   DYNAMIC ARRAY OF type_g_sfakwf3_d #???????
DEFINE g_sfakwf4_d          DYNAMIC ARRAY OF type_g_sfakwf4_d
DEFINE g_sfakwf4_d_t        type_g_sfakwf4_d
DEFINE g_sfakwf4_d_o        type_g_sfakwf4_d
DEFINE g_sfakwf4_d_mask_o   DYNAMIC ARRAY OF type_g_sfakwf4_d #???????
DEFINE g_sfakwf4_d_mask_n   DYNAMIC ARRAY OF type_g_sfakwf4_d #???????
DEFINE g_sfakwf5_d          DYNAMIC ARRAY OF type_g_sfakwf5_d
DEFINE g_sfakwf5_d_t        type_g_sfakwf5_d
DEFINE g_sfakwf5_d_o        type_g_sfakwf5_d
DEFINE g_sfakwf5_d_mask_o   DYNAMIC ARRAY OF type_g_sfakwf5_d #???????
DEFINE g_sfakwf5_d_mask_n   DYNAMIC ARRAY OF type_g_sfakwf5_d #???????
 
 
DEFINE g_browser         DYNAMIC ARRAY OF type_browser
DEFINE g_browser_f       DYNAMIC ARRAY OF type_browser
 
 
DEFINE g_wc                  STRING
DEFINE g_wc_t                STRING
DEFINE g_wc2                 STRING                          #??CONSTRUCT??
DEFINE g_wc2_table1          STRING
DEFINE g_wc2_table2   STRING
 
 
DEFINE g_wc2_table3   STRING
 
DEFINE g_wc2_table4   STRING
 
DEFINE g_wc2_table5   STRING
 
 
DEFINE g_wc2_extend          STRING
DEFINE g_wc_filter           STRING
DEFINE g_wc_filter_t         STRING
 
DEFINE g_sql                 STRING
DEFINE g_forupd_sql          STRING
DEFINE g_cnt                 LIKE type_t.num10
DEFINE g_current_idx         LIKE type_t.num10     
DEFINE g_jump                LIKE type_t.num10        
DEFINE g_no_ask              LIKE type_t.num5        
DEFINE g_rec_b               LIKE type_t.num10           
DEFINE l_ac                  LIKE type_t.num10    
DEFINE g_curr_diag           ui.Dialog                         #Current Dialog
                                                               
DEFINE g_pagestart           LIKE type_t.num10                 
DEFINE gwin_curr             ui.Window                         #Current Window
DEFINE gfrm_curr             ui.Form                           #Current Form
DEFINE g_page_action         STRING                            #page action
DEFINE g_header_hidden       LIKE type_t.num5                  #????
DEFINE g_worksheet_hidden    LIKE type_t.num5                  #????Panel
DEFINE g_page                STRING                            #???
DEFINE g_state               STRING       
DEFINE g_header_cnt          LIKE type_t.num10
DEFINE g_detail_cnt          LIKE type_t.num10                  #?????
DEFINE g_detail_idx          LIKE type_t.num10                  #????????
DEFINE g_detail_idx_tmp      LIKE type_t.num10                  #????????
DEFINE g_detail_idx2         LIKE type_t.num10                  #??2??????
DEFINE g_detail_idx_list     DYNAMIC ARRAY OF LIKE type_t.num10 #??2??????
DEFINE g_browser_cnt         LIKE type_t.num10                  #Browser???
DEFINE g_browser_idx         LIKE type_t.num10                  #Browser??????
DEFINE g_temp_idx            LIKE type_t.num10                  #Browser??????(???)
DEFINE g_order               STRING                             #??????
                                                        
DEFINE g_current_row         LIKE type_t.num10                  #Browser????
DEFINE g_current_sw          BOOLEAN                            #Browser???????
DEFINE g_current_page        LIKE type_t.num10                  #??????
DEFINE g_insert              LIKE type_t.chr5                   #??????page
 
DEFINE g_ref_fields          DYNAMIC ARRAY OF VARCHAR(500) #ap_ref???
DEFINE g_ref_vars            DYNAMIC ARRAY OF VARCHAR(500) #ap_ref???
DEFINE g_rtn_fields          DYNAMIC ARRAY OF VARCHAR(500) #ap_ref???
DEFINE gs_keys               DYNAMIC ARRAY OF VARCHAR(500) #???????
DEFINE gs_keys_bak           DYNAMIC ARRAY OF VARCHAR(500) #???????
DEFINE g_bfill               LIKE type_t.chr5              #??????
DEFINE g_error_show          LIKE type_t.num5              #??????????
DEFINE g_master_insert       BOOLEAN                       #??????????
 
DEFINE g_wc_frozen           STRING                        #??????
DEFINE g_chk                 BOOLEAN                       #??????
DEFINE g_aw                  STRING                        #?????????
DEFINE g_default             BOOLEAN                       #?????????
DEFINE g_log1                STRING                        #log?
DEFINE g_log2                STRING                        #log?
DEFINE g_loc                 LIKE type_t.chr5              #????????
DEFINE g_add_browse          STRING                        #?????WC
DEFINE g_update              BOOLEAN                       #????/??????
DEFINE g_idx_group           om.SaxAttributes              #????
DEFINE g_master_commit       LIKE type_t.chr1              #?????????
DEFINE g_err_rec             LIKE type_t.chr1              #???????   #161130-00056
#190108-00038 ---start---
DEFINE g_simple_mode         LIKE type_t.num5              #?????????(TRUE:??  FALSE:??)
DEFINE g_simple_name         LIKE dzzc_t.dzzc002           #???????
DEFINE g_current_mode        LIKE type_t.chr10             #????????????(simple:??  standard:??)
DEFINE g_simple_mode_exists  LIKE type_t.chr1              #?????????????(Y/N)
DEFINE gs_first_time         LIKE type_t.chr1              ##??????????init()?
#190108-00038 --- end ---
DEFINE g_autocomplete_param  DYNAMIC ARRAY OF LIKE type_t.chr1000   #autocomplete???????   #190121-00003
DEFINE g_other_wc            LIKE type_t.chr2000           #????   #190121-00003
 
#add-point:???????????(Module Variable) name="global.variable_customerization"

#end add-point
 
#add-point:??????(global.argv) name="global.argv"

#end add-point

{</section>}

{<section id="bsft001_wf.main" type="s" >}
#?? a26 ??????(Version:9)
#+ ????(?????)
MAIN
   #add-point:main?define(???) name="main.define_customerization"

   #end add-point   
   #add-point:main?define(?????????????????, ?????patch????????) name="main.define"

   #end add-point   
   
   OPTIONS
   INPUT NO WRAP
   DEFER INTERRUPT
   
   #??SQL?????? (???????)
   WHENEVER ERROR CALL cl_err_msg_log
       
   #????????????(????)
   CALL cl_ap_init("csf","")
 
   #add-point:????? name="main.init"
   #241120-00001#1 add--s
   DROP TABLE convert_tmp; 
   CREATE TEMP TABLE convert_tmp(
      imaa001   LIKE imaa_t.imaa001,
      from_unit LIKE inag_t.inag007,
      to_unit   LIKE inag_t.inag007,
      qty       LIKE inag_t.inag008
      ); 
   #241120-00001#1 add--e
   #end add-point
   
   
 
   #LOCK CURSOR (identifier)
   #add-point:SQL_define name="main.define_sql"

   #end add-point
   LET g_forupd_sql = " SELECT sfajwfdocno,'',sfajwfdocdt,sfajwf006,'',sfajwf007,'',sfajwf017,sfajwf019,sfajwf020,sfajwf021,sfajwf018,'',sfajwf022,sfajwf023,'',sfajwf012,'',sfajwf013,sfajwf014,sfajwf001,'',sfajwf002,'',sfajwf025,'',sfajwf015,sfajwfua002,sfajwf016,sfajwfua003,sfajwf024,sfajwf003,sfajwf005, 
       sfajwf004,sfajwf008,'',sfajwf009,'',sfajwf010,'',sfajwf011,'',sfajwfua011,sfajwfua012,sfajwfua013,sfajwfua014,sfajwfua015,sfajwfstus,sfajwfownid,'',sfajwfowndp,'',sfajwfcrtid,'',sfajwfcrtdp,'',sfajwfcrtdt,sfajwfmodid,'',sfajwfmoddt,sfajwfcnfid,'',sfajwfcnfdt", 
                      " FROM sfajwf_t",
                      " WHERE sfajwfent= ? AND sfajwfsite= ? AND sfajwfdocno=? FOR UPDATE"
   #add-point:SQL_define name="main.after_define_sql"

   #end add-point
   LET g_forupd_sql = cl_sql_forupd(g_forupd_sql)                #?????????
   LET g_forupd_sql = cl_sql_add_mask(g_forupd_sql)              #??????
   DECLARE bsft001_wf_cl CURSOR FROM g_forupd_sql                 # LOCK CURSOR
   CALL bsft001_wf_chk_data_exist(g_forupd_sql)   #190806-00019
 
   LET g_sql = " SELECT DISTINCT t0.sfajwfdocno,t0.sfajwfdocdt,t0.sfajwf006,t0.sfajwf007,t0.sfajwf017,t0.sfajwf019,t0.sfajwf020,t0.sfajwf021,t0.sfajwf018,t0.sfajwf022,t0.sfajwf023,t0.sfajwf012,t0.sfajwf013,t0.sfajwf014,t0.sfajwf001,t0.sfajwf002,t0.sfajwf025,t0.sfajwf015,t0.sfajwfua002,t0.sfajwf016,t0.sfajwfua003, 
       t0.sfajwf024,t0.sfajwf003,t0.sfajwf005,t0.sfajwf004,t0.sfajwf008,t0.sfajwf009,t0.sfajwf010,t0.sfajwf011,t0.sfajwfua011,t0.sfajwfua012,t0.sfajwfua013,t0.sfajwfua014,t0.sfajwfua015,t0.sfajwfstus,t0.sfajwfownid,t0.sfajwfowndp,t0.sfajwfcrtid,t0.sfajwfcrtdp,t0.sfajwfcrtdt,t0.sfajwfmodid,t0.sfajwfmoddt, 
       t0.sfajwfcnfid,t0.sfajwfcnfdt,t1.pmaal004 ,t2.ooibl004 ,t3.icaal003 ,t4.wfakwfl003 ,t5.ooag011 ,t6.ooefl003 ,t7.ooefl003 ,t8.inayl003 ,t9.inab003 ,t10.inayl003 ,t11.inab003 ,t12.ooag011 ,t13.ooefl003 ,t14.ooag011 ,t15.ooefl003 ,t16.ooag011 ,t17.ooag011",
               " FROM sfajwf_t t0",
                              " LEFT JOIN pmaal_t t1 ON t1.pmaalent="||g_enterprise||" AND t1.pmaal001=t0.sfajwf006 AND t1.pmaal002='"||g_dlang||"' ",
               " LEFT JOIN ooibl_t t2 ON t2.ooiblent="||g_enterprise||" AND t2.ooibl002=t0.sfajwf007 AND t2.ooibl003='"||g_dlang||"' ",
               " LEFT JOIN icaal_t t3 ON t3.icaalent="||g_enterprise||" AND t3.icaal001=t0.sfajwf023 AND t3.icaal001='"||g_dlang||"' ",
               " LEFT JOIN wfakwfl_t t4 ON t4.wfakwflent="||g_enterprise||" AND t4.wfakwfl001=t0.sfajwf012 AND t4.wfakwfl002='"||g_dlang||"' ",
               " LEFT JOIN ooag_t t5 ON t5.ooagent="||g_enterprise||" AND t5.ooag001=t0.sfajwf001  ",
               " LEFT JOIN ooefl_t t6 ON t6.ooeflent="||g_enterprise||" AND t6.ooefl001=t0.sfajwf002 AND t6.ooefl002='"||g_dlang||"' ",
               " LEFT JOIN ooefl_t t7 ON t7.ooeflent="||g_enterprise||" AND t7.ooefl001=t0.sfajwf025 AND t7.ooefl002='"||g_dlang||"' ",
               " LEFT JOIN inayl_t t8 ON t8.inaylent="||g_enterprise||" AND t8.inayl001=t0.sfajwf008 AND t8.inayl002='"||g_dlang||"' ",
               " LEFT JOIN inab_t t9 ON t9.inabent="||g_enterprise||" AND t9.inab001=t0.sfajwf009  ",
               " LEFT JOIN inayl_t t10 ON t10.inaylent="||g_enterprise||" AND t10.inayl001=t0.sfajwf010 AND t10.inayl002='"||g_dlang||"' ",
               " LEFT JOIN inab_t t11 ON t11.inabent="||g_enterprise||" AND t11.inab001=t0.sfajwf011  ",
               " LEFT JOIN ooag_t t12 ON t12.ooagent="||g_enterprise||" AND t12.ooag001=t0.sfajwfownid  ",
               " LEFT JOIN ooefl_t t13 ON t13.ooeflent="||g_enterprise||" AND t13.ooefl001=t0.sfajwfowndp AND t13.ooefl002='"||g_dlang||"' ",
               " LEFT JOIN ooag_t t14 ON t14.ooagent="||g_enterprise||" AND t14.ooag001=t0.sfajwfcrtid  ",
               " LEFT JOIN ooefl_t t15 ON t15.ooeflent="||g_enterprise||" AND t15.ooefl001=t0.sfajwfcrtdp AND t15.ooefl002='"||g_dlang||"' ",
               " LEFT JOIN ooag_t t16 ON t16.ooagent="||g_enterprise||" AND t16.ooag001=t0.sfajwfmodid  ",
               " LEFT JOIN ooag_t t17 ON t17.ooagent="||g_enterprise||" AND t17.ooag001=t0.sfajwfcnfid  ",
 
               " WHERE t0.sfajwfent = " ||g_enterprise|| " AND t0.sfajwfsite = ? AND t0.sfajwfdocno = ?"
   LET g_sql = cl_sql_add_mask(g_sql)              #??????
   #add-point:SQL_define name="main.after_refresh_sql"

   #end add-point
   PREPARE bsft001_wf_master_referesh FROM g_sql
 
    
 
 
   #190108-00038 ---start---
   
   #190108-00038 --- end ---
  
   IF g_bgjob = "Y" THEN
      #add-point:Service Call name="main.servicecall"

      #end add-point
   ELSE
      #???? (identifier)
      #190108-00038 ---modify start---
      OPEN WINDOW w_bsft001_wf WITH FORM cl_ap_formpath('csf',g_code)
      #190108-00038 --- modify end ---   
 
      #?????????
      CALL cl_ui_init()
   
      #?????
      CALL bsft001_wf_init()   
 
      #???? Menu (="N")
      CALL bsft001_wf_ui_dialog() 
      
      #add-point:????? name="main.before_close"

      #end add-point
 
      #????
      CLOSE WINDOW w_bsft001_wf
      
   END IF 
   
   CLOSE bsft001_wf_cl
   
   
 
   #add-point:????? name="main.exit"

   #end add-point
 
   #????
   CALL cl_ap_exitprogram("0")
END MAIN
 
 
 

{</section>}

{<section id="bsft001_wf.init" type="s" >}
#+ ?????????
PRIVATE FUNCTION bsft001_wf_init() RETURNS ()   #200213-00032
   #add-point:init?define(???) name="init.define_customerization"

   #end add-point    
   #190108-00038 ---start---
   DEFINE tpl_msg            STRING
   DEFINE tpl_node           om.DomNode
   DEFINE tpl_nodelist       om.NodeList
   DEFINE tpl_node_name      STRING
   DEFINE tpl_node_tagname   STRING
   DEFINE tpl_i              LIKE type_t.num5
   #190108-00038 --- end ---
   #add-point:init?define(?????????????????, ?????patch????????) name="init.define"

   #end add-point   
   
   #add-point:Function????  name="init.pre_function"

   #end add-point
   
   LET g_bfill       = "Y"
   LET g_detail_idx  = 1 #???????
   LET g_detail_idx2 = 1 #???????
   
   #??page??
   LET g_detail_idx_list[1] = 1 
   LET g_detail_idx_list[2] = 1
   LET g_detail_idx_list[3] = 1
   LET g_detail_idx_list[4] = 1
   LET g_detail_idx_list[5] = 1
 
   LET g_error_show  = 1
   LET l_ac = 1 #????
   LET g_err_rec = "N"   #161130-00056
      CALL cl_set_combo_scc_part('sfajwfstus','13','A,D,R,W,N,Y,F,U,X')
 
      CALL cl_set_combo_scc('sfajwf017','3020') 
   CALL cl_set_combo_scc('sfajwf013','22207') 
   CALL cl_set_combo_scc('sfajwf014','22208') 
   CALL cl_set_combo_scc('sfajwfua002','18005') 
   CALL cl_set_combo_scc('sfajwfua003','18006') 
   CALL cl_set_combo_scc('sfajwf003','4007') 
   CALL cl_set_combo_scc('sfajwf005','4010') 
   CALL cl_set_combo_scc('sfajwf004','4008') 
   CALL cl_set_combo_scc('sfakwf005','22201') 
   CALL cl_set_combo_scc('sfakwf014','22205') 
   CALL cl_set_combo_scc('sfakwf015','22206') 
   CALL cl_set_combo_scc('sfbcwf008','1101') 
   CALL cl_set_combo_scc('sfbcwf026','4012') 
 
   LET gwin_curr = ui.Window.getCurrent()  #??????
   LET gfrm_curr = gwin_curr.getForm()     #???????????
   LET g_wc2_extend = " 1=1" #???????? #190730-00003#4 add
   
   #page??
   LET g_idx_group = om.SaxAttributes.create()
   CALL g_idx_group.addAttribute("'1',","1")
   CALL g_idx_group.addAttribute("'4',","1")
   CALL g_idx_group.addAttribute("'2',","1")
   CALL g_idx_group.addAttribute("'3',","1")
   CALL g_idx_group.addAttribute("'5',","1")
 
 
   #190108-00038 ---start---
   CALL gfrm_curr.setElementHidden('ui_change',1)   #??????action
   #190108-00038 --- end ---
 
   #add-point:??????? name="init.init"
   CALL cl_set_combo_scc('sfanwf002','4019')  #240709-00009#1
   CALL cl_set_combo_scc('b_sfajwf013','22207') 
   CALL cl_set_combo_scc('b_sfajwf014','22208') 
   CALL cl_set_combo_scc('b_sfajwf003','4007') 
   CALL cl_set_combo_scc('b_sfajwf005','4010') 
   CALL cl_set_combo_scc('b_sfajwf004','4008')
   CALL cl_set_combo_scc_part('sfajwf022','2501','2')  #240325-00027#1 add
   CALL cl_get_para(g_enterprise,g_site,'S-MFG-0055') RETURNING g_para
   #????????g_site??aooi120???????????
   #230921-00006#7 add--s
   CALL cl_set_combo_scc('imaf013','2022')
   LET g_ooef004 = ''
   LET g_ooef008 = ''
   LET g_ooef009 = ''
   LET g_ooef016 = '' 
   SELECT ooef004,ooef008,ooef009,ooef016  
     INTO g_ooef004,g_ooef008,g_ooef009,g_ooef016  
     FROM ooef_t
    WHERE ooef001 = g_site AND ooefent  = g_enterprise
   
   #??????
   IF cl_get_para(g_enterprise,g_site,'S-BAS-0036')  = 'N' THEN
      CALL cl_set_comp_visible("sfbcwf021,sfbcwf021_desc,sfanwf006,sfanwf006_desc",FALSE)
   END IF
   CALL cl_set_comp_visible("number3,number4",FALSE)  #160122-00003#1
   CALL cl_ui_replace_sub_window(cl_ap_formpath("sub", "s_icd_wf_s01"), "grid_icd_wf", "Table", "s_detail1_s_icd_wf_s01")  
   CALL cl_set_toolbaritem_visible("turnkey",FALSE)
   #230921-00006#7 add--e
   CALL cl_set_combo_scc_part('sfajwf017','3020','1') #240201-00005#1
   CALL cl_set_combo_scc_part('sfamwf001','3020','1') #240201-00005#1
   #end add-point
   
   #?????init????default_search()??????????????????init()????g_wc??????
   IF cl_null(gs_first_time) OR gs_first_time <> "N" THEN   #190108-00038
      #???????
      CALL bsft001_wf_default_search()
   END IF   #190108-00038
    
END FUNCTION

{</section>}

{<section id="bsft001_wf.chk_data_exist" type="s" >}
#+ ??????????????
PRIVATE FUNCTION bsft001_wf_chk_data_exist(ps_sql) RETURNS ()   #200213-00032
   #add-point:chk_data_exist?define(???) name="chk_data_exist.define_customerization"

   #end add-point
   DEFINE ps_sql         STRING
   DEFINE ls_sql         STRING
   DEFINE ls_b           LIKE type_t.num5
   DEFINE ls_e           LIKE type_t.num5
   DEFINE ls_table       LIKE type_t.chr20
   DEFINE ls_wc          STRING
   #add-point:chk_data_exist?define (?????????????????, ?????patch????????) name="chk_

   #end add-point
 
   #add-point:chk_data_exist?action_chk name="chk_data_exist.action_chk"

   #end add-point
 
   #200220-00002 ---modify start---
   #????????????????????
   #ORACLE
   &ifdef is_ora
      LET ls_table = ""
      LET ls_wc = ""
      LET ls_b = ps_sql.getIndexOf("FROM",1)+5
      LET ls_e = ps_sql.getIndexOf("WHERE",ls_b)-1
      LET ls_table = ps_sql.subString(ls_b,ls_e)
 
      LET ls_b = ps_sql.getIndexOf("WHERE",1)
      LET ls_e = ps_sql.getIndexOf(" FOR ",ls_b)
      LET ls_wc = ps_sql.subString(ls_b,ls_e)
   &endif
 
   #MSV
   &ifdef is_msv
      LET ls_table = ""
      LET ls_wc = ""
      LET ls_b = ps_sql.getIndexOf("FROM",1)+5
      LET ls_e = ps_sql.getIndexOf("WITH",ls_b)-1
      LET ls_table = ps_sql.subString(ls_b,ls_e)
 
      LET ls_b = ps_sql.getIndexOf("WHERE",1)
      LET ls_e = ps_sql.getLength()
      LET ls_wc = ps_sql.subString(ls_b,ls_e)
   &endif
   #200220-00002 --- modify end ---
   
   #210511-00011 ---start---
   #POSTGRE
   &ifdef is_pgs
      LET ls_table = ""
      LET ls_wc = ""
      LET ls_b = ps_sql.getIndexOf("FROM",1)+5
      LET ls_e = ps_sql.getIndexOf("WHERE",ls_b)-1
      LET ls_table = ps_sql.subString(ls_b,ls_e)
 
      LET ls_b = ps_sql.getIndexOf("WHERE",1)
      LET ls_e = ps_sql.getIndexOf(" FOR ",ls_b)
      LET ls_wc = ps_sql.subString(ls_b,ls_e)
   &endif
   #210511-00011 --- end ---
 
   LET ls_sql = "SELECT COUNT(1) FROM ",ls_table," ",ls_wc
   PREPARE bsft001_wf_chk_data_exist_pre FROM ls_sql
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = 'PREPARE bsft001_wf_chk_data_exist_pre ERROR'
      LET g_errparam.code = SQLCA.SQLCODE
      LET g_errparam.popup = TRUE
      CALL cl_err()
   END IF
 
END FUNCTION

{</section>}

{<section id="bsft001_wf.ui_dialog" type="s" >}
#+ ????
PRIVATE FUNCTION bsft001_wf_ui_dialog() RETURNS ()   #200213-00032
   #add-point:ui_dialog?define(???) name="ui_dialog.define_customerization"

   #end add-point
   DEFINE li_idx     LIKE type_t.num10
   DEFINE ls_wc      STRING
   DEFINE lb_first   BOOLEAN
   DEFINE la_wc      DYNAMIC ARRAY OF RECORD
          tableid    STRING,
          wc         STRING
          END RECORD
   DEFINE la_param   RECORD
          prog       STRING,
          actionid   STRING,
          background LIKE type_t.chr1,
          param      DYNAMIC ARRAY OF STRING
          END RECORD
   DEFINE ls_js      STRING
   DEFINE la_output  DYNAMIC ARRAY OF STRING   #?????????
   DEFINE  l_cmd_token           base.StringTokenizer   #????cmdrun?? 
   DEFINE  l_cmd_next            STRING                 #????cmdrun??
   DEFINE  l_cmd_cnt             LIKE type_t.num5       #????cmdrun??
   DEFINE  l_cmd_prog_arg        STRING                 #????cmdrun??
   DEFINE  l_cmd_arg             STRING                 #????cmdrun??
   #(ver:87) ---add start---
   DEFINE l_arr_len       INTEGER
   DEFINE l_arr_cnt       INTEGER
   DEFINE lb_get_type     LIKE type_t.chr20
   #(ver:87) --- add end ---
   #add-point:ui_dialog?define (?????????????????, ?????patch????????) name="ui_dialog.define"
   DEFINE  l_n             LIKE type_t.num10                #?????  
   DEFINE l_imafwf210      LIKE imaf_t.imafwf210
   DEFINE l_success        LIKE type_t.num5
   DEFINE l_amount_die     LIKE icbawf_t.icbawf011
   DEFINE l_imaf053        LIKE imaf_t.imaf053
   DEFINE l_amount         LIKE inbb_t.inbb011
   DEFINE l_amount_2       LIKE inbb_t.inbb011
   DEFINE l_imaa006        LIKE imaa_t.imaa006
   DEFINE l_sfbcwf048      LIKE sfbcwf_t.sfbcwf048   
   #240423-00009#2 --s 
   DEFINE l_sql            STRING
   DEFINE l_sfbcwfseq      LIKE sfbcwf_t.sfbcwfseq
   DEFINE l_sfbcwfseq1     LIKE sfbcwf_t.sfbcwfseq1
   DEFINE l_sfbcwfseq2     LIKE sfbcwf_t.sfbcwfseq2
   DEFINE l_sfbcwf006      LIKE sfbcwf_t.sfbcwf006
   DEFINE l_sfbcwf043      LIKE sfbcwf_t.sfbcwf043
   DEFINE l_imafwf201      LIKE imaf_t.imafwf201
   #240423-00009#2 --e
   DEFINE l_sfbcwf023_sum     LIKE sfbcwf_t.sfbcwf023   
   DEFINE l_sfakwf006         LIKE sfakwf_t.sfakwf006 
   DEFINE l_sfakwf009         LIKE sfakwf_t.sfakwf009
   DEFINE l_sfakwf010         LIKE sfakwf_t.sfakwf010
   DEFINE l_sfakwf002         LIKE sfakwf_t.sfakwf002
   DEFINE l_bmba012           LIKE bmba_t.bmba012
   DEFINE l_bmba011           LIKE bmba_t.bmba011
   DEFINE l_cnt               LIKE type_t.num10
   DEFINE l_sfakwf034         LIKE sfakwf_t.sfakwf034 
   DEFINE l_sfbcwf_2   RECORD LIKE sfbcwf_t.*  #240725-00004#1 add
   #end add-point
   
   #add-point:Function????  name="ui_dialog.pre_function"

   #end add-point
   
   CALL cl_set_act_visible("accept,cancel", FALSE)
 
   #??????????
   IF g_default THEN
      CALL gfrm_curr.setElementHidden("mainlayout",0)
      CALL gfrm_curr.setElementHidden("worksheet",1)
      LET g_main_hidden = 0
   ELSE
      CALL gfrm_curr.setElementHidden("mainlayout",1)
      CALL gfrm_curr.setElementHidden("worksheet",0)
      LET g_main_hidden = 1
   END IF
   
   #action default??
   #?? a42 ??????(Version:3)
   #????????????
   CASE g_actdefault
      WHEN "insert"
         LET g_action_choice="insert"
         LET g_actdefault = ""
         IF cl_auth_chk_act("insert") THEN
            CALL bsft001_wf_insert()
            #add-point:ON ACTION insert name="menu.default.insert"

            #END add-point
         END IF
 
      #add-point:action default?? name="ui_dialog.action_default"

      #end add-point
      OTHERWISE
   END CASE
 
 
 
   
   LET lb_first = TRUE
   
   #add-point:ui_dialog?before dialog  name="ui_dialog.before_dialog"

   #end add-point
   
   WHILE TRUE 
   
      IF g_action_choice = "logistics" THEN
         #?????????
         CLEAR FORM
         CALL g_browser.clear()       
         INITIALIZE g_sfajwf_m.* TO NULL
         CALL g_sfakwf_d.clear()
         CALL g_sfakwf2_d.clear()
         CALL g_sfakwf3_d.clear()
         CALL g_sfakwf4_d.clear()
         CALL g_sfakwf5_d.clear()
 
         LET g_wc  = ' 1=2'
         LET g_wc2 = ' 1=1'
         LET g_action_choice = ""
         CALL bsft001_wf_init()
      END IF
   
      #190108-00038 ---start---
      
      #190108-00038 --- end ---
 
      CALL lib_cl_dlg.cl_dlg_before_display()
            
      DIALOG ATTRIBUTES(UNBUFFERED,FIELD ORDER FORM)
 
         #??????
         DISPLAY ARRAY g_browser TO s_browse.* ATTRIBUTES(COUNT=g_header_cnt)
            BEFORE ROW
               #??????? (?????????)
               LET g_current_idx = DIALOG.getCurrentRow("s_browse")
               IF g_current_row > 1 AND g_current_idx = 1 AND g_current_sw = FALSE THEN
                  CALL DIALOG.setCurrentRow("s_browse",g_current_row)
                  LET g_current_idx = g_current_row
               END IF
               LET g_current_row = g_current_idx #????
               LET g_current_sw = TRUE
         
               IF g_current_idx > g_browser.getLength() THEN
                  LET g_current_idx = g_browser.getLength()
               END IF 
               
               CALL bsft001_wf_fetch('') # reload data
               LET l_ac = 1
               CALL bsft001_wf_ui_detailshow() #Setting the current row 
         
               CALL bsft001_wf_idx_chk()
               #NEXT FIELD sfakwfseq
         
               ON ACTION qbefield_user   #?????? 
                  LET g_action_choice="qbefield_user"
                  CALL cl_ui_qbefield_user()
         END DISPLAY
    
         DISPLAY ARRAY g_sfakwf_d TO s_detail1.* ATTRIBUTES(COUNT=g_rec_b) #page1  
    
            BEFORE ROW
               #??????
               CALL bsft001_wf_idx_chk()
               #?????????
               LET l_ac = DIALOG.getCurrentRow("s_detail1")
               LET g_detail_idx = l_ac
               LET g_detail_idx_list[1] = l_ac
               CALL g_idx_group.addAttribute("'1',",l_ac)
               CALL bsft001_wf_b_fill2('3')
CALL bsft001_wf_b_fill2('4')
CALL bsft001_wf_b_fill2('5')
 
               #add-point:page1, before row?? name="ui_dialog.page1.before_row"

               #end add-point
               
            BEFORE DISPLAY
               #????????1???????
               IF g_loc = 'm' THEN
                  CALL FGL_SET_ARR_CURR(g_idx_group.getValue("'1',"))
               END IF
               LET g_loc = 'm'
               LET l_ac = DIALOG.getCurrentRow("s_detail1")
               LET g_current_page = 1
               #??????
               CALL bsft001_wf_idx_chk()
               #add-point:page1????? name="ui_dialog.page1.before_display"

               #end add-point
               
            #??ACTION(detail_show,page_1)
            
 
         #?? a43 ??????(Version:4)
         ON ACTION detail_qrystr
               MENU "" ATTRIBUTE(STYLE="popup")
                  #add-point:ON ACTION detail_qrystr???? name="menu.detail_show.page1_sub.detail_qrystr"

                  #END add-point
                                 #?? a43 ??????(Version:4)
               ON ACTION prog_sfakwf029
                  LET g_action_choice="prog_sfakwf029"
                  IF cl_auth_chk_act("prog_sfakwf029") THEN
                     
                     #add-point:ON ACTION prog_sfakwf029 name="menu.detail_show.page1_sub.prog_sfakwf029"
               #?? a41 ??????(Version:3)
               #??JSON???????????(??)
               INITIALIZE la_param.* TO NULL
               LET la_param.prog     = 'sfakwf029'
               LET la_param.param[1] = g_sfakwf_d[l_ac].sfakwf029

               LET ls_js = util.JSON.stringify(la_param)
               CALL cl_cmdrun_wait(ls_js)
 



                     #END add-point
                     
                  END IF
 
 
 
 
               END MENU
 
 
 
               #add-point:ON ACTION detail_qrystr name="menu.detail_show.page1.detail_qrystr"

               #END add-point
 
 
 
 
               
            #add-point:page1????? name="ui_dialog.page1.action"
#     ON ACTION detail_qrystr
#          MENU "" ATTRIBUTE(STYLE="popup")
#                  
#                  BEFORE MENU
#                     IF g_detail_idx < 1 OR cl_null(g_detail_idx) THEN 
#                        EXIT MENU
#                     END IF
#                  #201029-00004#1 add -e-
#                  #END add-point
#                                 #?? a43 ??????(Version:4)
#               ON ACTION prog_sfakwf029 
#                  LET g_action_choice="prog_sfakwf029"
#                  IF cl_auth_chk_act("prog_sfakwf029") THEN
#                     
#                     #add-point:ON ACTION prog_sfakwf029 name="menu.detail_show.page1_sub.prog_sfakwf029"
#                  #   CALL bsft001_wf_qrystr('sfakwf029')
#                     #END add-point
#                     
#                  END IF
#
#               #?? a43 ??????(Version:4)
#               ON ACTION prog_sfakwf030 
#                  LET g_action_choice="prog_sfakwf030"
#                  IF cl_auth_chk_act("prog_sfakwf030") THEN
#                     
#                     #add-point:ON ACTION prog_sfakwf030 name="menu.detail_show.page1_sub.prog_sfakwf030"
#                   #  CALL bsft001_wf_qrystr('sfakwf030')
#                     #END add-point
#                     
#                  END IF
#               #?? a43 ??????(Version:4)
#               ON ACTION prog_sfakwf031 
#                  LET g_action_choice="prog_sfakwf031"
#                  IF cl_auth_chk_act("prog_sfakwf031") THEN
#                     
#                     #add-point:ON ACTION prog_sfakwf031 name="menu.detail_show.page1_sub.prog_sfakwf031"
#                  #   CALL bsft001_wf_qrystr('sfakwf031')
#                     #END add-point
#                     
#                  END IF
#                  
#          END MENU
            #end add-point
               
         END DISPLAY
        
         #???????
         DISPLAY ARRAY g_sfakwf4_d TO s_detail4.* ATTRIBUTES(COUNT=g_rec_b)  
    
            BEFORE ROW
               #??????
               CALL bsft001_wf_idx_chk()
               LET l_ac = DIALOG.getCurrentRow("s_detail4")
               LET g_detail_idx = l_ac
               LET g_detail_idx_list[4] = l_ac
               CALL g_idx_group.addAttribute("'3',",l_ac)
               
               #add-point:page4, before row?? name="ui_dialog.body4.before_row"

               #end add-point
               
            BEFORE DISPLAY
               #????????1???????
               IF g_loc = 'm' THEN
                  CALL FGL_SET_ARR_CURR(g_idx_group.getValue("'3',"))
               END IF
               LET g_loc = 'm'
               LET l_ac = DIALOG.getCurrentRow("s_detail4")
               LET g_current_page = 4
               #??????
               CALL bsft001_wf_idx_chk()
               #add-point:page4????? name="ui_dialog.body4.before_display"

               #end add-point
      
            #??ACTION(detail_show,page_4)
            
         
            #add-point:page4????? name="ui_dialog.body4.action"

            #end add-point
         
         END DISPLAY
 
         
         #???????
         DISPLAY ARRAY g_sfakwf2_d TO s_detail2.* ATTRIBUTES(COUNT=g_rec_b)  
    
            BEFORE ROW
               #??????
               CALL bsft001_wf_idx_chk()
               LET l_ac = DIALOG.getCurrentRow("s_detail2")
               LET g_detail_idx2 = l_ac
               LET g_detail_idx_list[2] = l_ac
               CALL g_idx_group.addAttribute("'4',",l_ac)
               
               #add-point:page2, before row?? name="ui_dialog.body2.before_row"

               #end add-point
               
            BEFORE DISPLAY
               #?????????????????
               IF g_loc = 'd' THEN
                  CALL FGL_SET_ARR_CURR(g_idx_group.getValue("'4',"))
               END IF
               LET g_loc = 'd'
               LET l_ac = DIALOG.getCurrentRow("s_detail2")
               LET g_current_page = 2
               #??????
               CALL bsft001_wf_idx_chk()
               #add-point:page2????? name="ui_dialog.body2.before_display"

               #end add-point
      
            #??ACTION(detail_show,page_2)
            
 
         #?? a43 ??????(Version:4)
         ON ACTION gen_bin
            LET g_action_choice="gen_bin"
            IF cl_auth_chk_act("gen_bin") THEN
               
               #add-point:ON ACTION gen_bin name="menu.detail_show.page2.gen_bin"
               IF g_sfajwf_m.sfajwfstus <> 'N' THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = 'wf-00017'
                  LET g_errparam.extend = ""
                  LET g_errparam.popup = TRUE
                  CALL cl_err()    
                  EXIT DIALOG
               END IF
               LET l_n = 0 
               SELECT COUNT(1) INTO l_n
                 FROM sfbcwf_t
                WHERE sfbcwfent = g_enterprise 
                  AND sfbcwfdocno = g_sfajwf_m.sfajwfdocno
                  AND sfbcwfseq = g_sfakwf_d[g_detail_idx].sfakwfseq
               SELECT imafwf210 INTO l_imafwf210
                 FROM imaf_t
                WHERE imafent = g_enterprise
                  AND imafsite = g_site
                  AND imaf001 = g_sfakwf2_d[l_ac].sfbcwf006                    
               IF l_imafwf210 = 'Y' AND l_n > 0 THEN #??????????
                  IF NOT s_transaction_chk('Y',0) THEN
                     CALL s_transaction_begin()
                  END IF
                  CALL s_icd_wf_out(g_site,g_sfajwf_m.sfajwfdocno,g_sfakwf2_d[l_ac].sfbcwfseq1,g_sfakwf2_d[l_ac].sfbcwfseq2,g_sfakwf2_d[l_ac].sfbcwf006,g_sfakwf2_d[l_ac].sfbcwf021,g_sfakwf2_d[l_ac].sfbcwf014,g_sfakwf2_d[l_ac].sfbcwf013,'-1',g_sfajwf_m.sfajwf001,'1','',
                              g_sfakwf2_d[l_ac].sfbcwf019,g_sfakwf2_d[l_ac].sfbcwf020,g_sfakwf2_d[l_ac].sfbcwf029,g_sfakwf2_d[l_ac].sfbcwf040,g_sfakwf2_d[l_ac].sfbcwf041,g_sfakwf2_d[l_ac].sfbcwf042,g_sfakwf2_d[l_ac].sfbcwf030,g_sfakwf_d[g_detail_idx].sfakwfseq,g_sfakwf2_d[l_ac].sfbcwf039)   #160316-00007#1 add by lixh 20160316 add sfbcwf030  #add by lixh 20150909     
                     RETURNING l_success,l_amount,l_amount_die                  
                  IF l_success THEN
                     IF s_icd_wf_clear_flag(g_sfajwf_m.sfajwfdocno,g_sfakwf_d[g_detail_idx].sfakwfseq,'-1') THEN
                        LET g_sfakwf2_d[l_ac].sfbcwf040 = NULL 	#DATECODE
                        LET g_sfakwf2_d[l_ac].sfbcwf041 = NULL 	#????
                        LET g_sfakwf2_d[l_ac].sfbcwf042 = NULL 	#????
                     END IF 
#                     CALL s_icd_wf_clear_inbb003(g_sfajwf_m.sfajwfdocno,g_sfakwf_d[g_detail_idx].sfakwfseq,'-1') RETURNING l_success,l_icbawf003,l_icbawf018
#                     IF l_success THEN
#                        LET g_sfakwf2_d[l_ac].sfbcwf030 = l_icbawf003 	   #??????
#                        LET g_sfakwf2_d[l_ac].sfbcwf039 = l_icbawf018 	 #????	
#                     ELSE
#                        LET g_sfakwf2_d[l_ac].sfbcwf030 = NULL 	   #??????
#                        LET g_sfakwf2_d[l_ac].sfbcwf039 = NULL 	 #????	
#                     END IF
                     IF s_aint302_wf_oocawf008(g_sfakwf2_d[l_ac].sfbcwf006) THEN
                        LET l_amount_2 = l_amount_die
                     ELSE
                        LET l_amount_2 = l_amount
                     END IF
                     SELECT imaa006,imaf053 INTO l_imaa006,l_imaf053 FROM imaf_t 
                       LEFT OUTER JOIN imaa_t ON imaaent = g_enterprise AND imaa001 = imaf001
                      WHERE imafent = g_enterprise AND imafsite = g_site
                        AND imaf001 = g_sfakwf2_d[l_ac].sfbcwf006
                     IF s_aint302_wf_oocawf008(g_sfakwf2_d[l_ac].sfbcwf006) THEN
                        IF l_imaf053 = l_imaa006 THEN   #????=????
                           LET l_sfbcwf048 =  l_amount_die  #?????? 
                        ELSE
                           LET l_sfbcwf048 =  l_amount                
                        END IF                               
                     ELSE
                        IF l_imaf053 = l_imaa006 THEN   #????=????
                           LET l_sfbcwf048 =  l_amount  #?????? 
                        ELSE
                           LET l_sfbcwf048 =  l_amount_die                
                        END IF  
                     END IF                            
                     IF g_sfakwf2_d[l_ac].sfbcwf023 <> l_amount_2 OR l_sfbcwf048 <> g_sfakwf2_d_t.sfbcwf048 THEN      #???????????????????               
                        IF cl_ask_confirm('wf-00002') THEN   #????????????????????????????                                   
                           IF s_aint302_wf_oocawf008(g_sfakwf2_d[l_ac].sfbcwf006) THEN
                              LET g_sfakwf2_d[l_ac].sfbcwf047 = l_amount_die #????
                              IF g_sfakwf2_d[l_ac].sfbcwf014 = l_imaf053  THEN  #????=????
                                 LET g_sfakwf2_d[l_ac].sfbcwf023 = l_amount_die #?????
                              ELSE 
                                 LET g_sfakwf2_d[l_ac].sfbcwf023 = l_amount                                
                              END IF
                              IF l_imaf053 = l_imaa006 THEN   #????=????
                                 LET g_sfakwf2_d[l_ac].sfbcwf048 =  l_amount_die  #?????? 
                              ELSE
                                 LET g_sfakwf2_d[l_ac].sfbcwf048 =  l_amount                
                              END IF                               
                           ELSE
                              LET g_sfakwf2_d[l_ac].sfbcwf047 = l_amount #????
                              IF g_sfakwf2_d[l_ac].sfbcwf014 = l_imaf053  THEN 
                                 LET g_sfakwf2_d[l_ac].sfbcwf023 = l_amount 
                              ELSE                              
                                 LET g_sfakwf2_d[l_ac].sfbcwf023 = l_amount_die            
                              END IF
                              IF l_imaf053 = l_imaa006 THEN   #????=????
                                 LET g_sfakwf2_d[l_ac].sfbcwf048 =  l_amount  #?????? 
                              ELSE
                                 LET g_sfakwf2_d[l_ac].sfbcwf048 =  l_amount_die                
                              END IF  
                           END IF
                           #????
                           IF NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf014) THEN
                              CALL s_aooi250_take_decimals(g_sfakwf2_d[l_ac].sfbcwf014,g_sfakwf2_d[l_ac].sfbcwf023)
                                   RETURNING l_success,g_sfakwf2_d[l_ac].sfbcwf023
                           END IF
                           IF NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf014) THEN
                              CALL s_aooi250_take_decimals(g_sfakwf2_d[l_ac].sfbcwf014,g_sfakwf2_d[l_ac].sfbcwf024)
                                   RETURNING l_success,g_sfakwf2_d[l_ac].sfbcwf024
                           END IF
                           #?????=????+??????
                           LET g_sfakwf2_d[l_ac].sfbcwf013 = g_sfakwf2_d[l_ac].sfbcwf024 + g_sfakwf2_d[l_ac].sfbcwf023
                           IF NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf014) THEN
                              CALL s_aooi250_take_decimals(g_sfakwf2_d[l_ac].sfbcwf014,g_sfakwf2_d[l_ac].sfbcwf013)
                                   RETURNING l_success,g_sfakwf2_d[l_ac].sfbcwf013
                           END IF                           
                           
                           #241104-00004#1 add--s
                           SELECT COUNT(1) INTO l_cnt FROM bmba_t 
                            WHERE bmbaent = g_enterprise AND bmbasite = g_site AND bmba001 = g_sfakwf_d[g_detail_idx].sfakwf001 AND bmba003 = g_sfakwf2_d[l_ac].sfbcwf006
                              AND bmba002 = g_sfakwf_d[g_detail_idx].sfakwf001  AND bmba004 = g_sfakwf2_d[l_ac].sfbcwf002 AND bmbawf039 = 'Y'
                              AND bmba007 = g_sfakwf2_d[l_ac].sfbcwf003 AND bmba008 = g_sfakwf2_d[l_ac].sfbcwf004
                           IF l_cnt > 0 THEN  #?????????BOM???????????,???????????
                              SELECT bmba012,bmba011 INTO l_bmba012,l_bmba011 FROM bmba_t
                               WHERE bmbaent = g_enterprise AND bmbasite = g_site AND bmba001 = g_sfakwf_d[g_detail_idx].sfakwf001  AND bmba002 = g_sfakwf_d[g_detail_idx].sfakwf002
                                 AND bmba003 = g_sfakwf2_d[l_ac].sfbcwf006 AND bmba004 = g_sfakwf2_d[l_ac].sfbcwf002
                                 AND bmba007 = g_sfakwf2_d[l_ac].sfbcwf003 AND bmba008 = g_sfakwf2_d[l_ac].sfbcwf004
                              LET g_sfakwf2_d[l_ac].sfbcwf049 = g_sfakwf2_d[l_ac].sfbcwf023 * l_bmba012 / l_bmba011                              
                           ELSE
                              LET g_sfakwf2_d[l_ac].sfbcwf049 = g_sfakwf2_d[l_ac].sfbcwf023
                           END IF
                           #241104-00004#1 add--e
                           #250319-00001#1 add--s
                           #??QPA????
                           CALL bsft001_wf_sfbcwf023_qpa_02(g_sfakwf2_d[l_ac].sfbcwf023,g_sfakwf2_d[l_ac].sfbcwf049) RETURNING g_sfakwf2_d[l_ac].sfbcwf010,g_sfakwf2_d[l_ac].sfbcwf011
                           #250319-00001#1 add--e
                           UPDATE sfbcwf_t SET sfbcwf040 = g_sfakwf2_d[l_ac].sfbcwf040,                              
                                               sfbcwf041 = g_sfakwf2_d[l_ac].sfbcwf041,                                                 
                                               sfbcwf042 = g_sfakwf2_d[l_ac].sfbcwf042,
                                               sfbcwf047 = g_sfakwf2_d[l_ac].sfbcwf047,
                                               sfbcwf023 = g_sfakwf2_d[l_ac].sfbcwf023,                                             
                                               sfbcwf048 = g_sfakwf2_d[l_ac].sfbcwf048,
                                               sfbcwf024 = g_sfakwf2_d[l_ac].sfbcwf024,
                                               sfbcwf049 = g_sfakwf2_d[l_ac].sfbcwf049, #241104-00004#1 add
                                               sfbcwf010 = g_sfakwf2_d[l_ac].sfbcwf010, #250319-00001#1 add
                                               sfbcwf011 = g_sfakwf2_d[l_ac].sfbcwf011, #250319-00001#1 add
                                               sfbcwf013 = g_sfakwf2_d[l_ac].sfbcwf013
                            WHERE sfbcwfent = g_enterprise AND sfbcwfsite = g_site AND sfbcwfdocno = g_sfajwf_m.sfajwfdocno AND sfbcwfseq = g_sfakwf_d[g_detail_idx].sfakwfseq 
                              AND sfbcwfseq1 = g_sfakwf2_d[l_ac].sfbcwfseq1 AND sfbcwfseq2 = g_sfakwf2_d[l_ac].sfbcwfseq2
                           IF SQLCA.sqlcode THEN
                              INITIALIZE g_errparam TO NULL
                              LET g_errparam.code = SQLCA.sqlcode
                              LET g_errparam.extend = "sfbcwf_t"
                              LET g_errparam.popup = FALSE
                              CALL cl_err()  
                              CALL s_transaction_end('N','0') 
                              EXIT DIALOG
                           END IF   
                           #241104-00004#1 mark--s
                           #240423-00009#2 --s
#                           #??????,????bin?????????????????????????
#                           IF g_sfakwf2_d[l_ac].sfbcwf043 = 'Y' THEN
#                              LET l_sql = " SELECT * ",
#                                          " FROM sfbcwf_t ",
#                                          "  WHERE sfbcwfent = ",g_enterprise,"", 
#                                          " AND sfbcwfsite ='",g_site,"'",
#                                          " AND sfbcwfdocno ='",g_sfajwf_m.sfajwfdocno,"'",
#                                          " AND sfbcwfseq =",g_sfakwf_d[g_detail_idx].sfakwfseq,"", 
#                                          " AND sfbcwfseq1 !=",g_sfakwf2_d[l_ac].sfbcwfseq1,""
#                                 PREPARE ups_fucai_pb FROM l_sql
#                                 DECLARE ups_fucai_cs CURSOR FOR ups_fucai_pb
#                              FOREACH ups_fucai_cs INTO l_sfbcwf_2.*
#                                  IF SQLCA.SQLCODE THEN
#                                     INITIALIZE g_errparam TO NULL 
#                                     LET g_errparam.extend = "FOREACH:",SQLERRMESSAGE 
#                                     LET g_errparam.code = SQLCA.SQLCODE 
#                                     LET g_errparam.popup = TRUE 
#                                     CALL cl_err()
#                                     EXIT FOREACH
#                                  END IF
#                                  #???????????????
#                                  SELECT imafwf201 INTO l_imafwf201 FROM imaf_t WHERE imafent = g_enterprise AND imafsite = g_site
#                                    AND imaf001 = l_sfbcwf_2.sfbcwf006
#                                  SELECT imaa006,imaf053 INTO l_imaa006,l_imaf053 FROM imaf_t 
#                                    LEFT OUTER JOIN imaa_t ON imaaent = g_enterprise AND imaa001 = imaf001
#                                   WHERE imafent = g_enterprise AND imafsite = g_site
#                                     AND imaf001 = l_sfbcwf_2.sfbcwf006
#                                  IF (l_sfbcwf_2.sfbcwf043 = 'N' OR cl_null(l_sfbcwf_2.sfbcwf043)) AND (l_imafwf201='9' OR l_imafwf201='6') THEN
#                                      #240725-00004#1 mark--s
##                                     IF s_aint302_wf_oocawf008(l_sfbcwf006) THEN
##                                       IF l_imaf053 = l_imaa006 THEN   #????=????
##                                        UPDATE sfbcwf_t SET sfbcwf023 = l_amount_die,sfbcwf013 = l_amount_die
##                                        WHERE sfbcwfent = g_enterprise AND sfbcwfsite = g_site AND sfbcwfdocno = g_sfajwf_m.sfajwfdocno
##                                          AND sfbcwfseq1 = l_sfbcwfseq1 AND sfbcwfseq2 = l_sfbcwfseq2
##                                       ELSE
##                                        UPDATE sfbcwf_t SET sfbcwf023 = l_amount,sfbcwf013 = l_amount
##                                        WHERE sfbcwfent = g_enterprise AND sfbcwfsite = g_site AND sfbcwfdocno = g_sfajwf_m.sfajwfdocno
##                                          AND sfbcwfseq1 = l_sfbcwfseq1 AND sfbcwfseq2 = l_sfbcwfseq2
##                                       END IF
##                                     ELSE
##                                       IF l_imaf053 = l_imaa006 THEN   #????=????
##                                        UPDATE sfbcwf_t SET sfbcwf023 = l_amount,sfbcwf013 = l_amount
##                                        WHERE sfbcwfent = g_enterprise AND sfbcwfsite = g_site AND sfbcwfdocno = g_sfajwf_m.sfajwfdocno
##                                          AND sfbcwfseq1 = l_sfbcwfseq1 AND sfbcwfseq2 = l_sfbcwfseq2
##                                       ELSE
##                                        UPDATE sfbcwf_t SET sfbcwf023 = l_amount_die,sfbcwf013 = l_amount_die
##                                        WHERE sfbcwfent = g_enterprise AND sfbcwfsite = g_site AND sfbcwfdocno = g_sfajwf_m.sfajwfdocno
##                                          AND sfbcwfseq1 = l_sfbcwfseq1 AND sfbcwfseq2 = l_sfbcwfseq2
##                                       END IF
##                                     END IF
#                                      #240725-00004#1 mark--e
#                                     #240725-00004#1 add--s
#                                     LET l_sfbcwf_2.sfbcwf023 = g_sfakwf2_d[l_ac].sfbcwf023
#                                     #????
#                                     IF NOT cl_null(l_sfbcwf_2.sfbcwf014) THEN
#                                        CALL s_aooi250_take_decimals(l_sfbcwf_2.sfbcwf014,l_sfbcwf_2.sfbcwf023)
#                                             RETURNING l_success,l_sfbcwf_2.sfbcwf023
#                                     END IF
#                                     IF NOT cl_null(l_sfbcwf_2.sfbcwf014) THEN
#                                        CALL s_aooi250_take_decimals(l_sfbcwf_2.sfbcwf014,l_sfbcwf_2.sfbcwf024)
#                                             RETURNING l_success,l_sfbcwf_2.sfbcwf024
#                                     END IF
#                                     #?????=????+??????
#                                     LET l_sfbcwf_2.sfbcwf013 = l_sfbcwf_2.sfbcwf024 + l_sfbcwf_2.sfbcwf023
#                                     IF NOT cl_null(l_sfbcwf_2.sfbcwf014) THEN
#                                        CALL s_aooi250_take_decimals(l_sfbcwf_2.sfbcwf014,l_sfbcwf_2.sfbcwf013)
#                                             RETURNING l_success,l_sfbcwf_2.sfbcwf013
#                                     END IF 
#                                     SELECT bmba012,bmba011 INTO l_bmba012,l_bmba011 FROM bmba_t
#                                      WHERE bmbaent = g_enterprise AND bmbasite = g_site AND bmba001 =  g_sfakwf_d[g_detail_idx].sfakwf001 AND bmba002 =  g_sfakwf_d[g_detail_idx].sfakwf002
#                                        AND bmba003 = l_sfbcwf_2.sfbcwf006 AND bmba004 = l_sfbcwf_2.sfbcwf002
#                                        AND bmba007 = l_sfbcwf_2.sfbcwf003 AND bmba008 = l_sfbcwf_2.sfbcwf004
#                                     #????/??????????????????????????/????????                          
#                                     CALL s_aooi250_convert_qty(l_sfbcwf_2.sfbcwf006,l_sfbcwf_2.sfbcwf014,l_imaf053,l_sfbcwf_2.sfbcwf013) 
#                                        RETURNING l_success,l_sfbcwf_2.sfbcwf047  #????
#                                     CALL s_aooi250_convert_qty(l_sfbcwf_2.sfbcwf006,l_sfbcwf_2.sfbcwf014,l_imaa006,l_sfbcwf_2.sfbcwf013) 
#                                        RETURNING l_success,l_sfbcwf_2.sfbcwf048  #??????
#                                     LET l_sfbcwf_2.sfbcwf049 = l_sfbcwf_2.sfbcwf023 * l_bmba012 / l_bmba011            
#                                     #??QPA????
#                                     CALL s_bsft001_wf_02_qpa(l_sfbcwf_2.sfbcwf023,l_sfbcwf_2.sfbcwf049) RETURNING l_sfbcwf_2.sfbcwf010,l_sfbcwf_2.sfbcwf011
#                                     
#                                     UPDATE sfbcwf_t SET sfbcwf010 = l_sfbcwf_2.sfbcwf010, 
#                                                         sfbcwf011 = l_sfbcwf_2.sfbcwf011,
#                                                         sfbcwf023 = l_sfbcwf_2.sfbcwf023,
#                                                         sfbcwf024 = l_sfbcwf_2.sfbcwf024,
#                                                         sfbcwf013 = l_sfbcwf_2.sfbcwf013,
#                                                         sfbcwf019 = l_sfbcwf_2.sfbcwf019,
#                                                         sfbcwf020 = l_sfbcwf_2.sfbcwf020,
#                                                         sfbcwf029 = l_sfbcwf_2.sfbcwf029,         
#                                                         sfbcwf047 = l_sfbcwf_2.sfbcwf047, 
#                                                         sfbcwf048 = l_sfbcwf_2.sfbcwf048,
#                                                         sfbcwf049 = l_sfbcwf_2.sfbcwf049
#                                       WHERE sfbcwfent = g_enterprise AND sfbcwfsite = g_site AND sfbcwfdocno = g_sfajwf_m.sfajwfdocno
#                                         AND sfbcwfseq1 = l_sfbcwf_2.sfbcwfseq1 AND sfbcwfseq2 = l_sfbcwf_2.sfbcwfseq2
#                                     #240725-00004#1 add--e
#                                     IF SQLCA.sqlcode THEN
#                                        INITIALIZE g_errparam TO NULL
#                                        LET g_errparam.extend = "UPDATE sfbcwf_t:",SQLERRMESSAGE
#                                        LET g_errparam.code   = SQLCA.sqlcode
#                                        LET g_errparam.popup  = TRUE
#                                        CALL cl_err()
#                                        CALL s_transaction_end('N','0') 
#                                        EXIT DIALOG
#                                     END IF
#                                  END IF
#                              END FOREACH
#                           END IF
                           #240423-00009#2 --e
                           #241104-00004#1 mark--e
                           #241104-00004#1 add--s #QTB20250618043 mark
#                           IF g_sfakwf2_d[l_ac].sfbcwf043 = 'Y' THEN
#                              CALL bsft001_wf_up_fc() RETURNING l_success 
#                              IF NOT l_success THEN
#                                 CALL s_transaction_end('N','0') 
#                                 EXIT DIALOG
#                              END IF
#                           END IF
                           #241104-00004#1 add--e
                        END IF
                     END IF 
                     #240611-00019#2 mark--s
#                     #??????sfakwf006=?????sfbcwf023*bmba012????/bmba011????
#                     IF cl_null(g_sfakwf_d[g_detail_idx].sfakwf002) THEN
#                        LET l_sfakwf002 = ' '
#                     ELSE
#                        LET l_sfakwf002 = g_sfakwf_d[g_detail_idx].sfakwf002 
#                     END IF      
#                     SELECT COUNT(1) INTO l_cnt FROM bmba_t 
#                      WHERE bmbaent = g_enterprise AND bmbasite = g_site AND bmba001 = g_sfakwf_d[g_detail_idx].sfakwf001 AND bmba003 = g_sfakwf2_d[l_ac].sfbcwf006
#                        AND bmba002 = l_sfakwf002  AND bmba004 = g_sfakwf2_d[l_ac].sfbcwf002 AND bmbawf039 = 'Y'
#                        AND bmba007 = g_sfakwf2_d[l_ac].sfbcwf003 AND bmba008 = g_sfakwf2_d[l_ac].sfbcwf004
#                     IF l_cnt > 0 THEN  #?????????BOM???????????,???????????
#                        SELECT bmba012,bmba011 INTO l_bmba012,l_bmba011 FROM bmba_t
#                         WHERE bmbaent = g_enterprise AND bmbasite = g_site AND bmba001 = g_sfakwf_d[g_detail_idx].sfakwf001  AND bmba002 = l_sfakwf002
#                           AND bmba003 = g_sfakwf2_d[l_ac].sfbcwf006 AND bmba004 = g_sfakwf2_d[l_ac].sfbcwf002
#                           AND bmba007 = g_sfakwf2_d[l_ac].sfbcwf003 AND bmba008 = g_sfakwf2_d[l_ac].sfbcwf004
#                        SELECT SUM(sfbcwf023) INTO l_sfbcwf023_sum FROM sfbcwf_t 
#                         WHERE sfbcwfent = g_enterprise AND sfbcwfsite = g_site AND sfbcwfdocno = g_sfajwf_m.sfajwfdocno AND sfbcwfseq = g_sfakwf_d[g_detail_idx].sfakwfseq
#                           AND sfbcwf043 = 'Y' 
#                        LET l_sfakwf006 = l_sfbcwf023_sum * l_bmba012 / l_bmba011                  
#                     ELSE
#                        SELECT SUM(sfbcwf023) INTO l_sfbcwf023_sum FROM sfbcwf_t 
#                         WHERE sfbcwfent = g_enterprise AND sfbcwfsite = g_site AND sfbcwfdocno = g_sfajwf_m.sfajwfdocno AND sfbcwfseq = g_sfakwf_d[g_detail_idx].sfakwfseq          
#                        LET l_sfakwf006 = l_sfbcwf023_sum
#                     END IF 
#                     
#                     #???????????????????????????
##                     CALL s_aooi250_convert_qty(g_sfakwf2_d[l_ac].sfbcwf006,g_sfakwf2_d[l_ac].sfbcwf014,g_sfakwf_d[g_detail_idx].sfakwf007,g_sfakwf2_d[l_ac].sfbcwf023) 
##                           RETURNING l_success,g_sfakwf2_d[l_ac].sfbcwf047  #????
#                     CALL s_aooi250_convert_qty(g_sfakwf2_d[l_ac].sfbcwf006,g_sfakwf2_d[l_ac].sfbcwf014,g_sfakwf_d[g_detail_idx].sfakwf007,l_sfakwf006) 
#                          RETURNING l_success,l_sfakwf006  
#                     #??aimm215??????????????
#                     CALL s_asft300_02_get_sfaa012(g_sfakwf_d[g_detail_idx].sfakwf001,l_sfakwf006,g_sfakwf_d[g_detail_idx].sfakwf007,'N','N') 
#                              RETURNING l_sfakwf006,l_success     
#                     #????U1?????DATECODE??,U1????????????U1????
#                     SELECT sfbcwf029,sfbcwf040 INTO l_sfakwf009,l_sfakwf010 FROM sfbcwf_t 
#                      WHERE sfbcwfent = g_enterprise AND sfbcwfsite = g_site AND sfbcwfdocno = g_sfajwf_m.sfajwfdocno 
#                        AND sfbcwfseq = g_sfakwf_d[g_detail_idx].sfakwfseq AND sfbcwf043 = 'Y' 
#                        AND ROWNUM = 1  
#                     
#                     #?????? 
#                     SELECT imaa006,imaf053 INTO l_imaa006,l_imaf053 FROM imaf_t 
#                       LEFT OUTER JOIN imaa_t ON imaaent = g_enterprise AND imaa001 = imaf001
#                      WHERE imafent = g_enterprise AND imafsite = g_site
#                        AND imaf001 = g_sfakwf2_d[l_ac].sfbcwf006
#                     SELECT NVL(SUM(icbawf011),0),NVL(SUM(icbawf022),0) INTO l_amount_die,l_amount FROM icbawf_t
#                      LEFT JOIN sfbcwf_t ON sfbcwfent = icbawfent AND sfbcwfsite =icbawfsite AND sfbcwfdocno = icbawfdocno 
#                                      AND sfbcwfseq = icbawf032 AND sfbcwfseq1 = icbawfseq AND sfbcwfseq2 = icbawfseq1
#                      WHERE icbawfent = g_enterprise AND icbawfsite = g_site
#                        AND icbawfdocno = g_sfajwf_m.sfajwfdocno 
#                        AND icbawf032 = g_sfakwf_d[g_detail_idx].sfakwfseq  #????
#                        AND sfbcwf043 = 'Y'                
#                     IF s_aint302_wf_oocawf008(g_sfakwf2_d[l_ac].sfbcwf006) THEN
#                        IF g_sfakwf_d[g_detail_idx].sfakwf035 = l_imaf053 THEN   
#                           LET l_sfakwf034 = l_amount_die
#                        ELSE
#                           LET l_sfakwf034 = l_amount                
#                        END IF                               
#                     ELSE
#                        IF g_sfakwf_d[g_detail_idx].sfakwf035 = l_imaf053 THEN   
#                           LET l_sfakwf034 =  l_amount  
#                        ELSE
#                           LET l_sfakwf034 =  l_amount_die                
#                        END IF  
#                     END IF                
#                     UPDATE sfakwf_t SET sfakwf006 = l_sfakwf006, #????
#                                         sfakwf034 = l_sfakwf034,	#?????? 
#                                         sfakwf009 = l_sfakwf009,	#????
#                                         sfakwf010 = l_sfakwf010	#DATECODE          
#                      WHERE sfakwfent = g_enterprise AND sfakwfsite = g_site AND sfakwfdocno = g_sfajwf_m.sfajwfdocno   
#                        AND sfakwfseq = g_sfakwf_d[g_detail_idx].sfakwfseq
#                     CASE
#                        WHEN SQLCA.sqlerrd[3] = 0  #???????
#                        #   INITIALIZE g_errparam TO NULL 
#                        #   LET g_errparam.extend = "sfakwf_t" 
#                        #   LET g_errparam.code = "std-00009" 
#                        #   LET g_errparam.popup = TRUE 
#                        #   CALL cl_err()
#                        #   CALL s_transaction_end('N','0')
#                        #   CONTINUE WHILE
#                        WHEN SQLCA.SQLCODE #????
#                           INITIALIZE g_errparam TO NULL 
#                           LET g_errparam.extend = "sfakwf_t:",SQLERRMESSAGE 
#                           LET g_errparam.code = SQLCA.SQLCODE 
#                           LET g_errparam.popup = TRUE 
#                           CALL s_transaction_end('N','0')
#                           CALL cl_err()
#                           EXIT DIALOG
#                     END CASE 
#                     
#                     #??QPA????
#                     CALL bsft001_wf_sfbcwf023_qpa_02(g_sfakwf2_d[l_ac].sfbcwf023,l_sfakwf006) RETURNING g_sfakwf2_d[l_ac].sfbcwf010,g_sfakwf2_d[l_ac].sfbcwf011
#                     UPDATE sfbcwf_t SET sfbcwf010 = g_sfakwf2_d[l_ac].sfbcwf010, 
#                                         sfbcwf011 = g_sfakwf2_d[l_ac].sfbcwf011  
#                      WHERE sfbcwfent = g_enterprise AND sfbcwfsite = g_site AND sfbcwfdocno = g_sfajwf_m.sfajwfdocno AND sfbcwfseq = g_sfakwf_d[g_detail_idx].sfakwfseq 
#                        AND sfbcwfseq1 = g_sfakwf2_d[l_ac].sfbcwfseq1 AND sfbcwfseq2 = g_sfakwf2_d[l_ac].sfbcwfseq2
#                     CASE
#                        WHEN SQLCA.sqlerrd[3] = 0  #???????
#                        WHEN SQLCA.SQLCODE #????
#                           INITIALIZE g_errparam TO NULL 
#                           LET g_errparam.extend = "upd sfbcwf_t:",SQLERRMESSAGE 
#                           LET g_errparam.code = SQLCA.SQLCODE 
#                           LET g_errparam.popup = TRUE 
#                           CALL s_transaction_end('N','0')
#                           CALL cl_err()
#                           EXIT DIALOG
#                     END CASE 
                     #240611-00019#2 mark--e
                     #240611-00019#2 add--s
                     #??????sfbcwf049=?????sfbcwf023*bmba012????/bmba011????
                     IF cl_null(g_sfakwf_d[g_detail_idx].sfakwf002) THEN
                        LET l_sfakwf002 = ' '
                     ELSE
                        LET l_sfakwf002 = g_sfakwf_d[g_detail_idx].sfakwf002 
                     END IF      
                     SELECT COUNT(1) INTO l_cnt FROM bmba_t 
                      WHERE bmbaent = g_enterprise AND bmbasite = g_site AND bmba001 = g_sfakwf_d[g_detail_idx].sfakwf001 AND bmba003 = g_sfakwf2_d[l_ac].sfbcwf006
                        AND bmba002 = l_sfakwf002  AND bmba004 = g_sfakwf2_d[l_ac].sfbcwf002 AND bmbawf039 = 'Y'
                        AND bmba007 = g_sfakwf2_d[l_ac].sfbcwf003 AND bmba008 = g_sfakwf2_d[l_ac].sfbcwf004
                     IF l_cnt > 0 THEN  #?????????BOM???????????,???????????
                        SELECT bmba012,bmba011 INTO l_bmba012,l_bmba011 FROM bmba_t
                         WHERE bmbaent = g_enterprise AND bmbasite = g_site AND bmba001 = g_sfakwf_d[g_detail_idx].sfakwf001  AND bmba002 = l_sfakwf002
                           AND bmba003 = g_sfakwf2_d[l_ac].sfbcwf006 AND bmba004 = g_sfakwf2_d[l_ac].sfbcwf002
                           AND bmba007 = g_sfakwf2_d[l_ac].sfbcwf003 AND bmba008 = g_sfakwf2_d[l_ac].sfbcwf004
                        LET g_sfakwf2_d[l_ac].sfbcwf049 = g_sfakwf2_d[l_ac].sfbcwf023 * l_bmba012 / l_bmba011                              
                     ELSE
                        LET g_sfakwf2_d[l_ac].sfbcwf049 = g_sfakwf2_d[l_ac].sfbcwf023
                     END IF 
                     
                     #??QPA????
                     CALL bsft001_wf_sfbcwf023_qpa_02(g_sfakwf2_d[l_ac].sfbcwf023,g_sfakwf2_d[l_ac].sfbcwf049) RETURNING g_sfakwf2_d[l_ac].sfbcwf010,g_sfakwf2_d[l_ac].sfbcwf011
                     #241016-00014#1 add--s
                     CALL s_aooi250_convert_qty(g_sfakwf2_d[l_ac].sfbcwf006,g_sfakwf2_d[l_ac].sfbcwf014,g_sfakwf_d[g_detail_idx].sfakwf007,g_sfakwf2_d[l_ac].sfbcwf049) 
                          RETURNING l_success,g_sfakwf2_d[l_ac].sfbcwf049
                     #241016-00014#1 add--e
                     UPDATE sfbcwf_t SET sfbcwf010 = g_sfakwf2_d[l_ac].sfbcwf010, 
                                         sfbcwf011 = g_sfakwf2_d[l_ac].sfbcwf011,
                                         sfbcwf049 = g_sfakwf2_d[l_ac].sfbcwf049      
                      WHERE sfbcwfent = g_enterprise AND sfbcwfsite = g_site AND sfbcwfdocno = g_sfajwf_m.sfajwfdocno AND sfbcwfseq = g_sfakwf_d[g_detail_idx].sfakwfseq 
                        AND sfbcwfseq1 = g_sfakwf2_d[l_ac].sfbcwfseq1 AND sfbcwfseq2 = g_sfakwf2_d[l_ac].sfbcwfseq2
                     CASE
                        WHEN SQLCA.sqlerrd[3] = 0  #???????
                        WHEN SQLCA.SQLCODE #????
                           INITIALIZE g_errparam TO NULL 
                           LET g_errparam.extend = "upd sfbcwf_t:",SQLERRMESSAGE 
                           LET g_errparam.code = SQLCA.SQLCODE 
                           LET g_errparam.popup = TRUE 
                           CALL s_transaction_end('N','0')
                           CALL cl_err()
                           EXIT DIALOG
                     END CASE 
                     
                     IF g_sfajwf_m.sfajwf003 <> '2' THEN  #241016-00014#1 add
                        SELECT SUM(sfbcwf049) INTO l_sfakwf006 FROM sfbcwf_t 
                         WHERE sfbcwfent = g_enterprise AND sfbcwfsite = g_site AND sfbcwfdocno = g_sfajwf_m.sfajwfdocno AND sfbcwfseq = g_sfakwf_d[g_detail_idx].sfakwfseq
                           AND sfbcwf043 = 'Y' 
                     #241016-00014#1 add--s
                     ELSE
                        SELECT SUM(sfbcwf049) INTO l_sfakwf006 FROM sfbcwf_t 
                         WHERE sfbcwfent = g_enterprise AND sfbcwfsite = g_site AND sfbcwfdocno = g_sfajwf_m.sfajwfdocno AND sfbcwfseq = g_sfakwf_d[g_detail_idx].sfakwfseq
                     END IF
                     #241016-00014#1 add--e
                     #??aimm215??????????????
                     CALL s_asft300_02_get_sfaa012(g_sfakwf_d[g_detail_idx].sfakwf001,l_sfakwf006,g_sfakwf_d[g_detail_idx].sfakwf007,'N','N') 
                              RETURNING l_sfakwf006,l_success     
                     #????U1?????DATECODE??,U1????????????U1????
                     SELECT sfbcwf029,sfbcwf040 INTO l_sfakwf009,l_sfakwf010 FROM sfbcwf_t 
                      WHERE sfbcwfent = g_enterprise AND sfbcwfsite = g_site AND sfbcwfdocno = g_sfajwf_m.sfajwfdocno 
                        AND sfbcwfseq = g_sfakwf_d[g_detail_idx].sfakwfseq AND sfbcwf043 = 'Y' 
                        AND ROWNUM = 1  
                     
                     #?????? 
                     SELECT imaa006,imaf053 INTO l_imaa006,l_imaf053 FROM imaf_t 
                       LEFT OUTER JOIN imaa_t ON imaaent = g_enterprise AND imaa001 = imaf001
                      WHERE imafent = g_enterprise AND imafsite = g_site
                        AND imaf001 = g_sfakwf2_d[l_ac].sfbcwf006
                     SELECT NVL(SUM(icbawf011),0),NVL(SUM(icbawf022),0) INTO l_amount_die,l_amount FROM icbawf_t
                      LEFT JOIN sfbcwf_t ON sfbcwfent = icbawfent AND sfbcwfsite =icbawfsite AND sfbcwfdocno = icbawfdocno 
                                      AND sfbcwfseq = icbawf032 AND sfbcwfseq1 = icbawfseq AND sfbcwfseq2 = icbawfseq1
                      WHERE icbawfent = g_enterprise AND icbawfsite = g_site
                        AND icbawfdocno = g_sfajwf_m.sfajwfdocno 
                        AND icbawf032 = g_sfakwf_d[g_detail_idx].sfakwfseq  #????
                        AND sfbcwf043 = 'Y'                
                     IF s_aint302_wf_oocawf008(g_sfakwf2_d[l_ac].sfbcwf006) THEN
                        IF g_sfakwf_d[g_detail_idx].sfakwf035 = l_imaf053 THEN   
                           LET l_sfakwf034 = l_amount_die
                        ELSE
                           LET l_sfakwf034 = l_amount                
                        END IF                               
                     ELSE
                        IF g_sfakwf_d[g_detail_idx].sfakwf035 = l_imaf053 THEN   
                           LET l_sfakwf034 =  l_amount  
                        ELSE
                           LET l_sfakwf034 =  l_amount_die                
                        END IF  
                     END IF                
                     UPDATE sfakwf_t SET sfakwf006 = l_sfakwf006, #????
                                         sfakwf034 = l_sfakwf034,	#?????? 
                                         sfakwf009 = l_sfakwf009,	#????
                                         sfakwf010 = l_sfakwf010	#DATECODE          
                      WHERE sfakwfent = g_enterprise AND sfakwfsite = g_site AND sfakwfdocno = g_sfajwf_m.sfajwfdocno   
                        AND sfakwfseq = g_sfakwf_d[g_detail_idx].sfakwfseq
                     CASE
                        WHEN SQLCA.sqlerrd[3] = 0  #???????
                        #   INITIALIZE g_errparam TO NULL 
                        #   LET g_errparam.extend = "sfakwf_t" 
                        #   LET g_errparam.code = "std-00009" 
                        #   LET g_errparam.popup = TRUE 
                        #   CALL cl_err()
                        #   CALL s_transaction_end('N','0')
                        #   CONTINUE WHILE
                        WHEN SQLCA.SQLCODE #????
                           INITIALIZE g_errparam TO NULL 
                           LET g_errparam.extend = "sfakwf_t:",SQLERRMESSAGE 
                           LET g_errparam.code = SQLCA.SQLCODE 
                           LET g_errparam.popup = TRUE 
                           CALL s_transaction_end('N','0')
                           CALL cl_err()
                           EXIT DIALOG
                     END CASE
                     #240709-00009#1 add--s              
                     CALL bsft001_wf_b_fill()                     
                     DELETE FROM sfanwf_t
                      WHERE sfanwfent = g_enterprise
                        AND sfanwfdocno = g_sfajwf_m.sfajwfdocno
                        AND sfanwfseq1 =  g_sfakwf_d[g_detail_idx].sfakwfseq  #241016-00014#1 add 
                     CALL bsft001_wf_ins_sfanwf()
                     #240709-00009#1 add--e
                     #240611-00019#2 add--e                     
                     CALL s_transaction_end('Y','0')
                     CALL bsft001_wf_b_fill2('3') 
                     CALL bsft001_wf_b_fill() #??????????????DATECODE                        
                  ELSE
                     CALL s_transaction_end('N','0')                     
                  END IF 
                  CALL s_icd_wf_ins_b_fill2(g_site,g_sfajwf_m.sfajwfdocno,'-1')                  
               END IF  
               #END add-point
               
            END IF
 
 
 
 
         
            #add-point:page2????? name="ui_dialog.body2.action"

            #end add-point
         
         END DISPLAY
         #???????
         DISPLAY ARRAY g_sfakwf3_d TO s_detail3.* ATTRIBUTES(COUNT=g_rec_b)  
    
            BEFORE ROW
               #??????
               CALL bsft001_wf_idx_chk()
               LET l_ac = DIALOG.getCurrentRow("s_detail3")
               LET g_detail_idx2 = l_ac
               LET g_detail_idx_list[3] = l_ac
               CALL g_idx_group.addAttribute("'2',",l_ac)
               
               #add-point:page3, before row?? name="ui_dialog.body3.before_row"

               #end add-point
               
            BEFORE DISPLAY
               #?????????????????
               IF g_loc = 'd' THEN
                  CALL FGL_SET_ARR_CURR(g_idx_group.getValue("'2',"))
               END IF
               LET g_loc = 'd'
               LET l_ac = DIALOG.getCurrentRow("s_detail3")
               LET g_current_page = 3
               #??????
               CALL bsft001_wf_idx_chk()
               #add-point:page3????? name="ui_dialog.body3.before_display"

               #end add-point
      
            #??ACTION(detail_show,page_3)
            
         
            #add-point:page3????? name="ui_dialog.body3.action"

            #end add-point
         
         END DISPLAY
         #???????
         DISPLAY ARRAY g_sfakwf5_d TO s_detail5.* ATTRIBUTES(COUNT=g_rec_b)  
    
            BEFORE ROW
               #??????
               CALL bsft001_wf_idx_chk()
               LET l_ac = DIALOG.getCurrentRow("s_detail5")
               LET g_detail_idx2 = l_ac
               LET g_detail_idx_list[5] = l_ac
               CALL g_idx_group.addAttribute("'5',",l_ac)
               
               #add-point:page5, before row?? name="ui_dialog.body5.before_row"

               #end add-point
               
            BEFORE DISPLAY
               #?????????????????
               IF g_loc = 'd' THEN
                  CALL FGL_SET_ARR_CURR(g_idx_group.getValue("'5',"))
               END IF
               LET g_loc = 'd'
               LET l_ac = DIALOG.getCurrentRow("s_detail5")
               LET g_current_page = 5
               #??????
               CALL bsft001_wf_idx_chk()
               #add-point:page5????? name="ui_dialog.body5.before_display"

               #end add-point
      
            #??ACTION(detail_show,page_5)
            
         
            #add-point:page5????? name="ui_dialog.body5.action"

            #end add-point
         
         END DISPLAY
 
         
         #add-point:ui_dialog????display array name="ui_dialog.more_displayarray"
         SUBDIALOG sub_s_icd_wf.s_icd_wf_display 
         #end add-point
         
         SUBDIALOG lib_cl_dlg.cl_dlg_qryplan
         SUBDIALOG lib_cl_dlg.cl_dlg_relateapps
      
         BEFORE DIALOG
            CALL cl_ap_code_set_action() #171110-00013#1 
            #???browser??
            #190108-00038 ---modify start---
         #  CALL bsft001_wf_browser_fill("")   #190114-00003 mark
         #  IF g_action_choice <> "ui_change" THEN   #190114-00003
            IF g_action_choice = "ui_change" THEN
               DISPLAY g_browser_idx TO FORMONLY.b_index   #????
               DISPLAY g_browser_cnt TO FORMONLY.b_count   #???
               DISPLAY g_browser_idx TO FORMONLY.h_index   #????
               DISPLAY g_browser_cnt TO FORMONLY.h_count   #???
               DISPLAY g_detail_idx  TO FORMONLY.idx       #??????
               DISPLAY g_detail_cnt  TO FORMONLY.cnt       #?????
            ELSE
               CALL bsft001_wf_browser_fill("")
            END IF
            #190108-00038 --- modify end ---
            CALL cl_notice()
            CALL cl_navigator_setting(g_current_idx, g_detail_cnt)
            LET g_curr_diag = ui.DIALOG.getCurrent()
            LET g_current_sw = FALSE
            #??????? (?????????)
            LET g_current_idx = DIALOG.getCurrentRow("s_browse")
            IF g_current_row > 1 AND g_current_idx = 1 AND g_current_sw = FALSE THEN
               CALL DIALOG.setCurrentRow("s_browse",g_current_row)
               LET g_current_idx = g_current_row
            END IF
            
            #??g_current_idx???????
            #??,??0????1?
            IF g_current_idx <= 0 THEN
               LET g_current_idx = 1
            END IF
            #???????????1?
            IF g_current_idx > g_browser.getLength() THEN
               LEt g_current_idx = g_browser.getLength()
            END IF 
            
            LET g_current_sw = TRUE
            LET g_current_row = g_current_idx #????
            
            #??????fetch
            IF g_current_idx <> 0 THEN
               CALL bsft001_wf_fetch('') # reload data
            END IF
            #LET g_detail_idx = 1
            CALL bsft001_wf_ui_detailshow() #Setting the current row 
            
            #????
            LET g_current_page = 1
            CALL bsft001_wf_idx_chk()
            CALL cl_ap_performance_cal()
            #add-point:ui_dialog?before_dialog2 name="ui_dialog.before_dialog2"

            #end add-point
 
         #add-point:ui_dialog?more_action name="ui_dialog.more_action"

         #end add-point
 
         #?????
         ON ACTION statechange
            LET g_action_choice = "statechange"
            CALL bsft001_wf_statechange()
            #????????action??
            CALL cl_set_act_visible("statechange,modify,modify_detail,delete,reproduce", TRUE)
            CALL bsft001_wf_set_act_visible()   
            CALL bsft001_wf_set_act_no_visible()
            IF NOT (g_sfajwf_m.sfajwfdocno IS NULL
 
              ) THEN
               #????
               LET g_add_browse = " sfajwfent = " ||g_enterprise|| " AND sfajwfsite = '" ||g_site|| "' AND",
                                  " sfajwfdocno = '", g_sfajwf_m.sfajwfdocno, "' "
 
               #??????
               CALL bsft001_wf_browser_fill("")
            END IF
         #?? a32 ??????(Version:4)
         #????
         ON ACTION bpm_status
            #??????, ????HyperLink
            LET g_action_choice = "bpmstatus"   #181128-00048
            CALL cl_bpm_status()
            #add-point:ON ACTION bpm_status name="menu.bpm_status"

            #END add-point
 
 
 
          
         #?????? 
         ON ACTION queryplansel
            LET g_action_choice = "queryplan" #ver:81
            CALL cl_dlg_qryplan_select() RETURNING ls_wc
            #????????g_wc??????
            IF NOT cl_null(ls_wc) THEN
               CALL util.JSON.parse(ls_wc, la_wc)
               INITIALIZE g_wc, g_wc2,g_wc2_table1,g_wc2_extend TO NULL
               LET g_wc2_extend = " 1=1" #190730-00003#4 add
               INITIALIZE g_wc2_table2 TO NULL
 
 
               FOR li_idx = 1 TO la_wc.getLength()
                  CASE
                     WHEN la_wc[li_idx].tableid = "sfajwf_t" 
                        LET g_wc = la_wc[li_idx].wc
                     WHEN la_wc[li_idx].tableid = "sfakwf_t" 
                        LET g_wc2_table1 = la_wc[li_idx].wc
                     WHEN la_wc[li_idx].tableid = "sfamwf_t" 
                        LET g_wc2_table2 = la_wc[li_idx].wc
 
 
                     WHEN la_wc[li_idx].tableid = "EXTENDWC"
                        LET g_wc2_extend = la_wc[li_idx].wc
                  END CASE
               END FOR
               IF NOT cl_null(g_wc) OR NOT cl_null(g_wc2_table1) 
                  OR NOT cl_null(g_wc2_table2)
 
 
                  OR NOT cl_null(g_wc2_extend)
                  THEN
                  #??g_wc2
                  IF g_wc2_table1 <> " 1=1" AND NOT cl_null(g_wc2_table1) THEN
                     LET g_wc2 = g_wc2_table1
                  END IF
                  IF g_wc2_table2 <> " 1=1" AND NOT cl_null(g_wc2_table2)
                                                   AND NOT g_wc2.getIndexOf(g_wc2_table2,1) THEN   #200828-00027?????,??g_wc2???? (???)
                     LET g_wc2 = g_wc2 ," AND ", g_wc2_table2   #200917-00047
                  END IF
 
 
                  IF g_wc2_extend <> " 1=1" AND NOT cl_null(g_wc2_extend)
                                            AND NOT g_wc2.getIndexOf(g_wc2_extend,1) THEN   #200828-00027?????,??g_wc2???? (???)
                     LET g_wc2 = g_wc2 ," AND ", g_wc2_extend   #200917-00047
                  END IF
 
                  #LET g_wc2 = g_wc2_extend  #190730-00003#4 add
 
                  IF g_wc2.subString(1,5) = " AND " THEN
                     LET g_wc2 = g_wc2.subString(6,g_wc2.getLength())
                  END IF
                  
                  #190730-00003#4 -S-
                  IF g_wc2.subString(1,4) = " OR " THEN
                     LET g_wc2 = g_wc2.subString(5,g_wc2.getLength())
                  END IF 
                  #190730-00003#4 -E-
                  
               END IF
               CALL bsft001_wf_browser_fill("F")   #browser_fill()??notice????
               CALL cl_notice()   #????,?????EXIT DIALOG, SUBDIALOG???????????
               LET g_wc2_extend = " 1=1" #190730-00003#4 add
            END IF
         
         #??????
         ON ACTION qbe_select
            LET g_action_choice = "queryplan" #ver:81
            CALL cl_qbe_list("m") RETURNING ls_wc
            IF NOT cl_null(ls_wc) THEN
               CALL util.JSON.parse(ls_wc, la_wc)
               INITIALIZE g_wc, g_wc2,g_wc2_table1,g_wc2_extend TO NULL
               LET g_wc2_extend = " 1=1" #190730-00003#4 add
               INITIALIZE g_wc2_table2 TO NULL
 
 
               FOR li_idx = 1 TO la_wc.getLength()
                  CASE   
                     WHEN la_wc[li_idx].tableid = "sfajwf_t"                   
                        LET g_wc = la_wc[li_idx].wc
                     WHEN la_wc[li_idx].tableid = "sfakwf_t" 
                        LET g_wc2_table1 = la_wc[li_idx].wc
                     WHEN la_wc[li_idx].tableid = "sfamwf_t" 
                        LET g_wc2_table2 = la_wc[li_idx].wc
 
 
                     WHEN la_wc[li_idx].tableid = "EXTENDWC"
                        LET g_wc2_extend = la_wc[li_idx].wc
                  END CASE
               END FOR
               IF NOT cl_null(g_wc) OR NOT cl_null(g_wc2_table1)
                  OR NOT cl_null(g_wc2_table2)
 
 
                  OR NOT cl_null(g_wc2_extend)
                  THEN
                  
                  IF g_wc2_table1 <> " 1=1" AND NOT cl_null(g_wc2_table1) THEN
                     LET g_wc2 = g_wc2_table1
                  END IF
                  IF g_wc2_table2 <> " 1=1" AND NOT cl_null(g_wc2_table2)
                                                   AND NOT g_wc2.getIndexOf(g_wc2_table2,1) THEN   #200828-00027?????,??g_wc2???? (???)
                     LET g_wc2 = g_wc2 ," AND ", g_wc2_table2   #200917-00047
                  END IF
 
 
                  IF g_wc2_extend <> " 1=1" AND NOT cl_null(g_wc2_extend)
                                            AND NOT g_wc2.getIndexOf(g_wc2_extend,1) THEN   #200828-00027?????,??g_wc2???? (???)
                     LET g_wc2 = g_wc2 ," AND ", g_wc2_extend   #200917-00047
                  END IF
                  IF g_wc2.subString(1,5) = " AND " THEN
                     LET g_wc2 = g_wc2.subString(6,g_wc2.getLength())
                  END IF
                  #?????????????????????????
                  CALL bsft001_wf_browser_fill("F")
                  IF g_browser_cnt = 0 THEN
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = "" 
                     LET g_errparam.code = "-100" 
                     LET g_errparam.popup = TRUE 
                     CALL cl_err()
                     CLEAR FORM
                  ELSE
                     CALL bsft001_wf_fetch("F")
                  END IF
                  LET g_wc2_extend = " 1=1" #190730-00003#4 add
               END IF
            END IF
            #??????notice????,?????EXIT DIALOG, SUBDIALOG???????????
            CALL cl_notice()
          
         #?? a49 ??????(Version:4)
            #???????
            ON ACTION filter
               LET g_action_choice = "fetch"
               #add-point:filter action name="ui_dialog.action.filter"

               #end add-point
               CALL bsft001_wf_filter()
               EXIT DIALOG
 
 
 
         
         ON ACTION first
            LET g_action_choice = "fetch"
            CALL bsft001_wf_fetch('F')
            LET g_current_row = g_current_idx
            LET g_curr_diag = ui.DIALOG.getCurrent()
            CALL bsft001_wf_idx_chk()
            
         ON ACTION previous
            LET g_action_choice = "fetch"
            CALL bsft001_wf_fetch('P')
            LET g_current_row = g_current_idx
            LET g_curr_diag = ui.DIALOG.getCurrent()
            CALL bsft001_wf_idx_chk()
            
         ON ACTION jump
            LET g_action_choice = "fetch"
            CALL bsft001_wf_fetch('/')
            LET g_current_row = g_current_idx
            LET g_curr_diag = ui.DIALOG.getCurrent()
            CALL bsft001_wf_idx_chk()
            
         ON ACTION next
            LET g_action_choice = "fetch"
            CALL bsft001_wf_fetch('N')
            LET g_current_row = g_current_idx
            LET g_curr_diag = ui.DIALOG.getCurrent()
            CALL bsft001_wf_idx_chk()
            
         ON ACTION last
            LET g_action_choice = "fetch"
            CALL bsft001_wf_fetch('L')
            LET g_current_row = g_current_idx
            LET g_curr_diag = ui.DIALOG.getCurrent()
            CALL bsft001_wf_idx_chk()
          
         #excel????          
         ON ACTION exporttoexcel
            LET g_action_choice="exporttoexcel"
            IF cl_auth_chk_act("exporttoexcel") THEN
               #(ver:87) ---start---
               #????excel??????????????
               LET lb_get_type = cl_get_exporttoexcel_type()
               #add-point:ON ACTION exporttoexcel name="ui_dialog.exporttoexcel_type_change"

               #END add-point
               DISPLAY "lb_get_type:",lb_get_type
             
               CASE
                  WHEN lb_get_type = "poi"   #??poi??
                     #browser
                     CALL g_export_node.clear()
                     IF g_main_hidden = 1 THEN
                        LET l_arr_len = g_browser.getLength()
                        LET g_export_tabname[1] = "s_browse"
                        LET g_export_tag[1] = rec_arr_type.create(l_arr_len)
                        FOR l_arr_cnt = 1 TO l_arr_len
                           LET g_export_tag[1][l_arr_cnt] = g_browser[l_arr_cnt]
                        END FOR
 
                        #add-point:ON ACTION exporttoexcel name="menu.exporttoexcel_browser_poi"

                        #END add-point
                        CALL cl_export_poi()
                        #add-point:ON ACTION exporttoexcel name="menu.exporttoexcel_browser_after_poi"

                        #END add-point
                     #?browser
                     ELSE
                        LET l_arr_len = g_sfakwf_d.getLength()
                        LET g_export_tag[1] = rec_arr_type.create(l_arr_len)
                        LET g_export_tabname[1] = "s_detail1"
                        FOR l_arr_cnt = 1 TO l_arr_len
                           LET g_export_tag[1][l_arr_cnt] = g_sfakwf_d[l_arr_cnt]
                        END FOR
 
                        LET l_arr_len = g_sfakwf2_d.getLength()
                        LET g_export_tag[2] = rec_arr_type.create(l_arr_len)
                        LET g_export_tabname[2] = "s_detail2"
                        FOR l_arr_cnt = 1 TO l_arr_len
                            LET g_export_tag[2][l_arr_cnt] = g_sfakwf2_d[l_arr_cnt]
                        END FOR
                        LET l_arr_len = g_sfakwf3_d.getLength()
                        LET g_export_tag[3] = rec_arr_type.create(l_arr_len)
                        LET g_export_tabname[3] = "s_detail3"
                        FOR l_arr_cnt = 1 TO l_arr_len
                            LET g_export_tag[3][l_arr_cnt] = g_sfakwf3_d[l_arr_cnt]
                        END FOR
                        LET l_arr_len = g_sfakwf4_d.getLength()
                        LET g_export_tag[4] = rec_arr_type.create(l_arr_len)
                        LET g_export_tabname[4] = "s_detail4"
                        FOR l_arr_cnt = 1 TO l_arr_len
                            LET g_export_tag[4][l_arr_cnt] = g_sfakwf4_d[l_arr_cnt]
                        END FOR
                        LET l_arr_len = g_sfakwf5_d.getLength()
                        LET g_export_tag[5] = rec_arr_type.create(l_arr_len)
                        LET g_export_tabname[5] = "s_detail5"
                        FOR l_arr_cnt = 1 TO l_arr_len
                            LET g_export_tag[5][l_arr_cnt] = g_sfakwf5_d[l_arr_cnt]
                        END FOR
 
                        #add-point:ON ACTION exporttoexcel name="menu.exporttoexcel_poi"
                        #17538 add--s
                        LET l_arr_len = g_icbawf_d.getLength()
                        LET g_export_tag[3] = rec_arr_type.create(l_arr_len)
                        LET g_export_tabname[3] = "s_detail1_s_icd_wf_s01"
                        FOR l_arr_cnt = 1 TO l_arr_len
                           LET g_export_tag[3][l_arr_cnt] = g_icbawf_d[l_arr_cnt]
                        END FOR
                        #17538 add--e
                        #END add-point
                        CALL cl_export_to_excel_getpage()
                        CALL cl_export_poi()
                        #add-point:ON ACTION exporttoexcel name="menu.exporttoexcel_after_poi"

                        #END add-point
                     END IF
 
                  OTHERWISE   #??????
               #(ver:87) --- end ---
               
                     #browser
                     CALL g_export_node.clear()
                     IF g_main_hidden = 1 THEN
                        LET g_export_node[1] = base.typeInfo.create(g_browser)
                        LET g_export_id[1]   = "s_browse"
                        #add-point:ON ACTION exporttoexcel name="menu.exporttoexcel_browser"   #(ver:80)

                        #END add-point
                        CALL cl_export_to_excel()
                        #add-point:ON ACTION exporttoexcel name="menu.exporttoexcel_browser_after"   #(ver:80)

                        #END add-point
                     #?browser
                     ELSE
                        LET g_export_node[1] = base.typeInfo.create(g_sfakwf_d)
                        LET g_export_id[1]   = "s_detail1"
                        LET g_export_node[2] = base.typeInfo.create(g_sfakwf2_d)
                        LET g_export_id[2]   = "s_detail2"
                        LET g_export_node[3] = base.typeInfo.create(g_sfakwf3_d)
                        LET g_export_id[3]   = "s_detail3"
                        LET g_export_node[4] = base.typeInfo.create(g_sfakwf4_d)
                        LET g_export_id[4]   = "s_detail4"
                        LET g_export_node[5] = base.typeInfo.create(g_sfakwf5_d)
                        LET g_export_id[5]   = "s_detail5"
 
                        #add-point:ON ACTION exporttoexcel name="menu.exporttoexcel"
                        #17538 add--s
                        LET g_export_node[3] = base.typeInfo.create(g_icbawf_d)
                        LET g_export_id[3]   = "s_detail1_s_icd_wf_s01"
                        #17538 add--e
                        #END add-point
                        CALL cl_export_to_excel_getpage()
                        CALL cl_export_to_excel()
                        #add-point:ON ACTION exporttoexcel name="menu.exporttoexcel_after"   #(ver:80)

                        #END add-point
                     END IF
               END CASE   #(ver:87) add
            END IF
        
         ON ACTION close
            LET INT_FLAG = FALSE
            LET g_action_choice = "exit"
            EXIT DIALOG
          
         ON ACTION exit
            LET g_action_choice = "exit"
            EXIT DIALOG
 
         #180226-00040 ---modify start---
         #????
         ON ACTION mainhidden       
            #(ver:85) ---start---
            #add-point:ui_dialog? mainhidden name="ui_dialog.mainhidden"

            #end add-point
            #(ver:85) --- end ---
            IF g_main_hidden THEN
               CALL gfrm_curr.setElementHidden("mainlayout",0)
               CALL gfrm_curr.setElementHidden("worksheet",1)
               LET g_main_hidden = 0
            ELSE
               CALL gfrm_curr.setElementHidden("mainlayout",1)
               CALL gfrm_curr.setElementHidden("worksheet",0)
               LET g_main_hidden = 1
               CALL cl_notice()
            END IF
         #180226-00040 --- modify end ---
            
         #?????
         ON ACTION worksheethidden   
            #(ver:85) ---start---
            #add-point:ui_dialog? worksheethidden name="ui_dialog.worksheethidden"

            #end add-point
            #(ver:85) --- end ---
            IF g_main_hidden THEN
               CALL gfrm_curr.setElementHidden("mainlayout",0)
               CALL gfrm_curr.setElementHidden("worksheet",1)
               LET g_main_hidden = 0
            ELSE
               CALL gfrm_curr.setElementHidden("mainlayout",1)
               CALL gfrm_curr.setElementHidden("worksheet",0)
               LET g_main_hidden = 1
            END IF
            IF lb_first THEN
               LET lb_first = FALSE
               NEXT FIELD sfakwfseq
            END IF
       
         #????????hot key "Alt-s"??/????
         ON ACTION controls     
            IF g_header_hidden THEN
               CALL gfrm_curr.setElementHidden("vb_master",0)
               CALL gfrm_curr.setElementImage("controls","small/arr-u.png")
               LET g_header_hidden = 0     #visible
            ELSE
               CALL gfrm_curr.setElementHidden("vb_master",1)
               CALL gfrm_curr.setElementImage("controls","small/arr-d.png")
               LET g_header_hidden = 1     #hidden     
            END IF
    
         
         #?? a43 ??????(Version:4)
         ON ACTION delete
            LET g_action_choice="delete"
            IF cl_auth_chk_act("delete") THEN
               CALL bsft001_wf_delete()
               #add-point:ON ACTION delete name="menu.delete"

               #END add-point
               
            END IF
 
 
 
 
         #?? a43 ??????(Version:4)
         ON ACTION insert
            LET g_action_choice="insert"
            IF cl_auth_chk_act("insert") THEN
               CALL bsft001_wf_insert()
               #add-point:ON ACTION insert name="menu.insert"

               #END add-point
               
            END IF
 
 
 
 
         #?? a43 ??????(Version:4)
         ON ACTION modify
            LET g_action_choice="modify"
            IF cl_auth_chk_act("modify") THEN
               LET g_aw = ''
               CALL bsft001_wf_modify()
               #add-point:ON ACTION modify name="menu.modify"
       
               #END add-point
               
            END IF
 
 
 
 
         #?? a43 ??????(Version:4)
         ON ACTION modify_detail
            LET g_action_choice="modify_detail"
            IF cl_auth_chk_act("modify") THEN
               LET g_aw = g_curr_diag.getCurrentItem()
               CALL bsft001_wf_modify()
               #add-point:ON ACTION modify_detail name="menu.modify_detail"
          #240130-00006#5 -----s
            END IF
          
          ON ACTION select_1
            LET g_action_choice="select_1"
            IF cl_auth_chk_act("select_1") THEN
               #????
                 LET la_param.prog     = 'asft300_wf'
                 LET la_param.param[1] = g_sfakwf_d[l_ac].sfakwf029
                 LET ls_js = util.JSON.stringify(la_param)
                 CALL cl_cmdrun(ls_js)             
            END IF

         ON ACTION select_3
            LET g_action_choice="select_3"
            IF cl_auth_chk_act("select_3") THEN
                #?????
                LET la_param.prog     = 'asft311_wf'
                 LET la_param.param[1] = g_sfakwf_d[l_ac].sfakwf030
                 LET ls_js = util.JSON.stringify(la_param)
                 CALL cl_cmdrun(ls_js)
            END IF

         ON ACTION select_4
            LET g_action_choice="select_4"
            IF cl_auth_chk_act("select_4") THEN
                #?????
                LET la_param.prog     = 'apmt501_wf'
                 LET la_param.param[1] = g_sfakwf_d[l_ac].sfakwf031
                 LET ls_js = util.JSON.stringify(la_param)
                 CALL cl_cmdrun(ls_js) 
         #240130-00006#5 -----e
               #END add-point
               
            END IF
 
 
 
 
         #?? a43 ??????(Version:4)
         ON ACTION output
            LET g_action_choice="output"
            IF cl_auth_chk_act("output") THEN
               
               #add-point:ON ACTION output name="menu.output"
               LET g_rep_wc = " sfajwfent = '",g_enterprise,"' AND sfajwfsite ='",g_site,"' AND sfajwfdocno ='",g_sfajwf_m.sfajwfdocno,"'"
               #END add-point
               &include "erp/asf/bsft001_wf_rep.4gl"
               #add-point:ON ACTION output.after name="menu.after_output"

               #END add-point
               
            END IF
 
 
 
 
         #?? a43 ??????(Version:4)
         ON ACTION quickprint
            LET g_action_choice="quickprint"
            IF cl_auth_chk_act("quickprint") THEN
               
               #add-point:ON ACTION quickprint name="menu.quickprint"
               LET g_rep_wc = " sfajwfent = '",g_enterprise,"' AND sfajwfsite ='",g_site,"' AND sfajwfdocno ='",g_sfajwf_m.sfajwfdocno,"'"
               #END add-point
               &include "erp/asf/bsft001_wf_rep.4gl"
               #add-point:ON ACTION quickprint.after name="menu.after_quickprint"

               #END add-point
               
            END IF
 
 
 
 
         #?? a43 ??????(Version:4)
         ON ACTION query
            LET g_action_choice="query"
            IF cl_auth_chk_act("query") THEN
               CALL bsft001_wf_query()
               #add-point:ON ACTION query name="menu.query"

               #END add-point
               #?? a59 ??????(Version:3)  
               CALL g_curr_diag.setCurrentRow("s_detail1",1)
               CALL g_curr_diag.setCurrentRow("s_detail2",1)
               CALL g_curr_diag.setCurrentRow("s_detail3",1)
               CALL g_curr_diag.setCurrentRow("s_detail4",1)
               CALL g_curr_diag.setCurrentRow("s_detail5",1)
 
 
 
 
            END IF
 
 
 
 
         #?? a43 ??????(Version:4)
         ON ACTION replace
            LET g_action_choice="replace"
            IF cl_auth_chk_act("replace") THEN
               
               #add-point:ON ACTION replace name="menu.replace"

               #END add-point
               
            END IF
 
 
 
 
         #?? a43 ??????(Version:4)
         ON ACTION replace_a
            LET g_action_choice="replace_a"
            IF cl_auth_chk_act("replace_a") THEN
               
               #add-point:ON ACTION replace_a name="menu.replace_a"
               IF g_sfajwf_m.sfajwfstus MATCHES '[NYF]' AND NOT cl_null(g_sfajwf_m.sfajwfdocno) THEN
                  CALL bsft001_wf_02(g_sfajwf_m.sfajwfstus)
                  CALL bsft001_wf_b_fill()
               END IF
               #END add-point
               
            END IF
 
 
 
 
         #?? a43 ??????(Version:4)
         ON ACTION replace_set
            LET g_action_choice="replace_set"
            IF cl_auth_chk_act("replace_set") THEN
               
               #add-point:ON ACTION replace_set name="menu.replace_set"
               #??? ??? ???
               IF g_sfajwf_m.sfajwfstus MATCHES '[NYF]' AND NOT cl_null(g_sfajwf_m.sfajwfdocno) THEN
                  CALL bsft001_wf_03(g_sfajwf_m.sfajwfstus)
                  CALL bsft001_wf_b_fill()
               END IF
               #END add-point
               
            END IF
 
 
 
 
         #?? a43 ??????(Version:4)
         ON ACTION reproduce
            LET g_action_choice="reproduce"
            IF cl_auth_chk_act("reproduce") THEN
               CALL bsft001_wf_reproduce()
               #add-point:ON ACTION reproduce name="menu.reproduce"

               #END add-point
               
            END IF
 
 
 
 
         #?? a43 ??????(Version:4)
         ON ACTION turnkey
            LET g_action_choice="turnkey"
            IF cl_auth_chk_act("turnkey") THEN
               
               #add-point:ON ACTION turnkey name="menu.turnkey"
               CALL bsft001_wf_upd_wfapwf('u') 
               #END add-point
               
            END IF
 
 
 
 
 
            #180611-00048
         
         #?? a46 ??????(Version:3)
         #??????
         ON ACTION related_document
            CALL bsft001_wf_set_pk_array()
            IF cl_auth_chk_act("related_document") THEN
               #add-point:ON ACTION related_document name="ui_dialog.dialog.related_document"

               #END add-point
               CALL cl_doc()
            END IF
            
         ON ACTION agendum
            CALL bsft001_wf_set_pk_array()
            #add-point:ON ACTION agendum name="ui_dialog.dialog.agendum"

            #END add-point
            CALL cl_user_overview()
            CALL cl_user_overview_set_follow_pic()
         
         ON ACTION followup
            CALL bsft001_wf_set_pk_array()
            #add-point:ON ACTION followup name="ui_dialog.dialog.followup"

            #END add-point
            CALL cl_user_overview_follow(g_sfajwf_m.sfajwfdocdt)
 
 
 
         
         #190108-00038 ---start---
         
         #190108-00038 --- end ---
 
         #????ACTION
         &include "main_menu_exit_dialog.4gl"
         &include "relating_action.4gl"
    
         #??????ACTION
         &include "common_action.4gl" 
            CONTINUE DIALOG
      END DIALOG
 
      #(ver:79) ---add start---
      #add-point:ui_dialog? after dialog name="ui_dialog.exit_dialog"

      #end add-point
      #(ver:79) --- add end ---
    
      IF g_action_choice = "exit" AND NOT cl_null(g_action_choice) THEN
         #add-point:ui_dialog???dialog? name="ui_dialog.b_exit"

         #end add-point
         EXIT WHILE
      END IF
    
   END WHILE    
      
   CALL cl_set_act_visible("accept,cancel", TRUE)
    
END FUNCTION

{</section>}

{<section id="bsft001_wf.browser_fill" type="s" >}
#+ ????????
PRIVATE FUNCTION bsft001_wf_browser_fill(ps_page_action) RETURNS ()   #200213-00032
   #add-point:browser_fill?define(???) name="browser_fill.define_customerization"

   #end add-point  
   DEFINE ps_page_action    STRING
   DEFINE l_wc              STRING
   DEFINE l_wc2             STRING
   DEFINE l_sql             STRING
   DEFINE l_sub_sql         STRING
   DEFINE l_sql_rank        STRING
   #add-point:browser_fill?define (?????????????????, ?????patch????????) name="browser_fill.define"

   #end add-point    
   
   #add-point:Function???? name="browser_fill.before_browser_fill"

   #end add-point
   
   IF cl_null(g_wc) THEN
      LET g_wc = " 1=1"
   END IF
   IF cl_null(g_wc2) THEN
      LET g_wc2 = " 1=1"
   END IF
   LET l_wc  = g_wc.trim() 
   LET l_wc2 = g_wc2.trim()
 
   #add-point:browser_fill,foreach? name="browser_fill.before_foreach"

   #end add-point
   
   IF g_wc2 <> " 1=1" THEN
      #?????????                      
      LET l_sub_sql = " SELECT DISTINCT sfajwfdocno ",
                      " FROM sfajwf_t ",
                      " ",
                      " LEFT JOIN sfakwf_t ON sfakwfent = sfajwfent AND sfakwfsite = sfajwfsite AND sfajwfdocno = sfakwfdocno ", "  ",
                      #add-point:browser_fill?sql(sfakwf_t1) name="browser_fill.cnt.join.}"

                      #end add-point
                      " LEFT JOIN sfamwf_t ON sfamwfent = sfajwfent AND sfajwfdocno = sfamwfdocno", "  ",
                      #add-point:browser_fill?sql(sfamwf_t1) name="browser_fill.cnt.join.sfamwf_t1"

                      #end add-point
 
 
                      " LEFT JOIN sfbcwf_t ON sfbcwfent = sfajwfent AND sfbcwfsite = sfajwfsite AND sfakwfdocno = sfbcwfdocno AND sfakwfseq = sfbcwfseq", "  ",
                      #add-point:browser_fill?sql(sfbcwf_t1) name="browser_fill.cnt.join.sfbcwf_t1"

                      #end add-point
 
                      " LEFT JOIN wfapwf_t ON wfapwfent = sfajwfent AND wfapwfsite = sfajwfsite AND sfakwfdocno = wfapwfdocno AND sfakwfseq = wfapwfseq", "  ",
                      #add-point:browser_fill?sql(wfapwf_t1) name="browser_fill.cnt.join.wfapwf_t1"

                      #end add-point
 
                      " LEFT JOIN sfanwf_t ON sfanwfent = sfajwfent AND sfanwfsite = sfajwfsite AND sfakwfdocno = sfanwfdocno AND sfakwfseq = sfanwfseq1", "  ",
                      #add-point:browser_fill?sql(sfanwf_t1) name="browser_fill.cnt.join.sfanwf_t1"

                      #end add-point
 
 
                      " ", 
                      " ", 
                      " ",                      
 
 
                      " ",
 
                      " ",
 
                      " ",
 
 
                      " WHERE sfajwfent = " ||g_enterprise|| " AND sfajwfsite = '" ||g_site|| "' AND sfakwfent = " ||g_enterprise|| " AND sfakwfsite = '" ||g_site|| "' AND ",l_wc, " AND ", l_wc2, cl_sql_add_filter("sfajwf_t") 
                      ," AND ", g_wc2_extend #190730-00003#4 add
 
  ELSE
      #?????????
      LET l_sub_sql = " SELECT DISTINCT sfajwfdocno ",
                      " FROM sfajwf_t ", 
                      "  ",
                      "  ",
                      " WHERE sfajwfent = " ||g_enterprise|| " AND sfajwfsite = '" ||g_site|| "' AND ",l_wc CLIPPED, cl_sql_add_filter("sfajwf_t")
   END IF
   
   #add-point:browser_fill,cnt wc name="browser_fill.cnt_sqlwc"

   #end add-point
   
#  LET g_sql = " SELECT COUNT(1) FROM (",l_sub_sql,")"   #200804-00006 mark
   LET g_sql = " SELECT COUNT(1) FROM (",l_sub_sql,") PGS_A01 "   #200804-00006
   
   #add-point:browser_fill,count? name="browser_fill.before_count"

   #end add-point
   
   IF g_sql.getIndexOf(" 1=2",1) THEN
      DISPLAY "INFO: 1=2 jumped!"
   ELSE
      PREPARE header_cnt_pre FROM g_sql
      EXECUTE header_cnt_pre INTO g_browser_cnt   #???
      FREE header_cnt_pre
   END IF
    
   IF g_browser_cnt > g_max_browse THEN
      #????????????????????????????
      IF cl_null(g_action_choice) OR g_action_choice <> "ui_change" THEN   #190108-00038
         IF g_error_show = 1 THEN
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = g_browser_cnt
            LET g_errparam.code = 9035 
            LET g_errparam.popup = TRUE 
            CALL cl_err()
         END IF
      END IF   #190108-00038
      LET g_browser_cnt = g_max_browse
   END IF
   
   DISPLAY g_browser_cnt TO FORMONLY.b_count   #??????
   DISPLAY g_browser_cnt TO FORMONLY.h_count   #??????
 
   #?????????????WC
   IF cl_null(g_add_browse) THEN
      #????
      CLEAR FORM                
      INITIALIZE g_sfajwf_m.* TO NULL
      CALL g_sfakwf_d.clear()        
      CALL g_sfakwf2_d.clear() 
      CALL g_sfakwf3_d.clear() 
      CALL g_sfakwf4_d.clear() 
      CALL g_sfakwf5_d.clear() 
 
      #add-point:browser_fill g_add_browse????? name="browser_fill.add_browse.other"

      #end add-point   
      CALL g_browser.clear()
      LET g_cnt = 1
   ELSE
      LET l_wc  = g_add_browse
      LET l_wc2 = " 1=1" 
      LET g_cnt = g_current_idx
   END IF
 
   #??t0.sfajwfdocno,t0.sfajwfdocdt,t0.sfajwf006,t0.sfajwf007,t0.sfajwf012,t0.sfajwf013,t0.sfajwf014,t0.sfajwf001,t0.sfajwf002,t0.sfajwf015,t0.sfajwf016,t0.sfajwf003,t0.sfajwf004,t0.sfajwf005,t0.sfajwf008,t0.sfajwf009,t0.sfajwf010,t0.sfajwf011 Browser????(????bs_sql??)
   #??????????, ?????join????table
   #DISTINCT??????join????????(????DISTINCT????????)
   IF g_wc2 <> " 1=1" THEN
      #?????????   
      LET g_sql = " SELECT DISTINCT t0.sfajwfstus,t0.sfajwfdocno,t0.sfajwfdocdt,t0.sfajwf006,t0.sfajwf007,t0.sfajwf012,t0.sfajwf013,t0.sfajwf014,t0.sfajwf001,t0.sfajwf002,t0.sfajwf015,t0.sfajwf016,t0.sfajwf003,t0.sfajwf004,t0.sfajwf005,t0.sfajwf008,t0.sfajwf009,t0.sfajwf010,t0.sfajwf011 ",
                  " FROM sfajwf_t t0",
                  "  ",
                  "  LEFT JOIN sfakwf_t ON sfakwfent = sfajwfent AND sfakwfsite = sfajwfsite AND sfajwfdocno = sfakwfdocno ", "  ", 
                  #add-point:browser_fill?sql(sfakwf_t1) name="browser_fill.join.sfakwf_t1"

                  #end add-point
                  "  LEFT JOIN sfamwf_t ON sfamwfent = sfajwfent AND sfajwfdocno = sfamwfdocno", "  ", 
                  #add-point:browser_fill?sql(sfamwf_t1) name="browser_fill.join.sfamwf_t1"

                  #end add-point
 
 
                  "  LEFT JOIN sfbcwf_t ON sfbcwfent = sfajwfent AND sfbcwfsite = sfajwfsite AND sfakwfdocno = sfbcwfdocno AND sfakwfseq = sfbcwfseq", "  ", 
                  #add-point:browser_fill?sql(sfbcwf_t1) name="browser_fill.join.sfbcwf_t1"

                  #end add-point
 
                  "  LEFT JOIN wfapwf_t ON wfapwfent = sfajwfent AND wfapwfsite = sfajwfsite AND sfakwfdocno = wfapwfdocno AND sfakwfseq = wfapwfseq", "  ", 
                  #add-point:browser_fill?sql(wfapwf_t1) name="browser_fill.join.wfapwf_t1"

                  #end add-point
 
                  "  LEFT JOIN sfanwf_t ON sfanwfent = sfajwfent AND sfanwfsite = sfajwfsite AND sfakwfdocno = sfanwfdocno AND sfakwfseq = sfanwfseq1", "  ", 
                  #add-point:browser_fill?sql(sfanwf_t1) name="browser_fill.join.sfanwf_t1"

                  #end add-point
 
 
                  " ", 
                  " ",                      
 
 
                  " ",
 
                  " ",
 
                  " ",
 
 
                  
                  " WHERE t0.sfajwfent = " ||g_enterprise|| " AND t0.sfajwfsite = '" ||g_site|| "' AND ",l_wc," AND ",l_wc2, cl_sql_add_filter("sfajwf_t")
                  ," AND ",g_wc2_extend #190730-00003#4 add 
   ELSE
      #?????????   
      LET g_sql = " SELECT DISTINCT t0.sfajwfstus,t0.sfajwfdocno,t0.sfajwfdocdt,t0.sfajwf006,t0.sfajwf007,t0.sfajwf012,t0.sfajwf013,t0.sfajwf014,t0.sfajwf001,t0.sfajwf002,t0.sfajwf015,t0.sfajwf016,t0.sfajwf003,t0.sfajwf004,t0.sfajwf005,t0.sfajwf008,t0.sfajwf009,t0.sfajwf010,t0.sfajwf011 ",
                  " FROM sfajwf_t t0",
                  "  ",
                  
                  " WHERE t0.sfajwfent = " ||g_enterprise|| " AND t0.sfajwfsite = '" ||g_site|| "' AND ",l_wc, cl_sql_add_filter("sfajwf_t")
   END IF
   #add-point:browser_fill,sql wc name="browser_fill.fill_sqlwc"

   #end add-point
   LET g_sql = g_sql, " ORDER BY sfajwfdocno ",g_order   #200917-00047 mark   #201005-00006 remark
#  LET g_sql = " SELECT * FROM (",g_sql,") t01_eff ORDER BY sfajwfdocno ",g_order   #200917-00047   #201005-00006 mark
 
   #add-point:browser_fill,before_prepare name="browser_fill.before_prepare"

   #end add-point
        
   #LET g_sql = cl_sql_add_tabid(g_sql,"sfajwf_t") #WC??
   LET g_sql = cl_sql_add_mask(g_sql) #??????
   
   IF g_sql.getIndexOf(" 1=2",1) THEN
      DISPLAY "INFO: 1=2 jumped!"
   ELSE
      PREPARE browse_pre FROM g_sql
      display "g_sql:",g_sql
      DECLARE browse_cur CURSOR FOR browse_pre
      display 'SQL:',g_sql
      #add-point:browser_fill?open cursor name="browser_fill.open"

      #end add-point
      
      FOREACH browse_cur INTO g_browser[g_cnt].b_statepic,g_browser[g_cnt].b_sfajwfdocno,g_browser[g_cnt].b_sfajwfdocdt,g_browser[g_cnt].b_sfajwf006,g_browser[g_cnt].b_sfajwf007,g_browser[g_cnt].b_sfajwf012,g_browser[g_cnt].b_sfajwf013,g_browser[g_cnt].b_sfajwf014,g_browser[g_cnt].b_sfajwf001,g_browser[g_cnt].b_sfajwf002, 
          g_browser[g_cnt].b_sfajwf015,g_browser[g_cnt].b_sfajwf016,g_browser[g_cnt].b_sfajwf003,g_browser[g_cnt].b_sfajwf004,g_browser[g_cnt].b_sfajwf005,g_browser[g_cnt].b_sfajwf008,g_browser[g_cnt].b_sfajwf009,g_browser[g_cnt].b_sfajwf010,g_browser[g_cnt].b_sfajwf011
         IF SQLCA.SQLCODE THEN
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = "Foreach:",SQLERRMESSAGE 
            LET g_errparam.code = SQLCA.SQLCODE 
            LET g_errparam.popup = TRUE 
            CALL cl_err()
            EXIT FOREACH
         END IF
      
         #add-point:browser_fill?reference name="browser_fill.reference"

         #end add-point
      
         #??????
         CALL bsft001_wf_browser_mask()
      
               #?? a24 ??????(Version:3)
      #browser????
      CASE g_browser[g_cnt].b_statepic
         WHEN "A"
            LET g_browser[g_cnt].b_statepic = "stus/16/approved.png"
         WHEN "D"
            LET g_browser[g_cnt].b_statepic = "stus/16/withdraw.png"
         WHEN "R"
            LET g_browser[g_cnt].b_statepic = "stus/16/rejection.png"
         WHEN "W"
            LET g_browser[g_cnt].b_statepic = "stus/16/signing.png"
         WHEN "N"
            LET g_browser[g_cnt].b_statepic = "stus/16/unconfirmed.png"
         WHEN "Y"
            LET g_browser[g_cnt].b_statepic = "stus/16/confirmed.png"
         WHEN "F"
            LET g_browser[g_cnt].b_statepic = "stus/16/released.png"
         WHEN "U"
            LET g_browser[g_cnt].b_statepic = "stus/16/unreleased.png"
         WHEN "X"
            LET g_browser[g_cnt].b_statepic = "stus/16/invalid.png"
         
      END CASE
 
 
 
         LET g_cnt = g_cnt + 1
         IF g_cnt > g_max_browse THEN
            EXIT FOREACH
         END IF
         
      END FOREACH
      FREE browse_pre
   END IF
   
   #??g_add_browse, ???????
   IF NOT cl_null(g_add_browse) THEN
      LET g_add_browse = ""
      CALL g_curr_diag.setCurrentRow("s_browse",g_current_idx)
   END IF
   
   IF cl_null(g_browser[g_cnt].b_sfajwfdocno) THEN
      CALL g_browser.deleteElement(g_cnt)
   END IF
   
   LET g_header_cnt  = g_browser.getLength()
   LET g_browser_cnt = g_browser.getLength()
   
   #????
   IF g_browser_cnt > 0 THEN
      DISPLAY g_browser_idx TO FORMONLY.b_index #????
      DISPLAY g_browser_cnt TO FORMONLY.b_count #???
      DISPLAY g_browser_idx TO FORMONLY.h_index #????
      DISPLAY g_browser_cnt TO FORMONLY.h_count #???
      DISPLAY g_detail_idx  TO FORMONLY.idx     #??????
      DISPLAY g_detail_cnt  TO FORMONLY.cnt     #?????
   ELSE
      DISPLAY '' TO FORMONLY.b_index #????
      DISPLAY '' TO FORMONLY.b_count #???
      DISPLAY '' TO FORMONLY.h_index #????
      DISPLAY '' TO FORMONLY.h_count #???
      DISPLAY '' TO FORMONLY.idx     #??????
      DISPLAY '' TO FORMONLY.cnt     #?????
   END IF
 
   LET g_rec_b = g_cnt - 1
   LET g_detail_cnt = g_rec_b
   LET g_cnt = 0
 
   #???????????
   IF g_browser_cnt = 0 THEN
      CALL cl_set_act_visible("statechange,modify,modify_detail,delete,reproduce,mainhidden", FALSE)
      CALL cl_navigator_setting(0,0)
   ELSE
      CALL cl_set_act_visible("mainhidden", TRUE)
   END IF
                  
   
   #add-point:browser_fill???? name="browser_fill.after"
   CALL bsft001_wf_set_act_visible_b() 
   CALL bsft001_wf_set_act_no_visible_b() 
   CALL bsft001_wf_set_act_visible()   
   CALL bsft001_wf_set_act_no_visible() 
   #end add-point   
 
END FUNCTION

{</section>}

{<section id="bsft001_wf.ui_headershow" type="s" >}
#+ ????????
PRIVATE FUNCTION bsft001_wf_ui_headershow() RETURNS ()   #200213-00032
   #add-point:ui_headershow?define(???) name="ui_headershow.define_customerization"

   #end add-point  
   #add-point:ui_headershow?define (?????????????????, ?????patch????????) name="ui_headershow.define"

   #end add-point      
   
   #add-point:Function????  name="ui_headershow.pre_function"

   #end add-point
 
   IF g_browser.getLength() > 0 AND g_current_idx > 0 THEN   #200828-00027?????,?????? (???)
      LET g_sfajwf_m.sfajwfdocno = g_browser[g_current_idx].b_sfajwfdocno   
 
      EXECUTE bsft001_wf_master_referesh USING g_site,g_sfajwf_m.sfajwfdocno INTO g_sfajwf_m.sfajwfdocno,g_sfajwf_m.sfajwfdocdt,g_sfajwf_m.sfajwf006,g_sfajwf_m.sfajwf007,g_sfajwf_m.sfajwf017,g_sfajwf_m.sfajwf019,g_sfajwf_m.sfajwf020,g_sfajwf_m.sfajwf021,g_sfajwf_m.sfajwf018,g_sfajwf_m.sfajwf022,g_sfajwf_m.sfajwf023, 
          g_sfajwf_m.sfajwf012,g_sfajwf_m.sfajwf013,g_sfajwf_m.sfajwf014,g_sfajwf_m.sfajwf001,g_sfajwf_m.sfajwf002,g_sfajwf_m.sfajwf025,g_sfajwf_m.sfajwf015,g_sfajwf_m.sfajwfua002,g_sfajwf_m.sfajwf016,g_sfajwf_m.sfajwfua003,g_sfajwf_m.sfajwf024,g_sfajwf_m.sfajwf003,g_sfajwf_m.sfajwf005,g_sfajwf_m.sfajwf004, 
          g_sfajwf_m.sfajwf008,g_sfajwf_m.sfajwf009,g_sfajwf_m.sfajwf010,g_sfajwf_m.sfajwf011,g_sfajwf_m.sfajwfua011,g_sfajwf_m.sfajwfua012,g_sfajwf_m.sfajwfua013,g_sfajwf_m.sfajwfua014,g_sfajwf_m.sfajwfua015,g_sfajwf_m.sfajwfstus,g_sfajwf_m.sfajwfownid,g_sfajwf_m.sfajwfowndp,g_sfajwf_m.sfajwfcrtid, 
          g_sfajwf_m.sfajwfcrtdp,g_sfajwf_m.sfajwfcrtdt,g_sfajwf_m.sfajwfmodid,g_sfajwf_m.sfajwfmoddt,g_sfajwf_m.sfajwfcnfid,g_sfajwf_m.sfajwfcnfdt,g_sfajwf_m.sfajwf006_desc,g_sfajwf_m.sfajwf007_desc,g_sfajwf_m.sfajwf023_desc,g_sfajwf_m.sfajwf012_desc,g_sfajwf_m.sfajwf001_desc,g_sfajwf_m.sfajwf002_desc, 
          g_sfajwf_m.sfajwf025_desc,g_sfajwf_m.sfajwf008_desc,g_sfajwf_m.sfajwf009_desc,g_sfajwf_m.sfajwf010_desc,g_sfajwf_m.sfajwf011_desc,g_sfajwf_m.sfajwfownid_desc,g_sfajwf_m.sfajwfowndp_desc,g_sfajwf_m.sfajwfcrtid_desc,g_sfajwf_m.sfajwfcrtdp_desc,g_sfajwf_m.sfajwfmodid_desc,g_sfajwf_m.sfajwfcnfid_desc 

      
      CALL bsft001_wf_sfajwf_t_mask()
      CALL bsft001_wf_show()
   END IF   #200828-00027
      
END FUNCTION

{</section>}

{<section id="bsft001_wf.ui_detailshow" type="s" >}
#+ ????????
PRIVATE FUNCTION bsft001_wf_ui_detailshow() RETURNS ()   #200213-00032
   #add-point:ui_detailshow?define(???) name="ui_detailshow.define_customerization"

   #end add-point    
   #add-point:ui_detailshow?define (?????????????????, ?????patch????????) name="ui_detailshow.define"

   #end add-point    
 
   #add-point:Function???? name="ui_detailshow.before"

   #end add-point    
   
   IF g_curr_diag IS NOT NULL THEN
      CALL g_curr_diag.setCurrentRow("s_detail1",g_detail_idx)      
      CALL g_curr_diag.setCurrentRow("s_detail2",g_detail_idx)
      CALL g_curr_diag.setCurrentRow("s_detail3",g_detail_idx)
      CALL g_curr_diag.setCurrentRow("s_detail4",g_detail_idx)
      CALL g_curr_diag.setCurrentRow("s_detail5",g_detail_idx)
 
   END IF
   
   #add-point:ui_detailshow?after name="ui_detailshow.after"

   #end add-point    
   
END FUNCTION

{</section>}

{<section id="bsft001_wf.ui_browser_refresh" type="s" >}
#+ ??????????
PRIVATE FUNCTION bsft001_wf_ui_browser_refresh() RETURNS ()   #200213-00032
   #add-point:ui_browser_refresh?define(???) name="ui_browser_refresh.define_customerization"

   #end add-point    
   DEFINE l_i  LIKE type_t.num10
   #add-point:ui_browser_refresh?define (?????????????????, ?????patch????????) name="ui_browser_refresh.define"

   #end add-point    
   
   #add-point:Function????  name="ui_browser_refresh.pre_function"

   #end add-point
   
   LET g_browser_cnt = g_browser.getLength()
   LET g_header_cnt  = g_browser.getLength()
   FOR l_i =1 TO g_browser.getLength()
      IF g_browser[l_i].b_sfajwfdocno = g_sfajwf_m.sfajwfdocno 
 
         THEN
         CALL g_browser.deleteElement(l_i)
         EXIT FOR
      END IF
   END FOR
   LET g_browser_cnt = g_browser_cnt - 1
   LET g_header_cnt = g_header_cnt - 1
    
   #???????????
   IF g_browser_cnt = 0 THEN
      CALL cl_set_act_visible("statechange,modify,modify_detail,delete,reproduce,mainhidden", FALSE)
      CALL cl_navigator_setting(0,0)
      CLEAR FORM
   ELSE
      CALL cl_set_act_visible("mainhidden", TRUE)
   END IF
   
   #add-point:ui_browser_refresh?after name="ui_browser_refresh.after"

   #end add-point    
   
END FUNCTION

{</section>}

{<section id="bsft001_wf.construct" type="s" >}
#+ QBE????
PRIVATE FUNCTION bsft001_wf_construct() RETURNS ()   #200213-00032
   #add-point:cs?define(???) name="cs.define_customerization"

   #end add-point    
   DEFINE ls_return   STRING
   DEFINE ls_result   STRING 
   DEFINE ls_wc       STRING 
   DEFINE la_wc       DYNAMIC ARRAY OF RECORD
          tableid     STRING,
          wc          STRING
          END RECORD
   DEFINE li_idx      LIKE type_t.num10
   DEFINE lp_str      STRING   #201109-00009
   #add-point:cs?define (?????????????????, ?????patch????????) name="cs.define"

   #end add-point    
   
   #add-point:Function????  name="cs.pre_function"

   #end add-point
    
   #????
   CLEAR FORM                
   INITIALIZE g_sfajwf_m.* TO NULL
   CALL g_sfakwf_d.clear()        
   CALL g_sfakwf2_d.clear() 
   CALL g_sfakwf3_d.clear() 
   CALL g_sfakwf4_d.clear() 
   CALL g_sfakwf5_d.clear() 
 
   
   LET g_action_choice = ""
    
   INITIALIZE g_wc TO NULL
   INITIALIZE g_wc2 TO NULL
   
   INITIALIZE g_wc2_table1 TO NULL
   INITIALIZE g_wc2_table2 TO NULL
 
 
    
   LET g_qryparam.state = 'c'
   
   #add-point:cs???? name="cs.before_construct"

   #end add-point 
   
   #??DIALOG?? ??CONSTRUCT???CONSTRUCT
   DIALOG ATTRIBUTES(UNBUFFERED,FIELD ORDER FORM)
      
      #??
      CONSTRUCT BY NAME g_wc ON sfajwfdocno,oobal004,sfajwfdocdt,sfajwf006,sfajwf007,sfajwf017,sfajwf019,sfajwf020,sfajwf021,sfajwf018,l_sfajwf018,sfajwf022,sfajwf023,sfajwf012,sfajwf013,sfajwf014,sfajwf001,sfajwf002,sfajwf025,sfajwf015,sfajwfua002,sfajwf016,sfajwfua003,sfajwf024,sfajwf003,sfajwf005, 
          sfajwf004,sfajwf008,sfajwf009,sfajwf010,sfajwf011,sfajwfua011,sfajwfua012,sfajwfua013,sfajwfua014,sfajwfua015,sfajwfstus,sfajwfownid,sfajwfowndp,sfajwfcrtid,sfajwfcrtdp,sfajwfcrtdt,sfajwfmodid,sfajwfmoddt,sfajwfcnfid,sfajwfcnfdt
 
         BEFORE CONSTRUCT
            #add-point:cs?before_construct name="cs.head.before_construct"

            #end add-point 
            
         #??????????
         #?? a11 ??????(Version:3)
         #????????  
         ##----<<sfajwfcrtdt>>----
         AFTER FIELD sfajwfcrtdt
            CALL FGL_DIALOG_GETBUFFER() RETURNING ls_result
            IF NOT cl_null(ls_result) THEN
               IF NOT cl_chk_date_symbol(ls_result) THEN
                  LET ls_result = cl_add_date_extra_cond(ls_result)
               END IF
            END IF
            CALL FGL_DIALOG_SETBUFFER(ls_result)
 
         #----<<sfajwfmoddt>>----
         AFTER FIELD sfajwfmoddt
            CALL FGL_DIALOG_GETBUFFER() RETURNING ls_result
            IF NOT cl_null(ls_result) THEN
               IF NOT cl_chk_date_symbol(ls_result) THEN
                  LET ls_result = cl_add_date_extra_cond(ls_result)
               END IF
            END IF
            CALL FGL_DIALOG_SETBUFFER(ls_result)
         
         #----<<sfajwfcnfdt>>----
         AFTER FIELD sfajwfcnfdt
            CALL FGL_DIALOG_GETBUFFER() RETURNING ls_result
            IF NOT cl_null(ls_result) THEN
               IF NOT cl_chk_date_symbol(ls_result) THEN
                  LET ls_result = cl_add_date_extra_cond(ls_result)
               END IF
            END IF
            CALL FGL_DIALOG_SETBUFFER(ls_result)
         
         #----<<sfajwfpstdt>>----
 
 
 
            
         #??????????    
                  #Ctrlp:construct.c.sfajwfdocno
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwfdocno
            #add-point:ON ACTION controlp INFIELD sfajwfdocno name="construct.c.sfajwfdocno"
            #?? a08 ??????(Version:3)
            #??c?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            CALL q_sfajwfdocno_01_wf()                           #????
            DISPLAY g_qryparam.return1 TO sfajwfdocno  #??????
            NEXT FIELD sfajwfdocno                     #?????
    



            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwfdocno
            #add-point:BEFORE FIELD sfajwfdocno name="construct.b.sfajwfdocno"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwfdocno
            
            #add-point:AFTER FIELD sfajwfdocno name="construct.a.sfajwfdocno"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD oobal004
            #add-point:BEFORE FIELD oobal004 name="construct.b.oobal004"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD oobal004
            
            #add-point:AFTER FIELD oobal004 name="construct.a.oobal004"

            #END add-point
            
 
 
         #Ctrlp:construct.c.oobal004
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD oobal004
            #add-point:ON ACTION controlp INFIELD oobal004 name="construct.c.oobal004"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwfdocdt
            #add-point:BEFORE FIELD sfajwfdocdt name="construct.b.sfajwfdocdt"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwfdocdt
            
            #add-point:AFTER FIELD sfajwfdocdt name="construct.a.sfajwfdocdt"

            #END add-point
            
 
 
         #Ctrlp:construct.c.sfajwfdocdt
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwfdocdt
            #add-point:ON ACTION controlp INFIELD sfajwfdocdt name="construct.c.sfajwfdocdt"

            #END add-point
 
 
         #Ctrlp:construct.c.sfajwf006
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwf006
            #add-point:ON ACTION controlp INFIELD sfajwf006 name="construct.c.sfajwf006"
            #?? a08 ??????(Version:3)
            #??c?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            CALL q_pmaa001_3()                           #????
            DISPLAY g_qryparam.return1 TO sfajwf006  #??????
            NEXT FIELD sfajwf006                     #?????
    



            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwf006
            #add-point:BEFORE FIELD sfajwf006 name="construct.b.sfajwf006"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwf006
            
            #add-point:AFTER FIELD sfajwf006 name="construct.a.sfajwf006"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.sfajwf007
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwf007
            #add-point:ON ACTION controlp INFIELD sfajwf007 name="construct.c.sfajwf007"
            #?? a08 ??????(Version:3)
            #??c?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            CALL q_pmad002_2()                           #????
            DISPLAY g_qryparam.return1 TO sfajwf007  #??????
            NEXT FIELD sfajwf007                     #?????
    



            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwf007
            #add-point:BEFORE FIELD sfajwf007 name="construct.b.sfajwf007"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwf007
            
            #add-point:AFTER FIELD sfajwf007 name="construct.a.sfajwf007"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwf017
            #add-point:BEFORE FIELD sfajwf017 name="construct.b.sfajwf017"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwf017
            
            #add-point:AFTER FIELD sfajwf017 name="construct.a.sfajwf017"

            #END add-point
            
 
 
         #Ctrlp:construct.c.sfajwf017
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwf017
            #add-point:ON ACTION controlp INFIELD sfajwf017 name="construct.c.sfajwf017"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwf019
            #add-point:BEFORE FIELD sfajwf019 name="construct.b.sfajwf019"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwf019
            
            #add-point:AFTER FIELD sfajwf019 name="construct.a.sfajwf019"

            #END add-point
            
 
 
         #Ctrlp:construct.c.sfajwf019
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwf019
            #add-point:ON ACTION controlp INFIELD sfajwf019 name="construct.c.sfajwf019"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwf020
            #add-point:BEFORE FIELD sfajwf020 name="construct.b.sfajwf020"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwf020
            
            #add-point:AFTER FIELD sfajwf020 name="construct.a.sfajwf020"

            #END add-point
            
 
 
         #Ctrlp:construct.c.sfajwf020
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwf020
            #add-point:ON ACTION controlp INFIELD sfajwf020 name="construct.c.sfajwf020"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwf021
            #add-point:BEFORE FIELD sfajwf021 name="construct.b.sfajwf021"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwf021
            
            #add-point:AFTER FIELD sfajwf021 name="construct.a.sfajwf021"

            #END add-point
            
 
 
         #Ctrlp:construct.c.sfajwf021
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwf021
            #add-point:ON ACTION controlp INFIELD sfajwf021 name="construct.c.sfajwf021"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwf018
            #add-point:BEFORE FIELD sfajwf018 name="construct.b.sfajwf018"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwf018
            
            #add-point:AFTER FIELD sfajwf018 name="construct.a.sfajwf018"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.sfajwf018
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwf018
            #add-point:ON ACTION controlp INFIELD sfajwf018 name="construct.c.sfajwf018"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD l_sfajwf018
            #add-point:BEFORE FIELD l_sfajwf018 name="construct.b.l_sfajwf018"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD l_sfajwf018
            
            #add-point:AFTER FIELD l_sfajwf018 name="construct.a.l_sfajwf018"

            #END add-point
            
 
 
         #Ctrlp:construct.c.l_sfajwf018
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD l_sfajwf018
            #add-point:ON ACTION controlp INFIELD l_sfajwf018 name="construct.c.l_sfajwf018"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwf022
            #add-point:BEFORE FIELD sfajwf022 name="construct.b.sfajwf022"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwf022
            
            #add-point:AFTER FIELD sfajwf022 name="construct.a.sfajwf022"

            #END add-point
            
 
 
         #Ctrlp:construct.c.sfajwf022
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwf022
            #add-point:ON ACTION controlp INFIELD sfajwf022 name="construct.c.sfajwf022"

            #END add-point
 
 
         #Ctrlp:construct.c.sfajwf023
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwf023
            #add-point:ON ACTION controlp INFIELD sfajwf023 name="construct.c.sfajwf023"
            #?? a08 ??????(Version:3)
            #??c?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.arg1 = "2"
            CALL q_icaa001_1()                           #????
            DISPLAY g_qryparam.return1 TO sfajwf023  #??????
            NEXT FIELD sfajwf023                     #?????
    



            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwf023
            #add-point:BEFORE FIELD sfajwf023 name="construct.b.sfajwf023"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwf023
            
            #add-point:AFTER FIELD sfajwf023 name="construct.a.sfajwf023"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.sfajwf012
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwf012
            #add-point:ON ACTION controlp INFIELD sfajwf012 name="construct.c.sfajwf012"
            #?? a08 ??????(Version:3)
            #??c?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            CALL q_sfajwf012_wf()                           #????
            DISPLAY g_qryparam.return1 TO sfajwf012  #??????
            NEXT FIELD sfajwf012                     #?????
    



            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwf012
            #add-point:BEFORE FIELD sfajwf012 name="construct.b.sfajwf012"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwf012
            
            #add-point:AFTER FIELD sfajwf012 name="construct.a.sfajwf012"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwf013
            #add-point:BEFORE FIELD sfajwf013 name="construct.b.sfajwf013"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwf013
            
            #add-point:AFTER FIELD sfajwf013 name="construct.a.sfajwf013"

            #END add-point
            
 
 
         #Ctrlp:construct.c.sfajwf013
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwf013
            #add-point:ON ACTION controlp INFIELD sfajwf013 name="construct.c.sfajwf013"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwf014
            #add-point:BEFORE FIELD sfajwf014 name="construct.b.sfajwf014"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwf014
            
            #add-point:AFTER FIELD sfajwf014 name="construct.a.sfajwf014"

            #END add-point
            
 
 
         #Ctrlp:construct.c.sfajwf014
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwf014
            #add-point:ON ACTION controlp INFIELD sfajwf014 name="construct.c.sfajwf014"

            #END add-point
 
 
         #Ctrlp:construct.c.sfajwf001
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwf001
            #add-point:ON ACTION controlp INFIELD sfajwf001 name="construct.c.sfajwf001"
            #?? a08 ??????(Version:3)
            #??c?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            CALL q_ooag001_2()                           #????
            DISPLAY g_qryparam.return1 TO sfajwf001  #??????
            NEXT FIELD sfajwf001                     #?????
    



            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwf001
            #add-point:BEFORE FIELD sfajwf001 name="construct.b.sfajwf001"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwf001
            
            #add-point:AFTER FIELD sfajwf001 name="construct.a.sfajwf001"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.sfajwf002
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwf002
            #add-point:ON ACTION controlp INFIELD sfajwf002 name="construct.c.sfajwf002"
            #?? a08 ??????(Version:3)
            #??c?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            CALL q_ooeg001()                           #????
            DISPLAY g_qryparam.return1 TO sfajwf002  #??????
            NEXT FIELD sfajwf002                     #?????
    



            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwf002
            #add-point:BEFORE FIELD sfajwf002 name="construct.b.sfajwf002"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwf002
            
            #add-point:AFTER FIELD sfajwf002 name="construct.a.sfajwf002"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwf025
            #add-point:BEFORE FIELD sfajwf025 name="construct.b.sfajwf025"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwf025
            
            #add-point:AFTER FIELD sfajwf025 name="construct.a.sfajwf025"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.sfajwf025
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwf025
            #add-point:ON ACTION controlp INFIELD sfajwf025 name="construct.c.sfajwf025"
            #?? a08 ??????(Version:3)
            #??c?
            #250328-00010#1 add--s
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.arg1 = cl_get_today()
            LET g_qryparam.arg2 = g_site  
            CALL q_ooeg001_8()                       #????
            DISPLAY g_qryparam.return1 TO sfajwf025  #??????
            NEXT FIELD sfajwf025                     #?????
            #250328-00010#1 add--e



            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwf015
            #add-point:BEFORE FIELD sfajwf015 name="construct.b.sfajwf015"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwf015
            
            #add-point:AFTER FIELD sfajwf015 name="construct.a.sfajwf015"

            #END add-point
            
 
 
         #Ctrlp:construct.c.sfajwf015
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwf015
            #add-point:ON ACTION controlp INFIELD sfajwf015 name="construct.c.sfajwf015"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwfua002
            #add-point:BEFORE FIELD sfajwfua002 name="construct.b.sfajwfua002"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwfua002
            
            #add-point:AFTER FIELD sfajwfua002 name="construct.a.sfajwfua002"

            #END add-point
            
 
 
         #Ctrlp:construct.c.sfajwfua002
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwfua002
            #add-point:ON ACTION controlp INFIELD sfajwfua002 name="construct.c.sfajwfua002"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwf016
            #add-point:BEFORE FIELD sfajwf016 name="construct.b.sfajwf016"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwf016
            
            #add-point:AFTER FIELD sfajwf016 name="construct.a.sfajwf016"

            #END add-point
            
 
 
         #Ctrlp:construct.c.sfajwf016
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwf016
            #add-point:ON ACTION controlp INFIELD sfajwf016 name="construct.c.sfajwf016"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwfua003
            #add-point:BEFORE FIELD sfajwfua003 name="construct.b.sfajwfua003"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwfua003
            
            #add-point:AFTER FIELD sfajwfua003 name="construct.a.sfajwfua003"

            #END add-point
            
 
 
         #Ctrlp:construct.c.sfajwfua003
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwfua003
            #add-point:ON ACTION controlp INFIELD sfajwfua003 name="construct.c.sfajwfua003"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwf024
            #add-point:BEFORE FIELD sfajwf024 name="construct.b.sfajwf024"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwf024
            
            #add-point:AFTER FIELD sfajwf024 name="construct.a.sfajwf024"

            #END add-point
            
 
 
         #Ctrlp:construct.c.sfajwf024
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwf024
            #add-point:ON ACTION controlp INFIELD sfajwf024 name="construct.c.sfajwf024"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwf003
            #add-point:BEFORE FIELD sfajwf003 name="construct.b.sfajwf003"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwf003
            
            #add-point:AFTER FIELD sfajwf003 name="construct.a.sfajwf003"

            #END add-point
            
 
 
         #Ctrlp:construct.c.sfajwf003
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwf003
            #add-point:ON ACTION controlp INFIELD sfajwf003 name="construct.c.sfajwf003"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwf005
            #add-point:BEFORE FIELD sfajwf005 name="construct.b.sfajwf005"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwf005
            
            #add-point:AFTER FIELD sfajwf005 name="construct.a.sfajwf005"

            #END add-point
            
 
 
         #Ctrlp:construct.c.sfajwf005
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwf005
            #add-point:ON ACTION controlp INFIELD sfajwf005 name="construct.c.sfajwf005"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwf004
            #add-point:BEFORE FIELD sfajwf004 name="construct.b.sfajwf004"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwf004
            
            #add-point:AFTER FIELD sfajwf004 name="construct.a.sfajwf004"

            #END add-point
            
 
 
         #Ctrlp:construct.c.sfajwf004
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwf004
            #add-point:ON ACTION controlp INFIELD sfajwf004 name="construct.c.sfajwf004"

            #END add-point
 
 
         #Ctrlp:construct.c.sfajwf008
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwf008
            #add-point:ON ACTION controlp INFIELD sfajwf008 name="construct.c.sfajwf008"
            #?? a08 ??????(Version:3)
            #??c?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            CALL q_inaa001_2()                           #????
            DISPLAY g_qryparam.return1 TO sfajwf008  #??????
            NEXT FIELD sfajwf008                     #?????
    



            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwf008
            #add-point:BEFORE FIELD sfajwf008 name="construct.b.sfajwf008"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwf008
            
            #add-point:AFTER FIELD sfajwf008 name="construct.a.sfajwf008"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.sfajwf009
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwf009
            #add-point:ON ACTION controlp INFIELD sfajwf009 name="construct.c.sfajwf009"
            #?? a08 ??????(Version:3)
            #??c?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            CALL q_inaa001_2()                           #????
            DISPLAY g_qryparam.return1 TO sfajwf009  #??????
            NEXT FIELD sfajwf009                     #?????
    



            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwf009
            #add-point:BEFORE FIELD sfajwf009 name="construct.b.sfajwf009"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwf009
            
            #add-point:AFTER FIELD sfajwf009 name="construct.a.sfajwf009"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.sfajwf010
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwf010
            #add-point:ON ACTION controlp INFIELD sfajwf010 name="construct.c.sfajwf010"
            #?? a08 ??????(Version:3)
            #??c?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            CALL q_inaa001_2()                           #????
            DISPLAY g_qryparam.return1 TO sfajwf010  #??????
            NEXT FIELD sfajwf010                     #?????
    



            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwf010
            #add-point:BEFORE FIELD sfajwf010 name="construct.b.sfajwf010"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwf010
            
            #add-point:AFTER FIELD sfajwf010 name="construct.a.sfajwf010"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.sfajwf011
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwf011
            #add-point:ON ACTION controlp INFIELD sfajwf011 name="construct.c.sfajwf011"
            #?? a08 ??????(Version:3)
            #??c?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            CALL q_inab002_3()                           #????
            DISPLAY g_qryparam.return1 TO sfajwf011  #??????
            NEXT FIELD sfajwf011                     #?????
    



            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwf011
            #add-point:BEFORE FIELD sfajwf011 name="construct.b.sfajwf011"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwf011
            
            #add-point:AFTER FIELD sfajwf011 name="construct.a.sfajwf011"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwfua011
            #add-point:BEFORE FIELD sfajwfua011 name="construct.b.sfajwfua011"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwfua011
            
            #add-point:AFTER FIELD sfajwfua011 name="construct.a.sfajwfua011"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.sfajwfua011
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwfua011
            #add-point:ON ACTION controlp INFIELD sfajwfua011 name="construct.c.sfajwfua011"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwfua012
            #add-point:BEFORE FIELD sfajwfua012 name="construct.b.sfajwfua012"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwfua012
            
            #add-point:AFTER FIELD sfajwfua012 name="construct.a.sfajwfua012"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.sfajwfua012
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwfua012
            #add-point:ON ACTION controlp INFIELD sfajwfua012 name="construct.c.sfajwfua012"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwfua013
            #add-point:BEFORE FIELD sfajwfua013 name="construct.b.sfajwfua013"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwfua013
            
            #add-point:AFTER FIELD sfajwfua013 name="construct.a.sfajwfua013"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.sfajwfua013
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwfua013
            #add-point:ON ACTION controlp INFIELD sfajwfua013 name="construct.c.sfajwfua013"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwfua014
            #add-point:BEFORE FIELD sfajwfua014 name="construct.b.sfajwfua014"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwfua014
            
            #add-point:AFTER FIELD sfajwfua014 name="construct.a.sfajwfua014"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.sfajwfua014
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwfua014
            #add-point:ON ACTION controlp INFIELD sfajwfua014 name="construct.c.sfajwfua014"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwfua015
            #add-point:BEFORE FIELD sfajwfua015 name="construct.b.sfajwfua015"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwfua015
            
            #add-point:AFTER FIELD sfajwfua015 name="construct.a.sfajwfua015"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.sfajwfua015
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwfua015
            #add-point:ON ACTION controlp INFIELD sfajwfua015 name="construct.c.sfajwfua015"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwfstus
            #add-point:BEFORE FIELD sfajwfstus name="construct.b.sfajwfstus"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwfstus
            
            #add-point:AFTER FIELD sfajwfstus name="construct.a.sfajwfstus"

            #END add-point
            
 
 
         #Ctrlp:construct.c.sfajwfstus
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwfstus
            #add-point:ON ACTION controlp INFIELD sfajwfstus name="construct.c.sfajwfstus"

            #END add-point
 
 
         #Ctrlp:construct.c.sfajwfownid
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwfownid
            #add-point:ON ACTION controlp INFIELD sfajwfownid name="construct.c.sfajwfownid"
            #?? a08 ??????(Version:3)
            #??c?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            CALL q_ooag001()                           #????
            DISPLAY g_qryparam.return1 TO sfajwfownid  #??????
            NEXT FIELD sfajwfownid                     #?????
    



            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwfownid
            #add-point:BEFORE FIELD sfajwfownid name="construct.b.sfajwfownid"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwfownid
            
            #add-point:AFTER FIELD sfajwfownid name="construct.a.sfajwfownid"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.sfajwfowndp
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwfowndp
            #add-point:ON ACTION controlp INFIELD sfajwfowndp name="construct.c.sfajwfowndp"
            #?? a08 ??????(Version:3)
            #??c?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            CALL q_ooeg001_9()                           #????
            DISPLAY g_qryparam.return1 TO sfajwfowndp  #??????
            NEXT FIELD sfajwfowndp                     #?????
    



            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwfowndp
            #add-point:BEFORE FIELD sfajwfowndp name="construct.b.sfajwfowndp"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwfowndp
            
            #add-point:AFTER FIELD sfajwfowndp name="construct.a.sfajwfowndp"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.sfajwfcrtid
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwfcrtid
            #add-point:ON ACTION controlp INFIELD sfajwfcrtid name="construct.c.sfajwfcrtid"
            #?? a08 ??????(Version:3)
            #??c?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            CALL q_ooag001()                           #????
            DISPLAY g_qryparam.return1 TO sfajwfcrtid  #??????
            NEXT FIELD sfajwfcrtid                     #?????
    



            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwfcrtid
            #add-point:BEFORE FIELD sfajwfcrtid name="construct.b.sfajwfcrtid"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwfcrtid
            
            #add-point:AFTER FIELD sfajwfcrtid name="construct.a.sfajwfcrtid"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.sfajwfcrtdp
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwfcrtdp
            #add-point:ON ACTION controlp INFIELD sfajwfcrtdp name="construct.c.sfajwfcrtdp"
            #?? a08 ??????(Version:3)
            #??c?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            CALL q_ooeg001_9()                           #????
            DISPLAY g_qryparam.return1 TO sfajwfcrtdp  #??????
            NEXT FIELD sfajwfcrtdp                     #?????
    



            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwfcrtdp
            #add-point:BEFORE FIELD sfajwfcrtdp name="construct.b.sfajwfcrtdp"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwfcrtdp
            
            #add-point:AFTER FIELD sfajwfcrtdp name="construct.a.sfajwfcrtdp"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwfcrtdt
            #add-point:BEFORE FIELD sfajwfcrtdt name="construct.b.sfajwfcrtdt"

            #END add-point
 
 
         #Ctrlp:construct.c.sfajwfmodid
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwfmodid
            #add-point:ON ACTION controlp INFIELD sfajwfmodid name="construct.c.sfajwfmodid"
            #?? a08 ??????(Version:3)
            #??c?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            CALL q_ooag001()                           #????
            DISPLAY g_qryparam.return1 TO sfajwfmodid  #??????
            NEXT FIELD sfajwfmodid                     #?????
    



            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwfmodid
            #add-point:BEFORE FIELD sfajwfmodid name="construct.b.sfajwfmodid"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwfmodid
            
            #add-point:AFTER FIELD sfajwfmodid name="construct.a.sfajwfmodid"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwfmoddt
            #add-point:BEFORE FIELD sfajwfmoddt name="construct.b.sfajwfmoddt"

            #END add-point
 
 
         #Ctrlp:construct.c.sfajwfcnfid
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwfcnfid
            #add-point:ON ACTION controlp INFIELD sfajwfcnfid name="construct.c.sfajwfcnfid"
            #?? a08 ??????(Version:3)
            #??c?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            CALL q_ooag001()                           #????
            DISPLAY g_qryparam.return1 TO sfajwfcnfid  #??????
            NEXT FIELD sfajwfcnfid                     #?????
    



            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwfcnfid
            #add-point:BEFORE FIELD sfajwfcnfid name="construct.b.sfajwfcnfid"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwfcnfid
            
            #add-point:AFTER FIELD sfajwfcnfid name="construct.a.sfajwfcnfid"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwfcnfdt
            #add-point:BEFORE FIELD sfajwfcnfdt name="construct.b.sfajwfcnfdt"

            #END add-point
 
 
 
         
      END CONSTRUCT
 
      #????table??construct
      CONSTRUCT g_wc2_table1 ON sfakwfseq,sfakwf001,sfakwf002,sfakwf003,sfakwf004,sfakwf005,sfakwf006,sfakwf007,sfakwf008,sfakwf009,sfakwf010,sfakwf011,sfakwf012,sfakwf013,sfakwf014,sfakwf015,sfakwf016,sfakwf017,sfakwf018,sfakwf019,sfakwf020,sfakwf021,sfakwf022,sfakwf023,sfakwf024,sfakwf025,sfakwf026, 
          sfakwf027,sfakwf028,sfakwf029,sfakwf030,sfakwf031,sfakwf044,sfakwf032,sfakwf033,sfakwf034,sfakwf035,sfakwf036,sfakwf037,sfakwf038,sfakwf039,sfakwf040,sfakwf041,sfakwf042,sfakwf043,sfakwf045,sfakwf046,sfakwf047,sfakwf048,sfakwf049,sfakwfud001
           FROM s_detail1[1].sfakwfseq,s_detail1[1].sfakwf001,s_detail1[1].sfakwf002,s_detail1[1].sfakwf003,s_detail1[1].sfakwf004,s_detail1[1].sfakwf005,s_detail1[1].sfakwf006,s_detail1[1].sfakwf007,s_detail1[1].sfakwf008,s_detail1[1].sfakwf009,s_detail1[1].sfakwf010,s_detail1[1].sfakwf011,s_detail1[1].sfakwf012, 
               s_detail1[1].sfakwf013,s_detail1[1].sfakwf014,s_detail1[1].sfakwf015,s_detail1[1].sfakwf016,s_detail1[1].sfakwf017,s_detail1[1].sfakwf018,s_detail1[1].sfakwf019,s_detail1[1].sfakwf020,s_detail1[1].sfakwf021,s_detail1[1].sfakwf022,s_detail1[1].sfakwf023,s_detail1[1].sfakwf024,s_detail1[1].sfakwf025, 
               s_detail1[1].sfakwf026,s_detail1[1].sfakwf027,s_detail1[1].sfakwf028,s_detail1[1].sfakwf029,s_detail1[1].sfakwf030,s_detail1[1].sfakwf031,s_detail1[1].sfakwf044,s_detail1[1].sfakwf032,s_detail1[1].sfakwf033,s_detail1[1].sfakwf034,s_detail1[1].sfakwf035,s_detail1[1].sfakwf036,s_detail1[1].sfakwf037, 
               s_detail1[1].sfakwf038,s_detail1[1].sfakwf039,s_detail1[1].sfakwf040,s_detail1[1].sfakwf041,s_detail1[1].sfakwf042,s_detail1[1].sfakwf043,s_detail1[1].sfakwf045,s_detail1[1].sfakwf046,s_detail1[1].sfakwf047,s_detail1[1].sfakwf048,s_detail1[1].sfakwf049,s_detail1[1].sfakwfud001
                      
         BEFORE CONSTRUCT
            #add-point:cs?before_construct name="cs.body.before_construct"

            #end add-point 
            
       #????????????
       
         
       #????????????
                #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwfseq
            #add-point:BEFORE FIELD sfakwfseq name="construct.b.page1.sfakwfseq"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwfseq
            
            #add-point:AFTER FIELD sfakwfseq name="construct.a.page1.sfakwfseq"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page1.sfakwfseq
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwfseq
            #add-point:ON ACTION controlp INFIELD sfakwfseq name="construct.c.page1.sfakwfseq"

            #END add-point
 
 
         #Ctrlp:construct.c.page1.sfakwf001
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf001
            #add-point:ON ACTION controlp INFIELD sfakwf001 name="construct.c.page1.sfakwf001"
            #?? a08 ??????(Version:3)
            #??c?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            CALL q_imaf001_6()                           #????
            DISPLAY g_qryparam.return1 TO sfakwf001  #??????
            NEXT FIELD sfakwf001                     #?????
    



            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf001
            #add-point:BEFORE FIELD sfakwf001 name="construct.b.page1.sfakwf001"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf001
            
            #add-point:AFTER FIELD sfakwf001 name="construct.a.page1.sfakwf001"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.page1.sfakwf002
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf002
            #add-point:ON ACTION controlp INFIELD sfakwf002 name="construct.c.page1.sfakwf002"
            #?? a08 ??????(Version:3)
            #??c?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            CALL q_sfaa011()                           #????
            DISPLAY g_qryparam.return1 TO sfakwf002  #??????
            NEXT FIELD sfakwf002                     #?????
    



            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf002
            #add-point:BEFORE FIELD sfakwf002 name="construct.b.page1.sfakwf002"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf002
            
            #add-point:AFTER FIELD sfakwf002 name="construct.a.page1.sfakwf002"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf003
            #add-point:BEFORE FIELD sfakwf003 name="construct.b.page1.sfakwf003"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf003
            
            #add-point:AFTER FIELD sfakwf003 name="construct.a.page1.sfakwf003"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.page1.sfakwf003
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf003
            #add-point:ON ACTION controlp INFIELD sfakwf003 name="construct.c.page1.sfakwf003"
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			   LET g_qryparam.reqry = FALSE
            CALL q_sfakwf003_wf()
            DISPLAY g_qryparam.return1 TO sfakwf003
            NEXT FIELD sfakwf003
            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf004
            #add-point:BEFORE FIELD sfakwf004 name="construct.b.page1.sfakwf004"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf004
            
            #add-point:AFTER FIELD sfakwf004 name="construct.a.page1.sfakwf004"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.page1.sfakwf004
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf004
            #add-point:ON ACTION controlp INFIELD sfakwf004 name="construct.c.page1.sfakwf004"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf005
            #add-point:BEFORE FIELD sfakwf005 name="construct.b.page1.sfakwf005"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf005
            
            #add-point:AFTER FIELD sfakwf005 name="construct.a.page1.sfakwf005"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page1.sfakwf005
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf005
            #add-point:ON ACTION controlp INFIELD sfakwf005 name="construct.c.page1.sfakwf005"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf006
            #add-point:BEFORE FIELD sfakwf006 name="construct.b.page1.sfakwf006"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf006
            
            #add-point:AFTER FIELD sfakwf006 name="construct.a.page1.sfakwf006"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page1.sfakwf006
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf006
            #add-point:ON ACTION controlp INFIELD sfakwf006 name="construct.c.page1.sfakwf006"

            #END add-point
 
 
         #Ctrlp:construct.c.page1.sfakwf007
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf007
            #add-point:ON ACTION controlp INFIELD sfakwf007 name="construct.c.page1.sfakwf007"
            #?? a08 ??????(Version:3)
            #??c?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            CALL q_ooca001()                           #????
            DISPLAY g_qryparam.return1 TO sfakwf007  #??????
            NEXT FIELD sfakwf007                     #?????
    



            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf007
            #add-point:BEFORE FIELD sfakwf007 name="construct.b.page1.sfakwf007"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf007
            
            #add-point:AFTER FIELD sfakwf007 name="construct.a.page1.sfakwf007"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf008
            #add-point:BEFORE FIELD sfakwf008 name="construct.b.page1.sfakwf008"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf008
            
            #add-point:AFTER FIELD sfakwf008 name="construct.a.page1.sfakwf008"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page1.sfakwf008
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf008
            #add-point:ON ACTION controlp INFIELD sfakwf008 name="construct.c.page1.sfakwf008"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf009
            #add-point:BEFORE FIELD sfakwf009 name="construct.b.page1.sfakwf009"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf009
            
            #add-point:AFTER FIELD sfakwf009 name="construct.a.page1.sfakwf009"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.page1.sfakwf009
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf009
            #add-point:ON ACTION controlp INFIELD sfakwf009 name="construct.c.page1.sfakwf009"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf010
            #add-point:BEFORE FIELD sfakwf010 name="construct.b.page1.sfakwf010"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf010
            
            #add-point:AFTER FIELD sfakwf010 name="construct.a.page1.sfakwf010"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.page1.sfakwf010
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf010
            #add-point:ON ACTION controlp INFIELD sfakwf010 name="construct.c.page1.sfakwf010"

            #END add-point
 
 
         #Ctrlp:construct.c.page1.sfakwf011
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf011
            #add-point:ON ACTION controlp INFIELD sfakwf011 name="construct.c.page1.sfakwf011"
            #?? a08 ??????(Version:3)
            #??c?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            CALL q_sfakwf011_wf()                           #????
            DISPLAY g_qryparam.return1 TO sfakwf011  #??????
            NEXT FIELD sfakwf011                     #?????
    



            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf011
            #add-point:BEFORE FIELD sfakwf011 name="construct.b.page1.sfakwf011"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf011
            
            #add-point:AFTER FIELD sfakwf011 name="construct.a.page1.sfakwf011"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf012
            #add-point:BEFORE FIELD sfakwf012 name="construct.b.page1.sfakwf012"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf012
            
            #add-point:AFTER FIELD sfakwf012 name="construct.a.page1.sfakwf012"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.page1.sfakwf012
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf012
            #add-point:ON ACTION controlp INFIELD sfakwf012 name="construct.c.page1.sfakwf012"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf013
            #add-point:BEFORE FIELD sfakwf013 name="construct.b.page1.sfakwf013"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf013
            
            #add-point:AFTER FIELD sfakwf013 name="construct.a.page1.sfakwf013"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.page1.sfakwf013
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf013
            #add-point:ON ACTION controlp INFIELD sfakwf013 name="construct.c.page1.sfakwf013"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf014
            #add-point:BEFORE FIELD sfakwf014 name="construct.b.page1.sfakwf014"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf014
            
            #add-point:AFTER FIELD sfakwf014 name="construct.a.page1.sfakwf014"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page1.sfakwf014
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf014
            #add-point:ON ACTION controlp INFIELD sfakwf014 name="construct.c.page1.sfakwf014"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf015
            #add-point:BEFORE FIELD sfakwf015 name="construct.b.page1.sfakwf015"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf015
            
            #add-point:AFTER FIELD sfakwf015 name="construct.a.page1.sfakwf015"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page1.sfakwf015
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf015
            #add-point:ON ACTION controlp INFIELD sfakwf015 name="construct.c.page1.sfakwf015"

            #END add-point
 
 
         #Ctrlp:construct.c.page1.sfakwf016
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf016
            #add-point:ON ACTION controlp INFIELD sfakwf016 name="construct.c.page1.sfakwf016"
            #?? a08 ??????(Version:3)
            #??c?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            CALL q_sfakwf016_wf()                           #????
            DISPLAY g_qryparam.return1 TO sfakwf016  #??????
            NEXT FIELD sfakwf016                     #?????
    



            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf016
            #add-point:BEFORE FIELD sfakwf016 name="construct.b.page1.sfakwf016"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf016
            
            #add-point:AFTER FIELD sfakwf016 name="construct.a.page1.sfakwf016"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf017
            #add-point:BEFORE FIELD sfakwf017 name="construct.b.page1.sfakwf017"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf017
            
            #add-point:AFTER FIELD sfakwf017 name="construct.a.page1.sfakwf017"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.page1.sfakwf017
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf017
            #add-point:ON ACTION controlp INFIELD sfakwf017 name="construct.c.page1.sfakwf017"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf018
            #add-point:BEFORE FIELD sfakwf018 name="construct.b.page1.sfakwf018"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf018
            
            #add-point:AFTER FIELD sfakwf018 name="construct.a.page1.sfakwf018"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.page1.sfakwf018
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf018
            #add-point:ON ACTION controlp INFIELD sfakwf018 name="construct.c.page1.sfakwf018"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf019
            #add-point:BEFORE FIELD sfakwf019 name="construct.b.page1.sfakwf019"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf019
            
            #add-point:AFTER FIELD sfakwf019 name="construct.a.page1.sfakwf019"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page1.sfakwf019
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf019
            #add-point:ON ACTION controlp INFIELD sfakwf019 name="construct.c.page1.sfakwf019"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf020
            #add-point:BEFORE FIELD sfakwf020 name="construct.b.page1.sfakwf020"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf020
            
            #add-point:AFTER FIELD sfakwf020 name="construct.a.page1.sfakwf020"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.page1.sfakwf020
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf020
            #add-point:ON ACTION controlp INFIELD sfakwf020 name="construct.c.page1.sfakwf020"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf021
            #add-point:BEFORE FIELD sfakwf021 name="construct.b.page1.sfakwf021"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf021
            
            #add-point:AFTER FIELD sfakwf021 name="construct.a.page1.sfakwf021"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.page1.sfakwf021
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf021
            #add-point:ON ACTION controlp INFIELD sfakwf021 name="construct.c.page1.sfakwf021"

            #END add-point
 
 
         #Ctrlp:construct.c.page1.sfakwf022
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf022
            #add-point:ON ACTION controlp INFIELD sfakwf022 name="construct.c.page1.sfakwf022"
            #?? a08 ??????(Version:3)
            #??c?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            CALL q_sfakwf022_wf()                           #????
            DISPLAY g_qryparam.return1 TO sfakwf022  #??????
            NEXT FIELD sfakwf022                     #?????
    



            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf022
            #add-point:BEFORE FIELD sfakwf022 name="construct.b.page1.sfakwf022"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf022
            
            #add-point:AFTER FIELD sfakwf022 name="construct.a.page1.sfakwf022"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf023
            #add-point:BEFORE FIELD sfakwf023 name="construct.b.page1.sfakwf023"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf023
            
            #add-point:AFTER FIELD sfakwf023 name="construct.a.page1.sfakwf023"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.page1.sfakwf023
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf023
            #add-point:ON ACTION controlp INFIELD sfakwf023 name="construct.c.page1.sfakwf023"

            #END add-point
 
 
         #Ctrlp:construct.c.page1.sfakwf024
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf024
            #add-point:ON ACTION controlp INFIELD sfakwf024 name="construct.c.page1.sfakwf024"
            #?? a08 ??????(Version:3)
            #??c?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            CALL q_sfakwf024_wf()                           #????
            DISPLAY g_qryparam.return1 TO sfakwf024  #??????
            NEXT FIELD sfakwf024                     #?????
    



            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf024
            #add-point:BEFORE FIELD sfakwf024 name="construct.b.page1.sfakwf024"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf024
            
            #add-point:AFTER FIELD sfakwf024 name="construct.a.page1.sfakwf024"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf025
            #add-point:BEFORE FIELD sfakwf025 name="construct.b.page1.sfakwf025"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf025
            
            #add-point:AFTER FIELD sfakwf025 name="construct.a.page1.sfakwf025"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.page1.sfakwf025
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf025
            #add-point:ON ACTION controlp INFIELD sfakwf025 name="construct.c.page1.sfakwf025"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf026
            #add-point:BEFORE FIELD sfakwf026 name="construct.b.page1.sfakwf026"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf026
            
            #add-point:AFTER FIELD sfakwf026 name="construct.a.page1.sfakwf026"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.page1.sfakwf026
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf026
            #add-point:ON ACTION controlp INFIELD sfakwf026 name="construct.c.page1.sfakwf026"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf027
            #add-point:BEFORE FIELD sfakwf027 name="construct.b.page1.sfakwf027"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf027
            
            #add-point:AFTER FIELD sfakwf027 name="construct.a.page1.sfakwf027"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.page1.sfakwf027
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf027
            #add-point:ON ACTION controlp INFIELD sfakwf027 name="construct.c.page1.sfakwf027"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf028
            #add-point:BEFORE FIELD sfakwf028 name="construct.b.page1.sfakwf028"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf028
            
            #add-point:AFTER FIELD sfakwf028 name="construct.a.page1.sfakwf028"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.page1.sfakwf028
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf028
            #add-point:ON ACTION controlp INFIELD sfakwf028 name="construct.c.page1.sfakwf028"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf029
            #add-point:BEFORE FIELD sfakwf029 name="construct.b.page1.sfakwf029"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf029
            
            #add-point:AFTER FIELD sfakwf029 name="construct.a.page1.sfakwf029"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.page1.sfakwf029
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf029
            #add-point:ON ACTION controlp INFIELD sfakwf029 name="construct.c.page1.sfakwf029"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf030
            #add-point:BEFORE FIELD sfakwf030 name="construct.b.page1.sfakwf030"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf030
            
            #add-point:AFTER FIELD sfakwf030 name="construct.a.page1.sfakwf030"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.page1.sfakwf030
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf030
            #add-point:ON ACTION controlp INFIELD sfakwf030 name="construct.c.page1.sfakwf030"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf031
            #add-point:BEFORE FIELD sfakwf031 name="construct.b.page1.sfakwf031"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf031
            
            #add-point:AFTER FIELD sfakwf031 name="construct.a.page1.sfakwf031"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.page1.sfakwf031
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf031
            #add-point:ON ACTION controlp INFIELD sfakwf031 name="construct.c.page1.sfakwf031"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf044
            #add-point:BEFORE FIELD sfakwf044 name="construct.b.page1.sfakwf044"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf044
            
            #add-point:AFTER FIELD sfakwf044 name="construct.a.page1.sfakwf044"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.page1.sfakwf044
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf044
            #add-point:ON ACTION controlp INFIELD sfakwf044 name="construct.c.page1.sfakwf044"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf032
            #add-point:BEFORE FIELD sfakwf032 name="construct.b.page1.sfakwf032"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf032
            
            #add-point:AFTER FIELD sfakwf032 name="construct.a.page1.sfakwf032"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page1.sfakwf032
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf032
            #add-point:ON ACTION controlp INFIELD sfakwf032 name="construct.c.page1.sfakwf032"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf033
            #add-point:BEFORE FIELD sfakwf033 name="construct.b.page1.sfakwf033"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf033
            
            #add-point:AFTER FIELD sfakwf033 name="construct.a.page1.sfakwf033"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page1.sfakwf033
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf033
            #add-point:ON ACTION controlp INFIELD sfakwf033 name="construct.c.page1.sfakwf033"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf034
            #add-point:BEFORE FIELD sfakwf034 name="construct.b.page1.sfakwf034"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf034
            
            #add-point:AFTER FIELD sfakwf034 name="construct.a.page1.sfakwf034"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page1.sfakwf034
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf034
            #add-point:ON ACTION controlp INFIELD sfakwf034 name="construct.c.page1.sfakwf034"

            #END add-point
 
 
         #Ctrlp:construct.c.page1.sfakwf035
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf035
            #add-point:ON ACTION controlp INFIELD sfakwf035 name="construct.c.page1.sfakwf035"
            #?? a08 ??????(Version:3)
            #??c?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            CALL q_ooca001_1()                           #????
            DISPLAY g_qryparam.return1 TO sfakwf035  #??????
            NEXT FIELD sfakwf035                     #?????
    



            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf035
            #add-point:BEFORE FIELD sfakwf035 name="construct.b.page1.sfakwf035"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf035
            
            #add-point:AFTER FIELD sfakwf035 name="construct.a.page1.sfakwf035"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf036
            #add-point:BEFORE FIELD sfakwf036 name="construct.b.page1.sfakwf036"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf036
            
            #add-point:AFTER FIELD sfakwf036 name="construct.a.page1.sfakwf036"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page1.sfakwf036
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf036
            #add-point:ON ACTION controlp INFIELD sfakwf036 name="construct.c.page1.sfakwf036"

            #END add-point
 
 
         #Ctrlp:construct.c.page1.sfakwf037
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf037
            #add-point:ON ACTION controlp INFIELD sfakwf037 name="construct.c.page1.sfakwf037"
            #?? a08 ??????(Version:3)
            #??c?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            CALL q_oodb002_2()                           #????
            DISPLAY g_qryparam.return1 TO sfakwf037  #??????
            NEXT FIELD sfakwf037                     #?????
    



            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf037
            #add-point:BEFORE FIELD sfakwf037 name="construct.b.page1.sfakwf037"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf037
            
            #add-point:AFTER FIELD sfakwf037 name="construct.a.page1.sfakwf037"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf038
            #add-point:BEFORE FIELD sfakwf038 name="construct.b.page1.sfakwf038"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf038
            
            #add-point:AFTER FIELD sfakwf038 name="construct.a.page1.sfakwf038"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page1.sfakwf038
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf038
            #add-point:ON ACTION controlp INFIELD sfakwf038 name="construct.c.page1.sfakwf038"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf039
            #add-point:BEFORE FIELD sfakwf039 name="construct.b.page1.sfakwf039"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf039
            
            #add-point:AFTER FIELD sfakwf039 name="construct.a.page1.sfakwf039"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page1.sfakwf039
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf039
            #add-point:ON ACTION controlp INFIELD sfakwf039 name="construct.c.page1.sfakwf039"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf040
            #add-point:BEFORE FIELD sfakwf040 name="construct.b.page1.sfakwf040"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf040
            
            #add-point:AFTER FIELD sfakwf040 name="construct.a.page1.sfakwf040"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page1.sfakwf040
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf040
            #add-point:ON ACTION controlp INFIELD sfakwf040 name="construct.c.page1.sfakwf040"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf041
            #add-point:BEFORE FIELD sfakwf041 name="construct.b.page1.sfakwf041"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf041
            
            #add-point:AFTER FIELD sfakwf041 name="construct.a.page1.sfakwf041"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.page1.sfakwf041
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf041
            #add-point:ON ACTION controlp INFIELD sfakwf041 name="construct.c.page1.sfakwf041"

            #END add-point
 
 
         #Ctrlp:construct.c.page1.sfakwf042
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf042
            #add-point:ON ACTION controlp INFIELD sfakwf042 name="construct.c.page1.sfakwf042"
            #?? a08 ??????(Version:3)
            #??c?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            CALL q_bmfa012_1()                           #????
            DISPLAY g_qryparam.return1 TO sfakwf042  #??????
            DISPLAY g_qryparam.return2 TO sfakwf043
            NEXT FIELD sfakwf042                     #?????
    



            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf042
            #add-point:BEFORE FIELD sfakwf042 name="construct.b.page1.sfakwf042"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf042
            
            #add-point:AFTER FIELD sfakwf042 name="construct.a.page1.sfakwf042"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf043
            #add-point:BEFORE FIELD sfakwf043 name="construct.b.page1.sfakwf043"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf043
            
            #add-point:AFTER FIELD sfakwf043 name="construct.a.page1.sfakwf043"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page1.sfakwf043
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf043
            #add-point:ON ACTION controlp INFIELD sfakwf043 name="construct.c.page1.sfakwf043"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf045
            #add-point:BEFORE FIELD sfakwf045 name="construct.b.page1.sfakwf045"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf045
            
            #add-point:AFTER FIELD sfakwf045 name="construct.a.page1.sfakwf045"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.page1.sfakwf045
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf045
            #add-point:ON ACTION controlp INFIELD sfakwf045 name="construct.c.page1.sfakwf045"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf046
            #add-point:BEFORE FIELD sfakwf046 name="construct.b.page1.sfakwf046"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf046
            
            #add-point:AFTER FIELD sfakwf046 name="construct.a.page1.sfakwf046"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.page1.sfakwf046
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf046
            #add-point:ON ACTION controlp INFIELD sfakwf046 name="construct.c.page1.sfakwf046"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf047
            #add-point:BEFORE FIELD sfakwf047 name="construct.b.page1.sfakwf047"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf047
            
            #add-point:AFTER FIELD sfakwf047 name="construct.a.page1.sfakwf047"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.page1.sfakwf047
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf047
            #add-point:ON ACTION controlp INFIELD sfakwf047 name="construct.c.page1.sfakwf047"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf048
            #add-point:BEFORE FIELD sfakwf048 name="construct.b.page1.sfakwf048"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf048
            
            #add-point:AFTER FIELD sfakwf048 name="construct.a.page1.sfakwf048"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.page1.sfakwf048
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf048
            #add-point:ON ACTION controlp INFIELD sfakwf048 name="construct.c.page1.sfakwf048"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf049
            #add-point:BEFORE FIELD sfakwf049 name="construct.b.page1.sfakwf049"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf049
            
            #add-point:AFTER FIELD sfakwf049 name="construct.a.page1.sfakwf049"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.page1.sfakwf049
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf049
            #add-point:ON ACTION controlp INFIELD sfakwf049 name="construct.c.page1.sfakwf049"
            #250328-00010#1 add--s
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.arg1 = cl_get_today()
            LET g_qryparam.arg2 = g_site  
            CALL q_ooeg001_8()                       #????
            DISPLAY g_qryparam.return1 TO sfakwf049  #??????
            NEXT FIELD sfakwf049                     #?????
            #250328-00010#1 add--e
            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwfud001
            #add-point:BEFORE FIELD sfakwfud001 name="construct.b.page1.sfakwfud001"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwfud001
            
            #add-point:AFTER FIELD sfakwfud001 name="construct.a.page1.sfakwfud001"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.page1.sfakwfud001
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwfud001
            #add-point:ON ACTION controlp INFIELD sfakwfud001 name="construct.c.page1.sfakwfud001"

            #END add-point
 
 
   
       
      END CONSTRUCT
      
      CONSTRUCT g_wc2_table2 ON sfamwfseq,sfamwf001,sfamwf002,sfamwf003,sfamwf004,sfamwf005,sfamwf006,sfamwf007,sfamwf008
           FROM s_detail4[1].sfamwfseq,s_detail4[1].sfamwf001,s_detail4[1].sfamwf002,s_detail4[1].sfamwf003,s_detail4[1].sfamwf004,s_detail4[1].sfamwf005,s_detail4[1].sfamwf006,s_detail4[1].sfamwf007,s_detail4[1].sfamwf008
                      
         BEFORE CONSTRUCT
            #add-point:cs?before_construct name="cs.body2.before_construct"

            #end add-point 
            
       #????????????(table 2)
       
       
       #????????????       
                #?? a01 ??????(Version:2)
         BEFORE FIELD sfamwfseq
            #add-point:BEFORE FIELD sfamwfseq name="construct.b.page4.sfamwfseq"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfamwfseq
            
            #add-point:AFTER FIELD sfamwfseq name="construct.a.page4.sfamwfseq"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page4.sfamwfseq
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfamwfseq
            #add-point:ON ACTION controlp INFIELD sfamwfseq name="construct.c.page4.sfamwfseq"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfamwf001
            #add-point:BEFORE FIELD sfamwf001 name="construct.b.page4.sfamwf001"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfamwf001
            
            #add-point:AFTER FIELD sfamwf001 name="construct.a.page4.sfamwf001"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page4.sfamwf001
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfamwf001
            #add-point:ON ACTION controlp INFIELD sfamwf001 name="construct.c.page4.sfamwf001"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfamwf002
            #add-point:BEFORE FIELD sfamwf002 name="construct.b.page4.sfamwf002"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfamwf002
            
            #add-point:AFTER FIELD sfamwf002 name="construct.a.page4.sfamwf002"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.page4.sfamwf002
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfamwf002
            #add-point:ON ACTION controlp INFIELD sfamwf002 name="construct.c.page4.sfamwf002"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfamwf003
            #add-point:BEFORE FIELD sfamwf003 name="construct.b.page4.sfamwf003"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfamwf003
            
            #add-point:AFTER FIELD sfamwf003 name="construct.a.page4.sfamwf003"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page4.sfamwf003
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfamwf003
            #add-point:ON ACTION controlp INFIELD sfamwf003 name="construct.c.page4.sfamwf003"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfamwf004
            #add-point:BEFORE FIELD sfamwf004 name="construct.b.page4.sfamwf004"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfamwf004
            
            #add-point:AFTER FIELD sfamwf004 name="construct.a.page4.sfamwf004"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page4.sfamwf004
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfamwf004
            #add-point:ON ACTION controlp INFIELD sfamwf004 name="construct.c.page4.sfamwf004"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfamwf005
            #add-point:BEFORE FIELD sfamwf005 name="construct.b.page4.sfamwf005"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfamwf005
            
            #add-point:AFTER FIELD sfamwf005 name="construct.a.page4.sfamwf005"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page4.sfamwf005
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfamwf005
            #add-point:ON ACTION controlp INFIELD sfamwf005 name="construct.c.page4.sfamwf005"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfamwf006
            #add-point:BEFORE FIELD sfamwf006 name="construct.b.page4.sfamwf006"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfamwf006
            
            #add-point:AFTER FIELD sfamwf006 name="construct.a.page4.sfamwf006"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page4.sfamwf006
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfamwf006
            #add-point:ON ACTION controlp INFIELD sfamwf006 name="construct.c.page4.sfamwf006"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfamwf007
            #add-point:BEFORE FIELD sfamwf007 name="construct.b.page4.sfamwf007"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfamwf007
            
            #add-point:AFTER FIELD sfamwf007 name="construct.a.page4.sfamwf007"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page4.sfamwf007
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfamwf007
            #add-point:ON ACTION controlp INFIELD sfamwf007 name="construct.c.page4.sfamwf007"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfamwf008
            #add-point:BEFORE FIELD sfamwf008 name="construct.b.page4.sfamwf008"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfamwf008
            
            #add-point:AFTER FIELD sfamwf008 name="construct.a.page4.sfamwf008"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.page4.sfamwf008
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfamwf008
            #add-point:ON ACTION controlp INFIELD sfamwf008 name="construct.c.page4.sfamwf008"

            #END add-point
 
 
   
       
      END CONSTRUCT
 
 
      
      CONSTRUCT g_wc2_table3 ON sfbcwfseq1,sfbcwfseq2,sfbcwf002,sfbcwf003,sfbcwf004,sfbcwf005,sfbcwf022,sfbcwf006,sfbcwf033,imaf013,sfbcwf021,sfbcwf007,sfbcwf008,sfbcwf009,sfbcwf010,sfbcwf011,sfbcwf012,sfbcwf023,sfbcwf024,sfbcwf013,sfbcwf047,sfbcwf048,number5,number6,sfbcwf014,sfbcwf015,sfbcwf016,sfbcwf025, 
          number1,number2,sfbcwf017,sfbcwf018,number3,number4,sfbcwf019,sfbcwf020,sfbcwf029,sfbcwf039,sfbcwf030,sfbcwf040,sfbcwf041,sfbcwf042,sfbcwf028,sfbcwf001,sfbcwf026,sfbcwf027,sfbcwf034,sfbcwf035,ooff013,sfbcwf043,sfbcwf049
           FROM s_detail2[1].sfbcwfseq1,s_detail2[1].sfbcwfseq2,s_detail2[1].sfbcwf002,s_detail2[1].sfbcwf003,s_detail2[1].sfbcwf004,s_detail2[1].sfbcwf005,s_detail2[1].sfbcwf022,s_detail2[1].sfbcwf006,s_detail2[1].sfbcwf033,s_detail2[1].imaf013,s_detail2[1].sfbcwf021,s_detail2[1].sfbcwf007,s_detail2[1].sfbcwf008, 
               s_detail2[1].sfbcwf009,s_detail2[1].sfbcwf010,s_detail2[1].sfbcwf011,s_detail2[1].sfbcwf012,s_detail2[1].sfbcwf023,s_detail2[1].sfbcwf024,s_detail2[1].sfbcwf013,s_detail2[1].sfbcwf047,s_detail2[1].sfbcwf048,s_detail2[1].number5,s_detail2[1].number6,s_detail2[1].sfbcwf014,s_detail2[1].sfbcwf015, 
               s_detail2[1].sfbcwf016,s_detail2[1].sfbcwf025,s_detail2[1].number1,s_detail2[1].number2,s_detail2[1].sfbcwf017,s_detail2[1].sfbcwf018,s_detail2[1].number3,s_detail2[1].number4,s_detail2[1].sfbcwf019,s_detail2[1].sfbcwf020,s_detail2[1].sfbcwf029,s_detail2[1].sfbcwf039,s_detail2[1].sfbcwf030, 
               s_detail2[1].sfbcwf040,s_detail2[1].sfbcwf041,s_detail2[1].sfbcwf042,s_detail2[1].sfbcwf028,s_detail2[1].sfbcwf001,s_detail2[1].sfbcwf026,s_detail2[1].sfbcwf027,s_detail2[1].sfbcwf034,s_detail2[1].sfbcwf035,s_detail2[1].ooff013,s_detail2[1].sfbcwf043,s_detail2[1].sfbcwf049
                      
         BEFORE CONSTRUCT
            #add-point:cs?before_construct name="cs.body3.before_construct"

            #end add-point 
            
       #????????????(table 3)
       
       
       #????????????       
                #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwfseq1
            #add-point:BEFORE FIELD sfbcwfseq1 name="construct.b.page2.sfbcwfseq1"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwfseq1
            
            #add-point:AFTER FIELD sfbcwfseq1 name="construct.a.page2.sfbcwfseq1"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page2.sfbcwfseq1
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwfseq1
            #add-point:ON ACTION controlp INFIELD sfbcwfseq1 name="construct.c.page2.sfbcwfseq1"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwfseq2
            #add-point:BEFORE FIELD sfbcwfseq2 name="construct.b.page2.sfbcwfseq2"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwfseq2
            
            #add-point:AFTER FIELD sfbcwfseq2 name="construct.a.page2.sfbcwfseq2"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page2.sfbcwfseq2
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwfseq2
            #add-point:ON ACTION controlp INFIELD sfbcwfseq2 name="construct.c.page2.sfbcwfseq2"

            #END add-point
 
 
         #Ctrlp:construct.c.page2.sfbcwf002
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf002
            #add-point:ON ACTION controlp INFIELD sfbcwf002 name="construct.c.page2.sfbcwf002"
            #?? a08 ??????(Version:3)
            #??c?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.arg1 = "215"
            CALL q_oocq002()                           #????
            DISPLAY g_qryparam.return1 TO sfbcwf002  #??????
            NEXT FIELD sfbcwf002                     #?????
    



            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf002
            #add-point:BEFORE FIELD sfbcwf002 name="construct.b.page2.sfbcwf002"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf002
            
            #add-point:AFTER FIELD sfbcwf002 name="construct.a.page2.sfbcwf002"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.page2.sfbcwf003
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf003
            #add-point:ON ACTION controlp INFIELD sfbcwf003 name="construct.c.page2.sfbcwf003"
            #?? a08 ??????(Version:3)
            #??c?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.arg1 = "221"
            CALL q_oocq002()                           #????
            DISPLAY g_qryparam.return1 TO sfbcwf003  #??????
            NEXT FIELD sfbcwf003                     #?????
    



            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf003
            #add-point:BEFORE FIELD sfbcwf003 name="construct.b.page2.sfbcwf003"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf003
            
            #add-point:AFTER FIELD sfbcwf003 name="construct.a.page2.sfbcwf003"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf004
            #add-point:BEFORE FIELD sfbcwf004 name="construct.b.page2.sfbcwf004"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf004
            
            #add-point:AFTER FIELD sfbcwf004 name="construct.a.page2.sfbcwf004"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.page2.sfbcwf004
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf004
            #add-point:ON ACTION controlp INFIELD sfbcwf004 name="construct.c.page2.sfbcwf004"

            #END add-point
 
 
         #Ctrlp:construct.c.page2.sfbcwf005
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf005
            #add-point:ON ACTION controlp INFIELD sfbcwf005 name="construct.c.page2.sfbcwf005"
            #?? a08 ??????(Version:3)
            #??c?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            CALL q_imaa001_10()                           #????
            DISPLAY g_qryparam.return1 TO sfbcwf005  #??????
            NEXT FIELD sfbcwf005                     #?????
    



            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf005
            #add-point:BEFORE FIELD sfbcwf005 name="construct.b.page2.sfbcwf005"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf005
            
            #add-point:AFTER FIELD sfbcwf005 name="construct.a.page2.sfbcwf005"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf022
            #add-point:BEFORE FIELD sfbcwf022 name="construct.b.page2.sfbcwf022"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf022
            
            #add-point:AFTER FIELD sfbcwf022 name="construct.a.page2.sfbcwf022"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page2.sfbcwf022
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf022
            #add-point:ON ACTION controlp INFIELD sfbcwf022 name="construct.c.page2.sfbcwf022"

            #END add-point
 
 
         #Ctrlp:construct.c.page2.sfbcwf006
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf006
            #add-point:ON ACTION controlp INFIELD sfbcwf006 name="construct.c.page2.sfbcwf006"
            #?? a08 ??????(Version:3)
            #??c?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            CALL q_imaa001_10()                           #????
            DISPLAY g_qryparam.return1 TO sfbcwf006  #??????
            NEXT FIELD sfbcwf006                     #?????
    



            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf006
            #add-point:BEFORE FIELD sfbcwf006 name="construct.b.page2.sfbcwf006"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf006
            
            #add-point:AFTER FIELD sfbcwf006 name="construct.a.page2.sfbcwf006"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf033
            #add-point:BEFORE FIELD sfbcwf033 name="construct.b.page2.sfbcwf033"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf033
            
            #add-point:AFTER FIELD sfbcwf033 name="construct.a.page2.sfbcwf033"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page2.sfbcwf033
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf033
            #add-point:ON ACTION controlp INFIELD sfbcwf033 name="construct.c.page2.sfbcwf033"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD imaf013
            #add-point:BEFORE FIELD imaf013 name="construct.b.page2.imaf013"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD imaf013
            
            #add-point:AFTER FIELD imaf013 name="construct.a.page2.imaf013"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page2.imaf013
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD imaf013
            #add-point:ON ACTION controlp INFIELD imaf013 name="construct.c.page2.imaf013"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf021
            #add-point:BEFORE FIELD sfbcwf021 name="construct.b.page2.sfbcwf021"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf021
            
            #add-point:AFTER FIELD sfbcwf021 name="construct.a.page2.sfbcwf021"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.page2.sfbcwf021
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf021
            #add-point:ON ACTION controlp INFIELD sfbcwf021 name="construct.c.page2.sfbcwf021"
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            CALL q_sfba021()
            DISPLAY g_qryparam.return1 TO sfbcwf021
            NEXT FIELD sfbcwf021
            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf007
            #add-point:BEFORE FIELD sfbcwf007 name="construct.b.page2.sfbcwf007"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf007
            
            #add-point:AFTER FIELD sfbcwf007 name="construct.a.page2.sfbcwf007"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page2.sfbcwf007
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf007
            #add-point:ON ACTION controlp INFIELD sfbcwf007 name="construct.c.page2.sfbcwf007"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf008
            #add-point:BEFORE FIELD sfbcwf008 name="construct.b.page2.sfbcwf008"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf008
            
            #add-point:AFTER FIELD sfbcwf008 name="construct.a.page2.sfbcwf008"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page2.sfbcwf008
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf008
            #add-point:ON ACTION controlp INFIELD sfbcwf008 name="construct.c.page2.sfbcwf008"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf009
            #add-point:BEFORE FIELD sfbcwf009 name="construct.b.page2.sfbcwf009"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf009
            
            #add-point:AFTER FIELD sfbcwf009 name="construct.a.page2.sfbcwf009"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page2.sfbcwf009
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf009
            #add-point:ON ACTION controlp INFIELD sfbcwf009 name="construct.c.page2.sfbcwf009"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf010
            #add-point:BEFORE FIELD sfbcwf010 name="construct.b.page2.sfbcwf010"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf010
            
            #add-point:AFTER FIELD sfbcwf010 name="construct.a.page2.sfbcwf010"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page2.sfbcwf010
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf010
            #add-point:ON ACTION controlp INFIELD sfbcwf010 name="construct.c.page2.sfbcwf010"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf011
            #add-point:BEFORE FIELD sfbcwf011 name="construct.b.page2.sfbcwf011"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf011
            
            #add-point:AFTER FIELD sfbcwf011 name="construct.a.page2.sfbcwf011"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page2.sfbcwf011
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf011
            #add-point:ON ACTION controlp INFIELD sfbcwf011 name="construct.c.page2.sfbcwf011"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf012
            #add-point:BEFORE FIELD sfbcwf012 name="construct.b.page2.sfbcwf012"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf012
            
            #add-point:AFTER FIELD sfbcwf012 name="construct.a.page2.sfbcwf012"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page2.sfbcwf012
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf012
            #add-point:ON ACTION controlp INFIELD sfbcwf012 name="construct.c.page2.sfbcwf012"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf023
            #add-point:BEFORE FIELD sfbcwf023 name="construct.b.page2.sfbcwf023"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf023
            
            #add-point:AFTER FIELD sfbcwf023 name="construct.a.page2.sfbcwf023"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page2.sfbcwf023
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf023
            #add-point:ON ACTION controlp INFIELD sfbcwf023 name="construct.c.page2.sfbcwf023"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf024
            #add-point:BEFORE FIELD sfbcwf024 name="construct.b.page2.sfbcwf024"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf024
            
            #add-point:AFTER FIELD sfbcwf024 name="construct.a.page2.sfbcwf024"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page2.sfbcwf024
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf024
            #add-point:ON ACTION controlp INFIELD sfbcwf024 name="construct.c.page2.sfbcwf024"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf013
            #add-point:BEFORE FIELD sfbcwf013 name="construct.b.page2.sfbcwf013"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf013
            
            #add-point:AFTER FIELD sfbcwf013 name="construct.a.page2.sfbcwf013"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page2.sfbcwf013
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf013
            #add-point:ON ACTION controlp INFIELD sfbcwf013 name="construct.c.page2.sfbcwf013"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf047
            #add-point:BEFORE FIELD sfbcwf047 name="construct.b.page2.sfbcwf047"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf047
            
            #add-point:AFTER FIELD sfbcwf047 name="construct.a.page2.sfbcwf047"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page2.sfbcwf047
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf047
            #add-point:ON ACTION controlp INFIELD sfbcwf047 name="construct.c.page2.sfbcwf047"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf048
            #add-point:BEFORE FIELD sfbcwf048 name="construct.b.page2.sfbcwf048"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf048
            
            #add-point:AFTER FIELD sfbcwf048 name="construct.a.page2.sfbcwf048"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page2.sfbcwf048
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf048
            #add-point:ON ACTION controlp INFIELD sfbcwf048 name="construct.c.page2.sfbcwf048"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD number5
            #add-point:BEFORE FIELD number5 name="construct.b.page2.number5"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD number5
            
            #add-point:AFTER FIELD number5 name="construct.a.page2.number5"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page2.number5
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD number5
            #add-point:ON ACTION controlp INFIELD number5 name="construct.c.page2.number5"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD number6
            #add-point:BEFORE FIELD number6 name="construct.b.page2.number6"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD number6
            
            #add-point:AFTER FIELD number6 name="construct.a.page2.number6"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page2.number6
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD number6
            #add-point:ON ACTION controlp INFIELD number6 name="construct.c.page2.number6"

            #END add-point
 
 
         #Ctrlp:construct.c.page2.sfbcwf014
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf014
            #add-point:ON ACTION controlp INFIELD sfbcwf014 name="construct.c.page2.sfbcwf014"
            #?? a08 ??????(Version:3)
            #??c?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            CALL q_ooca001_1()                           #????
            DISPLAY g_qryparam.return1 TO sfbcwf014  #??????
            NEXT FIELD sfbcwf014                     #?????
    



            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf014
            #add-point:BEFORE FIELD sfbcwf014 name="construct.b.page2.sfbcwf014"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf014
            
            #add-point:AFTER FIELD sfbcwf014 name="construct.a.page2.sfbcwf014"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf015
            #add-point:BEFORE FIELD sfbcwf015 name="construct.b.page2.sfbcwf015"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf015
            
            #add-point:AFTER FIELD sfbcwf015 name="construct.a.page2.sfbcwf015"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page2.sfbcwf015
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf015
            #add-point:ON ACTION controlp INFIELD sfbcwf015 name="construct.c.page2.sfbcwf015"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf016
            #add-point:BEFORE FIELD sfbcwf016 name="construct.b.page2.sfbcwf016"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf016
            
            #add-point:AFTER FIELD sfbcwf016 name="construct.a.page2.sfbcwf016"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page2.sfbcwf016
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf016
            #add-point:ON ACTION controlp INFIELD sfbcwf016 name="construct.c.page2.sfbcwf016"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf025
            #add-point:BEFORE FIELD sfbcwf025 name="construct.b.page2.sfbcwf025"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf025
            
            #add-point:AFTER FIELD sfbcwf025 name="construct.a.page2.sfbcwf025"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page2.sfbcwf025
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf025
            #add-point:ON ACTION controlp INFIELD sfbcwf025 name="construct.c.page2.sfbcwf025"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD number1
            #add-point:BEFORE FIELD number1 name="construct.b.page2.number1"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD number1
            
            #add-point:AFTER FIELD number1 name="construct.a.page2.number1"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page2.number1
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD number1
            #add-point:ON ACTION controlp INFIELD number1 name="construct.c.page2.number1"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD number2
            #add-point:BEFORE FIELD number2 name="construct.b.page2.number2"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD number2
            
            #add-point:AFTER FIELD number2 name="construct.a.page2.number2"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page2.number2
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD number2
            #add-point:ON ACTION controlp INFIELD number2 name="construct.c.page2.number2"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf017
            #add-point:BEFORE FIELD sfbcwf017 name="construct.b.page2.sfbcwf017"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf017
            
            #add-point:AFTER FIELD sfbcwf017 name="construct.a.page2.sfbcwf017"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page2.sfbcwf017
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf017
            #add-point:ON ACTION controlp INFIELD sfbcwf017 name="construct.c.page2.sfbcwf017"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf018
            #add-point:BEFORE FIELD sfbcwf018 name="construct.b.page2.sfbcwf018"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf018
            
            #add-point:AFTER FIELD sfbcwf018 name="construct.a.page2.sfbcwf018"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page2.sfbcwf018
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf018
            #add-point:ON ACTION controlp INFIELD sfbcwf018 name="construct.c.page2.sfbcwf018"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD number3
            #add-point:BEFORE FIELD number3 name="construct.b.page2.number3"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD number3
            
            #add-point:AFTER FIELD number3 name="construct.a.page2.number3"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page2.number3
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD number3
            #add-point:ON ACTION controlp INFIELD number3 name="construct.c.page2.number3"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD number4
            #add-point:BEFORE FIELD number4 name="construct.b.page2.number4"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD number4
            
            #add-point:AFTER FIELD number4 name="construct.a.page2.number4"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page2.number4
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD number4
            #add-point:ON ACTION controlp INFIELD number4 name="construct.c.page2.number4"

            #END add-point
 
 
         #Ctrlp:construct.c.page2.sfbcwf019
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf019
            #add-point:ON ACTION controlp INFIELD sfbcwf019 name="construct.c.page2.sfbcwf019"
            #?? a08 ??????(Version:3)
            #??c?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            CALL q_inaa001_2()                           #????
            DISPLAY g_qryparam.return1 TO sfbcwf019  #??????
            NEXT FIELD sfbcwf019                     #?????
    



            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf019
            #add-point:BEFORE FIELD sfbcwf019 name="construct.b.page2.sfbcwf019"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf019
            
            #add-point:AFTER FIELD sfbcwf019 name="construct.a.page2.sfbcwf019"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.page2.sfbcwf020
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf020
            #add-point:ON ACTION controlp INFIELD sfbcwf020 name="construct.c.page2.sfbcwf020"
            #?? a08 ??????(Version:3)
            #??c?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            CALL q_inab002_3()                           #????
            DISPLAY g_qryparam.return1 TO sfbcwf020  #??????
            NEXT FIELD sfbcwf020                     #?????
    



            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf020
            #add-point:BEFORE FIELD sfbcwf020 name="construct.b.page2.sfbcwf020"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf020
            
            #add-point:AFTER FIELD sfbcwf020 name="construct.a.page2.sfbcwf020"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf029
            #add-point:BEFORE FIELD sfbcwf029 name="construct.b.page2.sfbcwf029"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf029
            
            #add-point:AFTER FIELD sfbcwf029 name="construct.a.page2.sfbcwf029"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.page2.sfbcwf029
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf029
            #add-point:ON ACTION controlp INFIELD sfbcwf029 name="construct.c.page2.sfbcwf029"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf039
            #add-point:BEFORE FIELD sfbcwf039 name="construct.b.page2.sfbcwf039"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf039
            
            #add-point:AFTER FIELD sfbcwf039 name="construct.a.page2.sfbcwf039"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.page2.sfbcwf039
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf039
            #add-point:ON ACTION controlp INFIELD sfbcwf039 name="construct.c.page2.sfbcwf039"
            #240423-00009#2 --s
            #????????
            #??c?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.arg1 = '11'
            CALL q_wfaawf001_2_wf()                           #????
            DISPLAY g_qryparam.return1 TO sfbcwf039  #??????
            NEXT FIELD sfbcwf039                     #?????
            #240423-00009#2 --e

            #END add-point
 
 
         #Ctrlp:construct.c.page2.sfbcwf030
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf030
            #add-point:ON ACTION controlp INFIELD sfbcwf030 name="construct.c.page2.sfbcwf030"
            #?? a08 ??????(Version:3)
            #??c?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            CALL q_inag003_5()                           #????
            DISPLAY g_qryparam.return1 TO sfbcwf030  #??????
            NEXT FIELD sfbcwf030                     #?????
    



            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf030
            #add-point:BEFORE FIELD sfbcwf030 name="construct.b.page2.sfbcwf030"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf030
            
            #add-point:AFTER FIELD sfbcwf030 name="construct.a.page2.sfbcwf030"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf040
            #add-point:BEFORE FIELD sfbcwf040 name="construct.b.page2.sfbcwf040"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf040
            
            #add-point:AFTER FIELD sfbcwf040 name="construct.a.page2.sfbcwf040"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.page2.sfbcwf040
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf040
            #add-point:ON ACTION controlp INFIELD sfbcwf040 name="construct.c.page2.sfbcwf040"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf041
            #add-point:BEFORE FIELD sfbcwf041 name="construct.b.page2.sfbcwf041"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf041
            
            #add-point:AFTER FIELD sfbcwf041 name="construct.a.page2.sfbcwf041"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.page2.sfbcwf041
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf041
            #add-point:ON ACTION controlp INFIELD sfbcwf041 name="construct.c.page2.sfbcwf041"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf042
            #add-point:BEFORE FIELD sfbcwf042 name="construct.b.page2.sfbcwf042"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf042
            
            #add-point:AFTER FIELD sfbcwf042 name="construct.a.page2.sfbcwf042"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.page2.sfbcwf042
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf042
            #add-point:ON ACTION controlp INFIELD sfbcwf042 name="construct.c.page2.sfbcwf042"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf028
            #add-point:BEFORE FIELD sfbcwf028 name="construct.b.page2.sfbcwf028"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf028
            
            #add-point:AFTER FIELD sfbcwf028 name="construct.a.page2.sfbcwf028"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page2.sfbcwf028
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf028
            #add-point:ON ACTION controlp INFIELD sfbcwf028 name="construct.c.page2.sfbcwf028"

            #END add-point
 
 
         #Ctrlp:construct.c.page2.sfbcwf001
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf001
            #add-point:ON ACTION controlp INFIELD sfbcwf001 name="construct.c.page2.sfbcwf001"
            #?? a08 ??????(Version:3)
            #??c?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            CALL q_imaa001_10()                           #????
            DISPLAY g_qryparam.return1 TO sfbcwf001  #??????
            NEXT FIELD sfbcwf001                     #?????
    



            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf001
            #add-point:BEFORE FIELD sfbcwf001 name="construct.b.page2.sfbcwf001"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf001
            
            #add-point:AFTER FIELD sfbcwf001 name="construct.a.page2.sfbcwf001"
            
            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf026
            #add-point:BEFORE FIELD sfbcwf026 name="construct.b.page2.sfbcwf026"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf026
            
            #add-point:AFTER FIELD sfbcwf026 name="construct.a.page2.sfbcwf026"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page2.sfbcwf026
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf026
            #add-point:ON ACTION controlp INFIELD sfbcwf026 name="construct.c.page2.sfbcwf026"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf027
            #add-point:BEFORE FIELD sfbcwf027 name="construct.b.page2.sfbcwf027"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf027
            
            #add-point:AFTER FIELD sfbcwf027 name="construct.a.page2.sfbcwf027"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.page2.sfbcwf027
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf027
            #add-point:ON ACTION controlp INFIELD sfbcwf027 name="construct.c.page2.sfbcwf027"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf034
            #add-point:BEFORE FIELD sfbcwf034 name="construct.b.page2.sfbcwf034"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf034
            
            #add-point:AFTER FIELD sfbcwf034 name="construct.a.page2.sfbcwf034"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.page2.sfbcwf034
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf034
            #add-point:ON ACTION controlp INFIELD sfbcwf034 name="construct.c.page2.sfbcwf034"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf035
            #add-point:BEFORE FIELD sfbcwf035 name="construct.b.page2.sfbcwf035"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf035
            
            #add-point:AFTER FIELD sfbcwf035 name="construct.a.page2.sfbcwf035"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page2.sfbcwf035
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf035
            #add-point:ON ACTION controlp INFIELD sfbcwf035 name="construct.c.page2.sfbcwf035"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD ooff013
            #add-point:BEFORE FIELD ooff013 name="construct.b.page2.ooff013"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD ooff013
            
            #add-point:AFTER FIELD ooff013 name="construct.a.page2.ooff013"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.page2.ooff013
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD ooff013
            #add-point:ON ACTION controlp INFIELD ooff013 name="construct.c.page2.ooff013"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf043
            #add-point:BEFORE FIELD sfbcwf043 name="construct.b.page2.sfbcwf043"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf043
            
            #add-point:AFTER FIELD sfbcwf043 name="construct.a.page2.sfbcwf043"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page2.sfbcwf043
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf043
            #add-point:ON ACTION controlp INFIELD sfbcwf043 name="construct.c.page2.sfbcwf043"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf049
            #add-point:BEFORE FIELD sfbcwf049 name="construct.b.page2.sfbcwf049"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf049
            
            #add-point:AFTER FIELD sfbcwf049 name="construct.a.page2.sfbcwf049"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page2.sfbcwf049
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf049
            #add-point:ON ACTION controlp INFIELD sfbcwf049 name="construct.c.page2.sfbcwf049"

            #END add-point
 
 
   
       
      END CONSTRUCT
 
      CONSTRUCT g_wc2_table4 ON wfapwfseq1,wfapwf001,wfapwf002,wfapwf003,wfapwf004,wfapwf005,wfapwf006,wfapwf007,wfapwf008,wfapwf009,wfapwf010,wfapwf011,wfapwf012,wfapwf013,wfapwf014,wfapwf015,wfapwf016,wfapwf017,wfapwf018,wfapwf022,wfapwf019,sfakwf012_1,sfakwf013_1,sfakwf014_1,sfakwf015_1,wfapwf021, 
          sfakwf017_1,sfakwf018_1,sfakwf019_1,sfakwf020_1,sfakwf021_1,wfapwf020,sfakwf023_1,wfapwf023,sfakwf025_1,sfakwf026_1,sfakwf027_1,sfakwf028_1,wfapwf024,wfapwf025,wfapwf026
           FROM s_detail3[1].wfapwfseq1,s_detail3[1].wfapwf001,s_detail3[1].wfapwf002,s_detail3[1].wfapwf003,s_detail3[1].wfapwf004,s_detail3[1].wfapwf005,s_detail3[1].wfapwf006,s_detail3[1].wfapwf007,s_detail3[1].wfapwf008,s_detail3[1].wfapwf009,s_detail3[1].wfapwf010,s_detail3[1].wfapwf011,s_detail3[1].wfapwf012, 
               s_detail3[1].wfapwf013,s_detail3[1].wfapwf014,s_detail3[1].wfapwf015,s_detail3[1].wfapwf016,s_detail3[1].wfapwf017,s_detail3[1].wfapwf018,s_detail3[1].wfapwf022,s_detail3[1].wfapwf019,s_detail3[1].sfakwf012_1,s_detail3[1].sfakwf013_1,s_detail3[1].sfakwf014_1,s_detail3[1].sfakwf015_1,s_detail3[1].wfapwf021, 
               s_detail3[1].sfakwf017_1,s_detail3[1].sfakwf018_1,s_detail3[1].sfakwf019_1,s_detail3[1].sfakwf020_1,s_detail3[1].sfakwf021_1,s_detail3[1].wfapwf020,s_detail3[1].sfakwf023_1,s_detail3[1].wfapwf023,s_detail3[1].sfakwf025_1,s_detail3[1].sfakwf026_1,s_detail3[1].sfakwf027_1,s_detail3[1].sfakwf028_1, 
               s_detail3[1].wfapwf024,s_detail3[1].wfapwf025,s_detail3[1].wfapwf026
                      
         BEFORE CONSTRUCT
            #add-point:cs?before_construct name="cs.body4.before_construct"

            #end add-point 
            
       #????????????(table 4)
       
       
       #????????????       
                #?? a01 ??????(Version:2)
         BEFORE FIELD wfapwfseq1
            #add-point:BEFORE FIELD wfapwfseq1 name="construct.b.page3.wfapwfseq1"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD wfapwfseq1
            
            #add-point:AFTER FIELD wfapwfseq1 name="construct.a.page3.wfapwfseq1"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page3.wfapwfseq1
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD wfapwfseq1
            #add-point:ON ACTION controlp INFIELD wfapwfseq1 name="construct.c.page3.wfapwfseq1"

            #END add-point
 
 
         #Ctrlp:construct.c.page3.wfapwf001
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD wfapwf001
            #add-point:ON ACTION controlp INFIELD wfapwf001 name="construct.c.page3.wfapwf001"
            #?? a08 ??????(Version:3)
            #??c?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            CALL q_imaf001_6()                           #????
            DISPLAY g_qryparam.return1 TO wfapwf001  #??????
            NEXT FIELD wfapwf001                     #?????
    



            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD wfapwf001
            #add-point:BEFORE FIELD wfapwf001 name="construct.b.page3.wfapwf001"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD wfapwf001
            
            #add-point:AFTER FIELD wfapwf001 name="construct.a.page3.wfapwf001"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD wfapwf002
            #add-point:BEFORE FIELD wfapwf002 name="construct.b.page3.wfapwf002"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD wfapwf002
            
            #add-point:AFTER FIELD wfapwf002 name="construct.a.page3.wfapwf002"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.page3.wfapwf002
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD wfapwf002
            #add-point:ON ACTION controlp INFIELD wfapwf002 name="construct.c.page3.wfapwf002"

            #END add-point
 
 
         #Ctrlp:construct.c.page3.wfapwf003
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD wfapwf003
            #add-point:ON ACTION controlp INFIELD wfapwf003 name="construct.c.page3.wfapwf003"
            #?? a08 ??????(Version:3)
            #??c?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            CALL q_imaa001_10()                           #????
            DISPLAY g_qryparam.return1 TO wfapwf003  #??????
            NEXT FIELD wfapwf003                     #?????
    



            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD wfapwf003
            #add-point:BEFORE FIELD wfapwf003 name="construct.b.page3.wfapwf003"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD wfapwf003
            
            #add-point:AFTER FIELD wfapwf003 name="construct.a.page3.wfapwf003"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD wfapwf004
            #add-point:BEFORE FIELD wfapwf004 name="construct.b.page3.wfapwf004"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD wfapwf004
            
            #add-point:AFTER FIELD wfapwf004 name="construct.a.page3.wfapwf004"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page3.wfapwf004
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD wfapwf004
            #add-point:ON ACTION controlp INFIELD wfapwf004 name="construct.c.page3.wfapwf004"

            #END add-point
 
 
         #Ctrlp:construct.c.page3.wfapwf005
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD wfapwf005
            #add-point:ON ACTION controlp INFIELD wfapwf005 name="construct.c.page3.wfapwf005"
            #?? a08 ??????(Version:3)
            #??c?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            CALL q_ooca001()                           #????
            DISPLAY g_qryparam.return1 TO wfapwf005  #??????
            NEXT FIELD wfapwf005                     #?????
    



            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD wfapwf005
            #add-point:BEFORE FIELD wfapwf005 name="construct.b.page3.wfapwf005"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD wfapwf005
            
            #add-point:AFTER FIELD wfapwf005 name="construct.a.page3.wfapwf005"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD wfapwf006
            #add-point:BEFORE FIELD wfapwf006 name="construct.b.page3.wfapwf006"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD wfapwf006
            
            #add-point:AFTER FIELD wfapwf006 name="construct.a.page3.wfapwf006"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page3.wfapwf006
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD wfapwf006
            #add-point:ON ACTION controlp INFIELD wfapwf006 name="construct.c.page3.wfapwf006"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD wfapwf007
            #add-point:BEFORE FIELD wfapwf007 name="construct.b.page3.wfapwf007"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD wfapwf007
            
            #add-point:AFTER FIELD wfapwf007 name="construct.a.page3.wfapwf007"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.page3.wfapwf007
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD wfapwf007
            #add-point:ON ACTION controlp INFIELD wfapwf007 name="construct.c.page3.wfapwf007"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD wfapwf008
            #add-point:BEFORE FIELD wfapwf008 name="construct.b.page3.wfapwf008"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD wfapwf008
            
            #add-point:AFTER FIELD wfapwf008 name="construct.a.page3.wfapwf008"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page3.wfapwf008
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD wfapwf008
            #add-point:ON ACTION controlp INFIELD wfapwf008 name="construct.c.page3.wfapwf008"

            #END add-point
 
 
         #Ctrlp:construct.c.page3.wfapwf009
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD wfapwf009
            #add-point:ON ACTION controlp INFIELD wfapwf009 name="construct.c.page3.wfapwf009"
            #?? a08 ??????(Version:3)
            #??c?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            CALL q_ooca001_1()                           #????
            DISPLAY g_qryparam.return1 TO wfapwf009  #??????
            NEXT FIELD wfapwf009                     #?????
    



            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD wfapwf009
            #add-point:BEFORE FIELD wfapwf009 name="construct.b.page3.wfapwf009"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD wfapwf009
            
            #add-point:AFTER FIELD wfapwf009 name="construct.a.page3.wfapwf009"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD wfapwf010
            #add-point:BEFORE FIELD wfapwf010 name="construct.b.page3.wfapwf010"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD wfapwf010
            
            #add-point:AFTER FIELD wfapwf010 name="construct.a.page3.wfapwf010"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page3.wfapwf010
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD wfapwf010
            #add-point:ON ACTION controlp INFIELD wfapwf010 name="construct.c.page3.wfapwf010"

            #END add-point
 
 
         #Ctrlp:construct.c.page3.wfapwf011
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD wfapwf011
            #add-point:ON ACTION controlp INFIELD wfapwf011 name="construct.c.page3.wfapwf011"
            #?? a08 ??????(Version:3)
            #??c?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            CALL q_ooca001_1()                           #????
            DISPLAY g_qryparam.return1 TO wfapwf011  #??????
            NEXT FIELD wfapwf011                     #?????
    



            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD wfapwf011
            #add-point:BEFORE FIELD wfapwf011 name="construct.b.page3.wfapwf011"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD wfapwf011
            
            #add-point:AFTER FIELD wfapwf011 name="construct.a.page3.wfapwf011"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD wfapwf012
            #add-point:BEFORE FIELD wfapwf012 name="construct.b.page3.wfapwf012"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD wfapwf012
            
            #add-point:AFTER FIELD wfapwf012 name="construct.a.page3.wfapwf012"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page3.wfapwf012
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD wfapwf012
            #add-point:ON ACTION controlp INFIELD wfapwf012 name="construct.c.page3.wfapwf012"

            #END add-point
 
 
         #Ctrlp:construct.c.page3.wfapwf013
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD wfapwf013
            #add-point:ON ACTION controlp INFIELD wfapwf013 name="construct.c.page3.wfapwf013"
            #?? a08 ??????(Version:3)
            #??c?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            CALL q_ooca001_1()                           #????
            DISPLAY g_qryparam.return1 TO wfapwf013  #??????
            NEXT FIELD wfapwf013                     #?????
    



            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD wfapwf013
            #add-point:BEFORE FIELD wfapwf013 name="construct.b.page3.wfapwf013"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD wfapwf013
            
            #add-point:AFTER FIELD wfapwf013 name="construct.a.page3.wfapwf013"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD wfapwf014
            #add-point:BEFORE FIELD wfapwf014 name="construct.b.page3.wfapwf014"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD wfapwf014
            
            #add-point:AFTER FIELD wfapwf014 name="construct.a.page3.wfapwf014"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page3.wfapwf014
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD wfapwf014
            #add-point:ON ACTION controlp INFIELD wfapwf014 name="construct.c.page3.wfapwf014"

            #END add-point
 
 
         #Ctrlp:construct.c.page3.wfapwf015
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD wfapwf015
            #add-point:ON ACTION controlp INFIELD wfapwf015 name="construct.c.page3.wfapwf015"
            #?? a08 ??????(Version:3)
            #??c?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            CALL q_oodb002_2()                           #????
            DISPLAY g_qryparam.return1 TO wfapwf015  #??????
            NEXT FIELD wfapwf015                     #?????
    



            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD wfapwf015
            #add-point:BEFORE FIELD wfapwf015 name="construct.b.page3.wfapwf015"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD wfapwf015
            
            #add-point:AFTER FIELD wfapwf015 name="construct.a.page3.wfapwf015"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD wfapwf016
            #add-point:BEFORE FIELD wfapwf016 name="construct.b.page3.wfapwf016"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD wfapwf016
            
            #add-point:AFTER FIELD wfapwf016 name="construct.a.page3.wfapwf016"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page3.wfapwf016
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD wfapwf016
            #add-point:ON ACTION controlp INFIELD wfapwf016 name="construct.c.page3.wfapwf016"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD wfapwf017
            #add-point:BEFORE FIELD wfapwf017 name="construct.b.page3.wfapwf017"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD wfapwf017
            
            #add-point:AFTER FIELD wfapwf017 name="construct.a.page3.wfapwf017"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page3.wfapwf017
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD wfapwf017
            #add-point:ON ACTION controlp INFIELD wfapwf017 name="construct.c.page3.wfapwf017"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD wfapwf018
            #add-point:BEFORE FIELD wfapwf018 name="construct.b.page3.wfapwf018"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD wfapwf018
            
            #add-point:AFTER FIELD wfapwf018 name="construct.a.page3.wfapwf018"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.page3.wfapwf018
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD wfapwf018
            #add-point:ON ACTION controlp INFIELD wfapwf018 name="construct.c.page3.wfapwf018"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD wfapwf022
            #add-point:BEFORE FIELD wfapwf022 name="construct.b.page3.wfapwf022"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD wfapwf022
            
            #add-point:AFTER FIELD wfapwf022 name="construct.a.page3.wfapwf022"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.page3.wfapwf022
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD wfapwf022
            #add-point:ON ACTION controlp INFIELD wfapwf022 name="construct.c.page3.wfapwf022"

            #END add-point
 
 
         #Ctrlp:construct.c.page3.wfapwf019
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD wfapwf019
            #add-point:ON ACTION controlp INFIELD wfapwf019 name="construct.c.page3.wfapwf019"
            #?? a08 ??????(Version:3)
            #??c?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            CALL q_sfakwf011_wf()                           #????
            DISPLAY g_qryparam.return1 TO wfapwf019  #??????
            NEXT FIELD wfapwf019                     #?????
    



            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD wfapwf019
            #add-point:BEFORE FIELD wfapwf019 name="construct.b.page3.wfapwf019"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD wfapwf019
            
            #add-point:AFTER FIELD wfapwf019 name="construct.a.page3.wfapwf019"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf012_1
            #add-point:BEFORE FIELD sfakwf012_1 name="construct.b.page3.sfakwf012_1"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf012_1
            
            #add-point:AFTER FIELD sfakwf012_1 name="construct.a.page3.sfakwf012_1"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page3.sfakwf012_1
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf012_1
            #add-point:ON ACTION controlp INFIELD sfakwf012_1 name="construct.c.page3.sfakwf012_1"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf013_1
            #add-point:BEFORE FIELD sfakwf013_1 name="construct.b.page3.sfakwf013_1"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf013_1
            
            #add-point:AFTER FIELD sfakwf013_1 name="construct.a.page3.sfakwf013_1"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page3.sfakwf013_1
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf013_1
            #add-point:ON ACTION controlp INFIELD sfakwf013_1 name="construct.c.page3.sfakwf013_1"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf014_1
            #add-point:BEFORE FIELD sfakwf014_1 name="construct.b.page3.sfakwf014_1"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf014_1
            
            #add-point:AFTER FIELD sfakwf014_1 name="construct.a.page3.sfakwf014_1"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page3.sfakwf014_1
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf014_1
            #add-point:ON ACTION controlp INFIELD sfakwf014_1 name="construct.c.page3.sfakwf014_1"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf015_1
            #add-point:BEFORE FIELD sfakwf015_1 name="construct.b.page3.sfakwf015_1"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf015_1
            
            #add-point:AFTER FIELD sfakwf015_1 name="construct.a.page3.sfakwf015_1"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page3.sfakwf015_1
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf015_1
            #add-point:ON ACTION controlp INFIELD sfakwf015_1 name="construct.c.page3.sfakwf015_1"

            #END add-point
 
 
         #Ctrlp:construct.c.page3.wfapwf021
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD wfapwf021
            #add-point:ON ACTION controlp INFIELD wfapwf021 name="construct.c.page3.wfapwf021"
            #?? a08 ??????(Version:3)
            #??c?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            CALL q_sfakwf016_wf()                           #????
            DISPLAY g_qryparam.return1 TO wfapwf021  #??????
            NEXT FIELD wfapwf021                     #?????
    



            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD wfapwf021
            #add-point:BEFORE FIELD wfapwf021 name="construct.b.page3.wfapwf021"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD wfapwf021
            
            #add-point:AFTER FIELD wfapwf021 name="construct.a.page3.wfapwf021"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf017_1
            #add-point:BEFORE FIELD sfakwf017_1 name="construct.b.page3.sfakwf017_1"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf017_1
            
            #add-point:AFTER FIELD sfakwf017_1 name="construct.a.page3.sfakwf017_1"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page3.sfakwf017_1
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf017_1
            #add-point:ON ACTION controlp INFIELD sfakwf017_1 name="construct.c.page3.sfakwf017_1"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf018_1
            #add-point:BEFORE FIELD sfakwf018_1 name="construct.b.page3.sfakwf018_1"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf018_1
            
            #add-point:AFTER FIELD sfakwf018_1 name="construct.a.page3.sfakwf018_1"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page3.sfakwf018_1
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf018_1
            #add-point:ON ACTION controlp INFIELD sfakwf018_1 name="construct.c.page3.sfakwf018_1"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf019_1
            #add-point:BEFORE FIELD sfakwf019_1 name="construct.b.page3.sfakwf019_1"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf019_1
            
            #add-point:AFTER FIELD sfakwf019_1 name="construct.a.page3.sfakwf019_1"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page3.sfakwf019_1
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf019_1
            #add-point:ON ACTION controlp INFIELD sfakwf019_1 name="construct.c.page3.sfakwf019_1"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf020_1
            #add-point:BEFORE FIELD sfakwf020_1 name="construct.b.page3.sfakwf020_1"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf020_1
            
            #add-point:AFTER FIELD sfakwf020_1 name="construct.a.page3.sfakwf020_1"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page3.sfakwf020_1
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf020_1
            #add-point:ON ACTION controlp INFIELD sfakwf020_1 name="construct.c.page3.sfakwf020_1"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf021_1
            #add-point:BEFORE FIELD sfakwf021_1 name="construct.b.page3.sfakwf021_1"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf021_1
            
            #add-point:AFTER FIELD sfakwf021_1 name="construct.a.page3.sfakwf021_1"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page3.sfakwf021_1
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf021_1
            #add-point:ON ACTION controlp INFIELD sfakwf021_1 name="construct.c.page3.sfakwf021_1"

            #END add-point
 
 
         #Ctrlp:construct.c.page3.wfapwf020
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD wfapwf020
            #add-point:ON ACTION controlp INFIELD wfapwf020 name="construct.c.page3.wfapwf020"
            #?? a08 ??????(Version:3)
            #??c?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            CALL q_sfakwf022_wf()                           #????
            DISPLAY g_qryparam.return1 TO wfapwf020  #??????
            NEXT FIELD wfapwf020                     #?????
    



            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD wfapwf020
            #add-point:BEFORE FIELD wfapwf020 name="construct.b.page3.wfapwf020"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD wfapwf020
            
            #add-point:AFTER FIELD wfapwf020 name="construct.a.page3.wfapwf020"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf023_1
            #add-point:BEFORE FIELD sfakwf023_1 name="construct.b.page3.sfakwf023_1"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf023_1
            
            #add-point:AFTER FIELD sfakwf023_1 name="construct.a.page3.sfakwf023_1"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page3.sfakwf023_1
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf023_1
            #add-point:ON ACTION controlp INFIELD sfakwf023_1 name="construct.c.page3.sfakwf023_1"

            #END add-point
 
 
         #Ctrlp:construct.c.page3.wfapwf023
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD wfapwf023
            #add-point:ON ACTION controlp INFIELD wfapwf023 name="construct.c.page3.wfapwf023"
            #?? a08 ??????(Version:3)
            #??c?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c' 
            LET g_qryparam.reqry = FALSE
            CALL q_sfakwf024_wf()                           #????
            DISPLAY g_qryparam.return1 TO wfapwf023  #??????
            NEXT FIELD wfapwf023                     #?????
    



            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD wfapwf023
            #add-point:BEFORE FIELD wfapwf023 name="construct.b.page3.wfapwf023"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD wfapwf023
            
            #add-point:AFTER FIELD wfapwf023 name="construct.a.page3.wfapwf023"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf025_1
            #add-point:BEFORE FIELD sfakwf025_1 name="construct.b.page3.sfakwf025_1"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf025_1
            
            #add-point:AFTER FIELD sfakwf025_1 name="construct.a.page3.sfakwf025_1"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page3.sfakwf025_1
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf025_1
            #add-point:ON ACTION controlp INFIELD sfakwf025_1 name="construct.c.page3.sfakwf025_1"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf026_1
            #add-point:BEFORE FIELD sfakwf026_1 name="construct.b.page3.sfakwf026_1"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf026_1
            
            #add-point:AFTER FIELD sfakwf026_1 name="construct.a.page3.sfakwf026_1"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page3.sfakwf026_1
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf026_1
            #add-point:ON ACTION controlp INFIELD sfakwf026_1 name="construct.c.page3.sfakwf026_1"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf027_1
            #add-point:BEFORE FIELD sfakwf027_1 name="construct.b.page3.sfakwf027_1"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf027_1
            
            #add-point:AFTER FIELD sfakwf027_1 name="construct.a.page3.sfakwf027_1"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page3.sfakwf027_1
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf027_1
            #add-point:ON ACTION controlp INFIELD sfakwf027_1 name="construct.c.page3.sfakwf027_1"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf028_1
            #add-point:BEFORE FIELD sfakwf028_1 name="construct.b.page3.sfakwf028_1"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf028_1
            
            #add-point:AFTER FIELD sfakwf028_1 name="construct.a.page3.sfakwf028_1"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page3.sfakwf028_1
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf028_1
            #add-point:ON ACTION controlp INFIELD sfakwf028_1 name="construct.c.page3.sfakwf028_1"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD wfapwf024
            #add-point:BEFORE FIELD wfapwf024 name="construct.b.page3.wfapwf024"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD wfapwf024
            
            #add-point:AFTER FIELD wfapwf024 name="construct.a.page3.wfapwf024"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.page3.wfapwf024
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD wfapwf024
            #add-point:ON ACTION controlp INFIELD wfapwf024 name="construct.c.page3.wfapwf024"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD wfapwf025
            #add-point:BEFORE FIELD wfapwf025 name="construct.b.page3.wfapwf025"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD wfapwf025
            
            #add-point:AFTER FIELD wfapwf025 name="construct.a.page3.wfapwf025"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.page3.wfapwf025
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD wfapwf025
            #add-point:ON ACTION controlp INFIELD wfapwf025 name="construct.c.page3.wfapwf025"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD wfapwf026
            #add-point:BEFORE FIELD wfapwf026 name="construct.b.page3.wfapwf026"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD wfapwf026
            
            #add-point:AFTER FIELD wfapwf026 name="construct.a.page3.wfapwf026"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.page3.wfapwf026
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD wfapwf026
            #add-point:ON ACTION controlp INFIELD wfapwf026 name="construct.c.page3.wfapwf026"

            #END add-point
 
 
   
       
      END CONSTRUCT
 
      CONSTRUCT g_wc2_table5 ON l_sfanwfseq1,sfanwfseq,sfanwf002,sfanwf001,sfanwf006,sfanwf003,sfanwf004,sfanwf005
           FROM s_detail5[1].l_sfanwfseq1,s_detail5[1].sfanwfseq,s_detail5[1].sfanwf002,s_detail5[1].sfanwf001,s_detail5[1].sfanwf006,s_detail5[1].sfanwf003,s_detail5[1].sfanwf004,s_detail5[1].sfanwf005
                      
         BEFORE CONSTRUCT
            #add-point:cs?before_construct name="cs.body5.before_construct"

            #end add-point 
            
       #????????????(table 5)
       
       
       #????????????       
                #?? a01 ??????(Version:2)
         BEFORE FIELD l_sfanwfseq1
            #add-point:BEFORE FIELD l_sfanwfseq1 name="construct.b.page5.l_sfanwfseq1"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD l_sfanwfseq1
            
            #add-point:AFTER FIELD l_sfanwfseq1 name="construct.a.page5.l_sfanwfseq1"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page5.l_sfanwfseq1
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD l_sfanwfseq1
            #add-point:ON ACTION controlp INFIELD l_sfanwfseq1 name="construct.c.page5.l_sfanwfseq1"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfanwfseq
            #add-point:BEFORE FIELD sfanwfseq name="construct.b.page5.sfanwfseq"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfanwfseq
            
            #add-point:AFTER FIELD sfanwfseq name="construct.a.page5.sfanwfseq"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page5.sfanwfseq
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfanwfseq
            #add-point:ON ACTION controlp INFIELD sfanwfseq name="construct.c.page5.sfanwfseq"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfanwf002
            #add-point:BEFORE FIELD sfanwf002 name="construct.b.page5.sfanwf002"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfanwf002
            
            #add-point:AFTER FIELD sfanwf002 name="construct.a.page5.sfanwf002"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page5.sfanwf002
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfanwf002
            #add-point:ON ACTION controlp INFIELD sfanwf002 name="construct.c.page5.sfanwf002"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfanwf001
            #add-point:BEFORE FIELD sfanwf001 name="construct.b.page5.sfanwf001"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfanwf001
            
            #add-point:AFTER FIELD sfanwf001 name="construct.a.page5.sfanwf001"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.page5.sfanwf001
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfanwf001
            #add-point:ON ACTION controlp INFIELD sfanwf001 name="construct.c.page5.sfanwf001"
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			   LET g_qryparam.reqry = FALSE
            CALL q_sfanwf001_01_wf()
            DISPLAY g_qryparam.return1 TO sfanwf001
            DISPLAY g_qryparam.return2 TO sfanwf006
            NEXT FIELD sfanwf001
            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfanwf006
            #add-point:BEFORE FIELD sfanwf006 name="construct.b.page5.sfanwf006"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfanwf006
            
            #add-point:AFTER FIELD sfanwf006 name="construct.a.page5.sfanwf006"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.page5.sfanwf006
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfanwf006
            #add-point:ON ACTION controlp INFIELD sfanwf006 name="construct.c.page5.sfanwf006"
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			   LET g_qryparam.reqry = FALSE
            CALL q_sfanwf001_01_wf()
            DISPLAY g_qryparam.return1 TO sfanwf001
            DISPLAY g_qryparam.return2 TO sfanwf006
            NEXT FIELD sfanwf006
            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfanwf003
            #add-point:BEFORE FIELD sfanwf003 name="construct.b.page5.sfanwf003"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfanwf003
            
            #add-point:AFTER FIELD sfanwf003 name="construct.a.page5.sfanwf003"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page5.sfanwf003
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfanwf003
            #add-point:ON ACTION controlp INFIELD sfanwf003 name="construct.c.page5.sfanwf003"

            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfanwf004
            #add-point:BEFORE FIELD sfanwf004 name="construct.b.page5.sfanwf004"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfanwf004
            
            #add-point:AFTER FIELD sfanwf004 name="construct.a.page5.sfanwf004"

            #END add-point
                        #?? a77 ??????(Version:2)
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
 
 
 
         #Ctrlp:construct.c.page5.sfanwf004
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfanwf004
            #add-point:ON ACTION controlp INFIELD sfanwf004 name="construct.c.page5.sfanwf004"
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
			   LET g_qryparam.reqry = FALSE
            CALL q_ooca001()
            DISPLAY g_qryparam.return1 TO sfanwf004
            NEXT FIELD sfanwf004
            #END add-point
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfanwf005
            #add-point:BEFORE FIELD sfanwf005 name="construct.b.page5.sfanwf005"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfanwf005
            
            #add-point:AFTER FIELD sfanwf005 name="construct.a.page5.sfanwf005"

            #END add-point
            
 
 
         #Ctrlp:construct.c.page5.sfanwf005
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfanwf005
            #add-point:ON ACTION controlp INFIELD sfanwf005 name="construct.c.page5.sfanwf005"

            #END add-point
 
 
   
       
      END CONSTRUCT
 
 
      
      #add-point:cs?add_cs(?????????CONSTRUCT??) name="cs.add_cs"

      #end add-point
 
      BEFORE DIALOG
         CALL cl_qbe_init()
         #add-point:cs?b_dialog name="cs.b_dialog"

         #end add-point  
 
      #??????
      ON ACTION qbe_select
         LET ls_wc = ""
         CLEAR FORM #200326-00032#1
         CALL cl_qbe_list("c") RETURNING ls_wc
         IF NOT cl_null(ls_wc) THEN
            CALL util.JSON.parse(ls_wc, la_wc)
            INITIALIZE g_wc, g_wc2, g_wc2_table1, g_wc2_extend TO NULL
            LET g_wc2_extend = " 1=1" #190730-00003#4 add
            INITIALIZE g_wc2_table2 TO NULL
 
 
            FOR li_idx = 1 TO la_wc.getLength()
               CASE
                  WHEN la_wc[li_idx].tableid = "sfajwf_t" 
                     LET g_wc = la_wc[li_idx].wc
                  WHEN la_wc[li_idx].tableid = "sfakwf_t" 
                     LET g_wc2_table1 = la_wc[li_idx].wc
                  WHEN la_wc[li_idx].tableid = "sfamwf_t" 
                     LET g_wc2_table2 = la_wc[li_idx].wc
 
 
               END CASE
            END FOR
         END IF
    
      #???????
      ON ACTION qbe_save
         CALL cl_qbe_save()
 
      ON ACTION accept
         CALL cl_qbe_auto_save() #180530-00049#1
         ACCEPT DIALOG
 
      ON ACTION cancel
         LET INT_FLAG = 1
         EXIT DIALOG 
 
      #??????ACTION
      &include "common_action.4gl" 
         CONTINUE DIALOG
   END DIALOG
   
   #??g_wc2
   LET g_wc2 = g_wc2_table1
   IF g_wc2_table2 <> " 1=1"
      AND NOT g_wc2.getIndexOf(g_wc2_table2,1) THEN   #200828-00027?????,??g_wc2???? (???)
 
      LET g_wc2 = g_wc2 ," AND ", g_wc2_table2   #200917-00047
   END IF
 
 
 
   IF g_wc2_table3 <> " 1=1"
      AND NOT g_wc2.getIndexOf(g_wc2_table3,1) THEN   #200828-00027?????,??g_wc2???? (???)
 
      LET g_wc2 = g_wc2 ," AND ", g_wc2_table3   #200917-00047
   END IF
 
   IF g_wc2_table4 <> " 1=1"
      AND NOT g_wc2.getIndexOf(g_wc2_table4,1) THEN   #200828-00027?????,??g_wc2???? (???)
 
      LET g_wc2 = g_wc2 ," AND ", g_wc2_table4   #200917-00047
   END IF
 
   IF g_wc2_table5 <> " 1=1"
      AND NOT g_wc2.getIndexOf(g_wc2_table5,1) THEN   #200828-00027?????,??g_wc2???? (???)
 
      LET g_wc2 = g_wc2 ," AND ", g_wc2_table5   #200917-00047
   END IF
 
 
   
   #add-point:cs???? name="cs.after_construct"

   #end add-point    
 
   IF INT_FLAG THEN
      RETURN
   END IF
 
END FUNCTION

{</section>}

{<section id="bsft001_wf.filter" type="s" >}
#?? a50 ??????(Version:12)
#+ filter????
PRIVATE FUNCTION bsft001_wf_filter() RETURNS ()   #200213-00032
   #add-point:filter?define name="filter.define_customerization"

   #end add-point   
   DEFINE lp_str     STRING   #201109-00009#2
   #add-point:filter?define(?????????????????, ?????patch????????) name="filter.define"

   #end add-point   
   
   #add-point:Function????  name="filter.pre_function"

   #end add-point
   
   #????
   IF NOT g_main_hidden THEN
      CALL gfrm_curr.setElementHidden("mainlayout",1)
      CALL gfrm_curr.setElementHidden("worksheet",0)
      LET g_main_hidden = 1
   END IF   
 
   LET INT_FLAG = 0
 
   LET g_qryparam.state = 'c'
 
   LET g_wc_filter_t = g_wc_filter.trim()
   LET g_wc_t = g_wc
 
   LET g_wc = cl_replace_str(g_wc, g_wc_filter_t, '')
 
   #??DIALOG?? ??CONSTRUCT???CONSTRUCT
   DIALOG ATTRIBUTES(UNBUFFERED,FIELD ORDER FORM)
 
      #??
      CONSTRUCT g_wc_filter ON sfajwfdocno,sfajwfdocdt,sfajwf006,sfajwf007,sfajwf012,sfajwf013,sfajwf014,sfajwf001,sfajwf002,sfajwf015,sfajwf016,sfajwf003,sfajwf004,sfajwf005,sfajwf008,sfajwf009,sfajwf010,sfajwf011
                          FROM s_browse[1].b_sfajwfdocno,s_browse[1].b_sfajwfdocdt,s_browse[1].b_sfajwf006,s_browse[1].b_sfajwf007,s_browse[1].b_sfajwf012,s_browse[1].b_sfajwf013,s_browse[1].b_sfajwf014,s_browse[1].b_sfajwf001,s_browse[1].b_sfajwf002,s_browse[1].b_sfajwf015,s_browse[1].b_sfajwf016,s_browse[1].b_sfajwf003, 
                              s_browse[1].b_sfajwf004,s_browse[1].b_sfajwf005,s_browse[1].b_sfajwf008,s_browse[1].b_sfajwf009,s_browse[1].b_sfajwf010,s_browse[1].b_sfajwf011
 
         BEFORE CONSTRUCT
               DISPLAY bsft001_wf_filter_parser('sfajwfdocno') TO s_browse[1].b_sfajwfdocno
            DISPLAY bsft001_wf_filter_parser('sfajwfdocdt') TO s_browse[1].b_sfajwfdocdt
            DISPLAY bsft001_wf_filter_parser('sfajwf006') TO s_browse[1].b_sfajwf006
            DISPLAY bsft001_wf_filter_parser('sfajwf007') TO s_browse[1].b_sfajwf007
            DISPLAY bsft001_wf_filter_parser('sfajwf012') TO s_browse[1].b_sfajwf012
            DISPLAY bsft001_wf_filter_parser('sfajwf013') TO s_browse[1].b_sfajwf013
            DISPLAY bsft001_wf_filter_parser('sfajwf014') TO s_browse[1].b_sfajwf014
            DISPLAY bsft001_wf_filter_parser('sfajwf001') TO s_browse[1].b_sfajwf001
            DISPLAY bsft001_wf_filter_parser('sfajwf002') TO s_browse[1].b_sfajwf002
            DISPLAY bsft001_wf_filter_parser('sfajwf015') TO s_browse[1].b_sfajwf015
            DISPLAY bsft001_wf_filter_parser('sfajwf016') TO s_browse[1].b_sfajwf016
            DISPLAY bsft001_wf_filter_parser('sfajwf003') TO s_browse[1].b_sfajwf003
            DISPLAY bsft001_wf_filter_parser('sfajwf004') TO s_browse[1].b_sfajwf004
            DISPLAY bsft001_wf_filter_parser('sfajwf005') TO s_browse[1].b_sfajwf005
            DISPLAY bsft001_wf_filter_parser('sfajwf008') TO s_browse[1].b_sfajwf008
            DISPLAY bsft001_wf_filter_parser('sfajwf009') TO s_browse[1].b_sfajwf009
            DISPLAY bsft001_wf_filter_parser('sfajwf010') TO s_browse[1].b_sfajwf010
            DISPLAY bsft001_wf_filter_parser('sfajwf011') TO s_browse[1].b_sfajwf011
   
         AFTER FIELD b_sfajwfdocno
            #add-point:AFTER FIELD b_sfajwfdocno name="construct.filter.af.b_sfajwfdocno"

            #END add-point
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
         AFTER FIELD b_sfajwf006
            #add-point:AFTER FIELD b_sfajwf006 name="construct.filter.af.b_sfajwf006"

            #END add-point
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
         AFTER FIELD b_sfajwf007
            #add-point:AFTER FIELD b_sfajwf007 name="construct.filter.af.b_sfajwf007"

            #END add-point
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
         AFTER FIELD b_sfajwf012
            #add-point:AFTER FIELD b_sfajwf012 name="construct.filter.af.b_sfajwf012"

            #END add-point
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
         AFTER FIELD b_sfajwf013
            #add-point:AFTER FIELD b_sfajwf013 name="construct.filter.af.b_sfajwf013"

            #END add-point
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
         AFTER FIELD b_sfajwf014
            #add-point:AFTER FIELD b_sfajwf014 name="construct.filter.af.b_sfajwf014"

            #END add-point
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
         AFTER FIELD b_sfajwf001
            #add-point:AFTER FIELD b_sfajwf001 name="construct.filter.af.b_sfajwf001"

            #END add-point
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
         AFTER FIELD b_sfajwf002
            #add-point:AFTER FIELD b_sfajwf002 name="construct.filter.af.b_sfajwf002"

            #END add-point
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
         AFTER FIELD b_sfajwf015
            #add-point:AFTER FIELD b_sfajwf015 name="construct.filter.af.b_sfajwf015"

            #END add-point
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
         AFTER FIELD b_sfajwf016
            #add-point:AFTER FIELD b_sfajwf016 name="construct.filter.af.b_sfajwf016"

            #END add-point
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
         AFTER FIELD b_sfajwf003
            #add-point:AFTER FIELD b_sfajwf003 name="construct.filter.af.b_sfajwf003"

            #END add-point
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
         AFTER FIELD b_sfajwf004
            #add-point:AFTER FIELD b_sfajwf004 name="construct.filter.af.b_sfajwf004"

            #END add-point
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
         AFTER FIELD b_sfajwf005
            #add-point:AFTER FIELD b_sfajwf005 name="construct.filter.af.b_sfajwf005"

            #END add-point
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
         AFTER FIELD b_sfajwf008
            #add-point:AFTER FIELD b_sfajwf008 name="construct.filter.af.b_sfajwf008"

            #END add-point
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
         AFTER FIELD b_sfajwf009
            #add-point:AFTER FIELD b_sfajwf009 name="construct.filter.af.b_sfajwf009"

            #END add-point
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
         AFTER FIELD b_sfajwf010
            #add-point:AFTER FIELD b_sfajwf010 name="construct.filter.af.b_sfajwf010"

            #END add-point
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
 
         AFTER FIELD b_sfajwf011
            #add-point:AFTER FIELD b_sfajwf011 name="construct.filter.af.b_sfajwf011"

            #END add-point
            CALL FGL_DIALOG_GETBUFFER() RETURNING lp_str
            IF NOT cl_null(lp_str) THEN
               LET lp_str = cl_ap_code_fuzzyquery(lp_str)   #??????
               CALL FGL_DIALOG_SETBUFFER(lp_str)
            END IF
   #201109-00009#2
      
         #add-point:filter?cs_ctrl name="filter.cs_ctrl"

         #end add-point
      
      END CONSTRUCT
 
      #add-point:filter?add_cs name="filter.add_cs"

      #end add-point
 
      BEFORE DIALOG
         #add-point:filter?b_dialog name="filter.b_dialog"

         #end add-point  
      
      ON ACTION accept
         ACCEPT DIALOG
 
      ON ACTION cancel
         LET INT_FLAG = 1
         EXIT DIALOG 
 
      #??????ACTION
      &include "common_action.4gl" 
         CONTINUE DIALOG
   
   END DIALOG
 
   IF NOT INT_FLAG THEN
      IF NOT g_wc.getIndexOf(g_wc_filter,1) THEN   #200828-00027?????,?????? (???)
         LET g_wc_filter = "   AND   ", g_wc_filter, "   "
         LET g_wc = g_wc , g_wc_filter   #200917-00047
      END IF   #200828-00027
   ELSE
      LET g_wc_filter = g_wc_filter_t
      LET g_wc = g_wc_t
   END IF
 
      CALL bsft001_wf_filter_show('sfajwfdocno')
   CALL bsft001_wf_filter_show('sfajwfdocdt')
   CALL bsft001_wf_filter_show('sfajwf006')
   CALL bsft001_wf_filter_show('sfajwf007')
   CALL bsft001_wf_filter_show('sfajwf012')
   CALL bsft001_wf_filter_show('sfajwf013')
   CALL bsft001_wf_filter_show('sfajwf014')
   CALL bsft001_wf_filter_show('sfajwf001')
   CALL bsft001_wf_filter_show('sfajwf002')
   CALL bsft001_wf_filter_show('sfajwf015')
   CALL bsft001_wf_filter_show('sfajwf016')
   CALL bsft001_wf_filter_show('sfajwf003')
   CALL bsft001_wf_filter_show('sfajwf004')
   CALL bsft001_wf_filter_show('sfajwf005')
   CALL bsft001_wf_filter_show('sfajwf008')
   CALL bsft001_wf_filter_show('sfajwf009')
   CALL bsft001_wf_filter_show('sfajwf010')
   CALL bsft001_wf_filter_show('sfajwf011')
 
END FUNCTION

{</section>}

{<section id="bsft001_wf.filter_parser" type="s" >}
#+ filter????
PRIVATE FUNCTION bsft001_wf_filter_parser(ps_field) RETURNS (STRING)   #200213-00032
   #add-point:filter?define name="filter_parser.define_customerization"

   #end add-point    
   DEFINE ps_field   STRING
   DEFINE ls_tmp     STRING
   DEFINE li_tmp     LIKE type_t.num10
   DEFINE li_tmp2    LIKE type_t.num10
   DEFINE ls_var     STRING
   #add-point:filter?define(?????????????????, ?????patch????????) name="filter_parser.define"

   #end add-point    
   
   #??????
   LET ls_tmp = ps_field, "='"
   LET li_tmp = g_wc_filter.getIndexOf(ls_tmp,1)
   IF li_tmp > 0 THEN
      LET li_tmp = ls_tmp.getLength() + li_tmp
      LET li_tmp2 = g_wc_filter.getIndexOf("'",li_tmp + 1) - 1
      LET ls_var = g_wc_filter.subString(li_tmp,li_tmp2)
   END IF
 
   #??????
   LET ls_tmp = ps_field, " like '"
   LET li_tmp = g_wc_filter.getIndexOf(ls_tmp,1)
   IF li_tmp > 0 THEN
      LET li_tmp = ls_tmp.getLength() + li_tmp
      LET li_tmp2 = g_wc_filter.getIndexOf("'",li_tmp + 1) - 1
      LET ls_var = g_wc_filter.subString(li_tmp,li_tmp2)
      LET ls_var = cl_replace_str(ls_var,'%','*')
   END IF
 
   RETURN ls_var
 
END FUNCTION

{</section>}

{<section id="bsft001_wf.filter_show" type="s" >}
#+ ??????
PRIVATE FUNCTION bsft001_wf_filter_show(ps_field) RETURNS ()   #200213-00032
   DEFINE ps_field         STRING
   DEFINE lnode_item       om.DomNode
   DEFINE ls_title         STRING
   DEFINE ls_name          STRING
   DEFINE ls_condition     STRING
 
   LET ls_name = "formonly.b_", ps_field
   LET lnode_item = gfrm_curr.findNode("TableColumn", ls_name)
   LET ls_title = lnode_item.getAttribute("text")
   IF ls_title.getIndexOf('?',1) > 0 THEN
      LET ls_title = ls_title.subString(1,ls_title.getIndexOf('?',1)-1)
   END IF
 
   #??????
   LET ls_condition = bsft001_wf_filter_parser(ps_field)
   IF NOT cl_null(ls_condition) THEN
      LET ls_title = ls_title, '?', ls_condition, '?'
   END IF
 
   #???????
   CALL lnode_item.setAttribute("text",ls_title)
 
END FUNCTION

{</section>}

{<section id="bsft001_wf.query" type="s" >}
#+ ????QBE????
PRIVATE FUNCTION bsft001_wf_query() RETURNS ()   #200213-00032
   #add-point:query?define(???) name="query.define_customerization"

   #end add-point   
   DEFINE ls_wc STRING
   #add-point:query?define (?????????????????, ?????patch????????) name="query.define"

   #end add-point   
   
   #add-point:Function????  name="query.pre_function"

   #end add-point
   
   #????
   IF g_main_hidden THEN
      CALL gfrm_curr.setElementHidden("mainlayout",0)
      CALL gfrm_curr.setElementHidden("worksheet",1)
      LET g_main_hidden = 0
   END IF   
   
   LET ls_wc = g_wc
   
   LET INT_FLAG = 0
   CALL cl_navigator_setting( g_current_idx, g_detail_cnt )
   ERROR ""
   
   #?????????
   CLEAR FORM
   CALL g_browser.clear()       
   CALL g_sfakwf_d.clear()
   CALL g_sfakwf2_d.clear()
   CALL g_sfakwf3_d.clear()
   CALL g_sfakwf4_d.clear()
   CALL g_sfakwf5_d.clear()
 
   
   #add-point:query?other name="query.other"

   #end add-point   
   
   DISPLAY '' TO FORMONLY.idx
   DISPLAY '' TO FORMONLY.cnt
   DISPLAY '' TO FORMONLY.b_index
   DISPLAY '' TO FORMONLY.b_count
   DISPLAY '' TO FORMONLY.h_index 
   DISPLAY '' TO FORMONLY.h_count
   
   LET g_wc2_extend = " 1=1" #???????? #190730-00003#4 add
   
   CALL bsft001_wf_construct()
 
   IF INT_FLAG THEN
      #????
      LET INT_FLAG = 0
      #LET g_wc = ls_wc
      LET g_wc = " 1=2"
      CALL bsft001_wf_browser_fill("")
      CALL bsft001_wf_fetch("")
      RETURN
   END IF
   
   #??WC??
   CALL cl_dlg_save_user_latestqry("("||g_wc||") AND ("||g_wc2||")")
   
   #???????? 
   LET g_detail_cnt  = 0
   LET g_current_idx = 1
   LET g_current_row = 0
   LET g_detail_idx  = 1
   LET g_detail_idx2 = 1
   LET g_detail_idx_list[1] = 1
   LET g_detail_idx_list[2] = 1
   LET g_detail_idx_list[3] = 1
   LET g_detail_idx_list[4] = 1
   LET g_detail_idx_list[5] = 1
 
   LET g_error_show  = 1
   LET g_wc_filter   = ""
   LET l_ac = 1
   CALL FGL_SET_ARR_CURR(1)
      CALL bsft001_wf_filter_show('sfajwfdocno')
   CALL bsft001_wf_filter_show('sfajwfdocdt')
   CALL bsft001_wf_filter_show('sfajwf006')
   CALL bsft001_wf_filter_show('sfajwf007')
   CALL bsft001_wf_filter_show('sfajwf012')
   CALL bsft001_wf_filter_show('sfajwf013')
   CALL bsft001_wf_filter_show('sfajwf014')
   CALL bsft001_wf_filter_show('sfajwf001')
   CALL bsft001_wf_filter_show('sfajwf002')
   CALL bsft001_wf_filter_show('sfajwf015')
   CALL bsft001_wf_filter_show('sfajwf016')
   CALL bsft001_wf_filter_show('sfajwf003')
   CALL bsft001_wf_filter_show('sfajwf004')
   CALL bsft001_wf_filter_show('sfajwf005')
   CALL bsft001_wf_filter_show('sfajwf008')
   CALL bsft001_wf_filter_show('sfajwf009')
   CALL bsft001_wf_filter_show('sfajwf010')
   CALL bsft001_wf_filter_show('sfajwf011')
   CALL bsft001_wf_browser_fill("F")
         
   IF g_browser_cnt = 0 THEN
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = "" 
      LET g_errparam.code = "-100" 
      LET g_errparam.popup = TRUE 
      CALL cl_err()
   ELSE
      CALL bsft001_wf_fetch("F") 
      #??????
      CALL bsft001_wf_idx_chk()
   END IF
 
END FUNCTION

{</section>}

{<section id="bsft001_wf.fetch" type="s" >}
#+ ??PK?????????
PRIVATE FUNCTION bsft001_wf_fetch(p_flag) RETURNS ()   #200213-00032
   #add-point:fetch?define(???) name="fetch.define_customerization"

   #end add-point    
   DEFINE p_flag     LIKE type_t.chr1
   DEFINE ls_msg     STRING
   #add-point:fetch?define (?????????????????, ?????patch????????) name="fetch.define"

   #end add-point    
   
   #add-point:Function????  name="fetch.pre_function"

   #end add-point
   
   IF g_browser_cnt = 0 THEN
      RETURN
   END IF
 
   #???????
   CALL g_sfakwf2_d.clear()
   CALL g_sfakwf3_d.clear()
   CALL g_sfakwf5_d.clear()
 
   
   CALL cl_ap_performance_next_start()
   CASE p_flag
      WHEN 'F' 
         LET g_current_idx = 1
      WHEN 'L'  
         LET g_current_idx = g_browser.getLength()              
      WHEN 'P'
         IF g_current_idx > 1 THEN               
            LET g_current_idx = g_current_idx - 1
         END IF 
      WHEN 'N'
         IF g_current_idx < g_header_cnt THEN
            LET g_current_idx =  g_current_idx + 1
         END IF        
      WHEN '/'
         IF (NOT g_no_ask) THEN    
            CALL cl_set_act_visible("accept,cancel", TRUE)    
            CALL cl_getmsg('fetch',g_lang) RETURNING ls_msg
            LET INT_FLAG = 0
 
            PROMPT ls_msg CLIPPED,':' FOR g_jump
               #??????ACTION
               &include "common_action.4gl" 
            END PROMPT
 
            CALL cl_set_act_visible("accept,cancel", FALSE)    
            IF INT_FLAG THEN
                LET INT_FLAG = 0
                EXIT CASE  
            END IF           
         END IF
         
         IF g_jump > 0 AND g_jump <= g_browser.getLength() THEN
             LET g_current_idx = g_jump
         END IF
         LET g_no_ask = FALSE  
   END CASE 
 
   CALL g_curr_diag.setCurrentRow("s_browse", g_current_idx) #??browse ??
   
   LET g_current_row = g_current_idx
   LET g_detail_cnt = g_header_cnt                  
   
   #???????
   IF g_detail_cnt > 0 THEN
      #???????, idx???1
      IF g_detail_idx <= 0 THEN
         LET g_detail_idx = 1
      END IF
      DISPLAY g_detail_idx TO FORMONLY.idx  
   ELSE
      LET g_detail_idx = 0
      DISPLAY '' TO FORMONLY.idx    
   END IF
   
   #???????
   LET g_browser_idx = g_pagestart+g_current_idx-1
   DISPLAY g_browser_idx TO FORMONLY.b_index   #????
   DISPLAY g_browser_idx TO FORMONLY.h_index   #????
   
   CALL cl_navigator_setting( g_current_idx, g_browser_cnt )
 
   #??????
   IF g_current_idx = 0 OR g_browser.getLength() = 0 THEN
      RETURN
   END IF
   
   #????browser??????
   IF g_current_idx > g_browser.getLength() THEN
      LET g_browser_idx = g_browser.getLength()
      LET g_current_idx = g_browser.getLength()
   END IF
   
   LET g_sfajwf_m.sfajwfdocno = g_browser[g_current_idx].b_sfajwfdocno
 
   
   #??DB,?TEMP???????
   EXECUTE bsft001_wf_master_referesh USING g_site,g_sfajwf_m.sfajwfdocno INTO g_sfajwf_m.sfajwfdocno,g_sfajwf_m.sfajwfdocdt,g_sfajwf_m.sfajwf006,g_sfajwf_m.sfajwf007,g_sfajwf_m.sfajwf017,g_sfajwf_m.sfajwf019,g_sfajwf_m.sfajwf020,g_sfajwf_m.sfajwf021,g_sfajwf_m.sfajwf018,g_sfajwf_m.sfajwf022,g_sfajwf_m.sfajwf023, 
       g_sfajwf_m.sfajwf012,g_sfajwf_m.sfajwf013,g_sfajwf_m.sfajwf014,g_sfajwf_m.sfajwf001,g_sfajwf_m.sfajwf002,g_sfajwf_m.sfajwf025,g_sfajwf_m.sfajwf015,g_sfajwf_m.sfajwfua002,g_sfajwf_m.sfajwf016,g_sfajwf_m.sfajwfua003,g_sfajwf_m.sfajwf024,g_sfajwf_m.sfajwf003,g_sfajwf_m.sfajwf005,g_sfajwf_m.sfajwf004, 
       g_sfajwf_m.sfajwf008,g_sfajwf_m.sfajwf009,g_sfajwf_m.sfajwf010,g_sfajwf_m.sfajwf011,g_sfajwf_m.sfajwfua011,g_sfajwf_m.sfajwfua012,g_sfajwf_m.sfajwfua013,g_sfajwf_m.sfajwfua014,g_sfajwf_m.sfajwfua015,g_sfajwf_m.sfajwfstus,g_sfajwf_m.sfajwfownid,g_sfajwf_m.sfajwfowndp,g_sfajwf_m.sfajwfcrtid,g_sfajwf_m.sfajwfcrtdp, 
       g_sfajwf_m.sfajwfcrtdt,g_sfajwf_m.sfajwfmodid,g_sfajwf_m.sfajwfmoddt,g_sfajwf_m.sfajwfcnfid,g_sfajwf_m.sfajwfcnfdt,g_sfajwf_m.sfajwf006_desc,g_sfajwf_m.sfajwf007_desc,g_sfajwf_m.sfajwf023_desc,g_sfajwf_m.sfajwf012_desc,g_sfajwf_m.sfajwf001_desc,g_sfajwf_m.sfajwf002_desc,g_sfajwf_m.sfajwf025_desc, 
       g_sfajwf_m.sfajwf008_desc,g_sfajwf_m.sfajwf009_desc,g_sfajwf_m.sfajwf010_desc,g_sfajwf_m.sfajwf011_desc,g_sfajwf_m.sfajwfownid_desc,g_sfajwf_m.sfajwfowndp_desc,g_sfajwf_m.sfajwfcrtid_desc,g_sfajwf_m.sfajwfcrtdp_desc,g_sfajwf_m.sfajwfmodid_desc,g_sfajwf_m.sfajwfcnfid_desc
   
   #??????
   LET g_sfajwf_m_mask_o.* =  g_sfajwf_m.*
   CALL bsft001_wf_sfajwf_t_mask()
   LET g_sfajwf_m_mask_n.* =  g_sfajwf_m.*
   
   #????????action??
   CALL cl_set_act_visible("statechange,modify,modify_detail,delete,reproduce", TRUE)
   CALL bsft001_wf_set_act_visible()   
   CALL bsft001_wf_set_act_no_visible()
   
   #add-point:fetch?action?? name="fetch.action_control"

   #end add-point  
   
   
   
   #add-point:fetch??? name="fetch.after"

   #end add-point
   
   #??????
   LET g_sfajwf_m_t.* = g_sfajwf_m.*
   LET g_sfajwf_m_o.* = g_sfajwf_m.*
   
   LET g_data_owner = g_sfajwf_m.sfajwfownid      
   LET g_data_dept  = g_sfajwf_m.sfajwfowndp
   LET g_data_crtid = g_sfajwf_m.sfajwfcrtid   #180201-00054
   LET g_data_crtdp = g_sfajwf_m.sfajwfcrtdp   #180201-00054
   
   #????   
   CALL bsft001_wf_show()
 
   #?? a56 ??????(Version:6)
   #??????????BPM?????? 
#  IF cl_bpm_chk() THEN   #181128-00048 mark
   IF cl_bpm_chk_status() THEN   #181128-00048
      CALL cl_set_act_visible("bpm_status",TRUE)
   ELSE
      CALL cl_set_act_visible("bpm_status",FALSE)
   END IF
 
   #181128-00048 ---start---
   #??BPM???T100???????????
   IF FGL_GETENV("BPMUSER") = "Y" THEN
      CALL cl_set_act_visible("insert,modify,delete,modify_detail,reproduce",FALSE)
   END IF
   #181128-00048 --- end ---
 
 
 
END FUNCTION

{</section>}

{<section id="bsft001_wf.insert" type="s" >}
#+ ????
PRIVATE FUNCTION bsft001_wf_insert() RETURNS ()   #200213-00032
   #add-point:insert?define(???) name="insert.define_customerization"

   #end add-point    
   #add-point:insert?define (?????????????????, ?????patch????????) name="insert.define"

   #end add-point    
   
   #add-point:Function????  name="insert.pre_function"

   #end add-point
   
   #???????
   CLEAR FORM                    
   CALL g_sfakwf_d.clear()   
   CALL g_sfakwf2_d.clear()  
   CALL g_sfakwf3_d.clear()  
   CALL g_sfakwf4_d.clear()  
   CALL g_sfakwf5_d.clear()  
 
 
   INITIALIZE g_sfajwf_m.* TO NULL             #DEFAULT ??
   
   LET g_sfajwfdocno_t = NULL
 
   
   LET g_master_insert = FALSE
   
   #add-point:insert?before name="insert.before"

   #end add-point    
   
   CALL s_transaction_begin()
   WHILE TRUE
      #??????(??)
      #?? a14 ??????(Version:5)    
      #????????  
      LET g_sfajwf_m.sfajwfownid = g_user
      LET g_sfajwf_m.sfajwfowndp = g_dept
      LET g_sfajwf_m.sfajwfcrtid = g_user
      LET g_sfajwf_m.sfajwfcrtdp = g_dept 
      LET g_sfajwf_m.sfajwfcrtdt = cl_get_current()
      LET g_sfajwf_m.sfajwfmodid = g_user
      LET g_sfajwf_m.sfajwfmoddt = cl_get_current()
      LET g_sfajwf_m.sfajwfstus = 'N'
 
 
 
 
      #append????
      
     
      #??????
            LET g_sfajwf_m.sfajwf019 = "0"
      LET g_sfajwf_m.sfajwf020 = "0"
      LET g_sfajwf_m.sfajwf021 = "0"
      LET g_sfajwf_m.sfajwfua003 = "5"
 
  
      #add-point:????? name="insert.default"
      CALL g_icbawf_d.clear()  
      CALL g_icbawf_d2.clear() 
      LET g_sfajwf_m.sfajwfdocdt = g_today
      LET g_sfajwf_m.sfajwf003 = '1'   #????
      LET g_sfajwf_m.sfajwf004 = '1'   #????
      LET g_sfajwf_m.sfajwfua003 = '5' #20250416 add
      #240530-00021#1 add---s
      
      IF cl_get_doc_para(g_enterprise,g_site,g_sfajwf_m.sfajwfdocno,'D-BWF-0004') = 'Y' THEN
            LET g_sfajwf_m.sfajwf005 = '2'
      ELSE
            IF cl_get_para(g_enterprise,g_site,"S-BWF-0001") = 'Y' THEN 
               LET g_sfajwf_m.sfajwf005 = '1'
            ELSE 
               LET g_sfajwf_m.sfajwf005 = '2'            
            END IF 
      END IF    
      DISPLAY BY NAME g_sfajwf_m.sfajwf005
      #240530-00021#1 add---e      
      
      
      #LET g_sfajwf_m.sfajwf005 = '1'   #????
      #240423-00004#1-24042401-16508 add by lijlg -----start ? IC????=Y (???)???????????+1.????IC????=N,???????????+2.??
      #240530-00021#1 mark -s
#      IF cl_get_para(g_enterprise,g_site,"S-BWF-0001") = 'Y' THEN 
#         LET g_sfajwf_m.sfajwf005 = '1'
#      ELSE 
#         LET g_sfajwf_m.sfajwf005 = '2'            
#      END IF 
      #240530-00021#1 mark -e
      #240423-00004#1-24042401-16508 add by lijlg -----end
      LET g_sfajwf_m.sfajwf013 = '2'   #????
      LET g_sfajwf_m.sfajwf014 = '1'  
      LET g_sfajwf_m.sfajwf015 = 'N'  
      LET g_sfajwf_m.sfajwf016 = 'N'
      LET g_sfajwf_m.sfajwf024 = 'N'   #???????  #240325-00027#1 add
      LET g_sfajwf_m.sfajwf017 = ""    #????   
      LET g_sfajwf_m.sfajwf001 = g_user   #????
      CALL s_desc_get_person_desc(g_sfajwf_m.sfajwf001) RETURNING g_sfajwf_m.sfajwf001_desc
      SELECT ooag003 INTO g_sfajwf_m.sfajwf002  #????
       FROM ooag_t
      WHERE ooagent = g_enterprise
        AND ooag001 = g_sfajwf_m.sfajwf001
      LET g_sfajwf_m.sfajwf002_desc = s_desc_get_department_desc(g_sfajwf_m.sfajwf002)
      DISPLAY BY NAME g_sfajwf_m.sfajwf001,g_sfajwf_m.sfajwf001_desc,g_sfajwf_m.sfajwf002,g_sfajwf_m.sfajwf002_desc            
      
      IF NOT cl_chk_update_docdt() THEN
         #?????>=???????????+1
         CALL cl_get_para(g_enterprise,g_site,'S-MFG-0031') RETURNING g_docdt #???? 
         IF g_docdt >= g_today THEN
            LET g_sfajwf_m.sfajwfdocdt = g_docdt + 1
         ELSE 
            LET g_sfajwf_m.sfajwfdocdt = g_today
         END IF
      END IF
      
      #end add-point 
      
      #??????(????????????????)
      LET g_sfajwf_m_t.* = g_sfajwf_m.*
      LET g_sfajwf_m_o.* = g_sfajwf_m.*
      
      #????(stus)??
            #?? a21 ??????(Version:3)
	  #???????????
      CASE g_sfajwf_m.sfajwfstus 
         WHEN "A"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/approved.png")
         WHEN "D"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/withdraw.png")
         WHEN "R"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/rejection.png")
         WHEN "W"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/signing.png")
         WHEN "N"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/unconfirmed.png")
         WHEN "Y"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/confirmed.png")
         WHEN "F"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/released.png")
         WHEN "U"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/unreleased.png")
         WHEN "X"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/invalid.png")
         
      END CASE
 
 
 
    
      CALL bsft001_wf_input("a")
      
      #add-point:????? name="insert.after_insert"

      #end add-point
      
      IF INT_FLAG THEN
         LET INT_FLAG = 0
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = '' 
         LET g_errparam.code = 9001 
         LET g_errparam.popup = FALSE 
         CALL s_transaction_end('N','0')
         CALL cl_err()
      END IF
      
      IF NOT g_master_insert THEN
         DISPLAY g_detail_cnt  TO FORMONLY.h_count    #???
         DISPLAY g_current_idx TO FORMONLY.h_index    #????
         INITIALIZE g_sfajwf_m.* TO NULL
         INITIALIZE g_sfakwf_d TO NULL
         INITIALIZE g_sfakwf2_d TO NULL
         INITIALIZE g_sfakwf3_d TO NULL
         INITIALIZE g_sfakwf4_d TO NULL
         INITIALIZE g_sfakwf5_d TO NULL
 
         #add-point:????? name="insert.cancel"

         #end add-point 
         CALL bsft001_wf_show()
         CALL bsft001_wf_idx_chk()   #(ver:83)
         RETURN
      END IF
      
      LET INT_FLAG = 0
      #CALL g_sfakwf_d.clear()
      #CALL g_sfakwf2_d.clear()
      #CALL g_sfakwf3_d.clear()
      #CALL g_sfakwf4_d.clear()
      #CALL g_sfakwf5_d.clear()
 
 
      LET g_rec_b = 0
      CALL s_transaction_end('Y','0')
      EXIT WHILE
        
   END WHILE
   
   #????????action??
   CALL cl_set_act_visible("statechange,modify,modify_detail,delete,reproduce", TRUE)
   CALL bsft001_wf_set_act_visible()   
   CALL bsft001_wf_set_act_no_visible()
   
   #?????????????
   LET g_sfajwfdocno_t = g_sfajwf_m.sfajwfdocno
 
   
   #?????????
   LET g_add_browse = " sfajwfent = " ||g_enterprise|| " AND sfajwfsite = '" ||g_site|| "' AND",
                      " sfajwfdocno = '", g_sfajwf_m.sfajwfdocno, "' "
 
                      
   #add-point:?????????? name="insert.after.add_browse"

   #end add-point
      
   #?????
   LET g_current_idx = g_browser.getLength() + 1
   LET g_current_row = g_browser.getLength() + 1 #190108-00038 add
   CALL bsft001_wf_browser_fill("")
   
   DISPLAY g_browser_cnt TO FORMONLY.h_count    #???
   DISPLAY g_current_idx TO FORMONLY.h_index    #????
   CALL cl_navigator_setting(g_current_idx, g_browser_cnt)
   
   CLOSE bsft001_wf_cl
   
   CALL bsft001_wf_idx_chk()
   
   #????????(?????reference)
   EXECUTE bsft001_wf_master_referesh USING g_site,g_sfajwf_m.sfajwfdocno INTO g_sfajwf_m.sfajwfdocno,g_sfajwf_m.sfajwfdocdt,g_sfajwf_m.sfajwf006,g_sfajwf_m.sfajwf007,g_sfajwf_m.sfajwf017,g_sfajwf_m.sfajwf019,g_sfajwf_m.sfajwf020,g_sfajwf_m.sfajwf021,g_sfajwf_m.sfajwf018,g_sfajwf_m.sfajwf022,g_sfajwf_m.sfajwf023, 
       g_sfajwf_m.sfajwf012,g_sfajwf_m.sfajwf013,g_sfajwf_m.sfajwf014,g_sfajwf_m.sfajwf001,g_sfajwf_m.sfajwf002,g_sfajwf_m.sfajwf025,g_sfajwf_m.sfajwf015,g_sfajwf_m.sfajwfua002,g_sfajwf_m.sfajwf016,g_sfajwf_m.sfajwfua003,g_sfajwf_m.sfajwf024,g_sfajwf_m.sfajwf003,g_sfajwf_m.sfajwf005,g_sfajwf_m.sfajwf004, 
       g_sfajwf_m.sfajwf008,g_sfajwf_m.sfajwf009,g_sfajwf_m.sfajwf010,g_sfajwf_m.sfajwf011,g_sfajwf_m.sfajwfua011,g_sfajwf_m.sfajwfua012,g_sfajwf_m.sfajwfua013,g_sfajwf_m.sfajwfua014,g_sfajwf_m.sfajwfua015,g_sfajwf_m.sfajwfstus,g_sfajwf_m.sfajwfownid,g_sfajwf_m.sfajwfowndp,g_sfajwf_m.sfajwfcrtid,g_sfajwf_m.sfajwfcrtdp, 
       g_sfajwf_m.sfajwfcrtdt,g_sfajwf_m.sfajwfmodid,g_sfajwf_m.sfajwfmoddt,g_sfajwf_m.sfajwfcnfid,g_sfajwf_m.sfajwfcnfdt,g_sfajwf_m.sfajwf006_desc,g_sfajwf_m.sfajwf007_desc,g_sfajwf_m.sfajwf023_desc,g_sfajwf_m.sfajwf012_desc,g_sfajwf_m.sfajwf001_desc,g_sfajwf_m.sfajwf002_desc,g_sfajwf_m.sfajwf025_desc, 
       g_sfajwf_m.sfajwf008_desc,g_sfajwf_m.sfajwf009_desc,g_sfajwf_m.sfajwf010_desc,g_sfajwf_m.sfajwf011_desc,g_sfajwf_m.sfajwfownid_desc,g_sfajwf_m.sfajwfowndp_desc,g_sfajwf_m.sfajwfcrtid_desc,g_sfajwf_m.sfajwfcrtdp_desc,g_sfajwf_m.sfajwfmodid_desc,g_sfajwf_m.sfajwfcnfid_desc
   
   
   #??????
   LET g_sfajwf_m_mask_o.* =  g_sfajwf_m.*
   CALL bsft001_wf_sfajwf_t_mask()
   LET g_sfajwf_m_mask_n.* =  g_sfajwf_m.*
   
   #?????????
   DISPLAY BY NAME g_sfajwf_m.sfajwfdocno,g_sfajwf_m.oobal004,g_sfajwf_m.sfajwfdocdt,g_sfajwf_m.sfajwf006,g_sfajwf_m.sfajwf006_desc,g_sfajwf_m.sfajwf007,g_sfajwf_m.sfajwf007_desc,g_sfajwf_m.sfajwf017,g_sfajwf_m.sfajwf019,g_sfajwf_m.sfajwf020,g_sfajwf_m.sfajwf021,g_sfajwf_m.sfajwf018,g_sfajwf_m.l_sfajwf018, 
       g_sfajwf_m.sfajwf022,g_sfajwf_m.sfajwf023,g_sfajwf_m.sfajwf023_desc,g_sfajwf_m.sfajwf012,g_sfajwf_m.sfajwf012_desc,g_sfajwf_m.sfajwf013,g_sfajwf_m.sfajwf014,g_sfajwf_m.sfajwf001,g_sfajwf_m.sfajwf001_desc,g_sfajwf_m.sfajwf002,g_sfajwf_m.sfajwf002_desc,g_sfajwf_m.sfajwf025,g_sfajwf_m.sfajwf025_desc, 
       g_sfajwf_m.sfajwf015,g_sfajwf_m.sfajwfua002,g_sfajwf_m.sfajwf016,g_sfajwf_m.sfajwfua003,g_sfajwf_m.sfajwf024,g_sfajwf_m.sfajwf003,g_sfajwf_m.sfajwf005,g_sfajwf_m.sfajwf004,g_sfajwf_m.sfajwf008,g_sfajwf_m.sfajwf008_desc,g_sfajwf_m.sfajwf009,g_sfajwf_m.sfajwf009_desc,g_sfajwf_m.sfajwf010,g_sfajwf_m.sfajwf010_desc, 
       g_sfajwf_m.sfajwf011,g_sfajwf_m.sfajwf011_desc,g_sfajwf_m.sfajwfua011,g_sfajwf_m.sfajwfua012,g_sfajwf_m.sfajwfua013,g_sfajwf_m.sfajwfua014,g_sfajwf_m.sfajwfua015,g_sfajwf_m.sfajwfstus,g_sfajwf_m.sfajwfownid,g_sfajwf_m.sfajwfownid_desc,g_sfajwf_m.sfajwfowndp,g_sfajwf_m.sfajwfowndp_desc,g_sfajwf_m.sfajwfcrtid, 
       g_sfajwf_m.sfajwfcrtid_desc,g_sfajwf_m.sfajwfcrtdp,g_sfajwf_m.sfajwfcrtdp_desc,g_sfajwf_m.sfajwfcrtdt,g_sfajwf_m.sfajwfmodid,g_sfajwf_m.sfajwfmodid_desc,g_sfajwf_m.sfajwfmoddt,g_sfajwf_m.sfajwfcnfid,g_sfajwf_m.sfajwfcnfid_desc,g_sfajwf_m.sfajwfcnfdt
   
   #add-point:????? name="insert.after"
   IF NOT cl_null(g_sfajwf_m.sfajwfdocno) THEN
      CALL s_aooi200_get_slip_desc(g_slip) RETURNING g_sfajwf_m.oobal004
   END IF
   DISPLAY BY NAME g_sfajwf_m.oobal004
   #end add-point 
   
   LET g_data_owner = g_sfajwf_m.sfajwfownid      
   LET g_data_dept  = g_sfajwf_m.sfajwfowndp
   LET g_data_crtid = g_sfajwf_m.sfajwfcrtid   #180201-00054
   LET g_data_crtdp = g_sfajwf_m.sfajwfcrtdp   #180201-00054
   
   
   #?????,??????
   CALL bsft001_wf_msgcentre_notify('insert')
   
   CALL bsft001_wf_idx_chk()   #(ver:83)
   
END FUNCTION

{</section>}

{<section id="bsft001_wf.modify" type="s" >}
#+ ????
PRIVATE FUNCTION bsft001_wf_modify() RETURNS ()   #200213-00032
   #add-point:modify?define(???) name="modify.define_customerization"

   #end add-point    
   DEFINE l_new_key    DYNAMIC ARRAY OF STRING
   DEFINE l_old_key    DYNAMIC ARRAY OF STRING
   DEFINE l_field_key  DYNAMIC ARRAY OF STRING
   DEFINE l_wc2_table1          STRING
   DEFINE lp_cnt       LIKE type_t.num5   #190806-00019
   DEFINE l_wc2_table2   STRING
 
 
   DEFINE l_wc2_table3   STRING
 
   DEFINE l_wc2_table4   STRING
 
   DEFINE l_wc2_table5   STRING
 
 
   #add-point:modify?define (?????????????????, ?????patch????????) name="modify.define"

   #end add-point    
   
   #add-point:Function????  name="modify.pre_function"

   #end add-point
   
   #??????
   LET g_sfajwf_m_t.* = g_sfajwf_m.*
   LET g_sfajwf_m_o.* = g_sfajwf_m.*
   
   IF g_sfajwf_m.sfajwfdocno IS NULL
 
   THEN
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = "" 
      LET g_errparam.code = "std-00003" 
      LET g_errparam.popup = FALSE 
      CALL cl_err()
      RETURN
   END IF
 
   ERROR ""
  
   LET g_sfajwfdocno_t = g_sfajwf_m.sfajwfdocno
 
   CALL s_transaction_begin()
   
   #191101-00032 ---modify start---
   #190806-00019 ---start---
   #?????????????
   IF g_action_choice = "modify" OR g_action_choice = "modify_detail" THEN   #191114-00036
      LET lp_cnt = 0
      EXECUTE bsft001_wf_chk_data_exist_pre INTO lp_cnt USING g_enterprise, g_site,g_sfajwf_m.sfajwfdocno
      IF cl_null(lp_cnt) OR lp_cnt = 0 THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.extend = ""
         LET g_errparam.code = "-100"
         LET g_errparam.popup = TRUE
         CLOSE bsft001_wf_cl
         CALL s_transaction_end('N','0')
         CALL cl_err()
         RETURN
      END IF
   END IF
   #190806-00019 --- end ---
   #191101-00032 --- modify end ---
 
   OPEN bsft001_wf_cl USING g_enterprise, g_site,g_sfajwf_m.sfajwfdocno
   IF SQLCA.SQLCODE THEN   #(ver:78)
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = "OPEN bsft001_wf_cl:",SQLERRMESSAGE 
      LET g_errparam.code = SQLCA.SQLCODE   #(ver:78)
      LET g_errparam.popup = TRUE 
      CLOSE bsft001_wf_cl
      CALL s_transaction_end('N','0')
      CALL cl_err()
      RETURN
   END IF
 
   #200804-00006 ---start---
   FETCH bsft001_wf_cl
   IF SQLCA.SQLCODE THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.extend = "FETCH bsft001_wf_cl:",SQLERRMESSAGE
      LET g_errparam.code = SQLCA.SQLCODE
      LET g_errparam.popup = TRUE
      CLOSE bsft001_wf_cl
      #PostgreSQL???????, ????????????
      CALL s_transaction_end('N','0')
      CALL s_transaction_begin()
      CALL cl_err()
      RETURN
   END IF
   #200804-00006 --- end ---
 
   #???????
   EXECUTE bsft001_wf_master_referesh USING g_site,g_sfajwf_m.sfajwfdocno INTO g_sfajwf_m.sfajwfdocno,g_sfajwf_m.sfajwfdocdt,g_sfajwf_m.sfajwf006,g_sfajwf_m.sfajwf007,g_sfajwf_m.sfajwf017,g_sfajwf_m.sfajwf019,g_sfajwf_m.sfajwf020,g_sfajwf_m.sfajwf021,g_sfajwf_m.sfajwf018,g_sfajwf_m.sfajwf022,g_sfajwf_m.sfajwf023, 
       g_sfajwf_m.sfajwf012,g_sfajwf_m.sfajwf013,g_sfajwf_m.sfajwf014,g_sfajwf_m.sfajwf001,g_sfajwf_m.sfajwf002,g_sfajwf_m.sfajwf025,g_sfajwf_m.sfajwf015,g_sfajwf_m.sfajwfua002,g_sfajwf_m.sfajwf016,g_sfajwf_m.sfajwfua003,g_sfajwf_m.sfajwf024,g_sfajwf_m.sfajwf003,g_sfajwf_m.sfajwf005,g_sfajwf_m.sfajwf004, 
       g_sfajwf_m.sfajwf008,g_sfajwf_m.sfajwf009,g_sfajwf_m.sfajwf010,g_sfajwf_m.sfajwf011,g_sfajwf_m.sfajwfua011,g_sfajwf_m.sfajwfua012,g_sfajwf_m.sfajwfua013,g_sfajwf_m.sfajwfua014,g_sfajwf_m.sfajwfua015,g_sfajwf_m.sfajwfstus,g_sfajwf_m.sfajwfownid,g_sfajwf_m.sfajwfowndp,g_sfajwf_m.sfajwfcrtid,g_sfajwf_m.sfajwfcrtdp, 
       g_sfajwf_m.sfajwfcrtdt,g_sfajwf_m.sfajwfmodid,g_sfajwf_m.sfajwfmoddt,g_sfajwf_m.sfajwfcnfid,g_sfajwf_m.sfajwfcnfdt,g_sfajwf_m.sfajwf006_desc,g_sfajwf_m.sfajwf007_desc,g_sfajwf_m.sfajwf023_desc,g_sfajwf_m.sfajwf012_desc,g_sfajwf_m.sfajwf001_desc,g_sfajwf_m.sfajwf002_desc,g_sfajwf_m.sfajwf025_desc, 
       g_sfajwf_m.sfajwf008_desc,g_sfajwf_m.sfajwf009_desc,g_sfajwf_m.sfajwf010_desc,g_sfajwf_m.sfajwf011_desc,g_sfajwf_m.sfajwfownid_desc,g_sfajwf_m.sfajwfowndp_desc,g_sfajwf_m.sfajwfcrtid_desc,g_sfajwf_m.sfajwfcrtdp_desc,g_sfajwf_m.sfajwfmodid_desc,g_sfajwf_m.sfajwfcnfid_desc
   
   #?????????
   IF NOT bsft001_wf_action_chk() THEN
      CALL s_transaction_end('N','0')
      RETURN
   END IF
   
   #??????
   LET g_sfajwf_m_mask_o.* =  g_sfajwf_m.*
   CALL bsft001_wf_sfajwf_t_mask()
   LET g_sfajwf_m_mask_n.* =  g_sfajwf_m.*
   
   
   
   #add-point:modify?show?? name="modify.before_show"

   #end add-point  
   
   #LET l_wc2_table1 = g_wc2_table1
   #LET g_wc2_table1 = " 1=1"
   #LET l_wc2_table2 = g_wc2_table2
   #LET l_wc2_table2 = " 1=1"
 
 
   #LET l_wc2_table3 = g_wc2_table3
   #LET l_wc2_table3 = " 1=1"
 
   #LET l_wc2_table4 = g_wc2_table4
   #LET l_wc2_table4 = " 1=1"
 
   #LET l_wc2_table5 = g_wc2_table5
   #LET l_wc2_table5 = " 1=1"
 
 
   
   CALL bsft001_wf_show()
   #add-point:modify?show?? name="modify.after_show"

   #end add-point
   
   #LET g_wc2_table1 = l_wc2_table1
   #LET  g_wc2_table2 = l_wc2_table2 
 
 
   #LET  g_wc2_table3 = l_wc2_table3 
 
   #LET  g_wc2_table4 = l_wc2_table4 
 
   #LET  g_wc2_table5 = l_wc2_table5 
 
 
    
   WHILE TRUE
      LET g_sfajwfdocno_t = g_sfajwf_m.sfajwfdocno
 
      
      #?????/??????(??)
      LET g_sfajwf_m.sfajwfmodid = g_user 
LET g_sfajwf_m.sfajwfmoddt = cl_get_current()
LET g_sfajwf_m.sfajwfmodid_desc = cl_get_username(g_sfajwf_m.sfajwfmodid)
      
      #add-point:modify???? name="modify.before_input"

      #end add-point
      
      #????
      LET g_loc = 'n'
      LET g_update = FALSE
      LET g_master_commit = "N"
      CALL bsft001_wf_input("u")
      LET g_loc = 'n'
 
      #add-point:modify???? name="modify.after_input"
      #230921-00006#7 add--s
      IF INT_FLAG AND l_ac > 0 THEN
         CALL s_transaction_end('N','0')
         CALL s_transaction_begin()
         #????/BIN??
         DELETE FROM icbawf_t
          WHERE icbawfent = g_enterprise AND icbawfsite = g_site
            AND icbawfdocno = g_sfajwf_m.sfajwfdocno
            AND icbawfseq  = g_sfakwf2_d[l_ac].sfbcwfseq1 #??
            AND icbawfseq1 = g_sfakwf2_d[l_ac].sfbcwfseq2 #??
            AND icbawf032 = g_sfakwf_d[g_detail_idx].sfakwfseq  #????   
         IF SQLCA.SQLCODE THEN
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = "icbawf_t:",SQLERRMESSAGE 
            LET g_errparam.code = SQLCA.SQLCODE 
            LET g_errparam.popup = FALSE 
            CALL cl_err()
         END IF
         CALL s_transaction_end('Y','0') 
         LET INT_FLAG = 0
         #????commit???
         IF g_master_commit = "N" THEN
            LET g_sfajwf_m.* = g_sfajwf_m_t.*
         #  CALL bsft001_wf_show()   #(ver:83)
         END IF
         CALL bsft001_wf_show()   #(ver:83)
         CALL bsft001_wf_idx_chk()   #(ver:83)
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = '' 
         LET g_errparam.code = 9001 
         LET g_errparam.popup = FALSE 
         CALL cl_err()
         RETURN         
      END IF
      #230921-00006#7 add--e      
      #end add-point
      
      IF g_update OR NOT INT_FLAG THEN
         #??modid?moddt???update
         UPDATE sfajwf_t SET (sfajwfstus,sfajwfmodid,sfajwfmoddt) = (g_sfajwf_m.sfajwfstus,g_sfajwf_m.sfajwfmodid,g_sfajwf_m.sfajwfmoddt)
          WHERE sfajwfent = g_enterprise AND sfajwfsite = g_site AND sfajwfdocno = g_sfajwfdocno_t
 
      END IF
    
      IF INT_FLAG THEN
         CALL s_transaction_end('N','0')
         LET INT_FLAG = 0
         #????commit???
         IF g_master_commit = "N" THEN
            LET g_sfajwf_m.* = g_sfajwf_m_t.*
         #  CALL bsft001_wf_show()   #(ver:83)
         END IF
         CALL bsft001_wf_show()   #(ver:83)
         CALL bsft001_wf_idx_chk()   #(ver:83)
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = '' 
         LET g_errparam.code = 9001 
         LET g_errparam.popup = FALSE 
         CALL cl_err()
         RETURN
      END IF 
                  
      #???key?????
      IF g_sfajwf_m.sfajwfdocno != g_sfajwf_m_t.sfajwfdocno
 
      THEN
         CALL s_transaction_begin()
         
         #add-point:??fk??? name="modify.body.b_fk_update"

         #end add-point
         
         #????key?
         UPDATE sfakwf_t SET sfakwfdocno = g_sfajwf_m.sfajwfdocno
 
          WHERE sfakwfent = g_enterprise AND sfakwfsite = g_site AND sfakwfdocno = g_sfajwf_m_t.sfajwfdocno
 
            
         #add-point:??fk??? name="modify.body.m_fk_update"

         #end add-point
 
         CASE
            WHEN SQLCA.sqlerrd[3] = 0  #???????
            #   INITIALIZE g_errparam TO NULL 
            #   LET g_errparam.extend = "sfakwf_t" 
            #   LET g_errparam.code = "std-00009" 
            #   LET g_errparam.popup = TRUE 
            #   CALL cl_err()
            #   CALL s_transaction_end('N','0')
            #   CONTINUE WHILE
            WHEN SQLCA.SQLCODE #????
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "sfakwf_t:",SQLERRMESSAGE 
               LET g_errparam.code = SQLCA.SQLCODE 
               LET g_errparam.popup = TRUE 
               CALL s_transaction_end('N','0')
               CALL cl_err()
               CONTINUE WHILE
         END CASE
         
         #add-point:??fk??? name="modify.body.a_fk_update"

         #end add-point
         
         #????key?
         #add-point:??fk??? name="modify.body.b_fk_update2"

         #end add-point
         
         UPDATE sfamwf_t
            SET sfamwfdocno = g_sfajwf_m.sfajwfdocno
 
          WHERE sfamwfent = g_enterprise AND
                sfamwfdocno = g_sfajwfdocno_t
 
         #add-point:??fk??? name="modify.body.m_fk_update2"

         #end add-point
         CASE
            WHEN SQLCA.sqlerrd[3] = 0  #???????
            #   INITIALIZE g_errparam TO NULL 
            #   LET g_errparam.extend = "sfamwf_t" 
            #   LET g_errparam.code = "std-00009" 
            #   LET g_errparam.popup = TRUE 
            #   CALL cl_err()
            #   CALL s_transaction_end('N','0')
            #   CONTINUE WHILE
            WHEN SQLCA.SQLCODE #????
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "sfamwf_t:",SQLERRMESSAGE 
               LET g_errparam.code = SQLCA.SQLCODE 
               LET g_errparam.popup = TRUE 
               CALL s_transaction_end('N','0')
               CALL cl_err()
               CONTINUE WHILE
         END CASE
         #add-point:??fk??? name="modify.body.a_fk_update2"

         #end add-point
 
 
         
         #????key?
         #add-point:??fk??? name="modify.body.b_fk_update3"

         #end add-point
         UPDATE sfbcwf_t
            SET sfbcwfdocno = g_sfajwf_m.sfajwfdocno
 
          WHERE sfbcwfent = g_enterprise AND sfbcwfsite = g_site AND
                sfbcwfdocno = g_sfajwfdocno_t
 
         #add-point:??fk??? name="modify.body.m_fk_update3"

         #end add-point
         CASE
            WHEN SQLCA.sqlerrd[3] = 0  #???????
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "sfbcwf_t" 
               LET g_errparam.code = "std-00009" 
               LET g_errparam.popup = TRUE 
               CALL s_transaction_end('N','0')
               CALL cl_err()
               CONTINUE WHILE
            WHEN SQLCA.SQLCODE #????
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "sfbcwf_t:",SQLERRMESSAGE 
               LET g_errparam.code = SQLCA.SQLCODE 
               LET g_errparam.popup = TRUE 
               CALL s_transaction_end('N','0')
               CALL cl_err()
               CONTINUE WHILE
         END CASE
         #add-point:??fk??? name="modify.body.a_fk_update3"

         #end add-point
 
         #????key?
         #add-point:??fk??? name="modify.body.b_fk_update4"

         #end add-point
         UPDATE wfapwf_t
            SET wfapwfdocno = g_sfajwf_m.sfajwfdocno
 
          WHERE wfapwfent = g_enterprise AND wfapwfsite = g_site AND
                wfapwfdocno = g_sfajwfdocno_t
 
         #add-point:??fk??? name="modify.body.m_fk_update4"

         #end add-point
         CASE
            WHEN SQLCA.sqlerrd[3] = 0  #???????
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "wfapwf_t" 
               LET g_errparam.code = "std-00009" 
               LET g_errparam.popup = TRUE 
               CALL s_transaction_end('N','0')
               CALL cl_err()
               CONTINUE WHILE
            WHEN SQLCA.SQLCODE #????
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "wfapwf_t:",SQLERRMESSAGE 
               LET g_errparam.code = SQLCA.SQLCODE 
               LET g_errparam.popup = TRUE 
               CALL s_transaction_end('N','0')
               CALL cl_err()
               CONTINUE WHILE
         END CASE
         #add-point:??fk??? name="modify.body.a_fk_update4"

         #end add-point
 
         #????key?
         #add-point:??fk??? name="modify.body.b_fk_update5"

         #end add-point
         UPDATE sfanwf_t
            SET sfanwfdocno = g_sfajwf_m.sfajwfdocno
 
          WHERE sfanwfent = g_enterprise AND sfanwfsite = g_site AND
                sfanwfdocno = g_sfajwfdocno_t
 
         #add-point:??fk??? name="modify.body.m_fk_update5"

         #end add-point
         CASE
            WHEN SQLCA.sqlerrd[3] = 0  #???????
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "sfanwf_t" 
               LET g_errparam.code = "std-00009" 
               LET g_errparam.popup = TRUE 
               CALL s_transaction_end('N','0')
               CALL cl_err()
               CONTINUE WHILE
            WHEN SQLCA.SQLCODE #????
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "sfanwf_t:",SQLERRMESSAGE 
               LET g_errparam.code = SQLCA.SQLCODE 
               LET g_errparam.popup = TRUE 
               CALL s_transaction_end('N','0')
               CALL cl_err()
               CONTINUE WHILE
         END CASE
         #add-point:??fk??? name="modify.body.a_fk_update5"

         #end add-point
 
 
         
         #UPDATE ???table key?
         
            #161130-00056 add
         
            #161130-00056 add
         
            #161130-00056 add
         
            #161130-00056 add
         
            #161130-00056 add
 
         CALL s_transaction_end('Y','0')
      END IF
    
      EXIT WHILE
   END WHILE
 
   #180720-00009 ---start---
   #add-point:modify???? name="modify.after"

   #end add-point
   #180720-00009 --- end ---
 
   #????????action??
   CALL cl_set_act_visible("statechange,modify,modify_detail,delete,reproduce", TRUE)
   CALL bsft001_wf_set_act_visible()   
   CALL bsft001_wf_set_act_no_visible()
 
   #?????????
   LET g_add_browse = " sfajwfent = " ||g_enterprise|| " AND sfajwfsite = '" ||g_site|| "' AND",
                      " sfajwfdocno = '", g_sfajwf_m.sfajwfdocno, "' "
 
   #??????
   CALL bsft001_wf_browser_fill("")
 
   CLOSE bsft001_wf_cl
   
   CALL s_transaction_end('Y','0')
 
   #180720-00009 ---start---
   #add-point:modify???? name="modify.before_end"

   #end add-point
   #180720-00009 --- end ---
 
   #?????,??????
   CALL bsft001_wf_msgcentre_notify('modify')
   
   CALL bsft001_wf_idx_chk() #ver:83
 
END FUNCTION 

{</section>}

{<section id="bsft001_wf.input" type="s" >}
#+ ????
PRIVATE FUNCTION bsft001_wf_input(p_cmd) RETURNS ()   #200213-00032
   #add-point:input?define(???) name="input.define_customerization"

   #end add-point  
   DEFINE  p_cmd                 LIKE type_t.chr1
   DEFINE  l_cmd_t               LIKE type_t.chr1
   DEFINE  l_cmd                 LIKE type_t.chr1
   DEFINE  l_n                   LIKE type_t.num10                #?????  
   DEFINE  l_cnt                 LIKE type_t.num10                #?????  
   DEFINE  l_lock_sw             LIKE type_t.chr1                #?????  
   DEFINE  l_allow_insert        LIKE type_t.num5                #???? 
   DEFINE  l_allow_delete        LIKE type_t.num5                #????  
   DEFINE  l_count               LIKE type_t.num10
   DEFINE  l_i                   LIKE type_t.num10
   DEFINE  l_ac_t                LIKE type_t.num10
   DEFINE  l_insert              BOOLEAN
   DEFINE  ls_return             STRING
   DEFINE  l_var_keys            DYNAMIC ARRAY OF STRING
   DEFINE  l_field_keys          DYNAMIC ARRAY OF STRING
   DEFINE  l_vars                DYNAMIC ARRAY OF STRING
   DEFINE  l_fields              DYNAMIC ARRAY OF STRING
   DEFINE  l_var_keys_bak        DYNAMIC ARRAY OF STRING
   DEFINE  lb_reproduce          BOOLEAN
   DEFINE  li_reproduce          LIKE type_t.num10
   DEFINE  li_reproduce_target   LIKE type_t.num10
   DEFINE  ls_keys               DYNAMIC ARRAY OF VARCHAR(500)
   DEFINE  ls_mdl_str            STRING   #180411-00062
   DEFINE  lp_js                 STRING   #190412-00022
   #add-point:input?define (?????????????????, ?????patch????????) name="input.define"
   DEFINE l_sql1        STRING 
   DEFINE l_msg         STRING
   DEFINE l_success     LIKE type_t.num5
   DEFINE l_num         LIKE type_t.num5
   DEFINE l_sys         LIKE type_t.num5
   DEFINE l_n1          LIKE type_t.num5
   DEFINE l_str3        LIKE type_t.chr20
   DEFINE l_flag        LIKE type_t.chr1 
   DEFINE l_ooba002     LIKE ooba_t.ooba002       
   DEFINE l_rate        LIKE type_t.num26_10
   DEFINE l_ooca002     LIKE ooca_t.ooca002  
   DEFINE l_ooca004     LIKE ooca_t.ooca004
   DEFINE l_inaa007     LIKE inaa_t.inaa007
   DEFINE l_imae081     LIKE imae_t.imae081
   DEFINE l_imaa005     LIKE imaa_t.imaa005
   DEFINE l_imaa006     LIKE imaa_t.imaa006
   DEFINE l_imaa004     LIKE imaa_t.imaa004   
   DEFINE l_bmbawf037     LIKE bmba_t.bmbawf037
   DEFINE l_bmbawf038     LIKE bmba_t.bmbawf038
   DEFINE l_imae084     LIKE imae_t.imae084
   DEFINE l_imaf153     LIKE imaf_t.imaf153
   DEFINE l_pmdn013     LIKE pmdn_t.pmdn013
   DEFINE l_imaf173     LIKE imaf_t.imaf173
   DEFINE l_imaf174     LIKE imaf_t.imaf174
   DEFINE l_imaf016     LIKE imaf_t.imaf016
   DEFINE l_bmea011     LIKE bmea_t.bmea011
   DEFINE l_bmea012     LIKE bmea_t.bmea012
   DEFINE l_bmea013     LIKE bmea_t.bmea013
   DEFINE l_imaa005_1     LIKE imaa_t.imaa005
   DEFINE l_sfbcwf013        LIKE sfbcwf_t.sfbcwf013
   DEFINE l_n_sfbcwf013      LIKE type_t.num20
   DEFINE l_sfbcwf013_1      LIKE sfbcwf_t.sfbcwf013
   DEFINE l_sfbcwf013_bom    LIKE sfbcwf_t.sfbcwf013
   DEFINE l_sfbcwf022_bom    LIKE sfbcwf_t.sfbcwf022
   DEFINE l_sfbcwf023_bom    LIKE sfbcwf_t.sfbcwf023   
   DEFINE l_sfbcwf013_other  LIKE sfbcwf_t.sfbcwf013
   DEFINE l_sfbcwf023_sum     LIKE sfbcwf_t.sfbcwf023   
   DEFINE l_sfakwf006         LIKE sfakwf_t.sfakwf006 
   DEFINE l_sfakwf009         LIKE sfakwf_t.sfakwf009
   DEFINE l_sfakwf010         LIKE sfakwf_t.sfakwf010
   DEFINE l_sfakwf002         LIKE sfakwf_t.sfakwf002
   DEFINE l_bmba012       LIKE bmba_t.bmba012
   DEFINE l_bmba011       LIKE bmba_t.bmba011
   DEFINE l_imafwf210     LIKE imaf_t.imafwf210
   DEFINE l_amount_die    LIKE icbawf_t.icbawf011
   DEFINE l_imaf053       LIKE imaf_t.imaf053
   DEFINE l_icbawf003     LIKE icbawf_t.icbawf003
   DEFINE l_icbawf018     LIKE icbawf_t.icbawf018
   DEFINE l_amount        LIKE inbb_t.inbb011
   DEFINE l_amount_2      LIKE inbb_t.inbb011
   DEFINE l_sfbcwf019     LIKE sfbcwf_t.sfbcwf019
   DEFINE l_sfbcwf020     LIKE sfbcwf_t.sfbcwf020
   DEFINE l_sfbcwf029     LIKE sfbcwf_t.sfbcwf029
   DEFINE l_sfbcwf030     LIKE sfbcwf_t.sfbcwf030
   DEFINE l_imafwf201     LIKE imaf_t.imafwf201
   DEFINE l_sql           STRING
   DEFINE l_bmaa001       LIKE bmaa_t.bmaa001
   DEFINE l_bmaastus      LIKE bmaa_t.bmaastus
   DEFINE r_xmdq007    LIKE xmdq_t.xmdq007
   DEFINE l_where      STRING
   DEFINE l_para_data_2    LIKE type_t.chr80   #VMI????Tag
   DEFINE  l_bmba          DYNAMIC ARRAY OF RECORD
           bmba001         LIKE bmba_t.bmba001,    #bom????????????key???
           bmba002         LIKE bmba_t.bmba002,
           bmba003         LIKE bmba_t.bmba003,
           bmba004         LIKE bmba_t.bmba004,
           bmba005         DATETIME YEAR TO SECOND,
           bmba007         LIKE bmba_t.bmba007,
           bmba008         LIKE bmba_t.bmba008, 
           bmba035         LIKE bmba_t.bmba035,     #???  #160512-00016#14
           l_bmba011       LIKE bmba_t.bmba011,     #QPA ?????????????
           l_bmba012       LIKE bmba_t.bmba012,     #QPA ?????????????
           l_inam002       LIKE inam_t.inam002      #??????
                           END RECORD
   DEFINE  l_inam          DYNAMIC ARRAY OF RECORD   #??????
              inam001      LIKE inam_t.inam001,
              inam002      LIKE inam_t.inam002,
              inam004      LIKE inam_t.inam004
                           END RECORD
   DEFINE l_wfakwf002    LIKE wfakwf_t.wfakwf002 
   DEFINE l_sfakwf037_desc    LIKE type_t.chr80
   DEFINE l_oodb011        LIKE oodb_t.oodb011    #??????1:????2:?????
   DEFINE l_sfbcwf048      LIKE sfbcwf_t.sfbcwf048   
   DEFINE l_sfakwf034      LIKE sfakwf_t.sfakwf034 
   DEFINE l_xmdd006        LIKE xmdd_t.xmdd006     
   DEFINE l_j              LIKE type_t.num5   
   DEFINE l_sfajwf018_str  STRING
   DEFINE l_gzcbl004       LIKE gzcbl_t.gzcbl004
   DEFINE l_inaa015        LIKE inaa_t.inaa015  #????
   DEFINE l_inaa010    LIKE inaa_t.inaa010  #????
   #240423-00009#2 --s
   DEFINE l_imafwf211  LIKE imaf_t.imafwf211
   DEFINE l_wfaawfl002 LIKE wfaawfl_t.wfaawfl002
   #240423-00009#2 --e
   #240423-00009#2 --s 
   DEFINE l_sfbcwfseq      LIKE sfbcwf_t.sfbcwfseq
   DEFINE l_sfbcwfseq1     LIKE sfbcwf_t.sfbcwfseq1
   DEFINE l_sfbcwfseq2     LIKE sfbcwf_t.sfbcwfseq2
   DEFINE l_sfbcwf006      LIKE sfbcwf_t.sfbcwf006
   DEFINE l_sfbcwf043      LIKE sfbcwf_t.sfbcwf043
   DEFINE l_qwhere   STRING
   #240423-00009#2 --e
   #240704-00015 add -s
   DEFINE l_errno_abg      LIKE gzze_t.gzze001
   DEFINE l_bgaf016        LIKE bgaf_t.bgaf016
   DEFINE l_pmdn058        LIKE pmdn_t.pmdn058
   DEFINE l_pmdn058_desc   LIKE type_t.chr500
   DEFINE l_pmdn058_desc_sql STRING   
   #240704-00015 add -e
   #240704-00015#1 add ---s
   DEFINE l_dfin5002 LIKE type_t.chr1
   DEFINE r_success LIKE type_t.num5
   DEFINE l_pmdl024 LIKE pmdl_t.pmdl024
   DEFINE l_controlno    LIKE ooha_t.ooha001
   DEFINE l_slip         LIKE type_t.chr20
   #240704-00015#1 add ---e
   #240709-00009#1 add--s
   DEFINE l_imaa011         LIKE imaa_t.imaa011  
   DEFINE l_sfanwf003       LIKE sfanwf_t.sfanwf003 
   DEFINE l_sfanwf003_cnt   LIKE sfanwf_t.sfanwf003 
   DEFINE l_sfanwf003_sum   LIKE sfanwf_t.sfanwf003
   DEFINE l_m               LIKE type_t.num5
   DEFINE l_k               LIKE type_t.num5
   DEFINE l_flag1           LIKE type_t.chr1
   DEFINE l_flag2           LIKE type_t.chr1
   DEFINE l_sfaadocno       LIKE sfaa_t.sfaadocno  
   DEFINE l_sfanwf RECORD  #??????
       sfanwfent LIKE sfanwf_t.sfanwfent, #????
       sfanwfsite LIKE sfanwf_t.sfanwfsite, #????
       sfanwfdocno LIKE sfanwf_t.sfanwfdocno, #??
       sfanwf001 LIKE sfanwf_t.sfanwf001, #????
       sfanwf002 LIKE sfanwf_t.sfanwf002, #??
       sfanwf003 LIKE sfanwf_t.sfanwf003, #?????
       sfanwf004 LIKE sfanwf_t.sfanwf004, #??
       sfanwf005 LIKE sfanwf_t.sfanwf005, #??????
       sfanwfseq LIKE sfanwf_t.sfanwfseq, #??
       sfanwf006 LIKE sfanwf_t.sfanwf006, #????
       #161109-00085#66 --s add
       sfanwfud001 LIKE sfanwf_t.sfanwfud001, #?????(??)001
       sfanwfud002 LIKE sfanwf_t.sfanwfud002, #?????(??)002
       sfanwfud003 LIKE sfanwf_t.sfanwfud003, #?????(??)003
       sfanwfud004 LIKE sfanwf_t.sfanwfud004, #?????(??)004
       sfanwfud005 LIKE sfanwf_t.sfanwfud005, #?????(??)005
       sfanwfud006 LIKE sfanwf_t.sfanwfud006, #?????(??)006
       sfanwfud007 LIKE sfanwf_t.sfanwfud007, #?????(??)007
       sfanwfud008 LIKE sfanwf_t.sfanwfud008, #?????(??)008
       sfanwfud009 LIKE sfanwf_t.sfanwfud009, #?????(??)009
       sfanwfud010 LIKE sfanwf_t.sfanwfud010, #?????(??)010
       sfanwfud011 LIKE sfanwf_t.sfanwfud011, #?????(??)011
       sfanwfud012 LIKE sfanwf_t.sfanwfud012, #?????(??)012
       sfanwfud013 LIKE sfanwf_t.sfanwfud013, #?????(??)013
       sfanwfud014 LIKE sfanwf_t.sfanwfud014, #?????(??)014
       sfanwfud015 LIKE sfanwf_t.sfanwfud015, #?????(??)015
       sfanwfud016 LIKE sfanwf_t.sfanwfud016, #?????(??)016
       sfanwfud017 LIKE sfanwf_t.sfanwfud017, #?????(??)017
       sfanwfud018 LIKE sfanwf_t.sfanwfud018, #?????(??)018
       sfanwfud019 LIKE sfanwf_t.sfanwfud019, #?????(??)019
       sfanwfud020 LIKE sfanwf_t.sfanwfud020, #?????(??)020
       sfanwfud021 LIKE sfanwf_t.sfanwfud021, #?????(????)021
       sfanwfud022 LIKE sfanwf_t.sfanwfud022, #?????(????)022
       sfanwfud023 LIKE sfanwf_t.sfanwfud023, #?????(????)023
       sfanwfud024 LIKE sfanwf_t.sfanwfud024, #?????(????)024
       sfanwfud025 LIKE sfanwf_t.sfanwfud025, #?????(????)025
       sfanwfud026 LIKE sfanwf_t.sfanwfud026, #?????(????)026
       sfanwfud027 LIKE sfanwf_t.sfanwfud027, #?????(????)027
       sfanwfud028 LIKE sfanwf_t.sfanwfud028, #?????(????)028
       sfanwfud029 LIKE sfanwf_t.sfanwfud029, #?????(????)029
       sfanwfud030 LIKE sfanwf_t.sfanwfud030, #?????(????)030
       #161109-00085#66 --e add
       sfanwf007 LIKE sfanwf_t.sfanwf007,  #???
       sfanwfseq1 LIKE sfanwf_t.sfanwfseq1  #????
   END RECORD
   #240709-00009#1 add--e
   DEFINE l_sfbcwf_2   RECORD LIKE sfbcwf_t.*  #240725-00004#1 add
   DEFINE l_cnt1              LIKE type_t.num5  #241105-16320#1 add
   DEFINE l_flag_043         LIKE type_t.chr1  #C250109 add by wangjue
   DEFINE l_flag_kz    LIKE type_t.num5 #250220-00015#1 add 
   #end add-point  
   
   #add-point:Function????  name="input.pre_function"
   #VMI????Tag
   LET l_para_data_2 = cl_get_para(g_enterprise,g_site,'S-BAS-0044')   #191219-00008#1 add
   #end add-point
   
   #??????
   IF p_cmd = 'r' THEN
      LET l_cmd_t = 'r'
      LET p_cmd   = 'a'
   ELSE
      LET l_cmd_t = p_cmd
   END IF   
   
   #?????????
   DISPLAY BY NAME g_sfajwf_m.sfajwfdocno,g_sfajwf_m.oobal004,g_sfajwf_m.sfajwfdocdt,g_sfajwf_m.sfajwf006,g_sfajwf_m.sfajwf006_desc,g_sfajwf_m.sfajwf007,g_sfajwf_m.sfajwf007_desc,g_sfajwf_m.sfajwf017,g_sfajwf_m.sfajwf019,g_sfajwf_m.sfajwf020,g_sfajwf_m.sfajwf021,g_sfajwf_m.sfajwf018,g_sfajwf_m.l_sfajwf018, 
       g_sfajwf_m.sfajwf022,g_sfajwf_m.sfajwf023,g_sfajwf_m.sfajwf023_desc,g_sfajwf_m.sfajwf012,g_sfajwf_m.sfajwf012_desc,g_sfajwf_m.sfajwf013,g_sfajwf_m.sfajwf014,g_sfajwf_m.sfajwf001,g_sfajwf_m.sfajwf001_desc,g_sfajwf_m.sfajwf002,g_sfajwf_m.sfajwf002_desc,g_sfajwf_m.sfajwf025,g_sfajwf_m.sfajwf025_desc, 
       g_sfajwf_m.sfajwf015,g_sfajwf_m.sfajwfua002,g_sfajwf_m.sfajwf016,g_sfajwf_m.sfajwfua003,g_sfajwf_m.sfajwf024,g_sfajwf_m.sfajwf003,g_sfajwf_m.sfajwf005,g_sfajwf_m.sfajwf004,g_sfajwf_m.sfajwf008,g_sfajwf_m.sfajwf008_desc,g_sfajwf_m.sfajwf009,g_sfajwf_m.sfajwf009_desc,g_sfajwf_m.sfajwf010,g_sfajwf_m.sfajwf010_desc, 
       g_sfajwf_m.sfajwf011,g_sfajwf_m.sfajwf011_desc,g_sfajwf_m.sfajwfua011,g_sfajwf_m.sfajwfua012,g_sfajwf_m.sfajwfua013,g_sfajwf_m.sfajwfua014,g_sfajwf_m.sfajwfua015,g_sfajwf_m.sfajwfstus,g_sfajwf_m.sfajwfownid,g_sfajwf_m.sfajwfownid_desc,g_sfajwf_m.sfajwfowndp,g_sfajwf_m.sfajwfowndp_desc,g_sfajwf_m.sfajwfcrtid, 
       g_sfajwf_m.sfajwfcrtid_desc,g_sfajwf_m.sfajwfcrtdp,g_sfajwf_m.sfajwfcrtdp_desc,g_sfajwf_m.sfajwfcrtdt,g_sfajwf_m.sfajwfmodid,g_sfajwf_m.sfajwfmodid_desc,g_sfajwf_m.sfajwfmoddt,g_sfajwf_m.sfajwfcnfid,g_sfajwf_m.sfajwfcnfid_desc,g_sfajwf_m.sfajwfcnfdt
   
   #ver:82
   #??????
   LET g_wc2 = " 1=1"
   LET g_wc2_table1 = " 1=1 "
   LET g_wc2_table2 = " 1=1 "
 
 
   #CALL bsft001_wf_b_fill()
   #ver:82
   
   #????
   IF g_main_hidden THEN
      CALL gfrm_curr.setElementHidden("mainlayout",0)
      CALL gfrm_curr.setElementHidden("worksheet",1)
      LET g_main_hidden = 0
   END IF
 
   CALL cl_set_head_visible("","YES")  
 
   LET l_insert = FALSE
   LET g_action_choice = ""
 
   #add-point:input?define_sql name="input.define_sql"

   #end add-point 
   LET g_forupd_sql = "SELECT sfakwfseq,sfakwf001,sfakwf002,sfakwf003,sfakwf004,sfakwf005,sfakwf006,sfakwf007,sfakwf008,sfakwf009,sfakwf010,sfakwf011,sfakwf012,sfakwf013,sfakwf014,sfakwf015,sfakwf016,sfakwf017,sfakwf018,sfakwf019,sfakwf020,sfakwf021,sfakwf022,sfakwf023,sfakwf024,sfakwf025,sfakwf026, 
       sfakwf027,sfakwf028,sfakwf029,sfakwf030,sfakwf031,sfakwf044,sfakwf032,sfakwf033,sfakwf034,sfakwf035,sfakwf036,sfakwf037,sfakwf038,sfakwf039,sfakwf040,sfakwf041,sfakwf042,sfakwf043,sfakwf045,sfakwf046,sfakwf047,sfakwf048,sfakwf049,sfakwfud001 FROM sfakwf_t WHERE sfakwfent=? AND sfakwfsite=? AND  
       sfakwfdocno=? AND sfakwfseq=? FOR UPDATE"
   #add-point:input?define_sql name="input.after_define_sql"

   #end add-point 
   LET g_forupd_sql = cl_sql_forupd(g_forupd_sql)
   LET g_forupd_sql = cl_sql_add_mask(g_forupd_sql)              #??????
   DECLARE bsft001_wf_bcl CURSOR FROM g_forupd_sql
   
   #add-point:input?define_sql name="input.define_sql2"

   #end add-point    
   LET g_forupd_sql = "SELECT sfamwfseq,sfamwf001,sfamwf002,sfamwf003,sfamwf004,sfamwf005,sfamwf006,sfamwf007,sfamwf008 FROM sfamwf_t WHERE sfamwfent=? AND sfamwfdocno=? AND sfamwfseq=? FOR UPDATE"
   #add-point:input?define_sql name="input.after_define_sql2"

   #end add-point
   LET g_forupd_sql = cl_sql_forupd(g_forupd_sql)
   LET g_forupd_sql = cl_sql_add_mask(g_forupd_sql)              #??????
   DECLARE bsft001_wf_bcl2 CURSOR FROM g_forupd_sql
 
 
   
   #add-point:input?define_sql name="input.define_sql3"

   #end add-point 
   LET g_forupd_sql = "SELECT sfbcwfseq1,sfbcwfseq2,sfbcwf002,sfbcwf003,sfbcwf004,sfbcwf005,sfbcwf022,sfbcwf006,sfbcwf033,sfbcwf021,sfbcwf007,sfbcwf008,sfbcwf009,sfbcwf010,sfbcwf011,sfbcwf012,sfbcwf023,sfbcwf024,sfbcwf013,sfbcwf047,sfbcwf048,sfbcwf014,sfbcwf015,sfbcwf016,sfbcwf025,sfbcwf017,sfbcwf018, 
       sfbcwf019,sfbcwf020,sfbcwf029,sfbcwf039,sfbcwf030,sfbcwf040,sfbcwf041,sfbcwf042,sfbcwf028,sfbcwf001,sfbcwf026,sfbcwf027,sfbcwf034,sfbcwf035,sfbcwf043,sfbcwf049 FROM sfbcwf_t WHERE sfbcwfent=? AND sfbcwfsite=? AND sfbcwfdocno=? AND sfbcwfseq=? AND sfbcwfseq1=? AND sfbcwfseq2=? FOR UPDATE"
   #add-point:input?define_sql name="input.after_define_sql3"

   #end add-point 
   LET g_forupd_sql = cl_sql_forupd(g_forupd_sql)
   LET g_forupd_sql = cl_sql_add_mask(g_forupd_sql)              #??????
   DECLARE bsft001_wf_bcl3 CURSOR FROM g_forupd_sql
 
   #add-point:input?define_sql name="input.define_sql4"

   #end add-point 
   LET g_forupd_sql = "SELECT wfapwfseq1,wfapwf001,wfapwf002,wfapwf003,wfapwf004,wfapwf005,wfapwf006,wfapwf007,wfapwf008,wfapwf009,wfapwf010,wfapwf011,wfapwf012,wfapwf013,wfapwf014,wfapwf015,wfapwf016,wfapwf017,wfapwf018,wfapwf022,wfapwf019,wfapwf021,wfapwf020,wfapwf023,wfapwf024,wfapwf025,wfapwf026  
       FROM wfapwf_t WHERE wfapwfent=? AND wfapwfsite=? AND wfapwfdocno=? AND wfapwfseq=? AND wfapwfseq1=? FOR UPDATE"
   #add-point:input?define_sql name="input.after_define_sql4"

   #end add-point 
   LET g_forupd_sql = cl_sql_forupd(g_forupd_sql)
   LET g_forupd_sql = cl_sql_add_mask(g_forupd_sql)              #??????
   DECLARE bsft001_wf_bcl4 CURSOR FROM g_forupd_sql
 
   #add-point:input?define_sql name="input.define_sql5"

   #end add-point 
   LET g_forupd_sql = "SELECT sfanwfseq,sfanwf002,sfanwf001,sfanwf006,sfanwf003,sfanwf004,sfanwf005 FROM sfanwf_t WHERE sfanwfent=? AND sfanwfsite=? AND sfanwfdocno=? AND sfanwfseq1=? AND sfanwfseq=? FOR UPDATE"
   #add-point:input?define_sql name="input.after_define_sql5"

   #end add-point 
   LET g_forupd_sql = cl_sql_forupd(g_forupd_sql)
   LET g_forupd_sql = cl_sql_add_mask(g_forupd_sql)              #??????
   DECLARE bsft001_wf_bcl5 CURSOR FROM g_forupd_sql
 
 
 
   #add-point:input?define_sql name="input.other_sql"

   #end add-point 
 
   LET l_allow_insert = cl_auth_detail_input("insert")
   LET l_allow_delete = cl_auth_detail_input("delete")
   LET g_qryparam.state = 'i'
   
   #??key??????
   CALL bsft001_wf_set_entry(p_cmd)
   #add-point:set_entry? name="input.after_set_entry"

   #end add-point
   CALL bsft001_wf_set_no_entry(p_cmd)
 
   DISPLAY BY NAME g_sfajwf_m.sfajwfdocno,g_sfajwf_m.sfajwfdocdt,g_sfajwf_m.sfajwf006,g_sfajwf_m.sfajwf007,g_sfajwf_m.sfajwf017,g_sfajwf_m.sfajwf019,g_sfajwf_m.sfajwf020,g_sfajwf_m.sfajwf021,g_sfajwf_m.sfajwf018,g_sfajwf_m.l_sfajwf018,g_sfajwf_m.sfajwf022,g_sfajwf_m.sfajwf023,g_sfajwf_m.sfajwf012,g_sfajwf_m.sfajwf013, 
       g_sfajwf_m.sfajwf014,g_sfajwf_m.sfajwf001,g_sfajwf_m.sfajwf002,g_sfajwf_m.sfajwf025,g_sfajwf_m.sfajwf015,g_sfajwf_m.sfajwfua002,g_sfajwf_m.sfajwf016,g_sfajwf_m.sfajwfua003,g_sfajwf_m.sfajwf024,g_sfajwf_m.sfajwf003,g_sfajwf_m.sfajwf005,g_sfajwf_m.sfajwf004,g_sfajwf_m.sfajwf008,g_sfajwf_m.sfajwf009, 
       g_sfajwf_m.sfajwf010,g_sfajwf_m.sfajwf011,g_sfajwf_m.sfajwfua011,g_sfajwf_m.sfajwfua012,g_sfajwf_m.sfajwfua013,g_sfajwf_m.sfajwfua014,g_sfajwf_m.sfajwfua015,g_sfajwf_m.sfajwfstus
   
   LET lb_reproduce = FALSE
   LET l_ac_t = 1
   
   #???????????, ????USER??????????
   #??????, ????????add-point?????
   CALL cl_mask_set_no_entry()
   
   #add-point:????? name="input.before_input"

   #end add-point
   
   DIALOG ATTRIBUTES(UNBUFFERED,FIELD ORDER FORM)

{</section>}

{<section id="bsft001_wf.input.head" type="s" >}
      #???
      INPUT BY NAME g_sfajwf_m.sfajwfdocno,g_sfajwf_m.sfajwfdocdt,g_sfajwf_m.sfajwf006,g_sfajwf_m.sfajwf007,g_sfajwf_m.sfajwf017,g_sfajwf_m.sfajwf019,g_sfajwf_m.sfajwf020,g_sfajwf_m.sfajwf021,g_sfajwf_m.sfajwf018,g_sfajwf_m.l_sfajwf018,g_sfajwf_m.sfajwf022,g_sfajwf_m.sfajwf023,g_sfajwf_m.sfajwf012,g_sfajwf_m.sfajwf013, 
          g_sfajwf_m.sfajwf014,g_sfajwf_m.sfajwf001,g_sfajwf_m.sfajwf002,g_sfajwf_m.sfajwf025,g_sfajwf_m.sfajwf015,g_sfajwf_m.sfajwfua002,g_sfajwf_m.sfajwf016,g_sfajwf_m.sfajwfua003,g_sfajwf_m.sfajwf024,g_sfajwf_m.sfajwf003,g_sfajwf_m.sfajwf005,g_sfajwf_m.sfajwf004,g_sfajwf_m.sfajwf008,g_sfajwf_m.sfajwf009, 
          g_sfajwf_m.sfajwf010,g_sfajwf_m.sfajwf011,g_sfajwf_m.sfajwfua011,g_sfajwf_m.sfajwfua012,g_sfajwf_m.sfajwfua013,g_sfajwf_m.sfajwfua014,g_sfajwf_m.sfajwfua015,g_sfajwf_m.sfajwfstus 
         ATTRIBUTE(WITHOUT DEFAULTS)
         
         #??ACTION(master_input)
         
     
         BEFORE INPUT
            IF s_transaction_chk("N",0) THEN
               CALL s_transaction_begin()
            END IF
            OPEN bsft001_wf_cl USING g_enterprise, g_site,g_sfajwf_m.sfajwfdocno
            IF SQLCA.SQLCODE THEN   #(ver:78)
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "OPEN bsft001_wf_cl:",SQLERRMESSAGE 
               LET g_errparam.code = SQLCA.SQLCODE   #(ver:78)
               LET g_errparam.popup = TRUE 
               CLOSE bsft001_wf_cl
               CALL s_transaction_end('N','0')
               CALL cl_err()
               RETURN
            END IF
 
            #200804-00006 ---start---
            FETCH bsft001_wf_cl
            IF SQLCA.SQLCODE AND SQLCA.SQLCODE <> 100 THEN
               INITIALIZE g_errparam TO NULL
               LET g_errparam.extend = "FETCH bsft001_wf_cl:",SQLERRMESSAGE
               LET g_errparam.code = SQLCA.SQLCODE
               LET g_errparam.popup = TRUE
               CLOSE bsft001_wf_cl
               #PostgreSQL???????, ????????????
               CALL s_transaction_end('N','0')
               CALL s_transaction_begin()
               CALL cl_err()
               RETURN
            END IF
            #200804-00006 --- end ---
 
            
            IF l_cmd_t = 'r' THEN
               
            END IF
            #?????????????, ????????????
            #????????/????
            CALL bsft001_wf_set_entry(p_cmd)
            #add-point:????? name="input.m.before_input"
            CALL bsft001_wf_set_no_require()    
            CALL bsft001_wf_set_require()     
            #end add-point
            CALL bsft001_wf_set_no_entry(p_cmd)
    
                  #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwfdocno
            #add-point:BEFORE FIELD sfajwfdocno name="input.b.sfajwfdocno"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwfdocno
            
            #add-point:AFTER FIELD sfajwfdocno name="input.a.sfajwfdocno"
            #?? a05 ??????(Version:3)
            #???????
            IF  NOT cl_null(g_sfajwf_m.sfajwfdocno) THEN 
               IF p_cmd = 'a' OR ( p_cmd = 'u' AND (g_sfajwf_m.sfajwfdocno != g_sfajwfdocno_t )) THEN 
                  IF NOT bsft001_wf_sfajwfdocno_chk() THEN  #????
                     LET g_sfajwf_m.sfajwfdocno = g_sfajwf_m_o.sfajwfdocno
                     LET g_sfajwf_m.oobal004 = s_aooi200_get_slip_desc(g_sfajwf_m.sfajwfdocno)
                     DISPLAY BY NAME g_sfajwf_m.sfajwfdocno,g_sfajwf_m.oobal004
                     NEXT FIELD CURRENT
                  END IF                 
                  #????????
                  LET g_sfajwf_m.oobal004 = s_aooi200_get_slip_desc(g_sfajwf_m.sfajwfdocno)              
                  DISPLAY g_sfajwf_m.oobal004 TO oobal004
                  CALL bsft001_wf_sfajwfdocno_default()
                     RETURNING l_success
                  IF NOT l_success THEN
                     LET g_sfajwf_m.* = g_sfajwf_m_o.*                 
                     LET g_sfajwf_m.oobal004 = s_aooi200_get_slip_desc(g_sfajwf_m.sfajwfdocno) 
                     DISPLAY BY NAME g_sfajwf_m.sfajwfdocno,g_sfajwf_m.oobal004
                     NEXT FIELD CURRENT
                  END IF
               END IF              
            END IF
            LET g_sfajwf_m_o.sfajwfdocno = g_sfajwf_m.sfajwfdocno
            IF NOT cl_null(g_sfajwf_m.sfajwfdocno) THEN
               CALL s_aooi200_get_slip(g_sfajwf_m.sfajwfdocno) RETURNING l_success,g_slip
            END IF
            CALL bsft001_wf_set_entry(p_cmd)
            CALL bsft001_wf_set_no_require()    
            CALL bsft001_wf_set_require()       
            CALL bsft001_wf_set_no_entry(p_cmd)
            DISPLAY BY NAME g_sfajwf_m.sfajwfdocno,g_sfajwf_m.oobal004
            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfajwfdocno
            #add-point:ON CHANGE sfajwfdocno name="input.g.sfajwfdocno"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwfdocdt
            #add-point:BEFORE FIELD sfajwfdocdt name="input.b.sfajwfdocdt"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwfdocdt
            
            #add-point:AFTER FIELD sfajwfdocdt name="input.a.sfajwfdocdt"
            IF NOT cl_null(g_sfajwf_m.sfajwfdocdt) THEN
               IF g_sfajwf_m.sfajwfdocdt != g_sfajwf_m_o.sfajwfdocdt OR cl_null(g_sfajwf_m_o.sfajwfdocdt) THEN
                  IF g_sfakwf_d.getLength() > 0 THEN
                     IF NOT cl_null(g_sfakwf_d[l_ac].sfakwf031) THEN
                        IF g_sfajwf_m.sfajwfdocdt > g_sfakwf_d[l_ac].sfakwf031 THEN
                           INITIALIZE g_errparam TO NULL
                           LET g_errparam.code = 'asf-00308'  #????????????????
                           LET g_errparam.extend = g_sfakwf_d[l_ac].sfakwf031
                           LET g_errparam.popup = TRUE
                           CALL cl_err()
                           LET g_sfajwf_m.sfajwfdocdt = g_sfajwf_m_o.sfajwfdocdt
                           DISPLAY BY NAME g_sfajwf_m.sfajwfdocdt
                           NEXT FIELD CURRENT
                        END IF
                     END IF
                  END IF
               END IF
            END IF
            LET g_sfajwf_m_o.sfajwfdocdt = g_sfajwf_m.sfajwfdocdt
            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfajwfdocdt
            #add-point:ON CHANGE sfajwfdocdt name="input.g.sfajwfdocdt"

            #END add-point 
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwf006
            
            #add-point:AFTER FIELD sfajwf006 name="input.a.sfajwf006"
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_sfajwf_m.sfajwf006
            CALL ap_ref_array2(g_ref_fields,"SELECT pmaal004 FROM pmaal_t WHERE pmaalent="||g_enterprise||" AND pmaal001=? AND pmaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_sfajwf_m.sfajwf006_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_sfajwf_m.sfajwf006_desc
            IF NOT cl_null(g_sfajwf_m.sfajwf006) THEN
#               IF g_sfajwf_m.sfajwf006 != g_sfajwf_m_o.sfajwf006 OR cl_null(g_sfajwf_m_o.sfajwf006) THEN
#                  INITIALIZE g_chkparam.* TO NULL
#                  LET g_chkparam.arg1 = g_sfajwf_m.sfajwf006
#                  IF NOT cl_chk_exist("v_pmaa001_1") THEN
#                     LET g_sfajwf_m.sfajwf006 = g_sfajwf_m_o.sfajwf006
#                     LET g_sfajwf_m.sfajwf006_desc = s_desc_get_trading_partner_abbr_desc(g_sfajwf_m.sfajwf006)
#                     DISPLAY BY NAME g_sfajwf_m.sfajwf006,g_sfajwf_m.sfajwf006_desc
#                     NEXT FIELD CURRENT
#                  END IF
#               END IF
#               LET g_sfajwf_m.sfajwf006_desc = s_desc_get_trading_partner_abbr_desc(g_sfajwf_m.sfajwf006)
#               DISPLAY BY NAME g_sfajwf_m.sfajwf006_desc               
               #??g_chkparam.*?????????????????????????????
               INITIALIZE g_chkparam.* TO NULL
               
               #??g_chkparam.*???
               LET g_chkparam.arg1 = g_sfajwf_m.sfajwf006
               
               #??????????library
               IF NOT cl_chk_exist("v_pmaa001_27") THEN  #160727-00025#9
                  NEXT FIELD CURRENT
               END IF
               
               #151217-00014#1 ---add (S)---
               IF NOT cl_chk_exist("v_pmab001_3") THEN  #160727-00025#9
                  #?????????
                  NEXT FIELD CURRENT
               END IF
               #151217-00014#1 ---add (E)---
               
               #?????????????????????????????????????????????  
               CALL s_control_chk_group('2','4',g_user,g_dept,g_sfajwf_m.sfajwf006,'','','','') RETURNING l_success,l_flag
               IF NOT l_success THEN      #????
                  NEXT FIELD CURRENT
               ELSE
                  IF NOT l_flag THEN      #????
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = 'apm-00268'
                     LET g_errparam.extend = g_sfajwf_m.sfajwf006
                     LET g_errparam.popup = TRUE
                     CALL cl_err()
                     NEXT FIELD CURRENT
                  END IF 
               END IF
               
               #?????????????????????????????????????
               CALL s_control_chk_doc('2',g_sfajwf_m.sfajwfdocno,g_sfajwf_m.sfajwf006,'','','','') RETURNING l_success,l_flag
               IF NOT l_success THEN      #????
                  NEXT FIELD CURRENT
               ELSE
                  IF NOT l_flag THEN      #????
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = 'apm-00239'
                     LET g_errparam.extend = g_sfajwf_m.sfajwf006
                     LET g_errparam.popup = TRUE
                     CALL cl_err()
                     NEXT FIELD CURRENT
                  END IF 
               END IF
              #??????apmm202??????pmab037,?????apmm200??
               SELECT pmab037 INTO g_sfajwf_m.sfajwf007  #????
                 FROM pmab_t 
                WHERE pmabent = g_enterprise
                  AND pmabsite = g_site
                  AND pmab001 = g_sfajwf_m.sfajwf006
               IF CL_NULL(g_sfajwf_m.sfajwf007) THEN
                  SELECT pmab037 INTO g_sfajwf_m.sfajwf007  #????
                    FROM pmab_t 
                   WHERE pmabent = g_enterprise
                     AND pmabsite = 'ALL'
                     AND pmab001 = g_sfajwf_m.sfajwf006
               END IF 
               LET g_sfajwf_m.sfajwf007_desc = s_desc_get_ooib002_desc(g_sfajwf_m.sfajwf007)   
               DISPLAY BY NAME g_sfajwf_m.sfajwf007_desc
            END IF
            LET g_sfajwf_m_o.sfajwf006 = g_sfajwf_m.sfajwf006
            DISPLAY BY NAME g_sfajwf_m.sfajwf006_desc

            #END add-point
            
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwf006
            #add-point:BEFORE FIELD sfajwf006 name="input.b.sfajwf006"

            #END add-point
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfajwf006
            #add-point:ON CHANGE sfajwf006 name="input.g.sfajwf006"

            #END add-point 
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwf007
            
            #add-point:AFTER FIELD sfajwf007 name="input.a.sfajwf007"
#            INITIALIZE g_ref_fields TO NULL
#            LET g_ref_fields[1] = g_sfajwf_m.sfajwf007
#            CALL ap_ref_array2(g_ref_fields,"SELECT ooibl004 FROM ooibl_t WHERE ooiblent="||g_enterprise||" AND ooibl002=? AND ooibl003='"||g_dlang||"'","") RETURNING g_rtn_fields
#            LET g_sfajwf_m.sfajwf007_desc = '', g_rtn_fields[1] , ''
#            DISPLAY BY NAME g_sfajwf_m.sfajwf007_desc
            
            CALL s_desc_get_ooib002_desc(g_sfajwf_m.sfajwf007) RETURNING g_sfajwf_m.sfajwf007_desc
            DISPLAY BY NAME g_sfajwf_m.sfajwf007_desc
            
            IF NOT cl_null(g_sfajwf_m.sfajwf007) THEN 
               #??g_chkparam.*?????????????????????????????
               INITIALIZE g_chkparam.* TO NULL             
               #??g_chkparam.*???
               LET g_chkparam.arg1 = g_sfajwf_m.sfajwf006
               LET g_chkparam.arg2 = g_sfajwf_m.sfajwf007

               #??????????library
               IF cl_chk_exist("v_pmad002_1") THEN
                  #?????????
                 
               ELSE
                  #?????????
                  LET g_sfajwf_m.sfajwf007 = g_sfajwf_m_t.sfajwf007
                  CALL s_desc_get_ooib002_desc(g_sfajwf_m.sfajwf007) RETURNING g_sfajwf_m.sfajwf007_desc
                  DISPLAY BY NAME g_sfajwf_m.sfajwf007_desc
                  NEXT FIELD CURRENT
               END IF
            END IF 
            
            LET g_sfajwf_m_o.sfajwf007 = g_sfajwf_m.sfajwf007 

            #END add-point
            
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwf007
            #add-point:BEFORE FIELD sfajwf007 name="input.b.sfajwf007"

            #END add-point
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfajwf007
            #add-point:ON CHANGE sfajwf007 name="input.g.sfajwf007"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwf017
            #add-point:BEFORE FIELD sfajwf017 name="input.b.sfajwf017"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwf017
            
            #add-point:AFTER FIELD sfajwf017 name="input.a.sfajwf017"
            IF g_sfajwf_m.sfajwf017 IS NULL THEN  
               LET g_sfajwf_m.sfajwf018 = ''      #????
               LET g_sfajwf_m.sfajwf019 = ''      #????
               LET g_sfajwf_m.sfajwf020 = ''      #????
               LET g_sfajwf_m.sfajwf021 = ''      #?????
               LET g_sfajwf_m.l_sfajwf018 = ''    #????                 
               DISPLAY BY NAME g_sfajwf_m.sfajwf018,g_sfajwf_m.sfajwf019,g_sfajwf_m.sfajwf020,g_sfajwf_m.sfajwf021,g_sfajwf_m.l_sfajwf018
            END IF
            CALL bsft001_wf_set_entry(p_cmd)
            CALL bsft001_wf_set_no_entry(p_cmd)
            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfajwf017
            #add-point:ON CHANGE sfajwf017 name="input.g.sfajwf017"
            IF g_sfajwf_m.sfajwf017 MATCHES '[1]' THEN   #151207-00017#2
               IF NOT bswf001_wf_sfajwf018_chk1() THEN
                  LET g_sfajwf_m.sfajwf018 = ''      #????
                  LET g_sfajwf_m.sfajwf019 = ''      #????
                  LET g_sfajwf_m.sfajwf020 = ''      #????
                  LET g_sfajwf_m.sfajwf021 = ''      #?????
                  LET g_sfajwf_m.l_sfajwf018 = ''    #????                 
                  DISPLAY BY NAME g_sfajwf_m.sfajwf018,g_sfajwf_m.sfajwf019,g_sfajwf_m.sfajwf020,g_sfajwf_m.sfajwf021,g_sfajwf_m.l_sfajwf018
              #200225-00005#1 add -e
               END IF
            END IF
            CALL bsft001_wf_set_entry(p_cmd)     
            CALL bsft001_wf_set_no_entry(p_cmd)
            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwf019
            #add-point:BEFORE FIELD sfajwf019 name="input.b.sfajwf019"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwf019
            
            #add-point:AFTER FIELD sfajwf019 name="input.a.sfajwf019"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfajwf019
            #add-point:ON CHANGE sfajwf019 name="input.g.sfajwf019"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwf020
            #add-point:BEFORE FIELD sfajwf020 name="input.b.sfajwf020"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwf020
            
            #add-point:AFTER FIELD sfajwf020 name="input.a.sfajwf020"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfajwf020
            #add-point:ON CHANGE sfajwf020 name="input.g.sfajwf020"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwf021
            #add-point:BEFORE FIELD sfajwf021 name="input.b.sfajwf021"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwf021
            
            #add-point:AFTER FIELD sfajwf021 name="input.a.sfajwf021"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfajwf021
            #add-point:ON CHANGE sfajwf021 name="input.g.sfajwf021"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwf018
            #add-point:BEFORE FIELD sfajwf018 name="input.b.sfajwf018"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwf018
            
            #add-point:AFTER FIELD sfajwf018 name="input.a.sfajwf018"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfajwf018
            #add-point:ON CHANGE sfajwf018 name="input.g.sfajwf018"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD l_sfajwf018
            #add-point:BEFORE FIELD l_sfajwf018 name="input.b.l_sfajwf018"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD l_sfajwf018
            
            #add-point:AFTER FIELD l_sfajwf018 name="input.a.l_sfajwf018"
            #??/??/??? ????????1???2????3??1-2-3
            #240201-00005#1 add--s  
            IF NOT cl_null(g_sfajwf_m.l_sfajwf018) THEN
               IF g_sfajwf_m.l_sfajwf018 != g_sfajwf_m_o.l_sfajwf018 OR cl_null(g_sfajwf_m_o.l_sfajwf018) THEN
                  #???-???
                  LET l_sfajwf018_str = g_sfajwf_m.l_sfajwf018
                  LET l_i = l_sfajwf018_str.getIndexOf("-",2)
                  IF l_i > 0 THEN
                     LET g_sfajwf_m.sfajwf019 = l_sfajwf018_str.substring(1,l_i-1)#.trim()
                     LET l_j = l_sfajwf018_str.getIndexOf("-",l_i+1)
                     IF l_j > 0 THEN
                        LET g_sfajwf_m.sfajwf020 = l_sfajwf018_str.substring(l_i+1,l_j-1)#.trim()
                        LET g_sfajwf_m.sfajwf021 = l_sfajwf018_str.substring(l_j+1,l_sfajwf018_str.getLength())#.trim()
                     ELSE
                        LET g_sfajwf_m.sfajwf020 = l_sfajwf018_str.substring(l_i+1,l_sfajwf018_str.getLength())#.trim()
                        LET g_sfajwf_m.sfajwf021 = ''
                     END IF
                  ELSE
                     LET g_sfajwf_m.sfajwf019 = l_sfajwf018_str.trim()
                     LET g_sfajwf_m.sfajwf020 = ''
                     LET g_sfajwf_m.sfajwf021 = ''
                  END IF
#                  IF NOT asft300_sfaa006_chk() THEN
                     LET g_sfajwf_m.sfajwf018 = g_sfajwf_m_o.sfajwf018
                     LET g_sfajwf_m.sfajwf019 = g_sfajwf_m_o.sfajwf019
                     LET g_sfajwf_m.sfajwf020 = g_sfajwf_m_o.sfajwf020
                     LET g_sfajwf_m.sfajwf021 = g_sfajwf_m_o.sfajwf021
                     LET g_sfajwf_m.l_sfajwf018 = g_sfajwf_m_o.l_sfajwf018
                     DISPLAY BY NAME g_sfajwf_m.sfajwf018,g_sfajwf_m.sfajwf019,g_sfajwf_m.sfajwf020,g_sfajwf_m.sfajwf021,g_sfajwf_m.l_sfajwf018
                     NEXT FIELD CURRENT
#                  END IF
               END IF
            END IF
            LET g_sfajwf_m_o.l_sfajwf018 = g_sfajwf_m.l_sfajwf018
            CALL bsft001_wf_set_entry(p_cmd)     #180813-00045#1
            CALL bsft001_wf_set_no_entry(p_cmd)  #180813-00045#1
            #240201-00005#1 add--e
            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE l_sfajwf018
            #add-point:ON CHANGE l_sfajwf018 name="input.g.l_sfajwf018"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwf022
            #add-point:BEFORE FIELD sfajwf022 name="input.b.sfajwf022"
            
            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwf022
            
            #add-point:AFTER FIELD sfajwf022 name="input.a.sfajwf022"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfajwf022
            #add-point:ON CHANGE sfajwf022 name="input.g.sfajwf022"

            #END add-point 
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwf023
            
            #add-point:AFTER FIELD sfajwf023 name="input.a.sfajwf023"
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_sfajwf_m.sfajwf023
            CALL ap_ref_array2(g_ref_fields,"SELECT icaal003 FROM icaal_t WHERE icaalent="||g_enterprise||" AND icaal001=? AND icaal001='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_sfajwf_m.sfajwf023_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_sfajwf_m.sfajwf023_desc
            CALL s_desc_get_icaa001_desc(g_sfajwf_m.sfajwf023) RETURNING g_sfajwf_m.sfajwf023_desc
            DISPLAY BY NAME g_sfajwf_m.sfajwf023_desc
            
            IF NOT cl_null(g_sfajwf_m.sfajwf023) THEN
               IF g_sfajwf_m.sfajwf023 <> g_sfajwf_m_o.sfajwf023 OR cl_null(g_sfajwf_m_o.sfajwf023) THEN
                  #???????a19??
                  #??g_chkparam.*?????????????????????????????
                  INITIALIZE g_chkparam.* TO NULL
                  #160318-00025#15 by 07900 --add-str 
                  LET g_errshow = TRUE #????
                  #160318-00025#15 by 07900 --add-end
                  #??????????library
                  #2:???
                  IF g_sfajwf_m.sfajwf022 = '2' THEN
                     #??g_chkparam.*???
                     LET g_chkparam.arg1 = g_sfajwf_m.sfajwf023
                     LET g_chkparam.arg2 = '2'
                     LET g_chkparam.arg3 = '0'
                     LET g_chkparam.arg4 = g_site
                     
                     #??????
                     LET l_gzcbl004 = ''
                     SELECT gzcbl004 INTO l_gzcbl004
                       FROM gzcbl_t
                      WHERE gzcbl001 = '2501'
                        AND gzcbl002 = '2'
                        AND gzcbl003 = g_dlang
                     LET l_gzcbl004 = g_chkparam.arg2,".",l_gzcbl004
                     LET g_chkparam.err_str[1] = "aic-00084|",l_gzcbl004
                     LET g_chkparam.err_str[2] = "aic-00085|",g_chkparam.arg3
                   
                  END IF
                  
                  LET g_chkparam.where = " icaa003 = '2' AND icaawf019 = 'Y' "
                  #160318-00025#15 by 07900 --add-str 
                  LET g_chkparam.err_str[3] ="aic-00012:sub-01302|aici100_wf|",cl_get_progname("aici100_wf",g_lang,"2"),"|:EXEPROGaici100"
                  #160318-00025#15 by 07900 --add-end
                                    
                  IF NOT cl_chk_exist("v_icaa001_1") THEN
                     LET g_sfajwf_m.sfajwf023 = g_sfajwf_m_o.sfajwf023
                     CALL s_desc_get_icaa001_desc(g_sfajwf_m.sfajwf023) RETURNING g_sfajwf_m.sfajwf023_desc
                     DISPLAY BY NAME g_sfajwf_m.sfajwf023_desc
                     NEXT FIELD CURRENT
                  END IF

               END IF
            END IF
            
            LET g_sfajwf_m_o.sfajwf023 = g_sfajwf_m.sfajwf023
            #END add-point
            
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwf023
            #add-point:BEFORE FIELD sfajwf023 name="input.b.sfajwf023"

            #END add-point
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfajwf023
            #add-point:ON CHANGE sfajwf023 name="input.g.sfajwf023"

            #END add-point 
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwf012
            
            #add-point:AFTER FIELD sfajwf012 name="input.a.sfajwf012"
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_sfajwf_m.sfajwf012
            CALL ap_ref_array2(g_ref_fields,"SELECT wfajwfl003 FROM wfajwfl_t WHERE wfajwflent="||g_enterprise||" AND wfakwfl001=? AND wfakwfl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_sfajwf_m.sfajwf012_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_sfajwf_m.sfajwf012_desc
            IF NOT cl_null(g_sfajwf_m.sfajwf012) THEN 
               #??????
               #??g_chkparam.*?????????????????????????????
               INITIALIZE g_chkparam.* TO NULL
 
               #??g_chkparam.*???
               LET g_chkparam.arg1 = g_sfajwf_m.sfajwf012
#               LET g_chkparam.arg2 = g_sfajwf_m.sfajwfdocdt  #????
               
               #??????????library
               IF cl_chk_exist("v_wfakwf001_01_wf") THEN
                  #?????????
               ELSE
                  #?????????
                  NEXT FIELD CURRENT
               END IF
            END IF 

            #END add-point
            
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwf012
            #add-point:BEFORE FIELD sfajwf012 name="input.b.sfajwf012"

            #END add-point
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfajwf012
            #add-point:ON CHANGE sfajwf012 name="input.g.sfajwf012"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwf013
            #add-point:BEFORE FIELD sfajwf013 name="input.b.sfajwf013"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwf013
            
            #add-point:AFTER FIELD sfajwf013 name="input.a.sfajwf013"
            IF NOT cl_null(g_sfajwf_m.sfajwf013) THEN
               IF (g_sfajwf_m.sfajwf013 != g_sfajwf_m_o.sfajwf013 OR cl_null(g_sfajwf_m_o.sfajwf013)) THEN    
                  SELECT COUNT(1) INTO l_n
                    FROM sfakwf_t 
                   WHERE sfakwfent = g_enterprise AND sfakwfsite = g_site AND sfakwfdocno = g_sfajwf_m.sfajwfdocno
                   #240423-00004#1-24042401-16508 add by lijlg -----start ???????????????????
                  SELECT COUNT(1) INTO l_cnt
                    FROM sfbcwf_t 
                   WHERE sfbcwfent = g_enterprise AND sfbcwfsite = g_site AND sfbcwfdocno = g_sfajwf_m.sfajwfdocno      
                   #240423-00004#1-24042401-16508 add by lijlg -----end
                  IF l_n > 0 AND l_cnt > 0 THEN          
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = ""
                     LET g_errparam.code = "wf-00039"   #???????????????????????
                     LET g_errparam.popup = TRUE 
                     CALL cl_err()
                     NEXT FIELD CURRENT 
                  ELSE
                     IF g_sfajwf_m.sfajwf013 = '2' THEN
                        LET g_sfajwf_m.sfajwf014 = '1'
                     ELSE
                        LET g_sfajwf_m.sfajwf014 = '2'
                     END IF
                     DISPLAY BY NAME g_sfajwf_m.sfajwf014
                  END IF
               END IF
            END IF     
            DISPLAY BY NAME g_sfajwf_m.sfajwf013
            CALL bsft001_wf_set_entry(p_cmd)
            CALL bsft001_wf_set_no_entry(p_cmd)
            LET g_sfajwf_m_o.sfajwf013 = g_sfajwf_m.sfajwf013
            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfajwf013
            #add-point:ON CHANGE sfajwf013 name="input.g.sfajwf013"
            CALL bsft001_wf_set_entry(p_cmd)
            CALL bsft001_wf_set_no_entry(p_cmd)
            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwf014
            #add-point:BEFORE FIELD sfajwf014 name="input.b.sfajwf014"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwf014
            
            #add-point:AFTER FIELD sfajwf014 name="input.a.sfajwf014"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfajwf014
            #add-point:ON CHANGE sfajwf014 name="input.g.sfajwf014"

            #END add-point 
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwf001
            
            #add-point:AFTER FIELD sfajwf001 name="input.a.sfajwf001"
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_sfajwf_m.sfajwf001
            CALL ap_ref_array2(g_ref_fields,"SELECT oofa011 FROM oofa_t WHERE oofaent="||g_enterprise||" AND oofa003=? ","") RETURNING g_rtn_fields
            LET g_sfajwf_m.sfajwf001_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_sfajwf_m.sfajwf001_desc
            
            LET g_sfajwf_m.sfajwf001_desc = ''            
            IF NOT cl_null(g_sfajwf_m.sfajwf001) THEN
               IF p_cmd = 'a' OR (g_sfajwf_m.sfajwf001 != g_sfajwf_m_o.sfajwf001 OR cl_null(g_sfajwf_m_o.sfajwf001)) THEN    
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_sfajwf_m.sfajwf001
                  LET g_chkparam.arg2 = g_site        
                  #160318-00025#4-s
                  LET g_errshow = TRUE 
                  LET g_chkparam.err_str[1] = "aim-00070:sub-01302|aooi130|",cl_get_progname("aooi130",g_lang,"2"),"|:EXEPROGaooi130"
                  #160318-00025#4-e
                  IF NOT cl_chk_exist("v_ooag001_6") THEN          
                     LET g_sfajwf_m.sfajwf001 = g_sfajwf_m_o.sfajwf001
                     LET g_sfajwf_m.sfajwf001_desc = s_desc_get_person_desc(g_sfajwf_m.sfajwf001)  
                     DISPLAY BY NAME g_sfajwf_m.sfajwf001,g_sfajwf_m.sfajwf001_desc
                     NEXT FIELD CURRENT
                  END IF
               END IF
               LET g_sfajwf_m.sfajwf001_desc = s_desc_get_person_desc(g_sfajwf_m.sfajwf001)  
               DISPLAY BY NAME g_sfajwf_m.sfajwf001_desc
                SELECT ooag003 INTO g_sfajwf_m.sfajwf002  #????
                  FROM ooag_t
                 WHERE ooagent = g_enterprise
                   AND ooag001 = g_sfajwf_m.sfajwf001
                 LET g_sfajwf_m.sfajwf002_desc = s_desc_get_department_desc(g_sfajwf_m.sfajwf002)
                 DISPLAY BY NAME g_sfajwf_m.sfajwf002,g_sfajwf_m.sfajwf002_desc 
            END IF     
            DISPLAY BY NAME g_sfajwf_m.sfajwf001,g_sfajwf_m.sfajwf001_desc  
            LET g_sfajwf_m_o.sfajwf001 = g_sfajwf_m.sfajwf001
            #END add-point
            
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwf001
            #add-point:BEFORE FIELD sfajwf001 name="input.b.sfajwf001"

            #END add-point
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfajwf001
            #add-point:ON CHANGE sfajwf001 name="input.g.sfajwf001"

            #END add-point 
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwf002
            
            #add-point:AFTER FIELD sfajwf002 name="input.a.sfajwf002"
#            INITIALIZE g_ref_fields TO NULL
#            LET g_ref_fields[1] = g_sfajwf_m.sfajwf002
#            CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent="||g_enterprise||" AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
#            LET g_sfajwf_m.sfajwf002_desc = '', g_rtn_fields[1] , ''
#            DISPLAY BY NAME g_sfajwf_m.sfajwf002_desc
            
            IF NOT cl_null(g_sfajwf_m.sfajwf002) THEN 
               IF g_sfajwf_m.sfajwf002 != g_sfajwf_m_o.sfajwf002 OR cl_null(g_sfajwf_m_o.sfajwf002) THEN    #160824-00007#278 161229 by lori add
                  #??g_chkparam.*?????????????????????????????
                  INITIALIZE g_chkparam.* TO NULL
   
                  #??g_chkparam.*???
                  LET g_chkparam.arg1 = g_sfajwf_m.sfajwf002
                  LET g_chkparam.arg2 = g_sfajwf_m.sfajwfdocdt   
                  LET g_errshow = TRUE #????                   
                  LET g_chkparam.err_str[1] ="aoo-00029:sub-01302|aooi125|",cl_get_progname("aooi125",g_lang,"2"),"|:EXEPROGaooi125"
                  #??????????library
                  IF NOT cl_chk_exist("v_ooeg001") THEN
                     LET g_sfajwf_m.sfajwf002 = g_sfajwf_m_o.sfajwf002
                     DISPLAY BY NAME g_sfajwf_m.sfajwf002
                     CALL s_desc_get_department_desc(g_sfajwf_m.sfajwf002) RETURNING g_sfajwf_m.sfajwf002_desc
                     DISPLAY BY NAME g_sfajwf_m.sfajwf002_desc
                     NEXT FIELD sfajwf002
                  END IF
               END IF
            END IF

            LET g_sfajwf_m_o.sfajwf002 = g_sfajwf_m.sfajwf002   

            #END add-point
            
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwf002
            #add-point:BEFORE FIELD sfajwf002 name="input.b.sfajwf002"

            #END add-point
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfajwf002
            #add-point:ON CHANGE sfajwf002 name="input.g.sfajwf002"

            #END add-point 
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwf025
            
            #add-point:AFTER FIELD sfajwf025 name="input.a.sfajwf025"
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_sfajwf_m.sfajwf025
            CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent="||g_enterprise||" AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_sfajwf_m.sfajwf025_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_sfajwf_m.sfajwf025_desc

            #250328-00010#1 add--s
            LET g_sfajwf_m.sfajwf025_desc = ''
            IF NOT cl_null(g_sfajwf_m.sfajwf025) THEN
               IF g_sfajwf_m.sfajwf025 != g_sfajwf_m_o.sfajwf025 OR cl_null(g_sfajwf_m_o.sfajwf025) THEN
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_sfajwf_m.sfajwf025
                  LET g_chkparam.arg2 = cl_get_today()
                  LET g_chkparam.arg3 = g_site    
                  LET g_errshow = TRUE 
                  LET g_chkparam.err_str[1] = "aoo-00029:sub-01302|aooi125|",cl_get_progname("aooi125",g_lang,"2"),"|:EXEPROGaooi125"
                  IF NOT cl_chk_exist("v_ooeg001_4") THEN
                     LET g_sfajwf_m.sfajwf025 = g_sfajwf_m_o.sfajwf025
                     LET g_sfajwf_m.sfajwf025_desc = s_desc_get_department_desc(g_sfajwf_m.sfajwf025)
                     DISPLAY BY NAME g_sfajwf_m.sfajwf025,g_sfajwf_m.sfajwf025_desc
                     NEXT FIELD CURRENT
                  END IF
               END IF
               LET g_sfajwf_m.sfajwf025_desc = s_desc_get_department_desc(g_sfajwf_m.sfajwf025)
               DISPLAY BY NAME g_sfajwf_m.sfajwf025_desc
            END IF
            LET g_sfajwf_m_o.sfajwf025 = g_sfajwf_m.sfajwf025
            DISPLAY BY NAME g_sfajwf_m.sfajwf025_desc 
            #250328-00010#1 add--e
            #END add-point
            
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwf025
            #add-point:BEFORE FIELD sfajwf025 name="input.b.sfajwf025"

            #END add-point
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfajwf025
            #add-point:ON CHANGE sfajwf025 name="input.g.sfajwf025"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwf015
            #add-point:BEFORE FIELD sfajwf015 name="input.b.sfajwf015"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwf015
            
            #add-point:AFTER FIELD sfajwf015 name="input.a.sfajwf015"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfajwf015
            #add-point:ON CHANGE sfajwf015 name="input.g.sfajwf015"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwfua002
            #add-point:BEFORE FIELD sfajwfua002 name="input.b.sfajwfua002"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwfua002
            
            #add-point:AFTER FIELD sfajwfua002 name="input.a.sfajwfua002"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfajwfua002
            #add-point:ON CHANGE sfajwfua002 name="input.g.sfajwfua002"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwf016
            #add-point:BEFORE FIELD sfajwf016 name="input.b.sfajwf016"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwf016
            
            #add-point:AFTER FIELD sfajwf016 name="input.a.sfajwf016"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfajwf016
            #add-point:ON CHANGE sfajwf016 name="input.g.sfajwf016"
            #250319-00001#1 add--s
            IF g_sfajwf_m.sfajwf016 = 'Y' THEN
               LET g_sfajwf_m.sfajwf003 = '2'
            ELSE
               LET g_sfajwf_m.sfajwf003 = '1' 
            END IF
            #250319-00001#1 add--e
            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwfua003
            #add-point:BEFORE FIELD sfajwfua003 name="input.b.sfajwfua003"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwfua003
            
            #add-point:AFTER FIELD sfajwfua003 name="input.a.sfajwfua003"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfajwfua003
            #add-point:ON CHANGE sfajwfua003 name="input.g.sfajwfua003"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwf024
            #add-point:BEFORE FIELD sfajwf024 name="input.b.sfajwf024"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwf024
            
            #add-point:AFTER FIELD sfajwf024 name="input.a.sfajwf024"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfajwf024
            #add-point:ON CHANGE sfajwf024 name="input.g.sfajwf024"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwf003
            #add-point:BEFORE FIELD sfajwf003 name="input.b.sfajwf003"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwf003
            
            #add-point:AFTER FIELD sfajwf003 name="input.a.sfajwf003"
            IF NOT cl_null(g_sfajwf_m.sfajwf003) THEN
               IF cl_null(g_sfajwf_m_o.sfajwf003) OR g_sfajwf_m_o.sfajwf003 != g_sfajwf_m.sfajwf003 THEN
                  #???????????????
#                  IF NOT asft300_life_cycle_chk(g_sfajwf_m.sfajwf003,g_sfajwf_m.sfaa010) THEN
#                     LET g_sfajwf_m.sfajwf003 = g_sfajwf_m_o.sfajwf003
#                  END IF
                  #240709-00009#1 add--s
                  IF g_sfajwf_m.sfajwf003 = '3' THEN
                     LET l_cnt = 0 
                     SELECT COUNT(*) INTO l_cnt FROM sfac_t
                      WHERE sfacent = g_enterprise
                        AND sfacdocno = g_sfajwf_m.sfajwfdocno
                        AND sfac002 <> '4'
                     IF l_cnt > 0 THEN
                        INITIALIZE g_errparam TO NULL
                        LET g_errparam.code = 'asf-01040'   #????????????4:????????????????????????3:??????!
                        LET g_errparam.popup = TRUE
                        CALL cl_err()
                        LET g_sfajwf_m.sfajwf003 = g_sfajwf_m_o.sfajwf003
                        DISPLAY BY NAME g_sfajwf_m.sfajwf003
                        NEXT FIELD CURRENT                     
                     END IF
                  END IF
                  #240709-00009#1 add--s
               END IF              
            END IF
            #170919-00041#1 --e add
            CALL bsft001_wf_set_entry(p_cmd)
            CALL bsft001_wf_set_no_entry(p_cmd)
            LET g_sfajwf_m_o.sfajwf003 = g_sfajwf_m.sfajwf003 
            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfajwf003
            #add-point:ON CHANGE sfajwf003 name="input.g.sfajwf003"
            #250319-00001#1 add--s
            IF g_sfajwf_m.sfajwf003 = '2' THEN
               LET g_sfajwf_m.sfajwf016 = 'Y' 
            ELSE
               LET g_sfajwf_m.sfajwf016 = 'N' 
            END IF
            #250319-00001#1 add--e
            CALL bsft001_wf_set_entry(p_cmd)
            CALL bsft001_wf_set_no_entry(p_cmd)
            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwf005
            #add-point:BEFORE FIELD sfajwf005 name="input.b.sfajwf005"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwf005
            
            #add-point:AFTER FIELD sfajwf005 name="input.a.sfajwf005"
            IF g_sfajwf_m.sfajwf005 != g_sfajwf_m_o.sfajwf005 OR cl_null(g_sfajwf_m_o.sfajwf005) THEN
                                         
            END IF 
            #240423-00004#1-24042401-16508 add by lijlg -----start ?????=1.??,???????????
            IF g_sfajwf_m.sfajwf005 = '1' THEN 
               CALL cl_set_comp_required("sfajwf006,sfajwf007",FALSE)
            ELSE
               CALL cl_set_comp_required("sfajwf006,sfajwf007",TRUE)        
            END IF 
            #240423-00004#1-24042401-16508 add by lijlg -----end
            CALL bsft001_wf_set_entry(p_cmd)
            CALL bsft001_wf_set_no_entry(p_cmd)
            LET g_sfajwf_m_o.sfajwf005 = g_sfajwf_m.sfajwf005   
            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfajwf005
            #add-point:ON CHANGE sfajwf005 name="input.g.sfajwf005"
            CALL bsft001_wf_set_entry(p_cmd)
            CALL bsft001_wf_set_no_entry(p_cmd)
            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwf004
            #add-point:BEFORE FIELD sfajwf004 name="input.b.sfajwf004"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwf004
            
            #add-point:AFTER FIELD sfajwf004 name="input.a.sfajwf004"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfajwf004
            #add-point:ON CHANGE sfajwf004 name="input.g.sfajwf004"

            #END add-point 
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwf008
            
            #add-point:AFTER FIELD sfajwf008 name="input.a.sfajwf008"
#            INITIALIZE g_ref_fields TO NULL
#            LET g_ref_fields[1] = g_sfajwf_m.sfajwf008
#            CALL ap_ref_array2(g_ref_fields,"SELECT inayl003 FROM inayl_t WHERE inaylent="||g_enterprise||" AND inayl001=? AND inayl002='"||g_dlang||"'","") RETURNING g_rtn_fields
#            LET g_sfajwf_m.sfajwf008_desc = '', g_rtn_fields[1] , ''
#            DISPLAY BY NAME g_sfajwf_m.sfajwf008_desc

            LET g_sfajwf_m.sfajwf008_desc = ''
            IF NOT cl_null(g_sfajwf_m.sfajwf008) THEN
               IF g_sfajwf_m.sfajwf008 != g_sfajwf_m_o.sfajwf008 OR cl_null(g_sfajwf_m_o.sfajwf008) THEN
                  IF NOT bsft001_wf_chk_warehouses() THEN
                     LET g_sfajwf_m.sfajwf008 = g_sfajwf_m_o.sfajwf008
                     LET g_sfajwf_m.sfajwf008_desc = s_desc_get_stock_desc(g_site,g_sfajwf_m.sfajwf008)
                     DISPLAY BY NAME g_sfajwf_m.sfajwf008,g_sfajwf_m.sfajwf008_desc
                     NEXT FIELD CURRENT
                  END IF
               END IF
               LET g_sfajwf_m.sfajwf008_desc = s_desc_get_stock_desc(g_site,g_sfajwf_m.sfajwf008)
               DISPLAY BY NAME g_sfajwf_m.sfajwf008_desc
            END IF                
            LET g_sfajwf_m_o.sfajwf008 = g_sfajwf_m.sfajwf008
            CALL bsft001_wf_set_entry(p_cmd)            
            CALL bsft001_wf_set_no_entry(p_cmd)
            DISPLAY BY NAME g_sfajwf_m.sfajwf008_desc     
            #END add-point
            
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwf008
            #add-point:BEFORE FIELD sfajwf008 name="input.b.sfajwf008"

            #END add-point
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfajwf008
            #add-point:ON CHANGE sfajwf008 name="input.g.sfajwf008"

            #END add-point 
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwf009
            
            #add-point:AFTER FIELD sfajwf009 name="input.a.sfajwf009"
#            INITIALIZE g_ref_fields TO NULL
#            LET g_ref_fields[1] = g_sfajwf_m.sfajwf009
#            CALL ap_ref_array2(g_ref_fields,"SELECT inab003 FROM inab_t WHERE inabent="||g_enterprise||" AND inab001=? ","") RETURNING g_rtn_fields
#            LET g_sfajwf_m.sfajwf009_desc = '', g_rtn_fields[1] , ''
#            DISPLAY BY NAME g_sfajwf_m.sfajwf009_desc
            LET g_sfajwf_m.sfajwf009_desc = ''
            IF NOT cl_null(g_sfajwf_m.sfajwf009) THEN
               IF g_sfajwf_m.sfajwf009 != g_sfajwf_m_o.sfajwf009 OR cl_null(g_sfajwf_m_o.sfajwf009) THEN
                  IF NOT bsft001_wf_chk_warehouses() THEN
                     LET g_sfajwf_m.sfajwf009 = g_sfajwf_m_o.sfajwf009
                     LET g_sfajwf_m.sfajwf009_desc = s_desc_get_locator_desc(g_site,g_sfajwf_m.sfajwf008,g_sfajwf_m.sfajwf009)
                     DISPLAY BY NAME g_sfajwf_m.sfajwf009,g_sfajwf_m.sfajwf009_desc
                     NEXT FIELD CURRENT
                  END IF
               END IF
               LET g_sfajwf_m.sfajwf009_desc = s_desc_get_locator_desc(g_site,g_sfajwf_m.sfajwf008,g_sfajwf_m.sfajwf009)
               DISPLAY BY NAME g_sfajwf_m.sfajwf009_desc
            END IF 
            LET g_sfajwf_m_o.sfajwf009 = g_sfajwf_m.sfajwf009
            DISPLAY BY NAME g_sfajwf_m.sfajwf009_desc 

            #END add-point
            
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwf009
            #add-point:BEFORE FIELD sfajwf009 name="input.b.sfajwf009"

            #END add-point
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfajwf009
            #add-point:ON CHANGE sfajwf009 name="input.g.sfajwf009"

            #END add-point 
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwf010
            
            #add-point:AFTER FIELD sfajwf010 name="input.a.sfajwf010"
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_sfajwf_m.sfajwf010
            CALL ap_ref_array2(g_ref_fields,"SELECT inayl003 FROM inayl_t WHERE inaylent="||g_enterprise||" AND inayl001=? AND inayl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_sfajwf_m.sfajwf010_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_sfajwf_m.sfajwf010_desc


            #END add-point
            
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwf010
            #add-point:BEFORE FIELD sfajwf010 name="input.b.sfajwf010"

            #END add-point
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfajwf010
            #add-point:ON CHANGE sfajwf010 name="input.g.sfajwf010"

            #END add-point 
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwf011
            
            #add-point:AFTER FIELD sfajwf011 name="input.a.sfajwf011"
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_sfajwf_m.sfajwf011
            CALL ap_ref_array2(g_ref_fields,"SELECT inab003 FROM inab_t WHERE inabent="||g_enterprise||" AND inab001=? ","") RETURNING g_rtn_fields
            LET g_sfajwf_m.sfajwf011_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_sfajwf_m.sfajwf011_desc


            #END add-point
            
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwf011
            #add-point:BEFORE FIELD sfajwf011 name="input.b.sfajwf011"

            #END add-point
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfajwf011
            #add-point:ON CHANGE sfajwf011 name="input.g.sfajwf011"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwfua011
            #add-point:BEFORE FIELD sfajwfua011 name="input.b.sfajwfua011"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwfua011
            
            #add-point:AFTER FIELD sfajwfua011 name="input.a.sfajwfua011"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfajwfua011
            #add-point:ON CHANGE sfajwfua011 name="input.g.sfajwfua011"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwfua012
            #add-point:BEFORE FIELD sfajwfua012 name="input.b.sfajwfua012"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwfua012
            
            #add-point:AFTER FIELD sfajwfua012 name="input.a.sfajwfua012"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfajwfua012
            #add-point:ON CHANGE sfajwfua012 name="input.g.sfajwfua012"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwfua013
            #add-point:BEFORE FIELD sfajwfua013 name="input.b.sfajwfua013"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwfua013
            
            #add-point:AFTER FIELD sfajwfua013 name="input.a.sfajwfua013"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfajwfua013
            #add-point:ON CHANGE sfajwfua013 name="input.g.sfajwfua013"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwfua014
            #add-point:BEFORE FIELD sfajwfua014 name="input.b.sfajwfua014"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwfua014
            
            #add-point:AFTER FIELD sfajwfua014 name="input.a.sfajwfua014"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfajwfua014
            #add-point:ON CHANGE sfajwfua014 name="input.g.sfajwfua014"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwfua015
            #add-point:BEFORE FIELD sfajwfua015 name="input.b.sfajwfua015"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwfua015
            
            #add-point:AFTER FIELD sfajwfua015 name="input.a.sfajwfua015"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfajwfua015
            #add-point:ON CHANGE sfajwfua015 name="input.g.sfajwfua015"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfajwfstus
            #add-point:BEFORE FIELD sfajwfstus name="input.b.sfajwfstus"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfajwfstus
            
            #add-point:AFTER FIELD sfajwfstus name="input.a.sfajwfstus"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfajwfstus
            #add-point:ON CHANGE sfajwfstus name="input.g.sfajwfstus"

            #END add-point 
 
 
 #????
                  #Ctrlp:input.c.sfajwfdocno
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwfdocno
            #add-point:ON ACTION controlp INFIELD sfajwfdocno name="input.c.sfajwfdocno"
            #?? a07 ??????(Version:3)   
            #??i?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
 
            LET g_qryparam.default1 = g_sfajwf_m.sfajwfdocno             #??default?
              
            #??arg
            LET g_qryparam.arg1 = g_ooef004 #?????
            LET g_qryparam.arg2 = g_prog    #????
            
            CALL s_control_get_docno_sql(g_user,g_dept)  #???????????????,???
                 RETURNING l_success,l_sql1
            IF NOT cl_null(l_sql1) THEN
               LET g_qryparam.where = l_sql1
            END IF
            
            CALL q_ooba002_1()                                #????
 
            LET g_sfajwf_m.sfajwfdocno = g_qryparam.return1              

            DISPLAY g_sfajwf_m.sfajwfdocno TO sfajwfdocno              #
            LET g_sfajwf_m.oobal004 = s_aooi200_get_slip_desc(g_sfajwf_m.sfajwfdocno)              
            DISPLAY g_sfajwf_m.oobal004 TO oobal004
            NEXT FIELD sfajwfdocno                          #?????



            #END add-point
 
 
         #Ctrlp:input.c.sfajwfdocdt
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwfdocdt
            #add-point:ON ACTION controlp INFIELD sfajwfdocdt name="input.c.sfajwfdocdt"

            #END add-point
 
 
         #Ctrlp:input.c.sfajwf006
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwf006
            #add-point:ON ACTION controlp INFIELD sfajwf006 name="input.c.sfajwf006"
            #?? a07 ??????(Version:3)   
            #??i?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
 
            LET g_qryparam.default1 = g_sfajwf_m.sfajwf006             #??default?

            #??arg
            LET g_qryparam.where = "pmaa001 IN (SELECT pmab001 FROM pmab_t ",                                             
                                   "             WHERE pmabsite = '",g_site,"' AND pmabent = '",g_enterprise,"' AND 1=1)" 
            CALL s_control_get_supplier_sql('4',g_site,g_user,g_dept,g_sfajwf_m.sfajwfdocno) RETURNING l_success,l_sql1
            IF cl_null(l_sql1) THEN
               LET l_sql1 = " 1=1"
            END IF
            LET g_qryparam.where = g_qryparam.where ," AND ",l_sql1

            
            CALL q_pmaa001_3()                                #????
 
            LET g_sfajwf_m.sfajwf006 = g_qryparam.return1              
            
            DISPLAY g_sfajwf_m.sfajwf006 TO sfajwf006              #
            LET g_sfajwf_m.sfajwf006_desc = s_desc_get_trading_partner_abbr_desc(g_sfajwf_m.sfajwf006) 
            DISPLAY g_sfajwf_m.sfajwf006_desc TO sfajwf006_desc             
            NEXT FIELD sfajwf006                          #?????



            #END add-point
 
 
         #Ctrlp:input.c.sfajwf007
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwf007
            #add-point:ON ACTION controlp INFIELD sfajwf007 name="input.c.sfajwf007"
            #?? a07 ??????(Version:3)   
            #??i?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
 
            LET g_qryparam.default1 = g_sfajwf_m.sfajwf007             #??default?

            #??arg
            LET g_qryparam.arg1 = g_sfajwf_m.sfajwf006  #?????

 
            CALL q_pmad002_2()                                #????
 
            LET g_sfajwf_m.sfajwf007 = g_qryparam.return1              

            DISPLAY g_sfajwf_m.sfajwf007 TO sfajwf007              #
            LET g_sfajwf_m.sfajwf007_desc = s_desc_get_ooib002_desc(g_sfajwf_m.sfajwf007)
            DISPLAY g_sfajwf_m.sfajwf007_desc TO sfajwf007_desc
            NEXT FIELD sfajwf007                          #?????



            #END add-point
 
 
         #Ctrlp:input.c.sfajwf017
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwf017
            #add-point:ON ACTION controlp INFIELD sfajwf017 name="input.c.sfajwf017"

            #END add-point
 
 
         #Ctrlp:input.c.sfajwf019
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwf019
            #add-point:ON ACTION controlp INFIELD sfajwf019 name="input.c.sfajwf019"

            #END add-point
 
 
         #Ctrlp:input.c.sfajwf020
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwf020
            #add-point:ON ACTION controlp INFIELD sfajwf020 name="input.c.sfajwf020"

            #END add-point
 
 
         #Ctrlp:input.c.sfajwf021
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwf021
            #add-point:ON ACTION controlp INFIELD sfajwf021 name="input.c.sfajwf021"

            #END add-point
 
 
         #Ctrlp:input.c.sfajwf018
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwf018
            #add-point:ON ACTION controlp INFIELD sfajwf018 name="input.c.sfajwf018"
            #240201-00005#1 add--s
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_sfajwf_m.sfajwf018 
            LET g_qryparam.default2 = g_sfajwf_m.sfajwf019
            LET g_qryparam.default3 = g_sfajwf_m.sfajwf020
            LET g_qryparam.default4 = g_sfajwf_m.sfajwf021

            #???????????SQL
            CALL s_aooi210_get_check_sql(g_site,'',g_sfajwf_m.sfajwfdocno,'2','axmt500_wf','xmdddocno') RETURNING l_success,l_where   #180509-00055#1 add
            IF l_success THEN
               LET g_qryparam.where = l_where
            END IF

            IF cl_null(g_qryparam.where) THEN
               LET g_qryparam.where = "1=1"
            END IF
            LET g_qryparam.where = g_qryparam.where,
            " AND NOT (((COALESCE(xmdd006,0)+COALESCE(xmdd016,0)+COALESCE(xmdd034,0)-COALESCE(xmdd014,0)) <= 0) ",  #???????
            " AND EXISTS (SELECT 1 FROM imaf_t WHERE imafent=xmddent AND imafsite=xmdcunit AND imaf001=xmdd001 AND imaf012<>'1'))" #170302-00045#6-add
            ," AND NOT EXISTS (SELECT 1 FROM xmdc_t WHERE xmdcent = xmddent AND xmdcdocno = xmdddocno AND xmdcseq = xmddseq AND xmdc045 IN('2','3','4') )",
            " AND NOT EXISTS (SELECT 1 FROM sfajwf_t WHERE xmdaent=sfajwfent AND sfajwfstus<>'X' AND sfajwf017  = '1' AND sfajwf018  = xmda008)"
            ," AND NOT EXISTS (SELECT 1 FROM sfajwf_t WHERE xmdaent = sfajwfent AND sfajwfstus <> 'X' AND sfajwf017 = '1' AND sfajwf018 = xmdc055 AND xmda007 = '2') "
            CALL q_xmdddocno_01_wf()
               
            LET g_sfajwf_m.sfajwf018  = g_qryparam.return1
            LET g_sfajwf_m.sfajwf019 = g_qryparam.return2
            LET g_sfajwf_m.sfajwf020 = g_qryparam.return3
            LET g_sfajwf_m.sfajwf021 = g_qryparam.return4
            DISPLAY BY NAME g_sfajwf_m.sfajwf018,g_sfajwf_m.sfajwf019,g_sfajwf_m.sfajwf020,g_sfajwf_m.sfajwf021
            LET l_sfajwf018_str = g_sfajwf_m.sfajwf019 CLIPPED,"-",g_sfajwf_m.sfajwf020 CLIPPED,"-",g_sfajwf_m.sfajwf021 CLIPPED
            CALL cl_replace_str(l_sfajwf018_str, " ", "") RETURNING g_sfajwf_m.l_sfajwf018
            NEXT FIELD sfajwf018
            #240201-00005#1 add--e
            #END add-point
 
 
         #Ctrlp:input.c.l_sfajwf018
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD l_sfajwf018
            #add-point:ON ACTION controlp INFIELD l_sfajwf018 name="input.c.l_sfajwf018"
            #?? a07 ??????(Version:3)   
            #??i?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
 
            LET g_qryparam.default1 = g_sfajwf_m.sfajwf018
            LET g_qryparam.default2 = g_sfajwf_m.sfajwf019
            LET g_qryparam.default3 = g_sfajwf_m.sfajwf020
            LET g_qryparam.default4 = g_sfajwf_m.sfajwf021
            CALL s_aooi210_get_check_sql(g_site,'',g_sfajwf_m.sfajwfdocno,'2','axmt500_wf','xmdddocno') RETURNING l_success,l_where   #180509-00055#1 add
            IF l_success THEN
               LET g_qryparam.where = l_where
            END IF

            #170929-00012#1 add --s
            IF NOT cl_null(g_sfajwf_m.sfajwf018) THEN
               LET g_qryparam.where = g_qryparam.where, " AND xmdddocno = '",g_sfajwf_m.sfajwf018,"'"
            END IF
            #170929-00012#1 add --e
            #170830-00031#1-s
            IF cl_null(g_qryparam.where) THEN
               LET g_qryparam.where = "1=1"
            END IF
            LET g_qryparam.where = g_qryparam.where,
            " AND NOT (((COALESCE(xmdd006,0)+COALESCE(xmdd016,0)+COALESCE(xmdd034,0)-COALESCE(xmdd014,0)) <= 0) ",  #???????
            " AND EXISTS (SELECT 1 FROM imaf_t WHERE imafent=xmddent AND imafsite=xmdcunit AND imaf001=xmdd001 AND imaf012<>'1'))" #170302-00045#6-add
            #170830-00031#1-e
            #180208-00020#1 2019/08/08  By 12133 add ---(S)
            ," AND NOT EXISTS (SELECT 1 FROM xmdc_t WHERE xmdcent = xmddent AND xmdcdocno = xmdddocno AND xmdcseq = xmddseq AND xmdc045 IN('2','3','4') )",
            " AND NOT EXISTS (SELECT 1 FROM sfajwf_t WHERE xmdaent=sfajwfent AND sfajwfstus<>'X' AND sfajwf017 = '1' AND sfajwf018 = xmda008)"
            ," AND NOT EXISTS (SELECT 1 FROM sfajwf_t WHERE xmdaent = sfajwfent AND sfajwfstus <> 'X' AND sfajwf017 = '1' AND sfajwf018 = xmdc055 AND xmda007 = '2') "
            #180208-00020#1 2019/08/08  By 12133 add ---(E)
            CALL q_xmdddocno_01_wf()                                #????
 
            LET g_sfajwf_m.sfajwf018 = g_qryparam.return1
            LET g_sfajwf_m.sfajwf019 = g_qryparam.return2
            LET g_sfajwf_m.sfajwf020 = g_qryparam.return3
            LET g_sfajwf_m.sfajwf021 = g_qryparam.return4
            DISPLAY BY NAME g_sfajwf_m.sfajwf018,g_sfajwf_m.sfajwf019,g_sfajwf_m.sfajwf020,g_sfajwf_m.sfajwf021,g_sfajwf_m.l_sfajwf018
            DISPLAY g_sfajwf_m.l_sfajwf018 TO l_sfajwf018              #
            #DISPLAY g_sfajwf_m.xmddseq TO xmddseq #??
            #DISPLAY g_sfajwf_m.xmddseq1 TO xmddseq1 #??
            #DISPLAY g_sfajwf_m.xmddseq2 TO xmddseq2 #???
            NEXT FIELD l_sfajwf018                          #?????



            #END add-point
 
 
         #Ctrlp:input.c.sfajwf022
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwf022
            #add-point:ON ACTION controlp INFIELD sfajwf022 name="input.c.sfajwf022"

            #END add-point
 
 
         #Ctrlp:input.c.sfajwf023
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwf023
            #add-point:ON ACTION controlp INFIELD sfajwf023 name="input.c.sfajwf023"
            #?? a07 ??????(Version:3)   
            #??i?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
 
            LET g_qryparam.default1 = g_sfajwf_m.sfajwf023             #??default?

            #??arg
            LET g_qryparam.arg1 = '2' #s
            LET g_qryparam.arg2 = '0' #s
            LET g_qryparam.where = " icaa003 = '2' AND icaawf019 = 'Y' "
            CALL q_icaa001_1()                                #????
 
            LET g_sfajwf_m.sfajwf023 = g_qryparam.return1              

            DISPLAY g_sfajwf_m.sfajwf023 TO sfajwf023              #
            CALL s_desc_get_icaa001_desc(g_sfajwf_m.sfajwf023) RETURNING g_sfajwf_m.sfajwf023_desc
            DISPLAY BY NAME g_sfajwf_m.sfajwf023_desc
            NEXT FIELD sfajwf023                          #?????



            #END add-point
 
 
         #Ctrlp:input.c.sfajwf012
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwf012
            #add-point:ON ACTION controlp INFIELD sfajwf012 name="input.c.sfajwf012"
            #?? a07 ??????(Version:3)   
            #??i?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
 
            LET g_qryparam.default1 = g_sfajwf_m.sfajwf012             #??default?

            #??arg
#            LET g_qryparam.arg1 = g_sfajwf_m.sfajwfdocdt  #????

 
            CALL q_sfajwf012_01_wf()                                #????
 
            LET g_sfajwf_m.sfajwf012 = g_qryparam.return1     
                        


            DISPLAY g_sfajwf_m.sfajwf012 TO sfajwf012              #
            LET g_sfajwf_m.sfajwf012_desc = bsft001_wf_sfajwf012_desc(g_sfajwf_m.sfajwf012)   
            DISPLAY g_sfajwf_m.sfajwf012_desc TO sfajwf012_desc
            NEXT FIELD sfajwf012                          #?????



            #END add-point
 
 
         #Ctrlp:input.c.sfajwf013
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwf013
            #add-point:ON ACTION controlp INFIELD sfajwf013 name="input.c.sfajwf013"

            #END add-point
 
 
         #Ctrlp:input.c.sfajwf014
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwf014
            #add-point:ON ACTION controlp INFIELD sfajwf014 name="input.c.sfajwf014"

            #END add-point
 
 
         #Ctrlp:input.c.sfajwf001
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwf001
            #add-point:ON ACTION controlp INFIELD sfajwf001 name="input.c.sfajwf001"
            #?? a07 ??????(Version:3)   
            #??i?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
 
            LET g_qryparam.default1 = g_sfajwf_m.sfajwf001             #??default?

            #??arg
            LET g_qryparam.arg1 = "" #s

 
            CALL q_ooag001_2()                                #????
 
            LET g_sfajwf_m.sfajwf001 = g_qryparam.return1              

            DISPLAY g_sfajwf_m.sfajwf001 TO sfajwf001              #
            LET g_sfajwf_m.sfajwf001_desc = s_desc_get_person_desc(g_sfajwf_m.sfajwf001)
            DISPLAY g_sfajwf_m.sfajwf001_desc TO sfajwf001_desc
            NEXT FIELD sfajwf001                          #?????



            #END add-point
 
 
         #Ctrlp:input.c.sfajwf002
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwf002
            #add-point:ON ACTION controlp INFIELD sfajwf002 name="input.c.sfajwf002"
            #?? a07 ??????(Version:3)   
            #??i?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
 
            LET g_qryparam.default1 = g_sfajwf_m.sfajwf002             #??default?
            LET g_qryparam.default2 = "" #g_sfajwf_m.ooefl003 #??(??)
            #??arg
            IF g_sfajwf_m.sfajwf005 = '2' THEN                                       
               CALL q_pmab001_1()                                      
            ELSE
               LET g_qryparam.arg1 = g_today
               CALL q_ooeg001()
            END IF
 
            LET g_sfajwf_m.sfajwf002 = g_qryparam.return1 
            IF g_sfajwf_m.sfajwf005 = '2' THEN
               LET g_sfajwf_m.sfajwf002_desc = s_desc_get_trading_partner_abbr_desc(g_sfajwf_m.sfajwf002)
            ELSE
               LET g_sfajwf_m.sfajwf002_desc = s_desc_get_department_desc(g_sfajwf_m.sfajwf002)
            END IF
            DISPLAY g_sfajwf_m.sfajwf002_desc TO sfajwf002_desc            
            #LET g_sfajwf_m.ooefl003 = g_qryparam.return2 
            DISPLAY g_sfajwf_m.sfajwf002 TO sfajwf002              #
            #DISPLAY g_sfajwf_m.ooefl003 TO ooefl003 #??(??)
            NEXT FIELD sfajwf002                          #?????



            #END add-point
 
 
         #Ctrlp:input.c.sfajwf025
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwf025
            #add-point:ON ACTION controlp INFIELD sfajwf025 name="input.c.sfajwf025"
            #?? a07 ??????(Version:3)   
            #??i?
            #250328-00010#1 add--s
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
 
            LET g_qryparam.default1 = g_sfajwf_m.sfajwf025             #??default?

            #??arg
            LET g_qryparam.arg1 = cl_get_today()
            LET g_qryparam.arg2 = g_site 
 
            CALL q_ooeg001_8()                             #????
 
            LET g_sfajwf_m.sfajwf025 = g_qryparam.return1              

            DISPLAY g_sfajwf_m.sfajwf025 TO sfajwf025              #
            LET g_sfajwf_m.sfajwf025_desc = s_desc_get_department_desc(g_sfajwf_m.sfajwf025)
            DISPLAY g_sfajwf_m.sfajwf025_desc TO sfajwf025_desc 
            NEXT FIELD sfajwf025    
            #250328-00010#1 add--e


            #END add-point
 
 
         #Ctrlp:input.c.sfajwf015
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwf015
            #add-point:ON ACTION controlp INFIELD sfajwf015 name="input.c.sfajwf015"

            #END add-point
 
 
         #Ctrlp:input.c.sfajwfua002
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwfua002
            #add-point:ON ACTION controlp INFIELD sfajwfua002 name="input.c.sfajwfua002"

            #END add-point
 
 
         #Ctrlp:input.c.sfajwf016
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwf016
            #add-point:ON ACTION controlp INFIELD sfajwf016 name="input.c.sfajwf016"

            #END add-point
 
 
         #Ctrlp:input.c.sfajwfua003
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwfua003
            #add-point:ON ACTION controlp INFIELD sfajwfua003 name="input.c.sfajwfua003"

            #END add-point
 
 
         #Ctrlp:input.c.sfajwf024
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwf024
            #add-point:ON ACTION controlp INFIELD sfajwf024 name="input.c.sfajwf024"

            #END add-point
 
 
         #Ctrlp:input.c.sfajwf003
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwf003
            #add-point:ON ACTION controlp INFIELD sfajwf003 name="input.c.sfajwf003"

            #END add-point
 
 
         #Ctrlp:input.c.sfajwf005
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwf005
            #add-point:ON ACTION controlp INFIELD sfajwf005 name="input.c.sfajwf005"

            #END add-point
 
 
         #Ctrlp:input.c.sfajwf004
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwf004
            #add-point:ON ACTION controlp INFIELD sfajwf004 name="input.c.sfajwf004"

            #END add-point
 
 
         #Ctrlp:input.c.sfajwf008
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwf008
            #add-point:ON ACTION controlp INFIELD sfajwf008 name="input.c.sfajwf008"
            #?? a07 ??????(Version:3)   
            #??i?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
 
            LET g_qryparam.default1 = g_sfajwf_m.sfajwf008             #??default?

            #??arg
            LET g_qryparam.arg1 = "" #s

 
            CALL q_inaa001_2()                                #????
 
            LET g_sfajwf_m.sfajwf008 = g_qryparam.return1              

            DISPLAY g_sfajwf_m.sfajwf008 TO sfajwf008              #
            LET g_sfajwf_m.sfajwf008_desc = s_desc_get_stock_desc(g_site,g_sfajwf_m.sfajwf008)   
            DISPLAY g_sfajwf_m.sfajwf008_desc TO sfajwf008_desc
            NEXT FIELD sfajwf008                          #?????

            #END add-point
 
 
         #Ctrlp:input.c.sfajwf009
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwf009
            #add-point:ON ACTION controlp INFIELD sfajwf009 name="input.c.sfajwf009"
            #?? a07 ??????(Version:3)   
            #??i?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
 
            LET g_qryparam.default1 = g_sfajwf_m.sfajwf009             #??default?

            #??arg
            LET g_qryparam.arg1 = g_sfajwf_m.sfajwf008  #??

 
            CALL q_inab002_3()                                #????
 
            LET g_sfajwf_m.sfajwf009 = g_qryparam.return1              

            DISPLAY g_sfajwf_m.sfajwf009 TO sfajwf009              #
            LET g_sfajwf_m.sfajwf009_desc = s_desc_get_locator_desc(g_site,g_sfajwf_m.sfajwf008,g_sfajwf_m.sfajwf009)   
            DISPLAY g_sfajwf_m.sfajwf009_desc TO sfajwf009_desc
   
            NEXT FIELD sfajwf009                          #?????



            #END add-point
 
 
         #Ctrlp:input.c.sfajwf010
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwf010
            #add-point:ON ACTION controlp INFIELD sfajwf010 name="input.c.sfajwf010"
            #?? a07 ??????(Version:3)   
            #??i?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
 
            LET g_qryparam.default1 = g_sfajwf_m.sfajwf010             #??default?

            #??arg
            LET g_qryparam.arg1 = "" #s

 
            CALL q_inaa001_2()                                #????
 
            LET g_sfajwf_m.sfajwf010 = g_qryparam.return1              

            DISPLAY g_sfajwf_m.sfajwf010 TO sfajwf010              #
            LET g_sfajwf_m.sfajwf010_desc = s_desc_get_stock_desc(g_site,g_sfajwf_m.sfajwf010)   
            DISPLAY g_sfajwf_m.sfajwf010_desc TO sfajwf010_desc
            NEXT FIELD sfajwf010                          #?????



            #END add-point
 
 
         #Ctrlp:input.c.sfajwf011
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwf011
            #add-point:ON ACTION controlp INFIELD sfajwf011 name="input.c.sfajwf011"
            #?? a07 ??????(Version:3)   
            #??i?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
 
            LET g_qryparam.default1 = g_sfajwf_m.sfajwf011             #??default?

            #??arg
            LET g_qryparam.arg1 = g_sfajwf_m.sfajwf010  #??

            
            CALL q_inab002_3()                                #????
 
            LET g_sfajwf_m.sfajwf011 = g_qryparam.return1              

            DISPLAY g_sfajwf_m.sfajwf011 TO sfajwf011              #
            LET g_sfajwf_m.sfajwf011_desc = s_desc_get_locator_desc(g_site,g_sfajwf_m.sfajwf008,g_sfajwf_m.sfajwf011)   
            DISPLAY g_sfajwf_m.sfajwf011_desc TO sfajwf011_desc 
            NEXT FIELD sfajwf011                          #?????



            #END add-point
 
 
         #Ctrlp:input.c.sfajwfua011
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwfua011
            #add-point:ON ACTION controlp INFIELD sfajwfua011 name="input.c.sfajwfua011"

            #END add-point
 
 
         #Ctrlp:input.c.sfajwfua012
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwfua012
            #add-point:ON ACTION controlp INFIELD sfajwfua012 name="input.c.sfajwfua012"

            #END add-point
 
 
         #Ctrlp:input.c.sfajwfua013
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwfua013
            #add-point:ON ACTION controlp INFIELD sfajwfua013 name="input.c.sfajwfua013"

            #END add-point
 
 
         #Ctrlp:input.c.sfajwfua014
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwfua014
            #add-point:ON ACTION controlp INFIELD sfajwfua014 name="input.c.sfajwfua014"

            #END add-point
 
 
         #Ctrlp:input.c.sfajwfua015
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwfua015
            #add-point:ON ACTION controlp INFIELD sfajwfua015 name="input.c.sfajwfua015"

            #END add-point
 
 
         #Ctrlp:input.c.sfajwfstus
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfajwfstus
            #add-point:ON ACTION controlp INFIELD sfajwfstus name="input.c.sfajwfstus"

            #END add-point
 
 
 #????
            
         AFTER INPUT
            IF INT_FLAG THEN
               EXIT DIALOG
            END IF
 
            #CALL cl_err_collect_show()      #????????
            #CALL cl_showmsg()
            DISPLAY BY NAME g_sfajwf_m.sfajwfdocno
                        
            #add-point:??INPUT? name="input.head.after_input"
            #240201-00005#1 add--s
            IF cl_null(g_sfajwf_m.sfajwf018) THEN
               IF cl_null(g_sfajwf_m.sfajwf019) OR
                  cl_null(g_sfajwf_m.sfajwf020) OR
                  cl_null(g_sfajwf_m.sfajwf021) OR
                  cl_null(g_sfajwf_m.sfajwf018) THEN
                  IF g_sfajwf_m.sfajwf017 MATCHES '[1]'THEN
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = 'wf-00105' #???????????????????????????
                     LET g_errparam.popup = TRUE
                     CALL cl_err()
                     NEXT FIELD sfajwf018
                  END IF
               END IF
            END IF             
            #240201-00005#1 add--e
            #end add-point
                        
            IF p_cmd <> 'u' THEN
    
               CALL s_transaction_begin()
               
               #add-point:????? name="input.head.b_insert"
               IF NOT cl_null(g_sfajwf_m.sfajwf001) THEN
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_errshow = TRUE #????
                  LET g_chkparam.arg1 = g_sfajwf_m.sfajwf001
                  LET g_chkparam.arg2 = g_site
                  LET g_chkparam.err_str[1] ="aim-00070:sub-01302|aooi130|",cl_get_progname("aooi130",g_lang,"2"),"|:EXEPROGaooi130"
                  IF NOT cl_chk_exist("v_ooag001_6") THEN
                     LET g_sfajwf_m.sfajwf001 = g_sfajwf_m_o.sfajwf001
                     CALL s_desc_get_person_desc(g_sfajwf_m.sfajwf001)RETURNING g_sfajwf_m.sfajwf001_desc
                     DISPLAY BY NAME g_sfajwf_m.sfajwf001
                     NEXT FIELD sfajwf001
                  END IF
               END IF
               #????
               CALL s_aooi200_gen_docno(g_site,g_sfajwf_m.sfajwfdocno,g_sfajwf_m.sfajwfdocdt,g_prog)
                    RETURNING l_success,g_sfajwf_m.sfajwfdocno
               IF NOT l_success THEN
                  NEXT FIELD sfajwfdocno
               END IF
               #end add-point
               
               #190412-00022 ---start---
               #????????????????FUNCTION??
               LET lp_js = util.JSON.stringify(g_sfajwf_m)
               CALL cl_auth_belong_data(lp_js,"sfajwf_t") RETURNING g_sfajwf_m.sfajwfownid,g_sfajwf_m.sfajwfowndp
               #190412-00022 --- end ---
 
               INSERT INTO sfajwf_t (sfajwfent, sfajwfsite,sfajwfdocno,sfajwfdocdt,sfajwf006,sfajwf007,sfajwf017,sfajwf019,sfajwf020,sfajwf021,sfajwf018,sfajwf022,sfajwf023,sfajwf012,sfajwf013,sfajwf014,sfajwf001,sfajwf002,sfajwf025,sfajwf015,sfajwfua002,sfajwf016,sfajwfua003,sfajwf024,sfajwf003,sfajwf005, 
                   sfajwf004,sfajwf008,sfajwf009,sfajwf010,sfajwf011,sfajwfua011,sfajwfua012,sfajwfua013,sfajwfua014,sfajwfua015,sfajwfstus,sfajwfownid,sfajwfowndp,sfajwfcrtid,sfajwfcrtdp,sfajwfcrtdt,sfajwfmodid,sfajwfmoddt,sfajwfcnfid,sfajwfcnfdt)
               VALUES (g_enterprise, g_site,g_sfajwf_m.sfajwfdocno,g_sfajwf_m.sfajwfdocdt,g_sfajwf_m.sfajwf006,g_sfajwf_m.sfajwf007,g_sfajwf_m.sfajwf017,g_sfajwf_m.sfajwf019,g_sfajwf_m.sfajwf020,g_sfajwf_m.sfajwf021,g_sfajwf_m.sfajwf018,g_sfajwf_m.sfajwf022,g_sfajwf_m.sfajwf023,g_sfajwf_m.sfajwf012, 
                   g_sfajwf_m.sfajwf013,g_sfajwf_m.sfajwf014,g_sfajwf_m.sfajwf001,g_sfajwf_m.sfajwf002,g_sfajwf_m.sfajwf025,g_sfajwf_m.sfajwf015,g_sfajwf_m.sfajwfua002,g_sfajwf_m.sfajwf016,g_sfajwf_m.sfajwfua003,g_sfajwf_m.sfajwf024,g_sfajwf_m.sfajwf003,g_sfajwf_m.sfajwf005,g_sfajwf_m.sfajwf004,g_sfajwf_m.sfajwf008, 
                   g_sfajwf_m.sfajwf009,g_sfajwf_m.sfajwf010,g_sfajwf_m.sfajwf011,g_sfajwf_m.sfajwfua011,g_sfajwf_m.sfajwfua012,g_sfajwf_m.sfajwfua013,g_sfajwf_m.sfajwfua014,g_sfajwf_m.sfajwfua015,g_sfajwf_m.sfajwfstus,g_sfajwf_m.sfajwfownid,g_sfajwf_m.sfajwfowndp,g_sfajwf_m.sfajwfcrtid,g_sfajwf_m.sfajwfcrtdp, 
                   g_sfajwf_m.sfajwfcrtdt,g_sfajwf_m.sfajwfmodid,g_sfajwf_m.sfajwfmoddt,g_sfajwf_m.sfajwfcnfid,g_sfajwf_m.sfajwfcnfdt) 
               IF SQLCA.SQLCODE THEN
                  INITIALIZE g_errparam TO NULL 
                  LET g_errparam.extend = "g_sfajwf_m:",SQLERRMESSAGE 
                  LET g_errparam.code = SQLCA.SQLCODE 
                  LET g_errparam.popup = TRUE 
                  CALL s_transaction_end('N','0')
                  CALL cl_err()
                  NEXT FIELD CURRENT
               END IF
               
               #add-point:????? name="input.head.m_insert"

               #end add-point
               
               
               
                  #161130-00056
               
               #add-point:????? name="input.head.a_insert"

               #end add-point
               CALL s_transaction_end('Y','0') 
               
               IF l_cmd_t = 'r' AND p_cmd = 'a' THEN
                  CALL bsft001_wf_detail_reproduce()
                  #????????, ????????
                  CALL bsft001_wf_b_fill()
                  CALL bsft001_wf_b_fill2('0')
               END IF
               
               #add-point:????? name="input.head.a_insert2"

               #end add-point
               
               LET g_master_insert = TRUE
               
               LET p_cmd = 'u'
            ELSE
               CALL s_transaction_begin()
            
               #add-point:????? name="input.head.b_update"

               #end add-point
               
               #???????
               CALL bsft001_wf_sfajwf_t_mask_restore('restore_mask_o')
               
               UPDATE sfajwf_t SET (sfajwfdocno,sfajwfdocdt,sfajwf006,sfajwf007,sfajwf017,sfajwf019,sfajwf020,sfajwf021,sfajwf018,sfajwf022,sfajwf023,sfajwf012,sfajwf013,sfajwf014,sfajwf001,sfajwf002,sfajwf025,sfajwf015,sfajwfua002,sfajwf016,sfajwfua003,sfajwf024,sfajwf003,sfajwf005,sfajwf004,sfajwf008, 
                   sfajwf009,sfajwf010,sfajwf011,sfajwfua011,sfajwfua012,sfajwfua013,sfajwfua014,sfajwfua015,sfajwfstus,sfajwfownid,sfajwfowndp,sfajwfcrtid,sfajwfcrtdp,sfajwfcrtdt,sfajwfmodid,sfajwfmoddt,sfajwfcnfid,sfajwfcnfdt) = (g_sfajwf_m.sfajwfdocno,g_sfajwf_m.sfajwfdocdt,g_sfajwf_m.sfajwf006,g_sfajwf_m.sfajwf007, 
                   g_sfajwf_m.sfajwf017,g_sfajwf_m.sfajwf019,g_sfajwf_m.sfajwf020,g_sfajwf_m.sfajwf021,g_sfajwf_m.sfajwf018,g_sfajwf_m.sfajwf022,g_sfajwf_m.sfajwf023,g_sfajwf_m.sfajwf012,g_sfajwf_m.sfajwf013,g_sfajwf_m.sfajwf014,g_sfajwf_m.sfajwf001,g_sfajwf_m.sfajwf002,g_sfajwf_m.sfajwf025,g_sfajwf_m.sfajwf015, 
                   g_sfajwf_m.sfajwfua002,g_sfajwf_m.sfajwf016,g_sfajwf_m.sfajwfua003,g_sfajwf_m.sfajwf024,g_sfajwf_m.sfajwf003,g_sfajwf_m.sfajwf005,g_sfajwf_m.sfajwf004,g_sfajwf_m.sfajwf008,g_sfajwf_m.sfajwf009,g_sfajwf_m.sfajwf010,g_sfajwf_m.sfajwf011,g_sfajwf_m.sfajwfua011,g_sfajwf_m.sfajwfua012, 
                   g_sfajwf_m.sfajwfua013,g_sfajwf_m.sfajwfua014,g_sfajwf_m.sfajwfua015,g_sfajwf_m.sfajwfstus,g_sfajwf_m.sfajwfownid,g_sfajwf_m.sfajwfowndp,g_sfajwf_m.sfajwfcrtid,g_sfajwf_m.sfajwfcrtdp,g_sfajwf_m.sfajwfcrtdt,g_sfajwf_m.sfajwfmodid,g_sfajwf_m.sfajwfmoddt,g_sfajwf_m.sfajwfcnfid,g_sfajwf_m.sfajwfcnfdt) 

                WHERE sfajwfent = g_enterprise AND sfajwfsite = g_site AND sfajwfdocno = g_sfajwfdocno_t
 
               IF SQLCA.SQLCODE THEN
                  INITIALIZE g_errparam TO NULL 
                  LET g_errparam.extend = "sfajwf_t:",SQLERRMESSAGE 
                  LET g_errparam.code = SQLCA.SQLCODE 
                  LET g_errparam.popup = TRUE 
                  CALL s_transaction_end('N','0')
                  CALL cl_err()
                  NEXT FIELD CURRENT
               END IF
               
               #add-point:????? name="input.head.m_update"

               #end add-point
               
               
               
                  #161130-00056
               
               #?????????
               CALL bsft001_wf_sfajwf_t_mask_restore('restore_mask_n')
               
               #??????(????)
               LET g_log1 = util.JSON.stringify(g_sfajwf_m_t)
               LET g_log2 = util.JSON.stringify(g_sfajwf_m)
               IF NOT cl_log_modified_record(g_log1,g_log2) THEN 
                  CALL s_transaction_end('N','0')
               ELSE
                  CALL s_transaction_end('Y','0')
               END IF
               
               #add-point:????? name="input.head.a_update"

               #end add-point
            END IF
            
            LET g_master_commit = "Y"
            LET g_sfajwfdocno_t = g_sfajwf_m.sfajwfdocno
 
            
      END INPUT
   

{</section>}

{<section id="bsft001_wf.input.body" type="s" >}
   
      #Page1 ????????
      INPUT ARRAY g_sfakwf_d FROM s_detail1.*
          ATTRIBUTE(COUNT = g_rec_b,WITHOUT DEFAULTS, #MAXCOUNT = g_max_rec,
                  INSERT ROW = l_allow_insert, 
                  DELETE ROW = l_allow_delete,
                  APPEND ROW = l_allow_insert)
 
         #??ACTION(detail_input,page_1)
         
         
         BEFORE INPUT
            #add-point:????? name="input.body.before_input2"

            #end add-point
            IF g_insert = 'Y' AND NOT cl_null(g_insert) THEN 
              CALL FGL_SET_ARR_CURR(g_sfakwf_d.getLength()+1) 
              LET g_insert = 'N' 
           END IF 
 
            CALL bsft001_wf_b_fill() #ver:82
            #????????1???????
            IF g_loc = 'm' AND g_rec_b != 0 THEN
               CALL FGL_SET_ARR_CURR(g_idx_group.getValue("'1',"))
            END IF
            LET g_loc = 'm'
            LET g_rec_b = g_sfakwf_d.getLength()
            #add-point:????? name="input.d.before_input"
            #240709-00009#1 add--s
            LET l_m = 0
               SELECT COUNT(1) INTO l_m FROM sfbcwf_t 
                WHERE sfbcwfent = g_enterprise AND sfbcwfsite = g_site 
                  AND sfbcwfdocno = g_sfajwf_m.sfajwfdocno
            IF l_m = 0 THEN
               LET g_master_insert = TRUE
            END IF  
            #240709-00009#1 add--e
            #240201-00005#1 add--s
            IF g_sfajwf_m.sfajwf017 MATCHES '[1]' THEN                                        
               IF cl_null(g_sfajwf_m.sfajwf018) OR cl_null(g_sfajwf_m.sfajwf019) OR cl_null(g_sfajwf_m.sfajwf020) OR cl_null(g_sfajwf_m.sfajwf021) THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = 'wf-00105'
                  LET g_errparam.popup = TRUE
                  CALL cl_err()
                  NEXT FIELD sfajwf017
               END IF
            END IF
            #240201-00005#1 add--e
            #end add-point
         
         BEFORE ROW
            #add-point:modify?before row2 name="input.body.before_row2"
            CALL bsft001_wf_b_fill()
            #end add-point  
            LET l_insert = FALSE
            LET l_cmd = ''
            LET l_ac_t = l_ac 
            LET l_ac = ARR_CURR()
            LET g_detail_idx = l_ac
            LET g_detail_idx_list[1] = l_ac
            LET g_current_page = 1
            CALL bsft001_wf_b_fill2('3')
CALL bsft001_wf_b_fill2('4')
CALL bsft001_wf_b_fill2('5')
 
            LET l_lock_sw = 'N'            #DEFAULT
            LET l_n = ARR_COUNT()
            DISPLAY l_ac TO FORMONLY.idx
         
            CALL s_transaction_begin()
            OPEN bsft001_wf_cl USING g_enterprise, g_site,g_sfajwf_m.sfajwfdocno
            IF SQLCA.SQLCODE THEN   #(ver:78)
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "OPEN bsft001_wf_cl:",SQLERRMESSAGE 
               LET g_errparam.code = SQLCA.SQLCODE   #(ver:78)
               LET g_errparam.popup = TRUE 
               CLOSE bsft001_wf_cl
               CALL s_transaction_end('N','0')
               CALL cl_err()
               RETURN
            END IF
 
            #200804-00006 ---start---
            FETCH bsft001_wf_cl
            IF SQLCA.SQLCODE AND SQLCA.SQLCODE <> 100 THEN
               INITIALIZE g_errparam TO NULL
               LET g_errparam.extend = "FETCH bsft001_wf_cl:",SQLERRMESSAGE
               LET g_errparam.code = SQLCA.SQLCODE
               LET g_errparam.popup = TRUE
               CLOSE bsft001_wf_cl
               #PostgreSQL???????, ????????????
               CALL s_transaction_end('N','0')
               CALL s_transaction_begin()
               CALL cl_err()
               RETURN
            END IF
            #200804-00006 --- end ---
            
            LET g_rec_b = g_sfakwf_d.getLength()
            
            IF g_rec_b >= l_ac 
               AND g_sfakwf_d[l_ac].sfakwfseq IS NOT NULL
 
            THEN
               LET l_cmd='u'
               LET g_sfakwf_d_t.* = g_sfakwf_d[l_ac].*  #BACKUP
               LET g_sfakwf_d_o.* = g_sfakwf_d[l_ac].*  #BACKUP
               CALL bsft001_wf_set_entry_b(l_cmd)
               #add-point:modify?after_set_entry_b name="input.body.after_set_entry_b"

               #end add-point  
               CALL bsft001_wf_set_no_entry_b(l_cmd)
               IF NOT bsft001_wf_lock_b("sfakwf_t","'1'") THEN
                  LET l_lock_sw='Y'
               ELSE
                  FETCH bsft001_wf_bcl INTO g_sfakwf_d[l_ac].sfakwfseq,g_sfakwf_d[l_ac].sfakwf001,g_sfakwf_d[l_ac].sfakwf002,g_sfakwf_d[l_ac].sfakwf003,g_sfakwf_d[l_ac].sfakwf004,g_sfakwf_d[l_ac].sfakwf005,g_sfakwf_d[l_ac].sfakwf006,g_sfakwf_d[l_ac].sfakwf007,g_sfakwf_d[l_ac].sfakwf008,g_sfakwf_d[l_ac].sfakwf009, 
                      g_sfakwf_d[l_ac].sfakwf010,g_sfakwf_d[l_ac].sfakwf011,g_sfakwf_d[l_ac].sfakwf012,g_sfakwf_d[l_ac].sfakwf013,g_sfakwf_d[l_ac].sfakwf014,g_sfakwf_d[l_ac].sfakwf015,g_sfakwf_d[l_ac].sfakwf016,g_sfakwf_d[l_ac].sfakwf017,g_sfakwf_d[l_ac].sfakwf018,g_sfakwf_d[l_ac].sfakwf019,g_sfakwf_d[l_ac].sfakwf020, 
                      g_sfakwf_d[l_ac].sfakwf021,g_sfakwf_d[l_ac].sfakwf022,g_sfakwf_d[l_ac].sfakwf023,g_sfakwf_d[l_ac].sfakwf024,g_sfakwf_d[l_ac].sfakwf025,g_sfakwf_d[l_ac].sfakwf026,g_sfakwf_d[l_ac].sfakwf027,g_sfakwf_d[l_ac].sfakwf028,g_sfakwf_d[l_ac].sfakwf029,g_sfakwf_d[l_ac].sfakwf030,g_sfakwf_d[l_ac].sfakwf031, 
                      g_sfakwf_d[l_ac].sfakwf044,g_sfakwf_d[l_ac].sfakwf032,g_sfakwf_d[l_ac].sfakwf033,g_sfakwf_d[l_ac].sfakwf034,g_sfakwf_d[l_ac].sfakwf035,g_sfakwf_d[l_ac].sfakwf036,g_sfakwf_d[l_ac].sfakwf037,g_sfakwf_d[l_ac].sfakwf038,g_sfakwf_d[l_ac].sfakwf039,g_sfakwf_d[l_ac].sfakwf040,g_sfakwf_d[l_ac].sfakwf041, 
                      g_sfakwf_d[l_ac].sfakwf042,g_sfakwf_d[l_ac].sfakwf043,g_sfakwf_d[l_ac].sfakwf045,g_sfakwf_d[l_ac].sfakwf046,g_sfakwf_d[l_ac].sfakwf047,g_sfakwf_d[l_ac].sfakwf048,g_sfakwf_d[l_ac].sfakwf049,g_sfakwf_d[l_ac].sfakwfud001
                  IF SQLCA.SQLCODE THEN
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = g_sfakwf_d_t.sfakwfseq,":",SQLERRMESSAGE 
                     LET g_errparam.code = SQLCA.SQLCODE 
                     LET g_errparam.popup = TRUE 
                     CALL cl_err()
                     LET l_lock_sw = "Y"
                  END IF
                  
                  #??????
                  LET g_sfakwf_d_mask_o[l_ac].* =  g_sfakwf_d[l_ac].*
                  CALL bsft001_wf_sfakwf_t_mask()
                  LET g_sfakwf_d_mask_n[l_ac].* =  g_sfakwf_d[l_ac].*
                  
                  LET g_bfill = "N"
                  CALL bsft001_wf_show()
                  LET g_bfill = "Y"
                  
                  CALL cl_show_fld_cont()
               END IF
            ELSE
               LET l_cmd='a'
            END IF
            #add-point:modify?before row name="input.body.before_row"
            CALL bsft001_wf_set_no_require()   #240709-00009#1 add
            CALL bsft001_wf_set_require()      #240709-00009#1 add
            #end add-point  
            #??table????(???????)
            
 
            #??table??lock
            
 
            CALL bsft001_wf_idx_chk()   #(ver:83)
        
         BEFORE INSERT  
            
            IF s_transaction_chk("N",0) THEN
               CALL s_transaction_begin()
            END IF
            LET l_insert = TRUE
            LET l_n = ARR_COUNT()
            LET l_cmd = 'a'
            CALL bsft001_wf_idx_chk()   #(ver:83)
            INITIALIZE g_sfakwf_d[l_ac].* TO NULL 
            INITIALIZE g_sfakwf_d_t.* TO NULL 
            INITIALIZE g_sfakwf_d_o.* TO NULL 
            #??????(??)
            
            #??????
                  LET g_sfakwf_d[l_ac].sfakwf006 = "0"
      LET g_sfakwf_d[l_ac].sfakwf008 = "0"
      LET g_sfakwf_d[l_ac].sfakwf019 = "0"
      LET g_sfakwf_d[l_ac].sfakwf034 = "0"
      LET g_sfakwf_d[l_ac].sfakwf036 = "0"
      LET g_sfakwf_d[l_ac].sfakwf038 = "0"
 
            #add-point:modify?before?? name="input.body.insert.before_bak"
            #???
            LET g_sfakwf_d[l_ac].sfakwf032 = g_today
            IF g_sfakwf_d[l_ac].sfakwfseq IS NULL OR g_sfakwf_d[l_ac].sfakwfseq = 0 THEN
               SELECT max(sfakwfseq)+1
                 INTO g_sfakwf_d[l_ac].sfakwfseq
                 FROM sfakwf_t
                WHERE sfakwfdocno = g_sfajwf_m.sfajwfdocno AND sfakwfent = g_enterprise AND sfakwfsite = g_site   
               IF g_sfakwf_d[l_ac].sfakwfseq IS NULL THEN
                  LET g_sfakwf_d[l_ac].sfakwfseq = 1
               END IF  
               DISPLAY BY NAME g_sfakwf_d[l_ac].sfakwfseq        
            END IF 
            #?????Y???????0?????
            IF g_sfajwf_m.sfajwf015 = 'Y' THEN
               LET g_sfakwf_d[l_ac].sfakwf036 = 0
            END IF    
            IF g_sfajwf_m.sfajwf013 = '1' OR g_sfajwf_m.sfajwf013 = '3' THEN
               LET g_sfakwf_d[l_ac].sfakwf008 = 0
            END IF
            IF g_sfajwf_m.sfajwf013 = '2' THEN
               LET g_sfakwf_d[l_ac].sfakwf006 = 0
            END IF  
            LET g_sfakwf_d[l_ac].sfakwf039 = 'N' #?????
            #240201-00005#1 add--s
            IF NOT cl_null(g_sfajwf_m.sfajwf017) AND NOT cl_null(g_sfajwf_m.sfajwf018) AND NOT cl_null(g_sfajwf_m.sfajwf019) AND NOT cl_null(g_sfajwf_m.sfajwf020) AND NOT cl_null(g_sfajwf_m.sfajwf021) THEN
               SELECT xmdd001,xmdd006 INTO g_sfakwf_d[l_ac].sfakwf001,l_xmdd006 FROM xmdd_t
                WHERE xmddent = g_enterprise
                  AND xmdddocno = g_sfajwf_m.sfajwf018
                  AND xmddseq = g_sfajwf_m.sfajwf019
                  AND xmddseq1 = g_sfajwf_m.sfajwf020
                  AND xmddseq2 = g_sfajwf_m.sfajwf021
               IF NOT bsft001_wf_sfakwf001_chk() THEN
                  CALL g_sfakwf_d.clear()
                  CALL g_sfakwf2_d.clear()
                  CALL g_sfakwf3_d.clear()
                  CALL g_sfakwf4_d.clear()
                  RETURN
               END IF   
               CALL bsft001_wf_sfakwf001_ref(l_cmd)                  
               IF g_sfajwf_m.sfajwf013 = '2' THEN
                  LET g_sfakwf_d[l_ac].sfakwf008 = l_xmdd006
                  LET g_sfakwf_d[l_ac].sfakwf006 = 0  
               ELSE
                  LET g_sfakwf_d[l_ac].sfakwf006 = l_xmdd006
               END IF
            END IF   
            #240201-00005#1 add--e
            #240611-00019#1 add--s ?????????????????
            SELECT COUNT(1) INTO l_n FROM sfakwf_t  WHERE sfakwfent = g_enterprise AND sfakwfsite = g_site AND sfakwfdocno = g_sfajwf_m.sfajwfdocno
            IF l_n > 0 AND g_sfajwf_m.sfajwf017 MATCHES '[1]' AND NOT cl_null(g_sfajwf_m.sfajwf018) THEN  
               CALL fgl_set_arr_curr(l_ac_t) 
               CALL g_sfakwf_d.deleteElement(l_ac)
               LET INT_FLAG = TRUE
               LET l_ac = l_ac_t              
            END IF
            #240611-00019#1 add--e

            #250328-00010#1 add--s
            LET g_sfakwf_d[l_ac].sfakwf049 = g_sfajwf_m.sfajwf025
            LET g_sfakwf_d[l_ac].sfakwf049_desc = s_desc_get_department_desc(g_sfakwf_d[l_ac].sfakwf049)
            DISPLAY BY NAME g_sfakwf_d[l_ac].sfakwf049_desc  
            #250328-00010#1 add--e
            #end add-point
            LET g_sfakwf_d_t.* = g_sfakwf_d[l_ac].*     #?????
            LET g_sfakwf_d_o.* = g_sfakwf_d[l_ac].*     #?????
            CALL cl_show_fld_cont()
            CALL bsft001_wf_set_entry_b(l_cmd)
            #add-point:modify?after_set_entry_b name="input.body.insert.after_set_entry_b"
            
            #end add-point
            CALL bsft001_wf_set_no_entry_b(l_cmd)
            IF lb_reproduce THEN
               LET lb_reproduce = FALSE
               LET g_sfakwf_d[li_reproduce_target].* = g_sfakwf_d[li_reproduce].*
 
               LET g_sfakwf_d[li_reproduce_target].sfakwfseq = NULL
 
            END IF
            
 
            #add-point:modify?before insert name="input.body.before_insert"
            CALL bsft001_wf_set_no_require()   #240709-00009#1 add
            CALL bsft001_wf_set_require()      #240709-00009#1 add
            #end add-point  
  
         AFTER INSERT
            LET l_insert = FALSE
            IF INT_FLAG THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code = 9001 
               LET g_errparam.popup = FALSE 
               CALL cl_err()
               LET INT_FLAG = 0
               CANCEL INSERT
            END IF
               
            #add-point:???? name="input.body.b_a_insert"
            IF cl_null(g_sfakwf_d[l_ac].sfakwf003) THEN
               LET g_sfakwf_d[l_ac].sfakwf003 = ' '
            END IF
            #end add-point
               
            LET l_count = 1  
            SELECT COUNT(1) INTO l_count FROM sfakwf_t 
             WHERE sfakwfent = g_enterprise AND sfakwfsite = g_site AND sfakwfdocno = g_sfajwf_m.sfajwfdocno
 
               AND sfakwfseq = g_sfakwf_d[l_ac].sfakwfseq
 
                
            #?????, ??????
            IF l_count = 0 THEN 
               #add-point:????? name="input.body.b_insert"

               #end add-point
            
               #????????table
                              INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_sfajwf_m.sfajwfdocno
               LET gs_keys[2] = g_sfakwf_d[g_detail_idx].sfakwfseq
               CALL bsft001_wf_insert_b('sfakwf_t',gs_keys,"'1'")
                           
               #add-point:????? name="input.body.a_insert"

               #end add-point
            ELSE    
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = 'INSERT' 
               LET g_errparam.code = "std-00006" 
               LET g_errparam.popup = TRUE 
               INITIALIZE g_sfakwf_d[l_ac].* TO NULL
               CALL s_transaction_end('N','0')
               CALL cl_err()
               CANCEL INSERT
            END IF
 
            IF SQLCA.SQLCODE THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "sfakwf_t:",SQLERRMESSAGE 
               LET g_errparam.code = SQLCA.SQLCODE 
               LET g_errparam.popup = TRUE 
               CALL s_transaction_end('N','0')                    
               CALL cl_err()
               CANCEL INSERT
            ELSE
               #?????
               #CALL bsft001_wf_b_fill()
               #??????-?/?
               
                  #161130-00056 add
               #add-point:input?-after_insert name="input.body.a_insert2"

               #end add-point
               CALL s_transaction_end('Y','0')
               #ERROR 'INSERT O.K'
               LET g_rec_b = g_rec_b + 1
            END IF
              
         BEFORE DELETE                            #??????
            IF l_cmd = 'a' THEN
               LET l_cmd='d'
               #add-point:?????(=d) name="input.body.after_delete_d"

               #end add-point
            ELSE
               #add-point:????? name="input.body.b_delete_ask"

               #end add-point 
               IF NOT cl_ask_del_detail() THEN
                  CANCEL DELETE
               END IF
               IF l_lock_sw = "Y" THEN
                  INITIALIZE g_errparam TO NULL 
                  LET g_errparam.extend = "" 
                  LET g_errparam.code = -263 
                  LET g_errparam.popup = TRUE 
                  CALL cl_err()
                  CANCEL DELETE
               END IF
               
               #add-point:????? name="input.body.b_delete"

               #end add-point 
               
               #??????key?
               INITIALIZE gs_keys TO NULL
               LET gs_keys[01] = g_sfajwf_m.sfajwfdocno
 
               LET gs_keys[gs_keys.getLength()+1] = g_sfakwf_d_t.sfakwfseq
 
            
               #??????
               IF NOT bsft001_wf_delete_b('sfakwf_t',gs_keys,"'1'") THEN
                  CALL s_transaction_end('N','0')
                  CLOSE bsft001_wf_bcl
                  CANCEL DELETE
               END IF
    
               #??????
               IF NOT bsft001_wf_key_delete_b(gs_keys,'sfakwf_t') THEN
                  CALL s_transaction_end('N','0')
                  CLOSE bsft001_wf_bcl
                  CANCEL DELETE
               END IF
               
               #?????
               
 
               
   #161130-00056 add
               
               #add-point:????? name="input.body.m_delete"

               #end add-point 
               
               CALL s_transaction_end('Y','0')
               CLOSE bsft001_wf_bcl
            
               LET g_rec_b = g_rec_b-1
               #add-point:????? name="input.body.a_delete"

               #end add-point
               LET l_count = g_sfakwf_d.getLength()
               
               #add-point:?????(<>d) name="input.body.after_delete"

               #end add-point
            END IF
 
         AFTER DELETE
            #???????
            IF l_ac = (g_sfakwf_d.getLength() + 1) THEN
               CALL FGL_SET_ARR_CURR(l_ac-1)
            END IF
 
                  #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwfseq
            #add-point:BEFORE FIELD sfakwfseq name="input.b.page1.sfakwfseq"
            
            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwfseq
            
            #add-point:AFTER FIELD sfakwfseq name="input.a.page1.sfakwfseq"
            #?? a05 ??????(Version:3)
            #???????
            IF  g_sfajwf_m.sfajwfdocno IS NOT NULL AND g_sfakwf_d[g_detail_idx].sfakwfseq IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_sfajwf_m.sfajwfdocno != g_sfajwfdocno_t OR g_sfakwf_d[g_detail_idx].sfakwfseq != g_sfakwf_d_t.sfakwfseq)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(1) FROM sfakwf_t WHERE "||"sfakwfent = " ||g_enterprise|| " AND sfakwfsite = '" ||g_site|| "' AND "||"sfakwfdocno = '"||g_sfajwf_m.sfajwfdocno ||"' AND "|| "sfakwfseq = '"||g_sfakwf_d[g_detail_idx].sfakwfseq ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF                  
               END IF           
            END IF



            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfakwfseq
            #add-point:ON CHANGE sfakwfseq name="input.g.page1.sfakwfseq"

            #END add-point 
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf001
            
            #add-point:AFTER FIELD sfakwf001 name="input.a.page1.sfakwf001"
#            INITIALIZE g_ref_fields TO NULL
#            LET g_ref_fields[1] = g_sfakwf_d[l_ac].sfakwf001
#            CALL ap_ref_array2(g_ref_fields,"SELECT imaal003 FROM imaal_t WHERE imaalent="||g_enterprise||" AND imaal001=? AND imaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
#            LET g_sfakwf_d[l_ac].sfakwf001_desc = '', g_rtn_fields[1] , ''
#            DISPLAY BY NAME g_sfakwf_d[l_ac].sfakwf001_desc
            LET g_sfakwf_d[l_ac].sfakwf001_desc = ''
            LET g_sfakwf_d[l_ac].sfakwf001_desc_1 = ''
            IF NOT cl_null(g_sfakwf_d[l_ac].sfakwf001) THEN
               IF g_sfakwf_d[l_ac].sfakwf001 != g_sfakwf_d_o.sfakwf001 OR cl_null(g_sfakwf_d_o.sfakwf001) THEN
                  IF NOT bsft001_wf_sfakwf001_chk() THEN
                     LET g_sfakwf_d[l_ac].sfakwf001 = g_sfakwf_d_o.sfakwf001
                     CALL s_desc_get_item_desc(g_sfakwf_d[l_ac].sfakwf001) RETURNING g_sfakwf_d[l_ac].sfakwf001_desc,g_sfakwf_d[l_ac].sfakwf001_desc_1
                     DISPLAY BY NAME g_sfakwf_d[l_ac].sfakwf001,g_sfakwf_d[l_ac].sfakwf001_desc,g_sfakwf_d[l_ac].sfakwf001_desc_1
                     NEXT FIELD CURRENT
                  END IF 
                  CALL bsft001_wf_sfakwf001_ref(l_cmd)                  
               END IF  
               IF g_sfajwf_m.sfajwf013 <> '3' THEN 
                  LET g_sfakwf_d[l_ac].sfakwf006 = 0                  
               END IF               
            END IF       

            #240704-00015#1 add ---s
            LET l_dfin5002 = ''            
            LET l_controlno = '' 
            LET l_imaf153 = ''
            SELECT imaf153 INTO l_imaf153 FROM imaf_t
            WHERE imafent = g_enterprise AND imafsite = g_site AND imaf001 = g_sfakwf_d[l_ac].sfakwf001            
            CALL s_control_get_group1('4',g_user,g_dept,l_imaf153) RETURNING r_success,l_controlno 
            LET l_count = 0
            IF NOT cl_null(l_controlno) THEN
               #??????????????????????(apmi110)?????????????default?????
               SELECT COUNT(1) INTO l_count FROM pmal_t 
                WHERE pmalent = g_enterprise 
                  AND pmal001 = g_sfajwf_m.sfajwf006 
                  AND pmal002 = l_controlno 
                  AND pmalstus = 'Y'
               IF l_count > 0 THEN
                  SELECT pmal009
                    INTO l_pmdl024
                    FROM pmal_t 
                   WHERE pmalent = g_enterprise 
                     AND pmal001 = g_sfajwf_m.sfajwf006 
                     AND pmal002 = l_controlno 
                     AND pmalstus = 'Y'
               END IF
            END IF     
            #???????????????????????????????(apmm202)??  
            IF cl_null(l_controlno) OR l_count = 0 THEN
               SELECT pmab039
                 INTO l_pmdl024
                 FROM pmab_t 
                WHERE pmabent = g_enterprise 
                  AND pmabsite = g_site 
                  AND pmab001 = g_sfajwf_m.sfajwf006          
            END IF            
            
            CALL cl_get_doc_para(g_enterprise,g_site,g_slip,'D-FIN-5002') RETURNING l_dfin5002
            IF g_sfajwf_m.sfajwf005 = '2' AND (l_dfin5002 = 'Y' OR l_dfin5002 = 'C') THEN            
               CALL s_abg_get_bgao004(g_sfakwf_d[l_ac].sfakwf001,g_sfajwf_m.sfajwfdocdt,'35',l_pmdl024) RETURNING g_sfakwf_d[l_ac].sfakwf048
            END IF
            CALL bsft001_wf_detail_abg('3')
                 RETURNING l_success,l_errno_abg,l_bgaf016,
                           l_pmdn058,l_pmdn058_desc,l_pmdn058_desc_sql
            LET g_sfakwf_d[l_ac].sfakwf048_desc = l_pmdn058_desc
            DISPLAY BY NAME g_sfakwf_d[l_ac].sfakwf048_desc            
            #240704-00015#1 add ---e
            LET g_sfakwf_d_o.sfakwf001 = g_sfakwf_d[l_ac].sfakwf001
            CALL bsft001_wf_set_entry(p_cmd)
            CALL bsft001_wf_set_no_entry(p_cmd)
            CALL bsft001_wf_set_no_require()   #240709-00009#1 add
            CALL bsft001_wf_set_require()      #240709-00009#1 add
            DISPLAY BY NAME g_sfakwf_d[l_ac].sfakwf001_desc,g_sfakwf_d[l_ac].sfakwf001_desc_1 
            #END add-point
            
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf001
            #add-point:BEFORE FIELD sfakwf001 name="input.b.page1.sfakwf001"
            #240201-00005#1 add--s 
            IF g_sfajwf_m.sfajwf017 = '1' THEN                                          
               IF cl_null(g_sfajwf_m.sfajwf018) OR cl_null(g_sfajwf_m.sfajwf019) OR cl_null(g_sfajwf_m.sfajwf020) OR cl_null(g_sfajwf_m.sfajwf021) THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = 'asf-00150'
                  LET g_errparam.popup = TRUE
                  CALL cl_err()
                  NEXT FIELD sfakwf001
               END IF
            END IF
#            IF NOT cl_null(g_sfajwf_m.sfajwf017) AND NOT cl_null(g_sfajwf_m.sfajwf018) AND NOT cl_null(g_sfajwf_m.sfajwf019) AND NOT cl_null(g_sfajwf_m.sfajwf020) AND NOT cl_null(g_sfajwf_m.sfajwf021) THEN
#               SELECT xmdd001,xmdd006 INTO g_sfakwf_d[l_ac].sfakwf001,l_xmdd006 FROM xmdd_t
#                WHERE xmddent = g_enterprise
#                  AND xmdddocno = g_sfajwf_m.sfajwf018
#                  AND xmddseq = g_sfajwf_m.sfajwf019
#                  AND xmddseq1 = g_sfajwf_m.sfajwf020
#                  AND xmddseq2 = g_sfajwf_m.sfajwf021
#               IF NOT bsft001_wf_sfakwf001_chk() THEN
#                  CALL g_sfakwf_d.clear()
#                  CALL g_sfakwf2_d.clear()
#                  CALL g_sfakwf3_d.clear()
#                  CALL g_sfakwf4_d.clear()
#                  RETURN
#               END IF   
#               CALL bsft001_wf_sfakwf001_ref(l_cmd)                  
#               IF g_sfajwf_m.sfajwf013 = '2' THEN
#                  LET g_sfakwf_d[l_ac].sfakwf008 = l_xmdd006
#                  LET g_sfakwf_d[l_ac].sfakwf006 = 0  
#               ELSE
#                  LET g_sfakwf_d[l_ac].sfakwf006 = l_xmdd006
#               END IF
#            END IF   
            #240201-00005#1 add--e
            #END add-point
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfakwf001
            #add-point:ON CHANGE sfakwf001 name="input.g.page1.sfakwf001"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf002
            #add-point:BEFORE FIELD sfakwf002 name="input.b.page1.sfakwf002"
            #240201-00005#1 add--s 
            IF g_sfajwf_m.sfajwf017 = '1' THEN                                          
               IF cl_null(g_sfajwf_m.sfajwf018) OR cl_null(g_sfajwf_m.sfajwf019) OR cl_null(g_sfajwf_m.sfajwf020) OR cl_null(g_sfajwf_m.sfajwf021) THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = 'asf-00150'
                  LET g_errparam.popup = TRUE
                  CALL cl_err()
                  NEXT FIELD sfakwf002
               END IF
            END IF
            #240201-00005#1 add--e
            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf002
            
            #add-point:AFTER FIELD sfakwf002 name="input.a.page1.sfakwf002"
            IF cl_null(g_sfakwf_d[l_ac].sfakwf002) THEN
               LET g_sfakwf_d[l_ac].sfakwf002 = ' '
            ELSE
               IF g_sfakwf_d_o.sfakwf002 IS NULL OR g_sfakwf_d[l_ac].sfakwf002 != g_sfakwf_d_o.sfakwf002 THEN
                  IF NOT cl_null(g_sfakwf_d[l_ac].sfakwf001) THEN                
                    #160727-00025#1-s
                     CALL s_aooi200_get_slip(g_sfajwf_m.sfajwfdocno) RETURNING l_success,l_ooba002
                    #IF g_sfajwf_m.sfajwf003 MATCHES '[145]' THEN
                     IF g_sfajwf_m.sfajwf003 MATCHES '[14]' OR
                       (g_sfajwf_m.sfajwf003 = '5' AND cl_get_doc_para(g_enterprise,g_site,l_ooba002,'D-MFG-0024') <> '2') THEN
                    #160727-00025#1-e
                        LET l_bmaa001 = ''
                        LET l_bmaastus = ''
                        LET l_sql = " SELECT bmaa001,bmaastus FROM bmaa_t ",
                                    "  WHERE bmaaent = ",g_enterprise," AND bmaasite = '",g_site,"' ",
                                    "    AND bmaa001 = '", g_sfakwf_d[l_ac].sfakwf001,"' AND bmaa002 = '",g_sfakwf_d[l_ac].sfakwf002,"' "
                        PREPARE sel_bmaa_pre1 FROM l_sql
                        EXECUTE sel_bmaa_pre1 INTO l_bmaa001,l_bmaastus
                        IF cl_null(l_bmaa001) THEN
                           INITIALIZE g_errparam TO NULL
                           LET g_errparam.code = 'asf-00045'
                           LET g_errparam.extend = g_sfakwf_d[l_ac].sfakwf002
                           LET g_errparam.popup = TRUE
                           CALL cl_err()
                           LET g_sfakwf_d[l_ac].sfakwf002 = g_sfakwf_d_o.sfakwf002
                           DISPLAY BY NAME g_sfakwf_d[l_ac].sfakwf002
                           NEXT FIELD sfakwf002
                        END IF
                        IF cl_null(l_bmaastus) THEN
                           INITIALIZE g_errparam TO NULL
                           LET g_errparam.code = 'asf-00045'
                           LET g_errparam.extend = g_sfakwf_d[l_ac].sfakwf002
                           LET g_errparam.popup = TRUE
                           CALL cl_err()
                           LET g_sfakwf_d[l_ac].sfakwf002 = g_sfakwf_d_o.sfakwf002
                           DISPLAY BY NAME g_sfakwf_d[l_ac].sfakwf002
                           NEXT FIELD sfakwf002
                        END IF
                     END IF
                     #161216-00029#10 add(s)
                     LET l_n = 0 
                     SELECT COUNT(*) INTO l_n
                      FROM bmaa_t
                     WHERE bmaa001 = g_sfakwf_d[l_ac].sfakwf001
                       AND bmaa002 = g_sfakwf_d[l_ac].sfakwf002
                       AND bmaaent = g_enterprise
                       AND bmaasite = g_site
                       AND bmaastus = 'VO'
                     IF l_n > 0 THEN
                        INITIALIZE g_errparam TO NULL
                        LET g_errparam.code = 'abm-00274'
                        LET g_errparam.popup = TRUE
                        CALL cl_err()
                        LET g_sfakwf_d[l_ac].sfakwf002 = g_sfakwf_d_o.sfakwf002
                        NEXT FIELD CURRENT
                     END IF
                     #161216-00029#10 add(e)
                  END IF 
               END IF
            END IF
            LET g_sfakwf_d_o.sfakwf002 = g_sfakwf_d[l_ac].sfakwf002
            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfakwf002
            #add-point:ON CHANGE sfakwf002 name="input.g.page1.sfakwf002"

            #END add-point 
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf003
            
            #add-point:AFTER FIELD sfakwf003 name="input.a.page1.sfakwf003"
#            INITIALIZE g_ref_fields TO NULL
#            LET g_ref_fields[1] = g_sfakwf_d[l_ac].sfakwf003
#            CALL ap_ref_array2(g_ref_fields,"SELECT inaml004 FROM inaml_t WHERE inamlent="||g_enterprise||" AND inaml001=? AND inaml002=? AND inaml003='"||g_dlang||"'","") RETURNING g_rtn_fields
#            LET g_sfakwf_d[l_ac].sfakwf003_desc = '', g_rtn_fields[1] , ''
#            DISPLAY BY NAME g_sfakwf_d[l_ac].sfakwf003_desc

            IF NOT cl_null(g_sfakwf_d[l_ac].sfakwf001) AND NOT cl_null(g_sfakwf_d[l_ac].sfakwf003) THEN            
               #??????
               IF NOT s_feature_check(g_sfakwf_d[l_ac].sfakwf001,g_sfakwf_d[l_ac].sfakwf003) THEN
                  LET g_sfakwf_d[l_ac].sfakwf003 = g_sfakwf_d_t.sfakwf003
                  NEXT FIELD sfakwf003
               END IF
               #--151224-00025#4 add start--
               IF NOT s_feature_direct_input(g_sfakwf_d[l_ac].sfakwf001,g_sfakwf_d[l_ac].sfakwf003,g_sfakwf_d_t.sfakwf003,g_sfajwf_m.sfajwfdocno,g_site) THEN
                  NEXT FIELD CURRENT
               END IF
               #--151224-00025#4 add end--
               #????????
               CALL s_feature_description(g_sfakwf_d[l_ac].sfakwf001,g_sfakwf_d[l_ac].sfakwf003)
                  RETURNING l_success,g_sfakwf_d[l_ac].sfakwf003_desc
               IF NOT l_success THEN
                  LET g_sfakwf_d[l_ac].sfakwf003_desc = ''
               END IF
            ELSE 
               LET g_sfakwf_d[l_ac].sfakwf003_desc = ''
            END IF
#            IF NOT cl_null(g_sfakwf_d[l_ac].sfakwf001) THEN
#               #???????????
#               CALL bsft001_wf_get_work_date(p_cmd) 
#            END IF  
            #240523-00025#1 add -s
            IF g_sfakwf_d[l_ac].sfakwf003 != g_sfakwf_d_o.sfakwf003 OR cl_null(g_sfakwf_d_o.sfakwf003) THEN
               CALL bsft001_wf_sfakwf001_ref_2(l_cmd)                  
            END IF 
            #240523-00025#1 add -e

            DISPLAY BY NAME g_sfakwf_d[l_ac].sfakwf003_desc
            #END add-point
            
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf003
            #add-point:BEFORE FIELD sfakwf003 name="input.b.page1.sfakwf003"

            #END add-point
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfakwf003
            #add-point:ON CHANGE sfakwf003 name="input.g.page1.sfakwf003"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf004
            #add-point:BEFORE FIELD sfakwf004 name="input.b.page1.sfakwf004"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf004
            
            #add-point:AFTER FIELD sfakwf004 name="input.a.page1.sfakwf004"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfakwf004
            #add-point:ON CHANGE sfakwf004 name="input.g.page1.sfakwf004"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf005
            #add-point:BEFORE FIELD sfakwf005 name="input.b.page1.sfakwf005"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf005
            
            #add-point:AFTER FIELD sfakwf005 name="input.a.page1.sfakwf005"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfakwf005
            #add-point:ON CHANGE sfakwf005 name="input.g.page1.sfakwf005"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf006
            #add-point:BEFORE FIELD sfakwf006 name="input.b.page1.sfakwf006"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf006
            
            #add-point:AFTER FIELD sfakwf006 name="input.a.page1.sfakwf006"
            IF NOT cl_null(g_sfakwf_d[l_ac].sfakwf006) THEN
               IF g_sfakwf_d[l_ac].sfakwf006 != g_sfakwf_d_o.sfakwf006 OR cl_null(g_sfakwf_d_o.sfakwf006) THEN
                  #????
                  CALL s_aooi250_take_decimals(g_sfakwf_d[l_ac].sfakwf007,g_sfakwf_d[l_ac].sfakwf006)
                       RETURNING l_success,g_sfakwf_d[l_ac].sfakwf006                 
               END IF
               IF g_sfajwf_m.sfajwf013 = '3' AND g_sfakwf_d[l_ac].sfakwf006 <= 0 THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = "agl-00041"
                  LET g_errparam.extend = ""
                  LET g_errparam.popup = FALSE
                  CALL cl_err() 
                  NEXT FIELD CURRENT                     
               END IF
#               #???????????
#               CALL bsft001_wf_get_work_date(p_cmd)
            #241104-00004#1 add--s
            ELSE
               LET g_sfakwf_d[l_ac].sfakwf006 = 0
            #241104-00004#1 add--e
            END IF
            LET g_sfakwf_d_o.sfakwf006 = g_sfakwf_d[l_ac].sfakwf006
            DISPLAY BY NAME g_sfakwf_d[l_ac].sfakwf006
            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfakwf006
            #add-point:ON CHANGE sfakwf006 name="input.g.page1.sfakwf006"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf007
            #add-point:BEFORE FIELD sfakwf007 name="input.b.page1.sfakwf007"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf007
            
            #add-point:AFTER FIELD sfakwf007 name="input.a.page1.sfakwf007"
            IF NOT cl_null(g_sfakwf_d[l_ac].sfakwf007) THEN
               IF g_sfakwf_d[l_ac].sfakwf007 != g_sfakwf_d_o.sfakwf007 OR cl_null(g_sfakwf_d_o.sfakwf007) THEN
                  IF NOT bsft001_wf_chk_sfakwf007(g_sfakwf_d[l_ac].sfakwf007) THEN
                     LET g_sfakwf_d[l_ac].sfakwf007 = g_sfakwf_d_o.sfakwf007
                     DISPLAY BY NAME g_sfakwf_d[l_ac].sfakwf007
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            LET g_sfakwf_d_o.sfakwf007 = g_sfakwf_d[l_ac].sfakwf007
            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfakwf007
            #add-point:ON CHANGE sfakwf007 name="input.g.page1.sfakwf007"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf008
            #add-point:BEFORE FIELD sfakwf008 name="input.b.page1.sfakwf008"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf008
            
            #add-point:AFTER FIELD sfakwf008 name="input.a.page1.sfakwf008"
            IF NOT cl_null(g_sfakwf_d[l_ac].sfakwf008) THEN
               IF g_sfakwf_d[l_ac].sfakwf008 != g_sfakwf_d_o.sfakwf008 OR cl_null(g_sfakwf_d_o.sfakwf008) THEN
                  #????
                  #241104-00004#1 mark--s
#                  CALL s_aooi250_take_decimals(g_sfakwf_d[l_ac].sfakwf007,g_sfakwf_d[l_ac].sfakwf008)
#                       RETURNING l_success,g_sfakwf_d[l_ac].sfakwf008
                  #241104-00004#1 mark--e                          
               END IF
#               IF g_sfajwf_m.sfajwf013 = '2' AND g_sfakwf_d[l_ac].sfakwf008 <= 0 THEN #241104-00004#1 mark
               IF g_sfajwf_m.sfajwf013 = '2' AND g_sfakwf_d[l_ac].sfakwf008 < 0 THEN #241104-00004#1 add
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = "wf-00042"
                  LET g_errparam.extend = ""
                  LET g_errparam.popup = FALSE
                  CALL cl_err() 
                  NEXT FIELD CURRENT                     
               END IF
            #241104-00004#1 add--s
            ELSE
               LET g_sfakwf_d[l_ac].sfakwf008 = 0
            #241104-00004#1 add--e
            END IF
            LET g_sfakwf_d_o.sfakwf008 = g_sfakwf_d[l_ac].sfakwf008
            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfakwf008
            #add-point:ON CHANGE sfakwf008 name="input.g.page1.sfakwf008"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf009
            #add-point:BEFORE FIELD sfakwf009 name="input.b.page1.sfakwf009"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf009
            
            #add-point:AFTER FIELD sfakwf009 name="input.a.page1.sfakwf009"
#            IF NOT cl_null(g_sfakwf_d[l_ac].sfakwf006) THEN
#               #???????????
#               CALL bsft001_wf_get_work_date(p_cmd) 
#            END IF  
            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfakwf009
            #add-point:ON CHANGE sfakwf009 name="input.g.page1.sfakwf009"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf010
            #add-point:BEFORE FIELD sfakwf010 name="input.b.page1.sfakwf010"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf010
            
            #add-point:AFTER FIELD sfakwf010 name="input.a.page1.sfakwf010"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfakwf010
            #add-point:ON CHANGE sfakwf010 name="input.g.page1.sfakwf010"

            #END add-point 
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf011
            
            #add-point:AFTER FIELD sfakwf011 name="input.a.page1.sfakwf011"
            IF NOT cl_null(g_sfakwf_d[l_ac].sfakwf011) THEN 
#?? a17 ??????(Version:3)
               #??????
               #??g_chkparam.*?????????????????????????????
               INITIALIZE g_chkparam.* TO NULL
 
               #??g_chkparam.*???
               LET g_chkparam.arg1 = g_sfakwf_d[l_ac].sfakwf011
               #LET g_chkparam.arg2 = g_sfajwf_m.sfajwf006 #??
               LET g_chkparam.arg3 = g_sfakwf_d[l_ac].sfakwf001 #??
               LET g_chkparam.arg4 = g_sfajwf_m.sfajwf016  #??/??
               
               #240423-00009#2 --s
               #IC?????????=??,????????=2.???3.????
               IF g_sfajwf_m.sfajwf005 = '1' THEN
                  LET g_chkparam.arg5 = "'2','3'"
               ELSE
               #????=??????????????=1.????3.????
                  LET l_qwhere = ''
                  LET g_chkparam.arg5 = "'1','3'"
                  LET l_qwhere = l_qwhere," wfagwf009='",g_sfajwf_m.sfajwf006,"'"
                  LET g_chkparam.where = l_qwhere
               END IF
               #240423-00009#2 --e
               #??????????library
               IF cl_chk_exist("v_sfakwf011_01_wf") THEN
                  #?????????
               ELSE
                  #?????????
                  NEXT FIELD CURRENT
               END IF
               #240423-00009#2 --s
               #??????
               IF NOT cl_null(g_sfakwf_d[l_ac].sfakwf012) THEN
                  SELECT wfagwfl003 INTO g_sfakwf_d[l_ac].sfakwf012_desc FROM wfagwfl_t
                    WHERE wfagwflent = g_enterprise AND wfagwfl001 = g_sfakwf_d[l_ac].sfakwf012 AND wfagwfl002 = g_dlang
                  DISPLAY g_sfakwf_d[l_ac].sfakwf012_desc TO sfakwf012_desc
               END IF
               #240423-00009#2 --e
            ELSE
               LET g_sfakwf_d[l_ac].sfakwf012 = NULL
               LET g_sfakwf_d[l_ac].sfakwf013 = NULL
               LET g_sfakwf_d[l_ac].sfakwf014 = NULL
               LET g_sfakwf_d[l_ac].sfakwf015 = NULL
            END IF 
            #240523-00025#1 add -s
            IF g_sfakwf_d[l_ac].sfakwf011 != g_sfakwf_d_o.sfakwf011 OR cl_null(g_sfakwf_d_o.sfakwf011) THEN
               CALL bsft001_wf_sfakwf001_ref_2(l_cmd)                  
            END IF 
            #240523-00025#1 add -e

            #END add-point
            
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf011
            #add-point:BEFORE FIELD sfakwf011 name="input.b.page1.sfakwf011"

            #END add-point
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfakwf011
            #add-point:ON CHANGE sfakwf011 name="input.g.page1.sfakwf011"

            #END add-point 
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf012
            
            #add-point:AFTER FIELD sfakwf012 name="input.a.page1.sfakwf012"
            #240523-00025#1 add -s
            IF g_sfakwf_d[l_ac].sfakwf012 != g_sfakwf_d_o.sfakwf012 OR cl_null(g_sfakwf_d_o.sfakwf012) THEN
               CALL bsft001_wf_sfakwf001_ref_2(l_cmd)                  
            END IF 
            #240523-00025#1 add -e

            #END add-point
            
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf012
            #add-point:BEFORE FIELD sfakwf012 name="input.b.page1.sfakwf012"

            #END add-point
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfakwf012
            #add-point:ON CHANGE sfakwf012 name="input.g.page1.sfakwf012"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf013
            #add-point:BEFORE FIELD sfakwf013 name="input.b.page1.sfakwf013"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf013
            
            #add-point:AFTER FIELD sfakwf013 name="input.a.page1.sfakwf013"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfakwf013
            #add-point:ON CHANGE sfakwf013 name="input.g.page1.sfakwf013"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf014
            #add-point:BEFORE FIELD sfakwf014 name="input.b.page1.sfakwf014"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf014
            
            #add-point:AFTER FIELD sfakwf014 name="input.a.page1.sfakwf014"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfakwf014
            #add-point:ON CHANGE sfakwf014 name="input.g.page1.sfakwf014"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf015
            #add-point:BEFORE FIELD sfakwf015 name="input.b.page1.sfakwf015"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf015
            
            #add-point:AFTER FIELD sfakwf015 name="input.a.page1.sfakwf015"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfakwf015
            #add-point:ON CHANGE sfakwf015 name="input.g.page1.sfakwf015"

            #END add-point 
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf016
            
            #add-point:AFTER FIELD sfakwf016 name="input.a.page1.sfakwf016"
            IF NOT cl_null(g_sfakwf_d[l_ac].sfakwf016) THEN 
#?? a17 ??????(Version:3)
               #??????
               #??g_chkparam.*?????????????????????????????
               INITIALIZE g_chkparam.* TO NULL
 
               #??g_chkparam.*??? 
               LET g_chkparam.arg1 = g_sfakwf_d[l_ac].sfakwf016 
               #LET g_chkparam.arg2 = g_sfajwf_m.sfajwf006 #??
               LET g_chkparam.arg3 = g_sfakwf_d[l_ac].sfakwf001 #??
               #240423-00009#2 --s
               #IC?????????=??,????????=2.???3.????
               IF g_sfajwf_m.sfajwf005 = '1' THEN
                  LET g_chkparam.arg4 = "'2','3'"
               ELSE
               #????=??????????????=1.????3.????
                  LET l_qwhere = ''
                  LET g_chkparam.arg4 = "'1','3'"
                  LET l_qwhere = l_qwhere," wfahwf004='",g_sfajwf_m.sfajwf006,"'"
                  LET g_chkparam.where = l_qwhere
               END IF
               #240423-00009#2 --e
               #??????????library
               IF cl_chk_exist("v_sfakwf016_01_wf") THEN
                  #?????????
               ELSE
                  #?????????
                  NEXT FIELD CURRENT
               END IF
               #250220-00015#1 add ---s
               SELECT wfahwf005,wfahwf006,wfahwf010,wfahwf008,wfahwf009 INTO g_sfakwf_d[l_ac].sfakwf017,g_sfakwf_d[l_ac].sfakwf018
               ,g_sfakwf_d[l_ac].sfakwf019,g_sfakwf_d[l_ac].sfakwf020,g_sfakwf_d[l_ac].sfakwf021 FROM wfahwf_t
                WHERE wfahwfent = g_enterprise AND wfahwfsite = g_site AND wfahwf001 = g_sfakwf_d[l_ac].sfakwf016
               DISPLAY g_sfakwf_d[l_ac].sfakwf017 TO sfakwf017          
               DISPLAY g_sfakwf_d[l_ac].sfakwf018 TO sfakwf018  
               DISPLAY g_sfakwf_d[l_ac].sfakwf019 TO sfakwf019  
               DISPLAY g_sfakwf_d[l_ac].sfakwf020 TO sfakwf020  
               DISPLAY g_sfakwf_d[l_ac].sfakwf021 TO sfakwf021  
               #250220-00015#1 add ---e               
               #240423-00009#2 --s
               #250220-00015#1 add ---s
               SELECT wfahwf005,wfahwf006,wfahwf010,wfahwf008,wfahwf009 INTO g_sfakwf_d[l_ac].sfakwf017,g_sfakwf_d[l_ac].sfakwf018
               ,g_sfakwf_d[l_ac].sfakwf019,g_sfakwf_d[l_ac].sfakwf020,g_sfakwf_d[l_ac].sfakwf021 FROM wfahwf_t
                WHERE wfahwfent = g_enterprise AND wfahwfsite = g_site AND wfahwf001 = g_sfakwf_d[l_ac].sfakwf016
               DISPLAY g_sfakwf_d[l_ac].sfakwf017 TO sfakwf017          
               DISPLAY g_sfakwf_d[l_ac].sfakwf018 TO sfakwf018  
               DISPLAY g_sfakwf_d[l_ac].sfakwf019 TO sfakwf019  
               DISPLAY g_sfakwf_d[l_ac].sfakwf020 TO sfakwf020  
               DISPLAY g_sfakwf_d[l_ac].sfakwf021 TO sfakwf021  
               #250220-00015#1 add ---e               
               #??????
               IF NOT cl_null(g_sfakwf_d[l_ac].sfakwf017) THEN
                  SELECT wfaiwfl003 INTO g_sfakwf_d[l_ac].sfakwf017_desc FROM wfaiwfl_t
                    WHERE wfaiwflent = g_enterprise AND wfaiwfl001 = g_sfakwf_d[l_ac].sfakwf017 AND wfaiwfl002 = g_dlang
                  DISPLAY g_sfakwf_d[l_ac].sfakwf017_desc TO sfakwf017_desc
               END IF 
               #240423-00009#2 --e
 
            ELSE
               LET g_sfakwf_d[l_ac].sfakwf017 = NULL
               LET g_sfakwf_d[l_ac].sfakwf018 = NULL
               LET g_sfakwf_d[l_ac].sfakwf019 = NULL
               LET g_sfakwf_d[l_ac].sfakwf020 = NULL
               LET g_sfakwf_d[l_ac].sfakwf021 = NULL
            END IF 
            #240523-00025#1 add -s
            IF g_sfakwf_d[l_ac].sfakwf016 != g_sfakwf_d_o.sfakwf016 OR cl_null(g_sfakwf_d_o.sfakwf016) THEN
               CALL bsft001_wf_sfakwf001_ref_2(l_cmd)                  
            END IF 
            #240523-00025#1 add -e

            #END add-point
            
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf016
            #add-point:BEFORE FIELD sfakwf016 name="input.b.page1.sfakwf016"

            #END add-point
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfakwf016
            #add-point:ON CHANGE sfakwf016 name="input.g.page1.sfakwf016"

            #END add-point 
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf017
            
            #add-point:AFTER FIELD sfakwf017 name="input.a.page1.sfakwf017"
            #240523-00025#1 add -s
            IF g_sfakwf_d[l_ac].sfakwf017 != g_sfakwf_d_o.sfakwf017 OR cl_null(g_sfakwf_d_o.sfakwf017) THEN
               CALL bsft001_wf_sfakwf001_ref_2(l_cmd)                  
            END IF 
            #240523-00025#1 add -e

            #END add-point
            
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf017
            #add-point:BEFORE FIELD sfakwf017 name="input.b.page1.sfakwf017"

            #END add-point
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfakwf017
            #add-point:ON CHANGE sfakwf017 name="input.g.page1.sfakwf017"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf018
            #add-point:BEFORE FIELD sfakwf018 name="input.b.page1.sfakwf018"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf018
            
            #add-point:AFTER FIELD sfakwf018 name="input.a.page1.sfakwf018"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfakwf018
            #add-point:ON CHANGE sfakwf018 name="input.g.page1.sfakwf018"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf019
            #add-point:BEFORE FIELD sfakwf019 name="input.b.page1.sfakwf019"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf019
            
            #add-point:AFTER FIELD sfakwf019 name="input.a.page1.sfakwf019"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfakwf019
            #add-point:ON CHANGE sfakwf019 name="input.g.page1.sfakwf019"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf020
            #add-point:BEFORE FIELD sfakwf020 name="input.b.page1.sfakwf020"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf020
            
            #add-point:AFTER FIELD sfakwf020 name="input.a.page1.sfakwf020"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfakwf020
            #add-point:ON CHANGE sfakwf020 name="input.g.page1.sfakwf020"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf021
            #add-point:BEFORE FIELD sfakwf021 name="input.b.page1.sfakwf021"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf021
            
            #add-point:AFTER FIELD sfakwf021 name="input.a.page1.sfakwf021"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfakwf021
            #add-point:ON CHANGE sfakwf021 name="input.g.page1.sfakwf021"

            #END add-point 
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf022
            
            #add-point:AFTER FIELD sfakwf022 name="input.a.page1.sfakwf022"
            IF NOT cl_null(g_sfakwf_d[l_ac].sfakwf022) THEN 
#?? a17 ??????(Version:3)
               #??????
               #??g_chkparam.*?????????????????????????????
               INITIALIZE g_chkparam.* TO NULL
 
               #??g_chkparam.*???
               LET g_chkparam.arg1 = g_sfakwf_d[l_ac].sfakwf022
               LET g_chkparam.arg2 = g_sfajwf_m.sfajwf006 #??
               LET g_chkparam.arg3 = g_sfakwf_d[l_ac].sfakwf001 #??
               LET g_chkparam.arg4 = g_sfajwf_m.sfajwf016  #??/??
                  
               #??????????library
               IF cl_chk_exist("v_wfajwf001_wf") THEN
                  #?????????
               ELSE
                  #?????????
                  NEXT FIELD CURRENT
               END IF
            ELSE            
               LET g_sfakwf_d[l_ac].sfakwf023 = NULL
               LET g_sfakwf_d[l_ac].sfakwf023_desc = NULL
            END IF 


            #END add-point
            
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf022
            #add-point:BEFORE FIELD sfakwf022 name="input.b.page1.sfakwf022"

            #END add-point
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfakwf022
            #add-point:ON CHANGE sfakwf022 name="input.g.page1.sfakwf022"

            #END add-point 
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf023
            
            #add-point:AFTER FIELD sfakwf023 name="input.a.page1.sfakwf023"
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_sfakwf_d[l_ac].sfakwf023
            CALL ap_ref_array2(g_ref_fields,"SELECT wfajwfl003 FROM wfajwfl_t WHERE wfajwflent="||g_enterprise||" AND wfajwfl001=? AND wfajwfl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_sfakwf_d[l_ac].sfakwf023_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_sfakwf_d[l_ac].sfakwf023_desc


            #END add-point
            
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf023
            #add-point:BEFORE FIELD sfakwf023 name="input.b.page1.sfakwf023"

            #END add-point
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfakwf023
            #add-point:ON CHANGE sfakwf023 name="input.g.page1.sfakwf023"

            #END add-point 
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf024
            
            #add-point:AFTER FIELD sfakwf024 name="input.a.page1.sfakwf024"
            IF NOT cl_null(g_sfakwf_d[l_ac].sfakwf024) THEN 
#?? a17 ??????(Version:3)
               #??????
               #??g_chkparam.*?????????????????????????????
               INITIALIZE g_chkparam.* TO NULL
 
               #??g_chkparam.*???
               LET g_chkparam.arg1 = g_sfakwf_d[l_ac].sfakwf024 
               LET g_chkparam.arg2 = g_sfakwf_d[l_ac].sfakwf001 #??
                  
               #??????????library
               IF cl_chk_exist("v_wfalwf001_wf") THEN
                  #?????????
               ELSE
                  #?????????
                  NEXT FIELD CURRENT
               END IF
            ELSE            
               LET g_sfakwf_d[l_ac].sfakwf025 = NULL
               LET g_sfakwf_d[l_ac].sfakwf026 = NULL
               LET g_sfakwf_d[l_ac].sfakwf027 = NULL
               LET g_sfakwf_d[l_ac].sfakwf028 = NULL
            END IF 


            #END add-point
            
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf024
            #add-point:BEFORE FIELD sfakwf024 name="input.b.page1.sfakwf024"

            #END add-point
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfakwf024
            #add-point:ON CHANGE sfakwf024 name="input.g.page1.sfakwf024"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf025
            #add-point:BEFORE FIELD sfakwf025 name="input.b.page1.sfakwf025"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf025
            
            #add-point:AFTER FIELD sfakwf025 name="input.a.page1.sfakwf025"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfakwf025
            #add-point:ON CHANGE sfakwf025 name="input.g.page1.sfakwf025"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf026
            #add-point:BEFORE FIELD sfakwf026 name="input.b.page1.sfakwf026"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf026
            
            #add-point:AFTER FIELD sfakwf026 name="input.a.page1.sfakwf026"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfakwf026
            #add-point:ON CHANGE sfakwf026 name="input.g.page1.sfakwf026"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf027
            #add-point:BEFORE FIELD sfakwf027 name="input.b.page1.sfakwf027"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf027
            
            #add-point:AFTER FIELD sfakwf027 name="input.a.page1.sfakwf027"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfakwf027
            #add-point:ON CHANGE sfakwf027 name="input.g.page1.sfakwf027"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf028
            #add-point:BEFORE FIELD sfakwf028 name="input.b.page1.sfakwf028"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf028
            
            #add-point:AFTER FIELD sfakwf028 name="input.a.page1.sfakwf028"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfakwf028
            #add-point:ON CHANGE sfakwf028 name="input.g.page1.sfakwf028"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf029
            #add-point:BEFORE FIELD sfakwf029 name="input.b.page1.sfakwf029"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf029
            
            #add-point:AFTER FIELD sfakwf029 name="input.a.page1.sfakwf029"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfakwf029
            #add-point:ON CHANGE sfakwf029 name="input.g.page1.sfakwf029"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf030
            #add-point:BEFORE FIELD sfakwf030 name="input.b.page1.sfakwf030"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf030
            
            #add-point:AFTER FIELD sfakwf030 name="input.a.page1.sfakwf030"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfakwf030
            #add-point:ON CHANGE sfakwf030 name="input.g.page1.sfakwf030"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf031
            #add-point:BEFORE FIELD sfakwf031 name="input.b.page1.sfakwf031"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf031
            
            #add-point:AFTER FIELD sfakwf031 name="input.a.page1.sfakwf031"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfakwf031
            #add-point:ON CHANGE sfakwf031 name="input.g.page1.sfakwf031"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf044
            #add-point:BEFORE FIELD sfakwf044 name="input.b.page1.sfakwf044"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf044
            
            #add-point:AFTER FIELD sfakwf044 name="input.a.page1.sfakwf044"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfakwf044
            #add-point:ON CHANGE sfakwf044 name="input.g.page1.sfakwf044"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf032
            #add-point:BEFORE FIELD sfakwf032 name="input.b.page1.sfakwf032"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf032
            
            #add-point:AFTER FIELD sfakwf032 name="input.a.page1.sfakwf032"
            IF NOT cl_null(g_sfakwf_d[l_ac].sfakwf032) THEN
               IF g_sfakwf_d[l_ac].sfakwf032 != g_sfakwf_d_o.sfakwf032 OR cl_null(g_sfakwf_d_o.sfakwf032) THEN
                  IF NOT cl_null(g_sfajwf_m.sfajwfdocdt) THEN
                     IF g_sfajwf_m.sfajwfdocdt > g_sfakwf_d[l_ac].sfakwf032 THEN
                        INITIALIZE g_errparam TO NULL
                        LET g_errparam.code = 'asf-00308'
                        LET g_errparam.extend = g_sfajwf_m.sfajwfdocdt
                        LET g_errparam.popup = TRUE
                        CALL cl_err()
                        LET g_sfakwf_d[l_ac].sfakwf032 = g_sfakwf_d_o.sfakwf032
                        DISPLAY BY NAME g_sfakwf_d[l_ac].sfakwf032
                        NEXT FIELD CURRENT
                     END IF
                  END IF
                  IF cl_ask_confirm('asf-00142') THEN
                     CALL s_asft300_06('1',g_sfakwf_d[l_ac].sfakwf001,g_sfakwf_d[l_ac].sfakwf006,g_sfakwf_d[l_ac].sfakwf032)
                          RETURNING l_success,g_sfakwf_d[l_ac].sfakwf033
                     DISPLAY BY NAME g_sfakwf_d[l_ac].sfakwf033
                  END IF
                  IF NOT cl_null(g_sfakwf_d[l_ac].sfakwf033) THEN
                     IF g_sfakwf_d[l_ac].sfakwf032 > g_sfakwf_d[l_ac].sfakwf033 THEN
                        INITIALIZE g_errparam TO NULL
                        LET g_errparam.code = 'asf-00058'
                        LET g_errparam.extend = g_sfakwf_d[l_ac].sfakwf033
                        LET g_errparam.popup = TRUE
                        CALL cl_err()
                        LET g_sfakwf_d[l_ac].sfakwf032 = g_sfakwf_d_o.sfakwf032
                        DISPLAY BY NAME g_sfakwf_d[l_ac].sfakwf032
                        NEXT FIELD CURRENT
                     END IF
                  END IF
               END IF
            END IF
            LET g_sfakwf_d_o.sfakwf032 = g_sfakwf_d[l_ac].sfakwf032
            LET g_sfakwf_d_o.sfakwf033 = g_sfakwf_d[l_ac].sfakwf033
            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfakwf032
            #add-point:ON CHANGE sfakwf032 name="input.g.page1.sfakwf032"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf033
            #add-point:BEFORE FIELD sfakwf033 name="input.b.page1.sfakwf033"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf033
            
            #add-point:AFTER FIELD sfakwf033 name="input.a.page1.sfakwf033"
            IF NOT cl_null(g_sfakwf_d[l_ac].sfakwf033) THEN
               IF g_sfakwf_d[l_ac].sfakwf033 != g_sfakwf_d_o.sfakwf033 OR cl_null(g_sfakwf_d_o.sfakwf033) THEN
                  IF cl_ask_confirm('asf-00143') THEN
                     CALL s_asft300_06('2',g_sfakwf_d[l_ac].sfakwf001,g_sfakwf_d[l_ac].sfakwf006,g_sfakwf_d[l_ac].sfakwf033)
                          RETURNING l_success,g_sfakwf_d[l_ac].sfakwf032
                     IF g_sfakwf_d[l_ac].sfakwf032 < g_sfajwf_m.sfajwfdocdt THEN
                        LET g_sfakwf_d[l_ac].sfakwf032 = g_sfajwf_m.sfajwfdocdt
                     END IF
                     DISPLAY BY NAME g_sfakwf_d[l_ac].sfakwf032
                  END IF
                  IF NOT cl_null(g_sfakwf_d[l_ac].sfakwf032) THEN
                     IF g_sfakwf_d[l_ac].sfakwf032 > g_sfakwf_d[l_ac].sfakwf033 THEN
                        INITIALIZE g_errparam TO NULL
                        LET g_errparam.code = 'asf-00058'
                        LET g_errparam.extend = g_sfakwf_d[l_ac].sfakwf032
                        LET g_errparam.popup = TRUE
                        CALL cl_err()
                        LET g_sfakwf_d[l_ac].sfakwf033 = g_sfakwf_d_o.sfakwf033
                        DISPLAY BY NAME g_sfakwf_d[l_ac].sfakwf033
                        NEXT FIELD CURRENT
                     END IF
                  END IF
               END IF
            END IF
            LET g_sfakwf_d_o.sfakwf032 = g_sfakwf_d[l_ac].sfakwf032
            LET g_sfakwf_d_o.sfakwf033 = g_sfakwf_d[l_ac].sfakwf033
            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfakwf033
            #add-point:ON CHANGE sfakwf033 name="input.g.page1.sfakwf033"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf034
            #add-point:BEFORE FIELD sfakwf034 name="input.b.page1.sfakwf034"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf034
            
            #add-point:AFTER FIELD sfakwf034 name="input.a.page1.sfakwf034"
            IF NOT cl_null(g_sfakwf_d[l_ac].sfakwf034) THEN
               IF g_sfakwf_d[l_ac].sfakwf034 != g_sfakwf_d_o.sfakwf034 OR cl_null(g_sfakwf_d_o.sfakwf034) THEN
                  IF cl_get_para(g_enterprise,g_site,'S-BAS-0019') = "Y" THEN									
                        SELECT imaf144 INTO g_sfakwf_d[l_ac].sfakwf035 									
                        FROM imaf_t									
                        WHERE imafent  = g_enterprise									
                        AND imafsite = g_site									
                        AND imaf001  =  g_sfakwf_d[l_ac].sfakwf001									
                        IF cl_null(g_sfakwf_d[l_ac].sfakwf035) THEN									
                        LET g_sfakwf_d[l_ac].sfakwf035   = g_sfakwf_d[l_ac].sfakwf007    #????   									
                        END IF									
                        CALL s_aooi250_convert_qty( g_sfakwf_d[l_ac].sfakwf001,g_sfakwf_d[l_ac].sfakwf007,g_sfakwf_d[l_ac].sfakwf035,g_sfakwf_d[l_ac].sfakwf006)									
                        RETURNING l_success, g_sfakwf_d[l_ac].sfakwf034									
                        IF NOT cl_null( g_sfakwf_d[l_ac].sfakwf034) THEN									
                        CALL s_apmt500_unit_round(g_sfakwf_d[l_ac].sfakwf035, g_sfakwf_d[l_ac].sfakwf034) 									
                        RETURNING  g_sfakwf_d[l_ac].sfakwf034									
                        END IF									
                  ELSE									
                        LET  g_sfakwf_d[l_ac].sfakwf035   = g_sfakwf_d[l_ac].sfakwf007  #????									
                        LET  g_sfakwf_d[l_ac].sfakwf034   = g_sfakwf_d[l_ac].sfakwf006   #????         									
                  END IF	 
               END IF
            END IF
            #240523-00025#1 add -s
            IF g_sfakwf_d[l_ac].sfakwf034 != g_sfakwf_d_o.sfakwf034 OR cl_null(g_sfakwf_d_o.sfakwf034) THEN
               CALL bsft001_wf_sfakwf001_ref_2(l_cmd)                  
            END IF 
            #240523-00025#1 add -e
            LET g_sfakwf_d_o.sfakwf035 = g_sfakwf_d[l_ac].sfakwf035
            LET g_sfakwf_d_o.sfakwf034 = g_sfakwf_d[l_ac].sfakwf034	
            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfakwf034
            #add-point:ON CHANGE sfakwf034 name="input.g.page1.sfakwf034"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf035
            #add-point:BEFORE FIELD sfakwf035 name="input.b.page1.sfakwf035"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf035
            
            #add-point:AFTER FIELD sfakwf035 name="input.a.page1.sfakwf035"
            IF cl_null(g_sfakwf_d[l_ac].sfakwf035) THEN
               IF cl_get_para(g_enterprise,g_site,'S-BAS-0019') = "Y" THEN									
                  SELECT imaf144 INTO g_sfakwf_d[l_ac].sfakwf035 									
                    FROM imaf_t									
                   WHERE imafent  = g_enterprise									
                     AND imafsite = g_site									
                     AND imaf001  =  g_sfakwf_d[l_ac].sfakwf001									
                  IF cl_null(g_sfakwf_d[l_ac].sfakwf035) THEN									
                     LET g_sfakwf_d[l_ac].sfakwf035   = g_sfakwf_d[l_ac].sfakwf007    #????   									
                  END IF									
                     CALL s_aooi250_convert_qty( g_sfakwf_d[l_ac].sfakwf001,g_sfakwf_d[l_ac].sfakwf007,g_sfakwf_d[l_ac].sfakwf035,g_sfakwf_d[l_ac].sfakwf006)									
                        RETURNING l_success, g_sfakwf_d[l_ac].sfakwf034									
                  IF NOT cl_null( g_sfakwf_d[l_ac].sfakwf034) THEN									
                     CALL s_apmt500_unit_round(g_sfakwf_d[l_ac].sfakwf035, g_sfakwf_d[l_ac].sfakwf034) 									
                        RETURNING  g_sfakwf_d[l_ac].sfakwf034									
                  END IF									
               ELSE									
                  LET  g_sfakwf_d[l_ac].sfakwf035   = g_sfakwf_d[l_ac].sfakwf007  #????									
                  LET  g_sfakwf_d[l_ac].sfakwf034   = g_sfakwf_d[l_ac].sfakwf006   #????         									
               END IF	 
            END IF
            LET g_sfakwf_d_o.sfakwf035 = g_sfakwf_d[l_ac].sfakwf035
            LET g_sfakwf_d_o.sfakwf034 = g_sfakwf_d[l_ac].sfakwf034						            
            #240523-00025#1 add -s
            IF g_sfakwf_d[l_ac].sfakwf035 != g_sfakwf_d_o.sfakwf035 OR cl_null(g_sfakwf_d_o.sfakwf035) THEN
               CALL bsft001_wf_sfakwf001_ref_2(l_cmd)                  
            END IF 
            #240523-00025#1 add -e
            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfakwf035
            #add-point:ON CHANGE sfakwf035 name="input.g.page1.sfakwf035"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf036
            #add-point:BEFORE FIELD sfakwf036 name="input.b.page1.sfakwf036"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf036
            
            #add-point:AFTER FIELD sfakwf036 name="input.a.page1.sfakwf036"
            IF NOT cl_null(g_sfakwf_d[l_ac].sfakwf036) THEN
               IF g_sfakwf_d[l_ac].sfakwf036 != g_sfakwf_d_o.sfakwf036 OR cl_null(g_sfakwf_d_o.sfakwf036) THEN
                  IF g_sfajwf_m.sfajwf015 = 'N' AND g_sfakwf_d[l_ac].sfakwf036 = 0 THEN 
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.extend = ""
                     LET g_errparam.code = "wf-00043"  #???????N????????0????!
                     LET g_errparam.popup = TRUE
                     CALL cl_err()
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            LET g_sfakwf_d_o.sfakwf036 = g_sfakwf_d[l_ac].sfakwf036
            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfakwf036
            #add-point:ON CHANGE sfakwf036 name="input.g.page1.sfakwf036"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf037
            #add-point:BEFORE FIELD sfakwf037 name="input.b.page1.sfakwf037"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf037
            
            #add-point:AFTER FIELD sfakwf037 name="input.a.page1.sfakwf037"
            IF NOT cl_null(g_sfakwf_d[l_ac].sfakwf037) THEN
               IF g_sfakwf_d[l_ac].sfakwf037 <> g_sfakwf_d_o.sfakwf037 OR cl_null(g_sfakwf_d_o.sfakwf037) THEN 
                  CALL s_tax_chk(g_site,g_sfakwf_d[l_ac].sfakwf037)
                    RETURNING l_success,l_sfakwf037_desc,g_sfakwf_d[l_ac].sfakwf039,g_sfakwf_d[l_ac].sfakwf038,l_oodb011                         
                  IF NOT l_success THEN
                     LET g_sfakwf_d[l_ac].sfakwf037 = g_sfakwf_d_o.sfakwf037
                     LET g_sfakwf_d[l_ac].sfakwf038 = g_sfakwf_d_o.sfakwf038
                     LET g_sfakwf_d[l_ac].sfakwf039 = g_sfakwf_d_o.sfakwf039
                     NEXT FIELD CURRENT                     
                  END IF
                  #????
                  IF s_aooi200_chk_doc_fields(g_site,'1',g_slip,'sfakwf038') THEN  
                     CALL s_aooi200_get_doc_default(g_site,'1',g_slip,'sfakwf038',g_sfakwf_d[l_ac].sfakwf038) RETURNING g_sfakwf_d[l_ac].sfakwf038
                  END IF 
                  IF s_aooi200_chk_doc_fields(g_site,'1',g_slip,'sfakwf039') THEN  
                     CALL s_aooi200_get_doc_default(g_site,'1',g_slip,'sfakwf039',g_sfakwf_d[l_ac].sfakwf039) RETURNING g_sfakwf_d[l_ac].sfakwf039
                  END IF  
                  DISPLAY BY NAME g_sfakwf_d[l_ac].sfakwf038,g_sfakwf_d[l_ac].sfakwf039
               
               END IF                          
            END IF 
            #240523-00025#1 add -s
            IF g_sfakwf_d[l_ac].sfakwf037 != g_sfakwf_d_o.sfakwf037 OR cl_null(g_sfakwf_d_o.sfakwf037) THEN
               CALL bsft001_wf_sfakwf001_ref_2(l_cmd)                  
            END IF 
            #240523-00025#1 add -e
            LET g_sfakwf_d_o.sfakwf037 = g_sfakwf_d[l_ac].sfakwf037
            LET g_sfakwf_d_o.sfakwf038 = g_sfakwf_d[l_ac].sfakwf038
            LET g_sfakwf_d_o.sfakwf039 = g_sfakwf_d[l_ac].sfakwf039
            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfakwf037
            #add-point:ON CHANGE sfakwf037 name="input.g.page1.sfakwf037"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf039
            #add-point:BEFORE FIELD sfakwf039 name="input.b.page1.sfakwf039"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf039
            
            #add-point:AFTER FIELD sfakwf039 name="input.a.page1.sfakwf039"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfakwf039
            #add-point:ON CHANGE sfakwf039 name="input.g.page1.sfakwf039"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf040
            #add-point:BEFORE FIELD sfakwf040 name="input.b.page1.sfakwf040"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf040
            
            #add-point:AFTER FIELD sfakwf040 name="input.a.page1.sfakwf040"
            IF NOT cl_null(g_sfakwf_d[l_ac].sfakwf040) THEN
               IF g_sfakwf_d[l_ac].sfakwf040 != g_sfakwf_d_o.sfakwf040 OR cl_null(g_sfakwf_d_o.sfakwf040) THEN
                  #??"????"?"????"
                  LET l_imaf173 = 0
                  LET l_imaf174 = 0
                  SELECT imaf173,imaf174,imaf153 INTO l_imaf173,l_imaf174,l_imaf153  
                    FROM imaf_t
                   WHERE imafent = g_enterprise AND imafsite = g_site AND imaf001 = g_sfakwf_d[l_ac].sfakwf001
#                  IF cl_null(l_imaf153) THEN
#                     INITIALIZE g_errparam TO NULL
#                     LET g_errparam.code = 'axm-00553'
#                     LET g_errparam.extend = g_sfajwf_m.sfajwfdocno
#                     LET g_errparam.replace[1] = g_sfakwf_d[l_ac].sfakwf001
#                     LET g_errparam.popup = TRUE
#                     CALL cl_err()       
#                  END IF
                  
                  LET l_imaf173 = l_imaf173 * -1
                  LET l_imaf174 = l_imaf174 * -1
                  
                  #????,?????????????,????????????
                  #1.???? = ???? - [T:????????].[C:??????]
#                  IF NOT cl_null(l_imaf174) AND l_imaf174 <> 0 THEN
#                     CALL s_date_get_work_date(g_site,g_ooef008,g_ooef009,g_sfakwf_d[l_ac].sfakwf040,0,l_imaf174) RETURNING l_pmdn013
#                  ELSE
#                     LET l_pmdn013 = g_sfakwf_d[l_ac].sfakwf040
#                  END IF
#  #               2.????= ???? - [T:????????].[C:??????]                              
#                  IF NOT cl_null(l_imaf173) AND l_imaf173 <> 0 THEN
#                     CALL s_date_get_work_date(g_site,g_ooef008,g_ooef009,l_pmdn013,0,l_imaf173) RETURNING g_sfakwf_d[l_ac].sfakwf040
#                  ELSE
#                     LET g_sfakwf_d[l_ac].sfakwf040 = l_pmdn013
#                  END IF
#
#                  IF g_sfakwf_d[l_ac].sfakwf040 < g_sfajwf_m.sfajwfdocdt THEN
#                     LET g_sfakwf_d[l_ac].sfakwf040 = g_sfajwf_m.sfajwfdocdt
#                  END IF 
               END IF
            END IF
            LET g_sfakwf_d_o.sfakwf040 = g_sfakwf_d[l_ac].sfakwf040	
            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfakwf040
            #add-point:ON CHANGE sfakwf040 name="input.g.page1.sfakwf040"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf041
            #add-point:BEFORE FIELD sfakwf041 name="input.b.page1.sfakwf041"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf041
            
            #add-point:AFTER FIELD sfakwf041 name="input.a.page1.sfakwf041"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfakwf041
            #add-point:ON CHANGE sfakwf041 name="input.g.page1.sfakwf041"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf042
            #add-point:BEFORE FIELD sfakwf042 name="input.b.page1.sfakwf042"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf042
            
            #add-point:AFTER FIELD sfakwf042 name="input.a.page1.sfakwf042"
            IF NOT cl_null(g_sfakwf_d[l_ac].sfakwf042) THEN
               IF g_sfakwf_d[l_ac].sfakwf042 != g_sfakwf_d_o.sfakwf042 OR cl_null(g_sfakwf_d_o.sfakwf042) THEN
                  IF NOT bsft001_wf_chk_sfakwf042() THEN
                     LET g_sfakwf_d[l_ac].sfakwf042 = g_sfakwf_d_o.sfakwf042
                     DISPLAY BY NAME g_sfakwf_d[l_ac].sfakwf042
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfakwf042
            #add-point:ON CHANGE sfakwf042 name="input.g.page1.sfakwf042"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf043
            #add-point:BEFORE FIELD sfakwf043 name="input.b.page1.sfakwf043"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf043
            
            #add-point:AFTER FIELD sfakwf043 name="input.a.page1.sfakwf043"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfakwf043
            #add-point:ON CHANGE sfakwf043 name="input.g.page1.sfakwf043"

            #END add-point 
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf045
            
            #add-point:AFTER FIELD sfakwf045 name="input.a.page1.sfakwf045"
             #240704-00015#1 add ---s
#            INITIALIZE g_ref_fields TO NULL
#            LET g_ref_fields[1] = g_sfakwf_d[l_ac].sfakwf045
#            CALL ap_ref_array2(g_ref_fields,"SELECT pjbal003 FROM pjbal_t WHERE pjbalent="||g_enterprise||" AND pjbal001=? AND pjbal002='"||g_dlang||"'","") RETURNING g_rtn_fields
#            LET g_sfakwf_d[l_ac].sfakwf045_desc = '', g_rtn_fields[1] , ''
#            DISPLAY BY NAME g_sfakwf_d[l_ac].sfakwf045_desc
            CALL s_desc_get_project_desc(g_sfakwf_d[l_ac].sfakwf045) RETURNING g_sfakwf_d[l_ac].sfakwf045_desc
            DISPLAY BY NAME g_sfakwf_d[l_ac].sfakwf045_desc
            IF NOT cl_null(g_sfakwf_d[l_ac].sfakwf045) THEN 
               LET l_cnt = 0
               LET l_sql = " SELECT COUNT(1)",
                           "   FROM ( SELECT pjab001,pjab006",
                           "            FROM pjab_t",
                           "           WHERE pjabent = ",g_enterprise,
                           "             AND pjab001 = '",g_sfakwf_d[l_ac].sfakwf045,"'",
                           "             AND pjabstus = 'Y'",
                           "           UNION",
                           "          SELECT pjba001,pjba000",
                           "            FROM pjba_t",
                           "           WHERE pjbaent = ",g_enterprise,
                           "             AND pjba001 = '",g_sfakwf_d[l_ac].sfakwf045,"'",
                           "             AND pjbastus = 'Y'",
                           "        ) t51 "
               PREPARE bsft001_wf_sfakwf045_chk FROM l_sql
               EXECUTE bsft001_wf_sfakwf045_chk INTO l_cnt
               IF l_cnt = 0 THEN
                  INITIALIZE g_errparam.* TO NULL
                  LET g_errparam.code = 'apj-00089'  #?????????
                  LET g_errparam.extend = ''
                  LET g_errparam.popup = TRUE
                  CALL cl_err()
                  LET g_sfakwf_d[l_ac].sfakwf045 = g_sfakwf_d_o.sfakwf045
                  NEXT FIELD CURRENT
               END IF               
               #???????
               LET l_cnt = 0
               SELECT COUNT(1) INTO l_cnt 
                 FROM pjba_t 
                WHERE pjbaent = g_enterprise 
                  AND pjba001 = g_sfakwf_d[l_ac].sfakwf045
                  AND pjba011 = 'Y'
               IF l_cnt > 0 THEN
                  INITIALIZE g_errparam.* TO NULL
                  LET g_errparam.code = 'axm-01025'  #?????????
                  LET g_errparam.extend = ''
                  LET g_errparam.popup = TRUE
                  CALL cl_err()
                  LET g_sfakwf_d[l_ac].sfakwf045 = g_sfakwf_d_o.sfakwf045
                  CALL s_desc_get_project_desc(g_sfakwf_d[l_ac].sfakwf045) RETURNING g_sfakwf_d[l_ac].sfakwf045_desc
                  NEXT FIELD CURRENT
               END IF            
            END IF
            #240704-00015#1 add ---e
            #END add-point
            
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf045
            #add-point:BEFORE FIELD sfakwf045 name="input.b.page1.sfakwf045"

            #END add-point
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfakwf045
            #add-point:ON CHANGE sfakwf045 name="input.g.page1.sfakwf045"

            #END add-point 
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf046
            
            #add-point:AFTER FIELD sfakwf046 name="input.a.page1.sfakwf046"
            #240704-00015#1 add ---s
#            INITIALIZE g_ref_fields TO NULL
#            LET g_ref_fields[1] = g_sfakwf_d[l_ac].sfakwf045
#            LET g_ref_fields[2] = g_sfakwf_d[l_ac].sfakwf046
#            CALL ap_ref_array2(g_ref_fields,"SELECT pjbbl004 FROM pjbbl_t WHERE pjbblent="||g_enterprise||" AND pjbbl001=? AND pjbbl002=? AND pjbbl003='"||g_dlang||"'","") RETURNING g_rtn_fields
#            LET g_sfakwf_d[l_ac].sfakwf046_desc = '', g_rtn_fields[1] , ''
#            DISPLAY BY NAME g_sfakwf_d[l_ac].sfakwf046_desc

            CALL s_desc_get_wbs_desc(g_sfakwf_d[l_ac].sfakwf045,g_sfakwf_d[l_ac].sfakwf046) RETURNING g_sfakwf_d[l_ac].sfakwf046_desc
            DISPLAY BY NAME g_sfakwf_d[l_ac].sfakwf046_desc
            
            IF NOT cl_null(g_sfakwf_d[l_ac].sfakwf046) THEN 
               #??????
               #??g_chkparam.*?????????????????????????????
               INITIALIZE g_chkparam.* TO NULL

               #??g_chkparam.*???
               LET g_chkparam.arg1 = g_sfakwf_d[l_ac].sfakwf045
               LET g_chkparam.arg2 = g_sfakwf_d[l_ac].sfakwf046
                  
               #??????????library
               IF NOT cl_chk_exist("v_pjbb002") THEN
                  #?????????
                  LET g_sfakwf_d[l_ac].sfakwf046 = g_sfakwf_d_t.sfakwf046
                  CALL s_desc_get_wbs_desc(g_sfakwf_d[l_ac].sfakwf045,g_sfakwf_d[l_ac].sfakwf046) RETURNING g_sfakwf_d[l_ac].sfakwf046_desc
                  DISPLAY BY NAME g_sfakwf_d[l_ac].sfakwf046_desc
                  NEXT FIELD CURRENT
               END IF
            END IF 
            #240704-00015#1 add ---e
            #END add-point
            
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf046
            #add-point:BEFORE FIELD sfakwf046 name="input.b.page1.sfakwf046"

            #END add-point
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfakwf046
            #add-point:ON CHANGE sfakwf046 name="input.g.page1.sfakwf046"

            #END add-point 
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf047
            
            #add-point:AFTER FIELD sfakwf047 name="input.a.page1.sfakwf047"
            #240704-00015#1 add ---s
#            INITIALIZE g_ref_fields TO NULL
#            LET g_ref_fields[1] = g_sfakwf_d[l_ac].sfakwf045
#            LET g_ref_fields[2] = g_sfakwf_d[l_ac].sfakwf047
#            CALL ap_ref_array2(g_ref_fields,"SELECT pjbml004 FROM pjbml_t WHERE pjbmlent="||g_enterprise||" AND pjbml001=? AND pjbml002=? AND pjbml003='"||g_dlang||"'","") RETURNING g_rtn_fields
#            LET g_sfakwf_d[l_ac].sfakwf047_desc = '', g_rtn_fields[1] , ''
#            DISPLAY BY NAME g_sfakwf_d[l_ac].sfakwf047_desc
            
            CALL s_desc_get_activity_desc(g_sfakwf_d[l_ac].sfakwf045,g_sfakwf_d[l_ac].sfakwf047) RETURNING g_sfakwf_d[l_ac].sfakwf047_desc
            DISPLAY BY NAME g_sfakwf_d[l_ac].sfakwf047_desc
            
            IF NOT cl_null(g_sfakwf_d[l_ac].sfakwf047) THEN 
               #??????
               #??g_chkparam.*?????????????????????????????
               INITIALIZE g_chkparam.* TO NULL

               #??g_chkparam.*???
               LET g_chkparam.arg1 = g_sfakwf_d[l_ac].sfakwf045
               LET g_chkparam.arg2 = g_sfakwf_d[l_ac].sfakwf047
                  
               #??????????library
               IF NOT cl_chk_exist("v_pjbm002") THEN
                  #?????????
                  LET g_sfakwf_d[l_ac].sfakwf047 = g_sfakwf_d_t.sfakwf047
                  CALL s_desc_get_activity_desc(g_sfakwf_d[l_ac].sfakwf045,g_sfakwf_d[l_ac].sfakwf047) RETURNING g_sfakwf_d[l_ac].sfakwf047_desc
                  DISPLAY BY NAME g_sfakwf_d[l_ac].sfakwf047_desc
                  NEXT FIELD CURRENT
               END IF
            END IF 
            #240704-00015#1 add ---e
            #END add-point
            
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf047
            #add-point:BEFORE FIELD sfakwf047 name="input.b.page1.sfakwf047"

            #END add-point
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfakwf047
            #add-point:ON CHANGE sfakwf047 name="input.g.page1.sfakwf047"

            #END add-point 
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf048
            
            #add-point:AFTER FIELD sfakwf048 name="input.a.page1.sfakwf048"
            #240704-00015 add -s

            LET g_sfakwf_d[l_ac].sfakwf048_desc = ''
            DISPLAY BY NAME g_sfakwf_d[l_ac].sfakwf048_desc

            IF NOT cl_null(g_sfakwf_d[l_ac].sfakwf048) THEN
               
               #190829-00036#4 add ---s
               #?????????????
               CALL bsft001_wf_detail_abg('6') RETURNING l_success,l_errno_abg,l_bgaf016,l_pmdn058,l_pmdn058_desc,l_pmdn058_desc_sql                  
               IF NOT l_success THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.extend = ''
                  LET g_errparam.code = l_errno_abg
                  LET g_errparam.popup = TRUE
                  CALL cl_err()
                  
                  LET g_sfakwf_d[l_ac].sfakwf048 = g_sfakwf_d_t.sfakwf048
                  CALL bsft001_wf_detail_abg('3')
                       RETURNING l_success,l_errno_abg,l_bgaf016,
                                 l_pmdn058,l_pmdn058_desc,l_pmdn058_desc_sql
                  LET g_sfakwf_d[l_ac].sfakwf048_desc = l_pmdn058_desc
                  DISPLAY BY NAME g_sfakwf_d[l_ac].sfakwf048_desc
                  NEXT FIELD sfakwf048
               END IF
            END IF
            CALL bsft001_wf_detail_abg('3')
                 RETURNING l_success,l_errno_abg,l_bgaf016,
                           l_pmdn058,l_pmdn058_desc,l_pmdn058_desc_sql
            LET g_sfakwf_d[l_ac].sfakwf048_desc = l_pmdn058_desc
            DISPLAY BY NAME g_sfakwf_d[l_ac].sfakwf048_desc
            
            #240704-00015 add -e

            #END add-point
            
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf048
            #add-point:BEFORE FIELD sfakwf048 name="input.b.page1.sfakwf048"

            #END add-point
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfakwf048
            #add-point:ON CHANGE sfakwf048 name="input.g.page1.sfakwf048"

            #END add-point 
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf049
            
            #add-point:AFTER FIELD sfakwf049 name="input.a.page1.sfakwf049"
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_sfakwf_d[l_ac].sfakwf049
            CALL ap_ref_array2(g_ref_fields,"SELECT ooefl003 FROM ooefl_t WHERE ooeflent="||g_enterprise||" AND ooefl001=? AND ooefl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_sfakwf_d[l_ac].sfakwf049_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_sfakwf_d[l_ac].sfakwf049_desc
            
            #250328-00010#1 add--s
            LET g_sfakwf_d[l_ac].sfakwf049_desc = ''
            IF NOT cl_null(g_sfakwf_d[l_ac].sfakwf049) THEN
               IF g_sfakwf_d[l_ac].sfakwf049 != g_sfakwf_d_o.sfakwf049 OR cl_null(g_sfakwf_d_o.sfakwf049) THEN
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_sfakwf_d[l_ac].sfakwf049
                  LET g_chkparam.arg2 = cl_get_today()
                  LET g_chkparam.arg3 = g_site    
                  LET g_errshow = TRUE 
                  LET g_chkparam.err_str[1] = "aoo-00029:sub-01302|aooi125|",cl_get_progname("aooi125",g_lang,"2"),"|:EXEPROGaooi125"
                  IF NOT cl_chk_exist("v_ooeg001_4") THEN
                     LET g_sfakwf_d[l_ac].sfakwf049 = g_sfakwf_d_o.sfakwf049
                     LET g_sfakwf_d[l_ac].sfakwf049_desc = s_desc_get_department_desc(g_sfakwf_d[l_ac].sfakwf049)
                     DISPLAY BY NAME g_sfakwf_d[l_ac].sfakwf049,g_sfakwf_d[l_ac].sfakwf049_desc
                     NEXT FIELD CURRENT
                  END IF
               END IF
               LET g_sfakwf_d[l_ac].sfakwf049_desc = s_desc_get_department_desc(g_sfakwf_d[l_ac].sfakwf049)
               DISPLAY BY NAME g_sfakwf_d[l_ac].sfakwf049_desc
            END IF
            LET g_sfakwf_d_o.sfakwf049 = g_sfakwf_d[l_ac].sfakwf049
            DISPLAY BY NAME g_sfakwf_d[l_ac].sfakwf049_desc 
            #250328-00010#1 add--e

            #END add-point
            
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf049
            #add-point:BEFORE FIELD sfakwf049 name="input.b.page1.sfakwf049"

            #END add-point
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfakwf049
            #add-point:ON CHANGE sfakwf049 name="input.g.page1.sfakwf049"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwfud001
            #add-point:BEFORE FIELD sfakwfud001 name="input.b.page1.sfakwfud001"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwfud001
            
            #add-point:AFTER FIELD sfakwfud001 name="input.a.page1.sfakwfud001"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfakwfud001
            #add-point:ON CHANGE sfakwfud001 name="input.g.page1.sfakwfud001"

            #END add-point 
 
 
 
                  #Ctrlp:input.c.page1.sfakwfseq
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwfseq
            #add-point:ON ACTION controlp INFIELD sfakwfseq name="input.c.page1.sfakwfseq"

            #END add-point
 
 
         #Ctrlp:input.c.page1.sfakwf001
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf001
            #add-point:ON ACTION controlp INFIELD sfakwf001 name="input.c.page1.sfakwf001"
            #?? a07 ??????(Version:3)   
            #??i?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
 
            LET g_qryparam.default1 = g_sfakwf_d[l_ac].sfakwf001             #??default?

            #??arg
            LET g_qryparam.arg1 = "" #s

            IF g_sfajwf_m.sfajwf003 = '2' THEN
               LET g_qryparam.where = " imaa004 IN ('A','X','M') " 
            ELSE                       
               LET g_qryparam.where = " imaa004 IN ('A','X') "  #170620-00109#1 add
            END IF    
            CASE g_sfajwf_m.sfajwf003
               WHEN '1' #????
                  LET g_qryparam.where = g_qryparam.where,
                                         " AND EXISTS (SELECT oocq001 FROM oocq_t ",
                                         "              WHERE oocqent = imafent ",
                                         "                AND oocq001 = '210'",
                                         "                AND oocq002 = imaf016 ",
                                         "                AND oocq006 = 'Y') " #???????
               WHEN '4' #????
                  LET g_qryparam.where = g_qryparam.where,
                                         " AND EXISTS (SELECT oocq001 FROM oocq_t ",
                                         "              WHERE oocqent = imafent ",
                                         "                AND oocq001 = '210'",
                                         "                AND oocq002 = imaf016 ",
                                         "                AND oocq005 = 'Y') " #???????
            END CASE
            #?????????
            LET g_qryparam.where = g_qryparam.where, 
                                   " AND EXISTS (SELECT oocq001 FROM oocq_t ",
                                   "              WHERE oocqent = imafent ",
                                   "                AND oocq001 = '210'",
                                   "                AND oocq002 = imaf016 ",
                                   "                AND oocq009 = 'N' AND oocqstus = 'Y') "
            #??????????????????????
            SELECT wfakwf002 INTO l_wfakwf002 FROM wfakwf_t WHERE wfakwf001 = g_sfajwf_m.sfajwf012
            LET g_qryparam.where = g_qryparam.where, 
                                   " AND imafwf206 = '",l_wfakwf002,"' "
            CALL q_imaf001_6()                                #????
 
            LET g_sfakwf_d[l_ac].sfakwf001 = g_qryparam.return1              

            DISPLAY g_sfakwf_d[l_ac].sfakwf001 TO sfakwf001              #

            NEXT FIELD sfakwf001                          #?????



            #END add-point
 
 
         #Ctrlp:input.c.page1.sfakwf002
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf002
            #add-point:ON ACTION controlp INFIELD sfakwf002 name="input.c.page1.sfakwf002"
            #?? a07 ??????(Version:3)   
            #??i?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
 
            LET g_qryparam.default1 = g_sfakwf_d[l_ac].sfakwf002             #??default?

            #??arg
            LET g_qryparam.arg1 = g_sfakwf_d[l_ac].sfakwf001  #??

 
            CALL q_bmaa002_2()                                #????
 
            LET g_sfakwf_d[l_ac].sfakwf002 = g_qryparam.return1              

            DISPLAY g_sfakwf_d[l_ac].sfakwf002 TO sfakwf002              #

            NEXT FIELD sfakwf002                          #?????



            #END add-point
 
 
         #Ctrlp:input.c.page1.sfakwf003
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf003
            #add-point:ON ACTION controlp INFIELD sfakwf003 name="input.c.page1.sfakwf003"
            #???????
            SELECT imaa005 INTO l_imaa005_1 FROM imaa_t WHERE imaaent = g_enterprise AND imaa001 = g_sfakwf_d[l_ac].sfakwf001 #210514-00037#1 mark  #220511-00015#1 remark
            IF NOT cl_null(l_imaa005_1) THEN                   #210514-00037#1 mark  #220511-00015#1 remark
            #IF s_feature_auto_chk(g_sfakwf_d[l_ac].sfakwf001) THEN #210514-00037#1 add  #220511-00015#1 mark
               IF l_cmd = 'a' THEN 
                  CALL l_inam.clear()          
                  CALL s_feature_multi(g_sfakwf_d[l_ac].sfakwf001,'','',g_site,g_sfajwf_m.sfajwfdocno) RETURNING l_success,l_inam
                  LET g_sfakwf_d[l_ac].sfakwf003 = l_inam[1].inam002
                  LET g_sfakwf_d[l_ac].sfakwf006 = l_inam[1].inam004                   
               END IF
               IF l_cmd = 'u' THEN
                  CALL s_feature_single(g_sfakwf_d[l_ac].sfakwf001,g_sfakwf_d[l_ac].sfakwf003,g_site,g_sfajwf_m.sfajwfdocno)
                     RETURNING l_success,g_sfakwf_d[l_ac].sfakwf003
               END IF
            END IF
            #END add-point
 
 
         #Ctrlp:input.c.page1.sfakwf004
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf004
            #add-point:ON ACTION controlp INFIELD sfakwf004 name="input.c.page1.sfakwf004"

            #END add-point
 
 
         #Ctrlp:input.c.page1.sfakwf005
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf005
            #add-point:ON ACTION controlp INFIELD sfakwf005 name="input.c.page1.sfakwf005"

            #END add-point
 
 
         #Ctrlp:input.c.page1.sfakwf006
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf006
            #add-point:ON ACTION controlp INFIELD sfakwf006 name="input.c.page1.sfakwf006"

            #END add-point
 
 
         #Ctrlp:input.c.page1.sfakwf007
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf007
            #add-point:ON ACTION controlp INFIELD sfakwf007 name="input.c.page1.sfakwf007"
            #?? a07 ??????(Version:3)   
            #??i?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
 
            LET g_qryparam.default1 = g_sfakwf_d[l_ac].sfakwf007             #??default?

            #??arg
            LET g_qryparam.arg1 = g_sfakwf_d[l_ac].sfakwf001 #??

 
            CALL q_ooca001()                                #????
 
            LET g_sfakwf_d[l_ac].sfakwf007 = g_qryparam.return1              

            DISPLAY g_sfakwf_d[l_ac].sfakwf007 TO sfakwf007              #

            NEXT FIELD sfakwf007                          #?????



            #END add-point
 
 
         #Ctrlp:input.c.page1.sfakwf008
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf008
            #add-point:ON ACTION controlp INFIELD sfakwf008 name="input.c.page1.sfakwf008"

            #END add-point
 
 
         #Ctrlp:input.c.page1.sfakwf009
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf009
            #add-point:ON ACTION controlp INFIELD sfakwf009 name="input.c.page1.sfakwf009"

            #END add-point
 
 
         #Ctrlp:input.c.page1.sfakwf010
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf010
            #add-point:ON ACTION controlp INFIELD sfakwf010 name="input.c.page1.sfakwf010"

            #END add-point
 
 
         #Ctrlp:input.c.page1.sfakwf011
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf011
            #add-point:ON ACTION controlp INFIELD sfakwf011 name="input.c.page1.sfakwf011"
            #?? a07 ??????(Version:3)   
            #??i?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
 
            LET g_qryparam.default1 = g_sfakwf_d[l_ac].sfakwf011             #??default?
            LET g_qryparam.default2 = "" #g_sfakwf_d[l_ac].wfagwf003 #????
            LET g_qryparam.default3 = "" #g_sfakwf_d[l_ac].wfagwf004 #??????
            LET g_qryparam.default4 = "" #g_sfakwf_d[l_ac].wfagwf006 #????
            LET g_qryparam.default5 = "" #g_sfakwf_d[l_ac].wfagwf007 #????
            #??arg
            
            #LET g_qryparam.arg1 = g_sfajwf_m.sfajwf006 #??  #240423-00009#2 mark
            LET g_qryparam.arg2 = g_sfakwf_d[l_ac].sfakwf001 #??
            LET g_qryparam.arg3 = g_sfajwf_m.sfajwf016  #??/??
            #240423-00009#2 --s
            #IC?????????=??,????????=2.???3.????
            IF g_sfajwf_m.sfajwf005 = '1' THEN
               LET g_qryparam.arg4 = "'2','3'"
            ELSE
            #????=??????????????=1.????3.????
               LET l_qwhere = ''
               LET g_qryparam.arg4 = "'1','3'"
               LET l_qwhere = l_qwhere," wfagwf009='",g_sfajwf_m.sfajwf006,"'"
               LET g_qryparam.where = l_qwhere
            END IF
            #240423-00009#2 --e
            CALL q_wfagwf001_wf()                                #????
 
            LET g_sfakwf_d[l_ac].sfakwf011 = g_qryparam.return1              
            LET g_sfakwf_d[l_ac].sfakwf012 = g_qryparam.return2 
            LET g_sfakwf_d[l_ac].sfakwf013 = g_qryparam.return3 
            LET g_sfakwf_d[l_ac].sfakwf014 = g_qryparam.return4 
            LET g_sfakwf_d[l_ac].sfakwf015 = g_qryparam.return5 
            #240423-00009#2 --s
            #??????
            IF NOT cl_null(g_sfakwf_d[l_ac].sfakwf011) THEN
               SELECT wfagwf003,wfagwf004,wfagwf006,wfagwf007 INTO g_sfakwf_d[l_ac].sfakwf012,g_sfakwf_d[l_ac].sfakwf013
                ,g_sfakwf_d[l_ac].sfakwf014,g_sfakwf_d[l_ac].sfakwf015 FROM wfagwf_t
                WHERE wfagwfent = g_enterprise AND wfagwfsite = g_site AND wfagwf001 = g_sfakwf_d[l_ac].sfakwf011
            END IF
            IF NOT cl_null(g_sfakwf_d[l_ac].sfakwf012) THEN
               SELECT wfagwfl003 INTO g_sfakwf_d[l_ac].sfakwf012_desc FROM wfagwfl_t
                 WHERE wfagwflent = g_enterprise AND wfagwfl001 = g_sfakwf_d[l_ac].sfakwf012 AND wfagwfl002 = g_dlang
               DISPLAY g_sfakwf_d[l_ac].sfakwf012_desc TO sfakwf012_desc
            END IF
            
            #240423-00009#2 --e
            DISPLAY g_sfakwf_d[l_ac].sfakwf011 TO sfakwf011              #
            DISPLAY g_sfakwf_d[l_ac].sfakwf012 TO sfakwf012 #????
            DISPLAY g_sfakwf_d[l_ac].sfakwf013 TO sfakwf013 #??????
            DISPLAY g_sfakwf_d[l_ac].sfakwf014 TO sfakwf014 #????
            DISPLAY g_sfakwf_d[l_ac].sfakwf015 TO sfakwf015 #????
            NEXT FIELD sfakwf011                          #?????



            #END add-point
 
 
         #Ctrlp:input.c.page1.sfakwf012
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf012
            #add-point:ON ACTION controlp INFIELD sfakwf012 name="input.c.page1.sfakwf012"

            #END add-point
 
 
         #Ctrlp:input.c.page1.sfakwf013
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf013
            #add-point:ON ACTION controlp INFIELD sfakwf013 name="input.c.page1.sfakwf013"

            #END add-point
 
 
         #Ctrlp:input.c.page1.sfakwf014
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf014
            #add-point:ON ACTION controlp INFIELD sfakwf014 name="input.c.page1.sfakwf014"

            #END add-point
 
 
         #Ctrlp:input.c.page1.sfakwf015
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf015
            #add-point:ON ACTION controlp INFIELD sfakwf015 name="input.c.page1.sfakwf015"

            #END add-point
 
 
         #Ctrlp:input.c.page1.sfakwf016
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf016
            #add-point:ON ACTION controlp INFIELD sfakwf016 name="input.c.page1.sfakwf016"
            #?? a07 ??????(Version:3)   
            #??i?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
 
            LET g_qryparam.default1 = g_sfakwf_d[l_ac].sfakwf016             #??default?
            LET g_qryparam.default2 = "" #g_sfakwf_d[l_ac].wfahwf005 #????
            LET g_qryparam.default3 = "" #g_sfakwf_d[l_ac].wfahwf006 #????
            LET g_qryparam.default4 = "" #g_sfakwf_d[l_ac].wfahwf010 #????
            LET g_qryparam.default5 = "" #g_sfakwf_d[l_ac].wfahwf008 #???
            LET g_qryparam.default6 = "" #g_sfakwf_d[l_ac].wfahwf009 #?????
            #??arg
            #LET g_qryparam.arg1 = g_sfajwf_m.sfajwf006 #??   #240423-00009#2 mark
            LET g_qryparam.arg2 = g_sfakwf_d[l_ac].sfakwf001 #??
            #240423-00009#2 --s
            #IC?????????=??,????????=2.???3.????
            IF g_sfajwf_m.sfajwf005 = '1' THEN
               LET g_qryparam.arg3 = "'2','3'"
            ELSE
            #????=??????????????=1.????3.????
               LET l_qwhere = ''
               LET g_qryparam.arg3 = "'1','3'"
               LET l_qwhere = l_qwhere," wfahwf004='",g_sfajwf_m.sfajwf006,"'"
               LET g_qryparam.where = l_qwhere
            END IF
            #240423-00009#2 --e
            CALL q_sfakwf016_01_wf()                                #????
 
            LET g_sfakwf_d[l_ac].sfakwf016 = g_qryparam.return1              
            LET g_sfakwf_d[l_ac].sfakwf017 = g_qryparam.return2 
            LET g_sfakwf_d[l_ac].sfakwf018 = g_qryparam.return3 
            LET g_sfakwf_d[l_ac].sfakwf019 = g_qryparam.return4 
            LET g_sfakwf_d[l_ac].sfakwf020 = g_qryparam.return5 
            LET g_sfakwf_d[l_ac].sfakwf021 = g_qryparam.return6 
            #240423-00009#2 --s
            IF NOT cl_null(g_sfakwf_d[l_ac].sfakwf016) THEN
               SELECT wfahwf005,wfahwf006,wfahwf010,wfahwf008,wfahwf009 INTO g_sfakwf_d[l_ac].sfakwf017,g_sfakwf_d[l_ac].sfakwf018
               ,g_sfakwf_d[l_ac].sfakwf019,g_sfakwf_d[l_ac].sfakwf020,g_sfakwf_d[l_ac].sfakwf021 FROM wfahwf_t
                WHERE wfahwfent = g_enterprise AND wfahwfsite = g_site AND wfahwf001 = g_sfakwf_d[l_ac].sfakwf016
            END IF
            #??????
            IF NOT cl_null(g_sfakwf_d[l_ac].sfakwf017) THEN
               SELECT wfaiwfl003 INTO g_sfakwf_d[l_ac].sfakwf017_desc FROM wfaiwfl_t
                 WHERE wfaiwflent = g_enterprise AND wfaiwfl001 = g_sfakwf_d[l_ac].sfakwf017 AND wfaiwfl002 = g_dlang
               DISPLAY g_sfakwf_d[l_ac].sfakwf017_desc TO sfakwf017_desc
            END IF 
            #240423-00009#2 --e
            DISPLAY g_sfakwf_d[l_ac].sfakwf016 TO sfakwf016              #
            DISPLAY g_sfakwf_d[l_ac].sfakwf017 TO sfakwf017 #????
            DISPLAY g_sfakwf_d[l_ac].sfakwf018 TO sfakwf018 #????
            DISPLAY g_sfakwf_d[l_ac].sfakwf019 TO sfakwf019 #????
            DISPLAY g_sfakwf_d[l_ac].sfakwf020 TO sfakwf020 #???
            DISPLAY g_sfakwf_d[l_ac].sfakwf021 TO sfakwf021 #?????
            NEXT FIELD sfakwf016                          #?????



            #END add-point
 
 
         #Ctrlp:input.c.page1.sfakwf017
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf017
            #add-point:ON ACTION controlp INFIELD sfakwf017 name="input.c.page1.sfakwf017"

            #END add-point
 
 
         #Ctrlp:input.c.page1.sfakwf018
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf018
            #add-point:ON ACTION controlp INFIELD sfakwf018 name="input.c.page1.sfakwf018"

            #END add-point
 
 
         #Ctrlp:input.c.page1.sfakwf019
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf019
            #add-point:ON ACTION controlp INFIELD sfakwf019 name="input.c.page1.sfakwf019"

            #END add-point
 
 
         #Ctrlp:input.c.page1.sfakwf020
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf020
            #add-point:ON ACTION controlp INFIELD sfakwf020 name="input.c.page1.sfakwf020"

            #END add-point
 
 
         #Ctrlp:input.c.page1.sfakwf021
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf021
            #add-point:ON ACTION controlp INFIELD sfakwf021 name="input.c.page1.sfakwf021"

            #END add-point
 
 
         #Ctrlp:input.c.page1.sfakwf022
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf022
            #add-point:ON ACTION controlp INFIELD sfakwf022 name="input.c.page1.sfakwf022"
            #?? a07 ??????(Version:3)   
            #??i?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
 
            LET g_qryparam.default1 = g_sfakwf_d[l_ac].sfakwf022             #??default?
            LET g_qryparam.default2 = "" #g_sfakwf_d[l_ac].wfajwf004 #????
            LET g_qryparam.default3 = "" #g_sfakwf_d[l_ac].wfajwfl003 #??????
            #??arg
            LET g_qryparam.arg1 = g_sfajwf_m.sfajwf006 #??
            LET g_qryparam.arg2 = g_sfakwf_d[l_ac].sfakwf001 #??
            LET g_qryparam.arg3 = g_sfajwf_m.sfajwf016  #??/??
 
            CALL q_wfajwf001_wf()                                #????
 
            LET g_sfakwf_d[l_ac].sfakwf022 = g_qryparam.return1              
            LET g_sfakwf_d[l_ac].sfakwf023 = g_qryparam.return2 
            LET g_sfakwf_d[l_ac].sfakwf023_desc = g_qryparam.return3 
            DISPLAY g_sfakwf_d[l_ac].sfakwf022 TO sfakwf022              #
            DISPLAY g_sfakwf_d[l_ac].sfakwf023 TO sfakwf023 #????
            DISPLAY g_sfakwf_d[l_ac].sfakwf023_desc TO sfakwf023_desc #??????
            NEXT FIELD sfakwf022                          #?????



            #END add-point
 
 
         #Ctrlp:input.c.page1.sfakwf023
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf023
            #add-point:ON ACTION controlp INFIELD sfakwf023 name="input.c.page1.sfakwf023"

            #END add-point
 
 
         #Ctrlp:input.c.page1.sfakwf024
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf024
            #add-point:ON ACTION controlp INFIELD sfakwf024 name="input.c.page1.sfakwf024"
            #?? a07 ??????(Version:3)   
            #??i?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
 
            LET g_qryparam.default1 = g_sfakwf_d[l_ac].sfakwf024             #??default?
            LET g_qryparam.default2 = "" #g_sfakwf_d[l_ac].wfalwf005 #??????
            LET g_qryparam.default3 = "" #g_sfakwf_d[l_ac].wfalwf006 #??????
            LET g_qryparam.default4 = "" #g_sfakwf_d[l_ac].wfalwf007 #????
            LET g_qryparam.default5 = "" #g_sfakwf_d[l_ac].wfalwf008 #??????
            #??arg
            LET g_qryparam.arg1 = g_sfakwf_d[l_ac].sfakwf001 #??

            #250220-00015#1 add ----s
            LET g_qryparam.where = "wfalwf003 = '",g_sfajwf_m.sfajwf006 ,"'"   
            #250220-00015#1 add ----e 
            CALL q_wfalwf001_wf()                                #????
 
            LET g_sfakwf_d[l_ac].sfakwf024 = g_qryparam.return1              
            LET g_sfakwf_d[l_ac].sfakwf025 = g_qryparam.return2 
            LET g_sfakwf_d[l_ac].sfakwf026 = g_qryparam.return3 
            LET g_sfakwf_d[l_ac].sfakwf027 = g_qryparam.return4 
            LET g_sfakwf_d[l_ac].sfakwf028 = g_qryparam.return5 
            DISPLAY g_sfakwf_d[l_ac].sfakwf024 TO sfakwf024              #
            DISPLAY g_sfakwf_d[l_ac].sfakwf025 TO sfakwf025 #??????
            DISPLAY g_sfakwf_d[l_ac].sfakwf026 TO sfakwf026 #??????
            DISPLAY g_sfakwf_d[l_ac].sfakwf027 TO sfakwf027 #????
            DISPLAY g_sfakwf_d[l_ac].sfakwf028 TO sfakwf028 #??????
            NEXT FIELD sfakwf024                          #?????



            #END add-point
 
 
         #Ctrlp:input.c.page1.sfakwf025
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf025
            #add-point:ON ACTION controlp INFIELD sfakwf025 name="input.c.page1.sfakwf025"

            #END add-point
 
 
         #Ctrlp:input.c.page1.sfakwf026
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf026
            #add-point:ON ACTION controlp INFIELD sfakwf026 name="input.c.page1.sfakwf026"

            #END add-point
 
 
         #Ctrlp:input.c.page1.sfakwf027
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf027
            #add-point:ON ACTION controlp INFIELD sfakwf027 name="input.c.page1.sfakwf027"

            #END add-point
 
 
         #Ctrlp:input.c.page1.sfakwf028
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf028
            #add-point:ON ACTION controlp INFIELD sfakwf028 name="input.c.page1.sfakwf028"

            #END add-point
 
 
         #Ctrlp:input.c.page1.sfakwf029
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf029
            #add-point:ON ACTION controlp INFIELD sfakwf029 name="input.c.page1.sfakwf029"

            #END add-point
 
 
         #Ctrlp:input.c.page1.sfakwf030
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf030
            #add-point:ON ACTION controlp INFIELD sfakwf030 name="input.c.page1.sfakwf030"

            #END add-point
 
 
         #Ctrlp:input.c.page1.sfakwf031
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf031
            #add-point:ON ACTION controlp INFIELD sfakwf031 name="input.c.page1.sfakwf031"

            #END add-point
 
 
         #Ctrlp:input.c.page1.sfakwf044
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf044
            #add-point:ON ACTION controlp INFIELD sfakwf044 name="input.c.page1.sfakwf044"

            #END add-point
 
 
         #Ctrlp:input.c.page1.sfakwf032
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf032
            #add-point:ON ACTION controlp INFIELD sfakwf032 name="input.c.page1.sfakwf032"

            #END add-point
 
 
         #Ctrlp:input.c.page1.sfakwf033
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf033
            #add-point:ON ACTION controlp INFIELD sfakwf033 name="input.c.page1.sfakwf033"

            #END add-point
 
 
         #Ctrlp:input.c.page1.sfakwf034
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf034
            #add-point:ON ACTION controlp INFIELD sfakwf034 name="input.c.page1.sfakwf034"

            #END add-point
 
 
         #Ctrlp:input.c.page1.sfakwf035
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf035
            #add-point:ON ACTION controlp INFIELD sfakwf035 name="input.c.page1.sfakwf035"
            #?? a07 ??????(Version:3)   
            #??i?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
 
            LET g_qryparam.default1 = g_sfakwf_d[l_ac].sfakwf035             #??default?

            #??arg
            LET g_qryparam.arg1 = g_sfakwf_d[l_ac].sfakwf001 #??

 
            CALL q_imao002()                                #????
 
            LET g_sfakwf_d[l_ac].sfakwf035 = g_qryparam.return1              

            DISPLAY g_sfakwf_d[l_ac].sfakwf035 TO sfakwf035              #

            NEXT FIELD sfakwf035                          #?????



            #END add-point
 
 
         #Ctrlp:input.c.page1.sfakwf036
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf036
            #add-point:ON ACTION controlp INFIELD sfakwf036 name="input.c.page1.sfakwf036"

            #END add-point
 
 
         #Ctrlp:input.c.page1.sfakwf037
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf037
            #add-point:ON ACTION controlp INFIELD sfakwf037 name="input.c.page1.sfakwf037"
            #?? a07 ??????(Version:3)   
            #??i?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
 
            LET g_qryparam.default1 = g_sfakwf_d[l_ac].sfakwf037             #??default?

            #??arg
            LET g_qryparam.arg1 = "" #s

 
            CALL q_oodb002_2()                                #????
 
            LET g_sfakwf_d[l_ac].sfakwf037 = g_qryparam.return1              

            DISPLAY g_sfakwf_d[l_ac].sfakwf037 TO sfakwf037              #

            NEXT FIELD sfakwf037                          #?????



            #END add-point
 
 
         #Ctrlp:input.c.page1.sfakwf039
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf039
            #add-point:ON ACTION controlp INFIELD sfakwf039 name="input.c.page1.sfakwf039"

            #END add-point
 
 
         #Ctrlp:input.c.page1.sfakwf040
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf040
            #add-point:ON ACTION controlp INFIELD sfakwf040 name="input.c.page1.sfakwf040"

            #END add-point
 
 
         #Ctrlp:input.c.page1.sfakwf041
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf041
            #add-point:ON ACTION controlp INFIELD sfakwf041 name="input.c.page1.sfakwf041"

            #END add-point
 
 
         #Ctrlp:input.c.page1.sfakwf042
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf042
            #add-point:ON ACTION controlp INFIELD sfakwf042 name="input.c.page1.sfakwf042"
            #?? a07 ??????(Version:3)   
            #??i?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
 
            LET g_qryparam.default1 = g_sfakwf_d[l_ac].sfakwf042             #??default?
            LET g_qryparam.default2 = "" #g_sfakwf_d[l_ac].bmfa005 #????
            #??arg
            LET g_qryparam.arg1 = g_sfakwf_d[l_ac].sfakwf001 #????
            LET g_qryparam.arg2 = g_sfakwf_d[l_ac].sfakwf002  #??  
 
            CALL q_bmfa012_3()                                #????
 
            LET g_sfakwf_d[l_ac].sfakwf042 = g_qryparam.return1  
            LET g_sfakwf_d[l_ac].sfakwf043 = g_qryparam.return2            
            #LET g_sfakwf_d[l_ac].bmfa005 = g_qryparam.return2 
            DISPLAY g_sfakwf_d[l_ac].sfakwf042 TO sfakwf042              #
            DISPLAY g_sfakwf_d[l_ac].sfakwf043 TO sfakwf043
            #DISPLAY g_sfakwf_d[l_ac].bmfa005 TO bmfa005 #????
            NEXT FIELD sfakwf042                          #?????



            #END add-point
 
 
         #Ctrlp:input.c.page1.sfakwf043
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf043
            #add-point:ON ACTION controlp INFIELD sfakwf043 name="input.c.page1.sfakwf043"

            #END add-point
 
 
         #Ctrlp:input.c.page1.sfakwf045
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf045
            #add-point:ON ACTION controlp INFIELD sfakwf045 name="input.c.page1.sfakwf045"
            #240704-00015#1 add ---s
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_sfakwf_d[l_ac].sfakwf045


            #LET gdt_datetime = ''
            #LET gdt_datetime = g_sfajwf_m.sfajwfdocdt
            CALL q_pjab001_2()

            LET g_sfakwf_d[l_ac].sfakwf045 = g_qryparam.return1              

            DISPLAY g_sfakwf_d[l_ac].sfakwf045 TO sfakwf045
            CALL s_desc_get_project_desc(g_sfakwf_d[l_ac].sfakwf045) RETURNING g_sfakwf_d[l_ac].sfakwf045_desc
            DISPLAY BY NAME g_sfakwf_d[l_ac].sfakwf045_desc
         
            NEXT FIELD sfakwf045
            #240704-00015#1 add ---e
            #END add-point
 
 
         #Ctrlp:input.c.page1.sfakwf046
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf046
            #add-point:ON ACTION controlp INFIELD sfakwf046 name="input.c.page1.sfakwf046"
            #240704-00015#1 add ---s
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_sfakwf_d[l_ac].sfakwf046             #??default?

            #??arg
            LET g_qryparam.arg1 = g_sfakwf_d[l_ac].sfakwf045  #s


            CALL q_pjbb002_1()                                #????

            LET g_sfakwf_d[l_ac].sfakwf046 = g_qryparam.return1              

            DISPLAY g_sfakwf_d[l_ac].sfakwf046 TO sfakwf046              #
            CALL s_desc_get_wbs_desc(g_sfakwf_d[l_ac].sfakwf045,g_sfakwf_d[l_ac].sfakwf046) RETURNING g_sfakwf_d[l_ac].sfakwf046_desc
            DISPLAY BY NAME g_sfakwf_d[l_ac].sfakwf046_desc
         
            NEXT FIELD sfakwf046                          #?????
            #240704-00015#1 add ---e
            #END add-point
 
 
         #Ctrlp:input.c.page1.sfakwf047
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf047
            #add-point:ON ACTION controlp INFIELD sfakwf047 name="input.c.page1.sfakwf047"
            #240704-00015#1 add ---s
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE

            LET g_qryparam.default1 = g_sfakwf_d[l_ac].sfakwf047             #??default?

            #??arg
            LET g_qryparam.arg1 = g_sfakwf_d[l_ac].sfakwf045  #s


            CALL q_pjbm002()                                #????

            LET g_sfakwf_d[l_ac].sfakwf047 = g_qryparam.return1              

            DISPLAY g_sfakwf_d[l_ac].sfakwf047 TO sfakwf047              #
            CALL s_desc_get_activity_desc(g_sfakwf_d[l_ac].sfakwf045,g_sfakwf_d[l_ac].sfakwf047) RETURNING g_sfakwf_d[l_ac].sfakwf047_desc
            DISPLAY BY NAME g_sfakwf_d[l_ac].sfakwf047_desc
         
            NEXT FIELD sfakwf047                          #?????            
            #240704-00015#1 add ---e
            #END add-point
 
 
         #Ctrlp:input.c.page1.sfakwf048
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf048
            #add-point:ON ACTION controlp INFIELD sfakwf048 name="input.c.page1.sfakwf048"
            #240704-00015#1 add ---s
            CALL bsft001_wf_detail_abg('1')
                 RETURNING l_success,l_errno_abg,l_bgaf016,
                           l_pmdn058,l_pmdn058_desc,l_pmdn058_desc_sql
            LET g_sfakwf_d[l_ac].sfakwf048 = l_pmdn058
            LET g_sfakwf_d[l_ac].sfakwf048_desc = l_pmdn058_desc
            DISPLAY BY NAME g_sfakwf_d[l_ac].sfakwf048,g_sfakwf_d[l_ac].sfakwf048_desc
            #240704-00015#1 add ---e
            #END add-point
 
 
         #Ctrlp:input.c.page1.sfakwf049
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf049
            #add-point:ON ACTION controlp INFIELD sfakwf049 name="input.c.page1.sfakwf049"
            #250328-00010#1 add--s
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
 
            LET g_qryparam.default1 = g_sfakwf_d[l_ac].sfakwf049             #??default?

            #??arg
            LET g_qryparam.arg1 = cl_get_today()
            LET g_qryparam.arg2 = g_site 
 
            CALL q_ooeg001_8()                             #????
 
            LET g_sfakwf_d[l_ac].sfakwf049 = g_qryparam.return1              

            DISPLAY g_sfakwf_d[l_ac].sfakwf049 TO sfakwf049              #
            LET g_sfakwf_d[l_ac].sfakwf049_desc = s_desc_get_department_desc(g_sfakwf_d[l_ac].sfakwf049)
            DISPLAY g_sfakwf_d[l_ac].sfakwf049_desc TO sfakwf049_desc 
            NEXT FIELD sfakwf049     
            #250328-00010#1 add--e
            #END add-point
 
 
         #Ctrlp:input.c.page1.sfakwfud001
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwfud001
            #add-point:ON ACTION controlp INFIELD sfakwfud001 name="input.c.page1.sfakwfud001"

            #END add-point
 
 
 
 
         ON ROW CHANGE
            IF INT_FLAG THEN
               LET INT_FLAG = 0
               LET g_sfakwf_d[l_ac].* = g_sfakwf_d_t.*
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code = 9001 
               LET g_errparam.popup = FALSE 
               CLOSE bsft001_wf_bcl
               CALL s_transaction_end('N','0')
               CALL cl_err()
               EXIT DIALOG 
            END IF
              
            IF l_lock_sw = 'Y' THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = g_sfakwf_d[l_ac].sfakwfseq 
               LET g_errparam.code = -263 
               LET g_errparam.popup = TRUE 
               CALL cl_err()
               LET g_sfakwf_d[l_ac].* = g_sfakwf_d_t.*
               EXIT DIALOG   #210416-00007
            ELSE
            
               #add-point:????? name="input.body.b_update"
               IF cl_null(g_sfakwf_d[l_ac].sfakwf003) THEN
                  LET g_sfakwf_d[l_ac].sfakwf003 = ' '
               END IF
               #end add-point
               
               #?????/??????(??)
               
      
               #???????
               CALL bsft001_wf_sfakwf_t_mask_restore('restore_mask_o')
      
               UPDATE sfakwf_t SET (sfakwfdocno,sfakwfseq,sfakwf001,sfakwf002,sfakwf003,sfakwf004,sfakwf005,sfakwf006,sfakwf007,sfakwf008,sfakwf009,sfakwf010,sfakwf011,sfakwf012,sfakwf013,sfakwf014,sfakwf015,sfakwf016,sfakwf017,sfakwf018,sfakwf019,sfakwf020,sfakwf021,sfakwf022,sfakwf023,sfakwf024,sfakwf025, 
                   sfakwf026,sfakwf027,sfakwf028,sfakwf029,sfakwf030,sfakwf031,sfakwf044,sfakwf032,sfakwf033,sfakwf034,sfakwf035,sfakwf036,sfakwf037,sfakwf038,sfakwf039,sfakwf040,sfakwf041,sfakwf042,sfakwf043,sfakwf045,sfakwf046,sfakwf047,sfakwf048,sfakwf049,sfakwfud001) = (g_sfajwf_m.sfajwfdocno,g_sfakwf_d[l_ac].sfakwfseq, 
                   g_sfakwf_d[l_ac].sfakwf001,g_sfakwf_d[l_ac].sfakwf002,g_sfakwf_d[l_ac].sfakwf003,g_sfakwf_d[l_ac].sfakwf004,g_sfakwf_d[l_ac].sfakwf005,g_sfakwf_d[l_ac].sfakwf006,g_sfakwf_d[l_ac].sfakwf007,g_sfakwf_d[l_ac].sfakwf008,g_sfakwf_d[l_ac].sfakwf009,g_sfakwf_d[l_ac].sfakwf010,g_sfakwf_d[l_ac].sfakwf011, 
                   g_sfakwf_d[l_ac].sfakwf012,g_sfakwf_d[l_ac].sfakwf013,g_sfakwf_d[l_ac].sfakwf014,g_sfakwf_d[l_ac].sfakwf015,g_sfakwf_d[l_ac].sfakwf016,g_sfakwf_d[l_ac].sfakwf017,g_sfakwf_d[l_ac].sfakwf018,g_sfakwf_d[l_ac].sfakwf019,g_sfakwf_d[l_ac].sfakwf020,g_sfakwf_d[l_ac].sfakwf021,g_sfakwf_d[l_ac].sfakwf022, 
                   g_sfakwf_d[l_ac].sfakwf023,g_sfakwf_d[l_ac].sfakwf024,g_sfakwf_d[l_ac].sfakwf025,g_sfakwf_d[l_ac].sfakwf026,g_sfakwf_d[l_ac].sfakwf027,g_sfakwf_d[l_ac].sfakwf028,g_sfakwf_d[l_ac].sfakwf029,g_sfakwf_d[l_ac].sfakwf030,g_sfakwf_d[l_ac].sfakwf031,g_sfakwf_d[l_ac].sfakwf044,g_sfakwf_d[l_ac].sfakwf032, 
                   g_sfakwf_d[l_ac].sfakwf033,g_sfakwf_d[l_ac].sfakwf034,g_sfakwf_d[l_ac].sfakwf035,g_sfakwf_d[l_ac].sfakwf036,g_sfakwf_d[l_ac].sfakwf037,g_sfakwf_d[l_ac].sfakwf038,g_sfakwf_d[l_ac].sfakwf039,g_sfakwf_d[l_ac].sfakwf040,g_sfakwf_d[l_ac].sfakwf041,g_sfakwf_d[l_ac].sfakwf042,g_sfakwf_d[l_ac].sfakwf043, 
                   g_sfakwf_d[l_ac].sfakwf045,g_sfakwf_d[l_ac].sfakwf046,g_sfakwf_d[l_ac].sfakwf047,g_sfakwf_d[l_ac].sfakwf048,g_sfakwf_d[l_ac].sfakwf049,g_sfakwf_d[l_ac].sfakwfud001)
                WHERE sfakwfent = g_enterprise AND sfakwfsite = g_site AND sfakwfdocno = g_sfajwf_m.sfajwfdocno 
 
                  AND sfakwfseq = g_sfakwf_d_t.sfakwfseq #??   
 
                  
               #add-point:????? name="input.body.m_update"

               #end add-point
               CASE
                  WHEN SQLCA.sqlerrd[3] = 0  #???????
                     LET g_sfakwf_d[l_ac].* = g_sfakwf_d_t.*
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = "sfakwf_t" 
                     LET g_errparam.code = "std-00009" 
                     LET g_errparam.popup = TRUE 
                     CALL s_transaction_end('N','0')
                     CALL cl_err()
                     EXIT DIALOG   #210416-00007
                     
                  WHEN SQLCA.SQLCODE #????
                     LET g_sfakwf_d[l_ac].* = g_sfakwf_d_t.*  
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = "sfakwf_t:",SQLERRMESSAGE 
                     LET g_errparam.code = SQLCA.SQLCODE 
                     LET g_errparam.popup = TRUE 
                     CALL s_transaction_end('N','0')
                     CALL cl_err()                   
                     EXIT DIALOG   #210416-00007
                     
                  OTHERWISE
                     #??????-?/?
                     
                        #161130-00056 add
                                    INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_sfajwf_m.sfajwfdocno
               LET gs_keys_bak[1] = g_sfajwfdocno_t
               LET gs_keys[2] = g_sfakwf_d[g_detail_idx].sfakwfseq
               LET gs_keys_bak[2] = g_sfakwf_d_t.sfakwfseq
               CALL bsft001_wf_update_b('sfakwf_t',gs_keys,gs_keys_bak,"'1'")
               END CASE
 
                #210416-00007 ????add-point ---start---
                #add-point:??????????? name="input.body.a_update_b_mask"

                #end add-point
                #210416-00007 ????add-point --- end ---
 
               #?????????
               CALL bsft001_wf_sfakwf_t_mask_restore('restore_mask_n')
               
               #??key?????
               INITIALIZE gs_keys TO NULL
               IF NOT(g_sfakwf_d[g_detail_idx].sfakwfseq = g_sfakwf_d_t.sfakwfseq 
 
                  ) THEN
                  LET gs_keys[01] = g_sfajwf_m.sfajwfdocno
 
                  LET gs_keys[gs_keys.getLength()+1] = g_sfakwf_d_t.sfakwfseq
 
                  CALL bsft001_wf_key_update_b(gs_keys,'sfakwf_t')
               END IF
               
               #??????(????)
               LET g_log1 = util.JSON.stringify(g_sfajwf_m),util.JSON.stringify(g_sfakwf_d_t)
               LET g_log2 = util.JSON.stringify(g_sfajwf_m),util.JSON.stringify(g_sfakwf_d[l_ac])
               IF NOT cl_log_modified_record_d(g_log1,g_log2) THEN 
                  CALL s_transaction_end('N','0')
                  EXIT DIALOG   #210416-00007
               END IF
               
               #add-point:????? name="input.body.a_update"

               #end add-point
 
            END IF
            
         AFTER ROW
            #add-point:??after_row name="input.body.after_row"
            #240704-00015#1 add --s
            CALL s_aooi200_get_slip(g_sfajwf_m.sfajwfdocno)
                 RETURNING l_success,l_slip            
            
            IF cl_get_doc_para(g_enterprise,g_site,l_slip,'D-MFG-0112') = 'Y' THEN
               IF cl_null(g_sfakwf_d[l_ac].sfakwf045) THEN
                  NEXT FIELD sfakwf045
               END IF
            END IF 
            #240704-00015#1 add --e
            #241104-00004#1 add--s
            IF g_sfajwf_m.sfajwf013 = '2' AND (g_sfakwf_d[l_ac].sfakwf006 = 0 OR cl_null(g_sfakwf_d[l_ac].sfakwf006)) AND (g_sfakwf_d[l_ac].sfakwf008 = 0 OR cl_null(g_sfakwf_d[l_ac].sfakwf008)) THEN
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code = 'wf-00158' --????????????????/????????????????
               LET g_errparam.extend = ""
               LET g_errparam.popup = TRUE
               CALL cl_err()    
               NEXT FIELD sfakwf008
            END IF
            #241104-00004#1 add--e
            #end add-point
            CALL bsft001_wf_unlock_b("sfakwf_t","'1'")
            CALL s_transaction_end('Y','0')
            #??table??unlock
            #add-point:??after_row2 name="input.body.after_row2"
            
            #end add-point
              
         AFTER INPUT
            #add-point:input?after input  name="input.body.after_input"
            #240709-00009#1 add--s
            IF p_cmd <> 'u' THEN
               
            ELSE
               CALL s_transaction_begin()
               #170118-00063#1 add --(S)--
               IF (g_sfakwf_d[l_ac].sfakwf001 <> g_sfakwf_d_t.sfakwf001) OR
                  (g_sfakwf_d[l_ac].sfakwf002 <> g_sfakwf_d_t.sfakwf002) OR    #170824-00008#1
                  (g_sfakwf_d[l_ac].sfakwf006 <> g_sfakwf_d_t.sfakwf006) THEN
               
                  IF bsft001_wf_sfakwf001_chk() THEN
                     DELETE FROM sfanwf_t
                      WHERE sfanwfent = g_enterprise
                        AND sfanwfdocno = g_sfajwf_m.sfajwfdocno
                        AND sfanwfseq1 =  g_sfakwf_d[l_ac].sfakwfseq  #241016-00014#1 add
                     IF g_sfajwf_m.sfajwf003 != '3' THEN   #170602-00032#1 add   
                     CALL bsft001_wf_ins_sfanwf()
                     #170602-00032#1 add --(S)--
                     ELSE
                        IF (g_inam.getLength() > 0) THEN
                           CALL g_inam1.clear()
                           FOR l_i = 1 TO g_inam.getLength()
                               LET g_inam1[l_i].* = g_inam[l_i].*
                           END FOR                                
                        END IF
                        CALL bsft001_wf_07(g_sfajwf_m.sfajwfdocno,g_sfakwf_d[l_ac].sfakwfseq,g_inam) RETURNING l_flag2
                     END IF
                     #170602-00032#1 add --(E)--
                     SELECT sfakwf006 INTO g_sfakwf_d[l_ac].sfakwf006
                       FROM sfakwf_t
                      WHERE sfakwfent = g_enterprise
                        AND sfakwfdocno = g_sfajwf_m.sfajwfdocno
                     
                     DISPLAY BY NAME g_sfakwf_d[l_ac].sfakwf006
                     CALL bsft001_wf_b_fill_sfanwf()
                  ELSE                     
                     UPDATE sfakwf_t SET sfakwf006 = g_sfakwf_d_t.sfakwf006,
                                       sfakwf032 = g_sfakwf_d_t.sfakwf032,
                                       sfakwf033 = g_sfakwf_d_t.sfakwf033
                      WHERE sfakwfent = g_enterprise
                        AND sfakwfdocno = g_sfajwf_m.sfajwfdocno
                      
                      LET g_sfakwf_d[l_ac].sfakwf006 = g_sfakwf_d_t.sfakwf006
                      LET g_sfakwf_d[l_ac].sfakwf032 = g_sfakwf_d_t.sfakwf032
                      LET g_sfakwf_d[l_ac].sfakwf033 = g_sfakwf_d_t.sfakwf033
                      DISPLAY BY NAME g_sfakwf_d[l_ac].sfakwf006,g_sfakwf_d[l_ac].sfakwf032,g_sfakwf_d[l_ac].sfakwf033
                  END IF
               END IF
            END IF
            
            LET g_sfajwfdocno_t = g_sfajwf_m.sfajwfdocno

            #???????????????,??????  
            IF p_cmd = 'u' AND g_master_insert = TRUE THEN
               LET l_m = 0
               SELECT COUNT(1) INTO l_m FROM sfbcwf_t 
                WHERE sfbcwfent = g_enterprise AND sfbcwfsite = g_site 
                  AND sfbcwfdocno = g_sfajwf_m.sfajwfdocno
               IF l_m = 0 THEN  
                  CALL s_aooi200_get_slip(g_sfajwf_m.sfajwfdocno) RETURNING l_success,g_slip 
                  CALL cl_get_doc_para(g_enterprise,g_site,l_slip,'D-BWF-0001') RETURNING l_sfaadocno
                  IF cl_get_doc_para(g_enterprise,g_site,l_sfaadocno,'D-MFG-0038') = '1' THEN              
                  CALL s_transaction_begin()         
                  #161011-00039#1--add---str---
                  #???????????????????
                  IF g_sfajwf_m.sfajwf003 != '3' THEN
                     IF NOT cl_null(g_sfakwf_d[l_ac].sfakwf001) AND g_sfakwf_d[l_ac].sfakwf002 IS NOT NULL AND l_cmd_t = 'u' THEN
                        #??????????????
                        DELETE FROM sfanwf_t
                        WHERE sfanwfent = g_enterprise AND sfanwfsite = g_site AND sfanwfdocno = g_sfajwf_m.sfajwfdocno
                          AND sfanwfseq1 =  g_sfakwf_d[l_ac].sfakwfseq  #241016-00014#1 add
                        IF SQLCA.sqlcode THEN
                           CALL s_transaction_end('N','0')
                           INITIALIZE g_errparam TO NULL
                           LET g_errparam.extend = "sfanwf_t:",SQLERRMESSAGE
                           LET g_errparam.code   = SQLCA.sqlcode
                           LET g_errparam.popup  = FALSE
                           CALL cl_err()
                           RETURN
                        END IF
                        LET l_flag1 = 'N'
                        CALL bsft001_wf_ins_sfanwf()
                        CALL bsft001_wf_b_fill_sfanwf()
                        LET l_flag1 = 'Y'
                     END IF
                  END IF
                  #161011-00039#1--add---end---
                  #????????????
                  DELETE FROM sfbcwf_t WHERE sfbcwfent=g_enterprise AND sfbcwfsite=g_site AND sfbcwfdocno=g_sfajwf_m.sfajwfdocno
                  CALL cl_err_collect_init()   #181112-00058#1 add
                  CALL s_bsft001_wf_02(g_sfajwf_m.sfajwfdocno,g_sfakwf_d[l_ac].sfakwfseq,g_sfajwf_m.sfajwf003,g_sfakwf_d[l_ac].sfakwf001,
                                          #??                #????     #????               #????               
            
                             g_sfakwf_d[l_ac].sfakwf043,'N','','','','') 
                                     #BOM????    #?????Y/N)      #??????             #??DATECODE                  #??????             #??????
                   RETURNING l_success,l_num
                  #241104-00004#1 add--s
                  IF l_success AND g_sfajwf_m.sfajwf013 =  '2' THEN
                     CALL bsft001_wf_up_fc() RETURNING l_success 
                  END IF                     
                  #241104-00004#1 add--e
                  IF NOT l_success THEN
                     CALL s_transaction_end('N','0')
                  ELSE
                     #241030-00001#1 add ---s
                     CALL bsft001_wf_upd_sfakwf(l_ac,'') RETURNING l_success  #241212-00001#1 add,''
                     IF l_success THEN
                        CALL s_transaction_end('Y','0')
                     ELSE
                        CALL s_transaction_end('N','0')
                     END IF
                     #241030-00001#1 add ---e
                     #CALL s_transaction_end('Y','0') #241030-00001#1 mark
                  END IF
                  CALL cl_err_collect_show()   #181112-00058#1 add
                  CALL bsft001_wf_b_fill()
                  CALL bsft001_wf_b_fill2('3') 
                  LET g_rec_b = g_sfakwf2_d.getLength()
                END IF

               END IF
            END IF
            #240709-00009#1 add--e
            #end add-point 
    
         ON ACTION controlo    
            IF l_insert THEN
               #170920-00028 ---modify start---
               #????????????????
               IF l_ac_t <= 0 OR l_ac_t IS NULL THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.extend = ""
                  LET g_errparam.code   = "adz-01032"
                  LET g_errparam.popup  = TRUE
                  CALL cl_err()
               ELSE
                  LET li_reproduce = l_ac_t
                  LET li_reproduce_target = l_ac
                  LET g_sfakwf_d[li_reproduce_target].* = g_sfakwf_d[li_reproduce].*
 
                  LET g_sfakwf_d[li_reproduce_target].sfakwfseq = NULL
 
               END IF
               #170920-00028 --- modify end ---
            ELSE
               CALL FGL_SET_ARR_CURR(g_sfakwf_d.getLength()+1)
               LET lb_reproduce = TRUE
               LET li_reproduce = l_ac
               LET li_reproduce_target = g_sfakwf_d.getLength()+1
            END IF
            #(ver:84) ---start---
            #add-point:input?????  name="input.body.controlo"

            #end add-point
            #(ver:84) --- end ---
            
         #ON ACTION cancel
         #   LET INT_FLAG = 1
         #   LET g_detail_idx = 1
         #   EXIT DIALOG 
 
      END INPUT
      
      INPUT ARRAY g_sfakwf4_d FROM s_detail4.*
         ATTRIBUTE(COUNT = g_rec_b,WITHOUT DEFAULTS, #MAXCOUNT = g_max_rec,
                 INSERT ROW = l_allow_insert, #???insert????????, ???????!
                 DELETE ROW = l_allow_delete,
                 APPEND ROW = l_allow_insert)
                 
         #??ACTION(detail_input,page_4)
         
         
         BEFORE INPUT
            #add-point:????? name="input.body4.before_input2"

            #end add-point
            IF g_insert = 'Y' AND NOT cl_null(g_insert) THEN 
              CALL FGL_SET_ARR_CURR(g_sfakwf4_d.getLength()+1) 
              LET g_insert = 'N' 
           END IF 
 
            CALL bsft001_wf_b_fill() #ver:82
            #????????1???????
            IF g_loc = 'd' AND g_rec_b != 0 THEN
               CALL FGL_SET_ARR_CURR(g_idx_group.getValue("'3',"))
            END IF
            LET g_loc = 'd'
            LET g_rec_b = g_sfakwf4_d.getLength()
            #add-point:????? name="input.body4.before_input"
            #240709-00009#1 add--s
            IF g_sfajwf_m.sfajwf017 != '1' OR cl_null(g_sfakwf_d[l_ac].sfakwf001) THEN
               NEXT FIELD sfanwfseq
            END IF
            #???????????????????????????????????????BOM????????????????????
            #??????????????????????
            IF NOT cl_null(g_sfajwf_m.sfajwfdocno) THEN
               SELECT COUNT(1) INTO l_n FROM sfamwf_t WHERE sfamwfent=g_enterprise AND sfamwfsite=g_site AND sfamwfdocno=g_sfajwf_m.sfajwfdocno
               IF l_n > 0 THEN
                  NEXT FIELD sfanwfseq
               END IF
            END IF
            #240709-00009#1 add--e
            #end add-point
            
         BEFORE INSERT
            IF s_transaction_chk("N",0) THEN
               CALL s_transaction_begin()
            END IF
            LET l_insert = TRUE
            LET l_n = ARR_COUNT()
            CALL bsft001_wf_idx_chk()   #(ver:83)
            LET l_cmd = 'a'
            INITIALIZE g_sfakwf4_d[l_ac].* TO NULL 
            INITIALIZE g_sfakwf4_d_t.* TO NULL 
            INITIALIZE g_sfakwf4_d_o.* TO NULL 
            #??????(??4)
            
            #??????(??4)
            
            #add-point:modify?before?? name="input.body4.insert.before_bak"

            #end add-point
            LET g_sfakwf4_d_t.* = g_sfakwf4_d[l_ac].*     #?????
            LET g_sfakwf4_d_o.* = g_sfakwf4_d[l_ac].*     #?????
            CALL cl_show_fld_cont()
            CALL bsft001_wf_set_entry_b(l_cmd)
            #add-point:modify?after_set_entry_b name="input.body4.insert.after_set_entry_b"

            #end add-point
            CALL bsft001_wf_set_no_entry_b(l_cmd)
            IF lb_reproduce THEN
               LET lb_reproduce = FALSE
               LET g_sfakwf4_d[li_reproduce_target].* = g_sfakwf4_d[li_reproduce].*
 
               LET g_sfakwf4_d[li_reproduce_target].sfamwfseq = NULL
            END IF
            
 
            #add-point:modify?before insert name="input.body4.before_insert"

            #end add-point  
 
         BEFORE ROW     
            #add-point:modify?before row2 name="input.body4.before_row2"

            #end add-point  
            LET l_insert = FALSE
            LET l_cmd = ''
            LET l_ac_t = l_ac 
            LET l_ac = ARR_CURR()
            LET g_detail_idx = l_ac
            LET g_detail_idx_list[4] = l_ac   #210121-00015 modify
            LET g_current_page = 4
              
            LET l_lock_sw = 'N'            #DEFAULT
            LET l_n = ARR_COUNT()
            DISPLAY l_ac TO FORMONLY.idx
         
            CALL s_transaction_begin()
            OPEN bsft001_wf_cl USING g_enterprise, g_site,g_sfajwf_m.sfajwfdocno
            IF SQLCA.SQLCODE THEN   #(ver:78)
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "OPEN bsft001_wf_cl:",SQLERRMESSAGE 
               LET g_errparam.code = SQLCA.SQLCODE   #(ver:78)
               LET g_errparam.popup = TRUE 
               CLOSE bsft001_wf_cl
               CALL s_transaction_end('N','0')
               CALL cl_err()
               RETURN
            END IF
            
            #200804-00006 ---start---
            FETCH bsft001_wf_cl
            IF SQLCA.SQLCODE AND SQLCA.SQLCODE <> 100 THEN
               INITIALIZE g_errparam TO NULL
               LET g_errparam.extend = "FETCH bsft001_wf_cl:",SQLERRMESSAGE
               LET g_errparam.code = SQLCA.SQLCODE
               LET g_errparam.popup = TRUE
               CLOSE bsft001_wf_cl
               #PostgreSQL???????, ????????????
               CALL s_transaction_end('N','0')
               CALL s_transaction_begin()
               CALL cl_err()
               RETURN
            END IF
            #200804-00006 --- end ---
            LET g_rec_b = g_sfakwf4_d.getLength()
            
            IF g_rec_b >= l_ac 
               AND g_sfakwf4_d[l_ac].sfamwfseq IS NOT NULL
            THEN 
               LET l_cmd='u'
               LET g_sfakwf4_d_t.* = g_sfakwf4_d[l_ac].*  #BACKUP
               LET g_sfakwf4_d_o.* = g_sfakwf4_d[l_ac].*  #BACKUP
               CALL bsft001_wf_set_entry_b(l_cmd)
               #add-point:modify?after_set_entry_b name="input.body4.after_set_entry_b"

               #end add-point  
               CALL bsft001_wf_set_no_entry_b(l_cmd)
               IF NOT bsft001_wf_lock_b("sfamwf_t","'4'") THEN
                  LET l_lock_sw='Y'
               ELSE
                  FETCH bsft001_wf_bcl2 INTO g_sfakwf4_d[l_ac].sfamwfseq,g_sfakwf4_d[l_ac].sfamwf001,g_sfakwf4_d[l_ac].sfamwf002,g_sfakwf4_d[l_ac].sfamwf003,g_sfakwf4_d[l_ac].sfamwf004,g_sfakwf4_d[l_ac].sfamwf005,g_sfakwf4_d[l_ac].sfamwf006,g_sfakwf4_d[l_ac].sfamwf007,g_sfakwf4_d[l_ac].sfamwf008
                  IF SQLCA.SQLCODE THEN
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = SQLERRMESSAGE  
                     LET g_errparam.code = SQLCA.SQLCODE 
                     LET g_errparam.popup = TRUE 
                     CALL cl_err()
                     LET l_lock_sw = "Y"
                  END IF
                  
                  #??????
                  LET g_sfakwf4_d_mask_o[l_ac].* =  g_sfakwf4_d[l_ac].*
                  CALL bsft001_wf_sfamwf_t_mask()
                  LET g_sfakwf4_d_mask_n[l_ac].* =  g_sfakwf4_d[l_ac].*
                  
                  LET g_bfill = "N"
                  CALL bsft001_wf_show()
                  LET g_bfill = "Y"
                  
                  CALL cl_show_fld_cont()
               END IF
            ELSE
               LET l_cmd='a'
            END IF
            #add-point:modify?before row name="input.body4.before_row"

            #end add-point  
            #??table????(???????)
            
 
            #??table??lock
            
 
            CALL bsft001_wf_idx_chk()   #(ver:83)
            
         BEFORE DELETE                            #??????
            IF l_cmd = 'a' THEN
               LET l_cmd='d'
               #add-point:??AFTER DELETE (=d) name="input.body4.after_delete_d"

               #end add-point
            ELSE
               #add-point:????? name="input.body4.b_delete_ask"

               #end add-point 
               IF NOT cl_ask_del_detail() THEN
                  CANCEL DELETE
               END IF
               IF l_lock_sw = "Y" THEN
                  INITIALIZE g_errparam TO NULL 
                  LET g_errparam.extend = "" 
                  LET g_errparam.code = -263 
                  LET g_errparam.popup = TRUE 
                  CALL cl_err()
                  CANCEL DELETE
               END IF
               
               #add-point:??4??? name="input.body4.b_delete"

               #end add-point    
                  
               #??????key?
               INITIALIZE gs_keys TO NULL
               LET gs_keys[01] = g_sfajwf_m.sfajwfdocno
               LET gs_keys[gs_keys.getLength()+1] = g_sfakwf4_d_t.sfamwfseq
            
               #??????
               IF NOT bsft001_wf_delete_b('sfamwf_t',gs_keys,"'4'") THEN
                  CALL s_transaction_end('N','0')
                  CLOSE bsft001_wf_bcl
                  CANCEL DELETE
               END IF
    
               #??????
               IF NOT bsft001_wf_key_delete_b(gs_keys,'sfamwf_t') THEN
                  CALL s_transaction_end('N','0')
                  CLOSE bsft001_wf_bcl
                  CANCEL DELETE
               END IF
               
               #?????
               
 
               
   #161130-00056 add
               
               #add-point:??4??? name="input.body4.m_delete"

               #end add-point    
               
               CALL s_transaction_end('Y','0')
               CLOSE bsft001_wf_bcl
 
               LET g_rec_b = g_rec_b-1
               #add-point:??4??? name="input.body4.a_delete"

               #end add-point
               LET l_count = g_sfakwf_d.getLength()
               
               #add-point:?????(<>d) name="input.body4.after_delete"

               #end add-point
            END IF 
 
         AFTER DELETE
            #???????
            IF l_ac = (g_sfakwf4_d.getLength() + 1) THEN
               CALL FGL_SET_ARR_CURR(l_ac-1)
            END IF
 
         AFTER INSERT    
            LET l_insert = FALSE
            IF INT_FLAG THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code = 9001 
               LET g_errparam.popup = FALSE 
               CALL cl_err()
               LET INT_FLAG = 0
               CANCEL INSERT
            END IF
               
            #add-point:??4??? name="input.body4.b_a_insert"

            #end add-point
               
            LET l_count = 1  
            SELECT COUNT(1) INTO l_count FROM sfamwf_t 
             WHERE sfamwfent = g_enterprise AND sfamwfdocno = g_sfajwf_m.sfajwfdocno
               AND sfamwfseq = g_sfakwf4_d[l_ac].sfamwfseq
                
            #?????, ??????
            IF l_count = 0 THEN 
               #add-point:??4??? name="input.body4.b_insert"

               #end add-point
            
                              INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_sfajwf_m.sfajwfdocno
               LET gs_keys[2] = g_sfakwf4_d[g_detail_idx].sfamwfseq
               CALL bsft001_wf_insert_b('sfamwf_t',gs_keys,"'4'")
                           
               #add-point:?????4 name="input.body4.a_insert"

               #end add-point
            ELSE    
               INITIALIZE g_sfakwf_d[l_ac].* TO NULL
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = 'INSERT' 
               LET g_errparam.code = "std-00006" 
               LET g_errparam.popup = TRUE 
               CALL s_transaction_end('N','0')
               CALL cl_err()
               CANCEL INSERT
            END IF
 
            IF SQLCA.SQLCODE THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "sfamwf_t:",SQLERRMESSAGE 
               LET g_errparam.code = SQLCA.SQLCODE 
               LET g_errparam.popup = TRUE 
               CALL s_transaction_end('N','0')                    
               CALL cl_err()
               CANCEL INSERT
            ELSE
               #?????
               #CALL bsft001_wf_b_fill()
               #??????-?/?
               
                  #161130-00056 add
               #add-point:????? name="input.body4.after_insert"

               #end add-point
               CALL s_transaction_end('Y','0')
               #ERROR 'INSERT O.K'
               LET g_rec_b = g_rec_b + 1
            END IF
            
         ON ROW CHANGE 
            IF INT_FLAG THEN
               LET INT_FLAG = 0
               LET g_sfakwf4_d[l_ac].* = g_sfakwf4_d_t.*
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code = 9001 
               LET g_errparam.popup = FALSE 
               CLOSE bsft001_wf_bcl2
               CALL s_transaction_end('N','0')
               CALL cl_err()
               EXIT DIALOG 
            END IF
            
            IF l_lock_sw = 'Y' THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code = -263 
               LET g_errparam.popup = TRUE 
               CALL cl_err()
               LET g_sfakwf4_d[l_ac].* = g_sfakwf4_d_t.*
               EXIT DIALOG   #210416-00007
            ELSE
               #add-point:??page4??? name="input.body4.b_update"

               #end add-point
               
               #?????/??????(??4)
               
               
               #???????
               CALL bsft001_wf_sfamwf_t_mask_restore('restore_mask_o')
                              
               UPDATE sfamwf_t SET (sfamwfdocno,sfamwfseq,sfamwf001,sfamwf002,sfamwf003,sfamwf004,sfamwf005,sfamwf006,sfamwf007,sfamwf008) = (g_sfajwf_m.sfajwfdocno,g_sfakwf4_d[l_ac].sfamwfseq,g_sfakwf4_d[l_ac].sfamwf001,g_sfakwf4_d[l_ac].sfamwf002,g_sfakwf4_d[l_ac].sfamwf003,g_sfakwf4_d[l_ac].sfamwf004, 
                   g_sfakwf4_d[l_ac].sfamwf005,g_sfakwf4_d[l_ac].sfamwf006,g_sfakwf4_d[l_ac].sfamwf007,g_sfakwf4_d[l_ac].sfamwf008) #??????
                WHERE sfamwfent = g_enterprise AND sfamwfdocno = g_sfajwf_m.sfajwfdocno
                  AND sfamwfseq = g_sfakwf4_d_t.sfamwfseq #?? 
                  
               #add-point:??page4??? name="input.body4.m_update"

               #end add-point
                  
               CASE
                  WHEN SQLCA.sqlerrd[3] = 0  #???????
                     LET g_sfakwf4_d[l_ac].* = g_sfakwf4_d_t.*
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = "sfamwf_t" 
                     LET g_errparam.code = "std-00009" 
                     LET g_errparam.popup = TRUE 
                     CALL s_transaction_end('N','0')
                     CALL cl_err()
                     EXIT DIALOG   #210416-00007
                     
                  WHEN SQLCA.SQLCODE #????
                     LET g_sfakwf4_d[l_ac].* = g_sfakwf4_d_t.*
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = "sfamwf_t:",SQLERRMESSAGE 
                     LET g_errparam.code = SQLCA.SQLCODE 
                     LET g_errparam.popup = TRUE 
                     CALL s_transaction_end('N','0')
                     CALL cl_err()
                     EXIT DIALOG   #210416-00007
                     
                  OTHERWISE
                     #??????-?/?
                     
                        #161130-00056 add
                                    INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_sfajwf_m.sfajwfdocno
               LET gs_keys_bak[1] = g_sfajwfdocno_t
               LET gs_keys[2] = g_sfakwf4_d[g_detail_idx].sfamwfseq
               LET gs_keys_bak[2] = g_sfakwf4_d_t.sfamwfseq
               CALL bsft001_wf_update_b('sfamwf_t',gs_keys,gs_keys_bak,"'4'")
               END CASE
               #210416-00007 ????add-point ---start---
               #add-point:??page4????????? name="input.body4.a_update_b_mask"

               #end add-point
               #210416-00007 ????add-point --- end ---
               
               #?????????
               CALL bsft001_wf_sfamwf_t_mask_restore('restore_mask_n')
               
               #??key?????
               INITIALIZE gs_keys TO NULL
               IF NOT (g_sfakwf4_d[g_detail_idx].sfamwfseq = g_sfakwf4_d_t.sfamwfseq 
                  ) THEN
                  LET gs_keys[01] = g_sfajwf_m.sfajwfdocno
                  LET gs_keys[gs_keys.getLength()+1] = g_sfakwf4_d_t.sfamwfseq
                  CALL bsft001_wf_key_update_b(gs_keys,'sfamwf_t')
               END IF
               
               #??????(????)
               LET g_log1 = util.JSON.stringify(g_sfajwf_m),util.JSON.stringify(g_sfakwf4_d_t)
               LET g_log2 = util.JSON.stringify(g_sfajwf_m),util.JSON.stringify(g_sfakwf4_d[l_ac])
               IF NOT cl_log_modified_record_d(g_log1,g_log2) THEN 
                  CALL s_transaction_end('N','0')
                  EXIT DIALOG   #210416-00007
               END IF
               
               #add-point:??page4??? name="input.body4.a_update"

               #end add-point
            END IF
         
                  #?? a01 ??????(Version:2)
         BEFORE FIELD sfamwfseq
            #add-point:BEFORE FIELD sfamwfseq name="input.b.page4.sfamwfseq"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfamwfseq
            
            #add-point:AFTER FIELD sfamwfseq name="input.a.page4.sfamwfseq"
            #?? a05 ??????(Version:3)
            #???????
#            IF  g_sfajwf_m.sfajwfdocno IS NOT NULL AND g_sfakwf_d[g_detail_idx].sfakwfseq IS NOT NULL AND g_sfakwf4_d[g_detail_idx2].sfamwfdocno IS NOT NULL AND g_sfakwf4_d[g_detail_idx2].sfamwfseq IS NOT NULL THEN 
#               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_sfajwf_m.sfajwfdocno != g_sfajwfdocno_t OR g_sfakwf_d[g_detail_idx].sfakwfseq != g_sfakwf_d[g_detail_idx].sfakwfseq OR g_sfakwf4_d[g_detail_idx2].sfamwfdocno != g_sfakwf4_d_t.sfamwfdocno OR g_sfakwf4_d[g_detail_idx2].sfamwfseq != g_sfakwf4_d_t.sfamwfseq)) THEN 
#                  IF NOT ap_chk_notDup("","SELECT COUNT(1) FROM sfamwf_t WHERE "||"sfamwfent = " ||g_enterprise|| " AND "||"sfamwfdocno = '"||g_sfajwf_m.sfajwfdocno ||"' AND "|| "sfamwfseq = '"||g_sfakwf_d[g_detail_idx].sfakwfseq ||"'",'std-00004',0) THEN 
#                     NEXT FIELD CURRENT
#                  END IF
#               END IF
#            END IF



            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfamwfseq
            #add-point:ON CHANGE sfamwfseq name="input.g.page4.sfamwfseq"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfamwf001
            #add-point:BEFORE FIELD sfamwf001 name="input.b.page4.sfamwf001"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfamwf001
            
            #add-point:AFTER FIELD sfamwf001 name="input.a.page4.sfamwf001"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfamwf001
            #add-point:ON CHANGE sfamwf001 name="input.g.page4.sfamwf001"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfamwf002
            #add-point:BEFORE FIELD sfamwf002 name="input.b.page4.sfamwf002"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfamwf002
            
            #add-point:AFTER FIELD sfamwf002 name="input.a.page4.sfamwf002"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfamwf002
            #add-point:ON CHANGE sfamwf002 name="input.g.page4.sfamwf002"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfamwf003
            #add-point:BEFORE FIELD sfamwf003 name="input.b.page4.sfamwf003"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfamwf003
            
            #add-point:AFTER FIELD sfamwf003 name="input.a.page4.sfamwf003"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfamwf003
            #add-point:ON CHANGE sfamwf003 name="input.g.page4.sfamwf003"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfamwf004
            #add-point:BEFORE FIELD sfamwf004 name="input.b.page4.sfamwf004"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfamwf004
            
            #add-point:AFTER FIELD sfamwf004 name="input.a.page4.sfamwf004"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfamwf004
            #add-point:ON CHANGE sfamwf004 name="input.g.page4.sfamwf004"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfamwf005
            #add-point:BEFORE FIELD sfamwf005 name="input.b.page4.sfamwf005"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfamwf005
            
            #add-point:AFTER FIELD sfamwf005 name="input.a.page4.sfamwf005"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfamwf005
            #add-point:ON CHANGE sfamwf005 name="input.g.page4.sfamwf005"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfamwf006
            #add-point:BEFORE FIELD sfamwf006 name="input.b.page4.sfamwf006"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfamwf006
            
            #add-point:AFTER FIELD sfamwf006 name="input.a.page4.sfamwf006"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfamwf006
            #add-point:ON CHANGE sfamwf006 name="input.g.page4.sfamwf006"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfamwf007
            #add-point:BEFORE FIELD sfamwf007 name="input.b.page4.sfamwf007"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfamwf007
            
            #add-point:AFTER FIELD sfamwf007 name="input.a.page4.sfamwf007"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfamwf007
            #add-point:ON CHANGE sfamwf007 name="input.g.page4.sfamwf007"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfamwf008
            #add-point:BEFORE FIELD sfamwf008 name="input.b.page4.sfamwf008"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfamwf008
            
            #add-point:AFTER FIELD sfamwf008 name="input.a.page4.sfamwf008"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfamwf008
            #add-point:ON CHANGE sfamwf008 name="input.g.page4.sfamwf008"

            #END add-point 
 
 
 
                  #Ctrlp:input.c.page4.sfamwfseq
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfamwfseq
            #add-point:ON ACTION controlp INFIELD sfamwfseq name="input.c.page4.sfamwfseq"

            #END add-point
 
 
         #Ctrlp:input.c.page4.sfamwf001
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfamwf001
            #add-point:ON ACTION controlp INFIELD sfamwf001 name="input.c.page4.sfamwf001"

            #END add-point
 
 
         #Ctrlp:input.c.page4.sfamwf002
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfamwf002
            #add-point:ON ACTION controlp INFIELD sfamwf002 name="input.c.page4.sfamwf002"
            
            #END add-point
 
 
         #Ctrlp:input.c.page4.sfamwf003
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfamwf003
            #add-point:ON ACTION controlp INFIELD sfamwf003 name="input.c.page4.sfamwf003"

            #END add-point
 
 
         #Ctrlp:input.c.page4.sfamwf004
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfamwf004
            #add-point:ON ACTION controlp INFIELD sfamwf004 name="input.c.page4.sfamwf004"

            #END add-point
 
 
         #Ctrlp:input.c.page4.sfamwf005
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfamwf005
            #add-point:ON ACTION controlp INFIELD sfamwf005 name="input.c.page4.sfamwf005"

            #END add-point
 
 
         #Ctrlp:input.c.page4.sfamwf006
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfamwf006
            #add-point:ON ACTION controlp INFIELD sfamwf006 name="input.c.page4.sfamwf006"

            #END add-point
 
 
         #Ctrlp:input.c.page4.sfamwf007
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfamwf007
            #add-point:ON ACTION controlp INFIELD sfamwf007 name="input.c.page4.sfamwf007"

            #END add-point
 
 
         #Ctrlp:input.c.page4.sfamwf008
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfamwf008
            #add-point:ON ACTION controlp INFIELD sfamwf008 name="input.c.page4.sfamwf008"

            #END add-point
 
 
 
 
         AFTER ROW
            #add-point:??page4 after_row name="input.body4.after_row"

            #end add-point
            LET l_ac = ARR_CURR()
            IF INT_FLAG THEN
               LET INT_FLAG = 0
               IF l_cmd = 'u' THEN
                  LET g_sfakwf4_d[l_ac].* = g_sfakwf4_d_t.*
               END IF
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code = 9001 
               LET g_errparam.popup = FALSE 
               CLOSE bsft001_wf_bcl2
               CALL s_transaction_end('N','0')
               CALL cl_err()
               EXIT DIALOG 
            END IF
            
            #??table??unlock
            
            CALL bsft001_wf_unlock_b("sfamwf_t","'4'")
            CALL s_transaction_end('Y','0')
            #add-point:??page4 after_row2 name="input.body4.after_row2"

            #end add-point
 
         AFTER INPUT
            #add-point:input?after input  name="input.body4.after_input"

            #end add-point   
    
         ON ACTION controlo
            IF l_insert THEN
               #170920-00028 ---modify start---
               #????????????????
               IF l_ac_t <= 0 OR l_ac_t IS NULL THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.extend = ""
                  LET g_errparam.code   = "adz-01032"
                  LET g_errparam.popup  = TRUE
                  CALL cl_err()
               ELSE
                  LET li_reproduce = l_ac_t
                  LET li_reproduce_target = l_ac
                  LET g_sfakwf4_d[li_reproduce_target].* = g_sfakwf4_d[li_reproduce].*
 
                  LET g_sfakwf4_d[li_reproduce_target].sfamwfseq = NULL
               END IF
               #170920-00028 --- modify end ---
            ELSE
               CALL FGL_SET_ARR_CURR(g_sfakwf4_d.getLength()+1)
               LET lb_reproduce = TRUE
               LET li_reproduce = l_ac
               LET li_reproduce_target = g_sfakwf4_d.getLength()+1
            END IF
            #(ver:84) ---start---
            #add-point:input?????  name="input.body4.controlo"

            #end add-point
            #(ver:84) --- end ---
            
      END INPUT
 
      
      INPUT ARRAY g_sfakwf2_d FROM s_detail2.*
         ATTRIBUTE(COUNT = g_rec_b,WITHOUT DEFAULTS, #MAXCOUNT = g_max_rec,
                 INSERT ROW = l_allow_insert, #???insert????????, ???????!
                 DELETE ROW = l_allow_delete,
                 APPEND ROW = l_allow_insert)
                 
         #??ACTION(detail_input,page_2)
         
 
         #?? a43 ??????(Version:4)
         ON ACTION gen_bin
            LET g_action_choice="gen_bin"
            IF cl_auth_chk_act("gen_bin") THEN
               
               #add-point:ON ACTION gen_bin name="input.detail_input.page2.gen_bin"
               #??????????????
               IF g_sfajwf_m.sfajwfstus <> 'N' THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = 'wf-00017'
                  LET g_errparam.extend = ""
                  LET g_errparam.popup = TRUE
                  CALL cl_err()    
                  EXIT DIALOG
               END IF    
               SELECT imafwf210 INTO l_imafwf210
                 FROM imaf_t
                WHERE imafent = g_enterprise
                  AND imafsite = g_site
                  AND imaf001 = g_sfakwf2_d[l_ac].sfbcwf006                    
               IF l_imafwf210 = 'Y' THEN #??????????
                  CALL s_icd_wf_out(g_site,g_sfajwf_m.sfajwfdocno,g_sfakwf2_d[l_ac].sfbcwfseq1,g_sfakwf2_d[l_ac].sfbcwfseq2,g_sfakwf2_d[l_ac].sfbcwf006,g_sfakwf2_d[l_ac].sfbcwf021,g_sfakwf2_d[l_ac].sfbcwf014,g_sfakwf2_d[l_ac].sfbcwf013,'-1',g_sfajwf_m.sfajwf001,'1','',
                              g_sfakwf2_d[l_ac].sfbcwf019,g_sfakwf2_d[l_ac].sfbcwf020,g_sfakwf2_d[l_ac].sfbcwf029,g_sfakwf2_d[l_ac].sfbcwf040,g_sfakwf2_d[l_ac].sfbcwf041,g_sfakwf2_d[l_ac].sfbcwf042,g_sfakwf2_d[l_ac].sfbcwf030,g_sfakwf_d[g_detail_idx].sfakwfseq,g_sfakwf2_d[l_ac].sfbcwf039)   #160316-00007#1 add by lixh 20160316 add sfbcwf030  #add by lixh 20150909     
                     RETURNING l_success,l_amount,l_amount_die                  
                  IF l_success THEN
                     IF s_icd_wf_clear_flag(g_sfajwf_m.sfajwfdocno,g_sfakwf_d[g_detail_idx].sfakwfseq,'-1') THEN
                        LET g_sfakwf2_d[l_ac].sfbcwf040 = NULL 	#DATECODE
                        LET g_sfakwf2_d[l_ac].sfbcwf041 = NULL 	#????
                        LET g_sfakwf2_d[l_ac].sfbcwf042 = NULL 	#????
                     END IF 
#                     CALL s_icd_wf_clear_inbb003(g_sfajwf_m.sfajwfdocno,g_sfakwf_d[g_detail_idx].sfakwfseq,'-1') RETURNING l_success,l_icbawf003,l_icbawf018
#                     IF l_success THEN
#                        LET g_sfakwf2_d[l_ac].sfbcwf030 = l_icbawf003 	   #??????
#                        LET g_sfakwf2_d[l_ac].sfbcwf039 = l_icbawf018 	 #????	
#                     ELSE
#                        LET g_sfakwf2_d[l_ac].sfbcwf030 = NULL 	   #??????
#                        LET g_sfakwf2_d[l_ac].sfbcwf039 = NULL 	 #????	
#                     END IF
                     IF s_aint302_wf_oocawf008(g_sfakwf2_d[l_ac].sfbcwf006) THEN
                        LET l_amount_2 = l_amount_die
                     ELSE
                        LET l_amount_2 = l_amount
                     END IF
                     SELECT imaa006,imaf053 INTO l_imaa006,l_imaf053 FROM imaf_t 
                       LEFT OUTER JOIN imaa_t ON imaaent = g_enterprise AND imaa001 = imaf001
                      WHERE imafent = g_enterprise AND imafsite = g_site
                        AND imaf001 = g_sfakwf2_d[l_ac].sfbcwf006
                     IF s_aint302_wf_oocawf008(g_sfakwf2_d[l_ac].sfbcwf006) THEN
                        IF l_imaf053 = l_imaa006 THEN   #????=????
                           LET l_sfbcwf048 =  l_amount_die  #?????? 
                        ELSE
                           LET l_sfbcwf048 =  l_amount                
                        END IF                               
                     ELSE
                        IF l_imaf053 = l_imaa006 THEN   #????=????
                           LET l_sfbcwf048 =  l_amount  #?????? 
                        ELSE
                           LET l_sfbcwf048 =  l_amount_die                
                        END IF  
                     END IF                            
                     IF g_sfakwf2_d[l_ac].sfbcwf023 <> l_amount_2 OR l_sfbcwf048 <> g_sfakwf2_d_t.sfbcwf048 THEN      #???????????????????               
                        IF cl_ask_confirm('wf-00002') THEN   #????????????????????????????                                   
                           IF s_aint302_wf_oocawf008(g_sfakwf2_d[l_ac].sfbcwf006) THEN
                              LET g_sfakwf2_d[l_ac].sfbcwf047 = l_amount_die #????
                              IF g_sfakwf2_d[l_ac].sfbcwf014 = l_imaf053  THEN  #????=????
                                 LET g_sfakwf2_d[l_ac].sfbcwf023 = l_amount_die #?????
                              ELSE 
                                 LET g_sfakwf2_d[l_ac].sfbcwf023 = l_amount                                
                              END IF
                              IF l_imaf053 = l_imaa006 THEN   #????=????
                                 LET g_sfakwf2_d[l_ac].sfbcwf048 =  l_amount_die  #?????? 
                              ELSE
                                 LET g_sfakwf2_d[l_ac].sfbcwf048 =  l_amount                
                              END IF                               
                           ELSE
                              LET g_sfakwf2_d[l_ac].sfbcwf047 = l_amount #????
                              IF g_sfakwf2_d[l_ac].sfbcwf014 = l_imaf053  THEN 
                                 LET g_sfakwf2_d[l_ac].sfbcwf023 = l_amount 
                              ELSE                              
                                 LET g_sfakwf2_d[l_ac].sfbcwf023 = l_amount_die            
                              END IF
                              IF l_imaf053 = l_imaa006 THEN   #????=????
                                 LET g_sfakwf2_d[l_ac].sfbcwf048 =  l_amount  #?????? 
                              ELSE
                                 LET g_sfakwf2_d[l_ac].sfbcwf048 =  l_amount_die                
                              END IF  
                           END IF  
                           #????
                           IF NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf014) THEN
                              CALL s_aooi250_take_decimals(g_sfakwf2_d[l_ac].sfbcwf014,g_sfakwf2_d[l_ac].sfbcwf023)
                                   RETURNING l_success,g_sfakwf2_d[l_ac].sfbcwf023
                           END IF
                           IF NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf014) THEN
                              CALL s_aooi250_take_decimals(g_sfakwf2_d[l_ac].sfbcwf014,g_sfakwf2_d[l_ac].sfbcwf024)
                                   RETURNING l_success,g_sfakwf2_d[l_ac].sfbcwf024
                           END IF
                           #?????=????+??????
                           LET g_sfakwf2_d[l_ac].sfbcwf013 = g_sfakwf2_d[l_ac].sfbcwf024 + g_sfakwf2_d[l_ac].sfbcwf023
                           IF NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf014) THEN
                              CALL s_aooi250_take_decimals(g_sfakwf2_d[l_ac].sfbcwf014,g_sfakwf2_d[l_ac].sfbcwf013)
                                   RETURNING l_success,g_sfakwf2_d[l_ac].sfbcwf013
                           END IF
                           
                           #241104-00004#1 add--s
                           SELECT COUNT(1) INTO l_cnt FROM bmba_t 
                            WHERE bmbaent = g_enterprise AND bmbasite = g_site AND bmba001 = g_sfakwf_d[g_detail_idx].sfakwf001 AND bmba003 = g_sfakwf2_d[l_ac].sfbcwf006
                              AND bmba002 = g_sfakwf_d[g_detail_idx].sfakwf001  AND bmba004 = g_sfakwf2_d[l_ac].sfbcwf002 AND bmbawf039 = 'Y'
                              AND bmba007 = g_sfakwf2_d[l_ac].sfbcwf003 AND bmba008 = g_sfakwf2_d[l_ac].sfbcwf004
                           IF l_cnt > 0 THEN  #?????????BOM???????????,???????????
                              SELECT bmba012,bmba011 INTO l_bmba012,l_bmba011 FROM bmba_t
                               WHERE bmbaent = g_enterprise AND bmbasite = g_site AND bmba001 = g_sfakwf_d[g_detail_idx].sfakwf001  AND bmba002 = g_sfakwf_d[g_detail_idx].sfakwf002
                                 AND bmba003 = g_sfakwf2_d[l_ac].sfbcwf006 AND bmba004 = g_sfakwf2_d[l_ac].sfbcwf002
                                 AND bmba007 = g_sfakwf2_d[l_ac].sfbcwf003 AND bmba008 = g_sfakwf2_d[l_ac].sfbcwf004
                              LET g_sfakwf2_d[l_ac].sfbcwf049 = g_sfakwf2_d[l_ac].sfbcwf023 * l_bmba012 / l_bmba011                              
                           ELSE
                              LET g_sfakwf2_d[l_ac].sfbcwf049 = g_sfakwf2_d[l_ac].sfbcwf023
                           END IF
                           #241104-00004#1 add--e 
                           #250319-00001#1 add--s
                           #??QPA????
                           CALL bsft001_wf_sfbcwf023_qpa_02(g_sfakwf2_d[l_ac].sfbcwf023,g_sfakwf2_d[l_ac].sfbcwf049) RETURNING g_sfakwf2_d[l_ac].sfbcwf010,g_sfakwf2_d[l_ac].sfbcwf011
                           #250319-00001#1 add--e
                           UPDATE sfbcwf_t SET sfbcwf040 = g_sfakwf2_d[l_ac].sfbcwf040,                              
                                               sfbcwf041 = g_sfakwf2_d[l_ac].sfbcwf041,                                                 
                                               sfbcwf042 = g_sfakwf2_d[l_ac].sfbcwf042,
                                               sfbcwf047 = g_sfakwf2_d[l_ac].sfbcwf047,
                                               sfbcwf023 = g_sfakwf2_d[l_ac].sfbcwf023,                                             
                                               sfbcwf048 = g_sfakwf2_d[l_ac].sfbcwf048,
                                               sfbcwf024 = g_sfakwf2_d[l_ac].sfbcwf024,
                                               sfbcwf049 = g_sfakwf2_d[l_ac].sfbcwf049, #241104-00004#1 add
                                               sfbcwf010 = g_sfakwf2_d[l_ac].sfbcwf010, #250319-00001#1 add
                                               sfbcwf011 = g_sfakwf2_d[l_ac].sfbcwf011, #250319-00001#1 add
                                               #241212-00001#1 add--s
                                               sfbcwf019 = g_sfakwf2_d[l_ac].sfbcwf019,
                                               sfbcwf020 = g_sfakwf2_d[l_ac].sfbcwf020,
                                               sfbcwf029 = g_sfakwf2_d[l_ac].sfbcwf029,
                                               #241212-00001#1 add--e 
                                               sfbcwf013 = g_sfakwf2_d[l_ac].sfbcwf013
                            WHERE sfbcwfent = g_enterprise AND sfbcwfsite = g_site AND sfbcwfdocno = g_sfajwf_m.sfajwfdocno AND sfbcwfseq = g_sfakwf_d[g_detail_idx].sfakwfseq 
                              AND sfbcwfseq1 = g_sfakwf2_d[l_ac].sfbcwfseq1 AND sfbcwfseq2 = g_sfakwf2_d[l_ac].sfbcwfseq2
                           IF SQLCA.sqlcode THEN
                              INITIALIZE g_errparam TO NULL
                              LET g_errparam.code = SQLCA.sqlcode
                              LET g_errparam.extend = "sfbcwf_t"
                              LET g_errparam.popup = FALSE
                              CALL cl_err()  
                           END IF 
                           #241104-00004#1 mark--s
                           #240423-00009#2 --s
#                           #??????,????bin?????????????????????????
#                           IF g_sfakwf2_d[l_ac].sfbcwf043 = 'Y' THEN
#                              LET l_sql = " SELECT * ",
#                                          " FROM sfbcwf_t ",
#                                          "  WHERE sfbcwfent = ",g_enterprise,"", 
#                                          " AND sfbcwfsite ='",g_site,"'",
#                                          " AND sfbcwfdocno ='",g_sfajwf_m.sfajwfdocno,"'",
#                                          " AND sfbcwfseq =",g_sfakwf_d[g_detail_idx].sfakwfseq,"", 
#                                          " AND sfbcwfseq1 !=",g_sfakwf2_d[l_ac].sfbcwfseq1,""
#                                 PREPARE ups_fucai_pb1 FROM l_sql
#                                 DECLARE ups_fucai_cs1 CURSOR FOR ups_fucai_pb1
#                              FOREACH ups_fucai_cs1 INTO l_sfbcwf_2.*
#                                  IF SQLCA.SQLCODE THEN
#                                     INITIALIZE g_errparam TO NULL 
#                                     LET g_errparam.extend = "FOREACH:",SQLERRMESSAGE 
#                                     LET g_errparam.code = SQLCA.SQLCODE 
#                                     LET g_errparam.popup = TRUE 
#                                     CALL cl_err()
#                                     EXIT FOREACH
#                                  END IF
#                                  #???????????????
#                                  SELECT imafwf201 INTO l_imafwf201 FROM imaf_t WHERE imafent = g_enterprise AND imafsite = g_site
#                                    AND imaf001 = l_sfbcwf_2.sfbcwf006
#                                  SELECT imaa006,imaf053 INTO l_imaa006,l_imaf053 FROM imaf_t 
#                                    LEFT OUTER JOIN imaa_t ON imaaent = g_enterprise AND imaa001 = imaf001
#                                   WHERE imafent = g_enterprise AND imafsite = g_site
#                                     AND imaf001 = l_sfbcwf_2.sfbcwf006
#                                  IF (l_sfbcwf_2.sfbcwf043 = 'N' OR cl_null(l_sfbcwf_2.sfbcwf043)) AND (l_imafwf201='9' OR l_imafwf201='6') THEN
#                                     #240725-00004#1 mark--s
##                                     IF s_aint302_wf_oocawf008(l_sfbcwf006) THEN
##                                       IF l_imaf053 = l_imaa006 THEN   #????=????
##                                        UPDATE sfbcwf_t SET sfbcwf023 = l_amount_die,sfbcwf013 = l_amount_die
##                                        WHERE sfbcwfent = g_enterprise AND sfbcwfsite = g_site AND sfbcwfdocno = g_sfajwf_m.sfajwfdocno
##                                          AND sfbcwfseq1 = l_sfbcwfseq1 AND sfbcwfseq2 = l_sfbcwfseq2
##                                       ELSE
##                                        UPDATE sfbcwf_t SET sfbcwf023 = l_amount,sfbcwf013 = l_amount
##                                        WHERE sfbcwfent = g_enterprise AND sfbcwfsite = g_site AND sfbcwfdocno = g_sfajwf_m.sfajwfdocno
##                                          AND sfbcwfseq1 = l_sfbcwfseq1 AND sfbcwfseq2 = l_sfbcwfseq2
##                                       END IF
##                                     ELSE
##                                       IF l_imaf053 = l_imaa006 THEN   #????=????
##                                        UPDATE sfbcwf_t SET sfbcwf023 = l_amount,sfbcwf013 = l_amount
##                                        WHERE sfbcwfent = g_enterprise AND sfbcwfsite = g_site AND sfbcwfdocno = g_sfajwf_m.sfajwfdocno
##                                          AND sfbcwfseq1 = l_sfbcwfseq1 AND sfbcwfseq2 = l_sfbcwfseq2
##                                       ELSE
##                                        UPDATE sfbcwf_t SET sfbcwf023 = l_amount_die,sfbcwf013 = l_amount_die
##                                        WHERE sfbcwfent = g_enterprise AND sfbcwfsite = g_site AND sfbcwfdocno = g_sfajwf_m.sfajwfdocno
##                                          AND sfbcwfseq1 = l_sfbcwfseq1 AND sfbcwfseq2 = l_sfbcwfseq2
##                                       END IF
##                                     END IF
#                                     #240725-00004#1 mark--e
#                                     #240725-00004#1 add--s
#                                     LET l_sfbcwf_2.sfbcwf023 =g_sfakwf2_d[l_ac].sfbcwf023
#                                     #????
#                                     IF NOT cl_null(l_sfbcwf_2.sfbcwf014) THEN
#                                        CALL s_aooi250_take_decimals(l_sfbcwf_2.sfbcwf014,l_sfbcwf_2.sfbcwf023)
#                                             RETURNING l_success,l_sfbcwf_2.sfbcwf023
#                                     END IF
#                                     IF NOT cl_null(l_sfbcwf_2.sfbcwf014) THEN
#                                        CALL s_aooi250_take_decimals(l_sfbcwf_2.sfbcwf014,l_sfbcwf_2.sfbcwf024)
#                                             RETURNING l_success,l_sfbcwf_2.sfbcwf024
#                                     END IF
#                                     #?????=????+??????
#                                     LET l_sfbcwf_2.sfbcwf013 = l_sfbcwf_2.sfbcwf024 + l_sfbcwf_2.sfbcwf023
#                                     IF NOT cl_null(l_sfbcwf_2.sfbcwf014) THEN
#                                        CALL s_aooi250_take_decimals(l_sfbcwf_2.sfbcwf014,l_sfbcwf_2.sfbcwf013)
#                                             RETURNING l_success,l_sfbcwf_2.sfbcwf013
#                                     END IF 
#                                     SELECT bmba012,bmba011 INTO l_bmba012,l_bmba011 FROM bmba_t
#                                      WHERE bmbaent = g_enterprise AND bmbasite = g_site AND bmba001 =  g_sfakwf_d[g_detail_idx].sfakwf001 AND bmba002 =  g_sfakwf_d[g_detail_idx].sfakwf002
#                                        AND bmba003 = l_sfbcwf_2.sfbcwf006 AND bmba004 = l_sfbcwf_2.sfbcwf002
#                                        AND bmba007 = l_sfbcwf_2.sfbcwf003 AND bmba008 = l_sfbcwf_2.sfbcwf004
#                                     #????/??????????????????????????/????????                          
#                                     CALL s_aooi250_convert_qty(l_sfbcwf_2.sfbcwf006,l_sfbcwf_2.sfbcwf014,l_imaf053,l_sfbcwf_2.sfbcwf013) 
#                                        RETURNING l_success,l_sfbcwf_2.sfbcwf047  #????
#                                     CALL s_aooi250_convert_qty(l_sfbcwf_2.sfbcwf006,l_sfbcwf_2.sfbcwf014,l_imaa006,l_sfbcwf_2.sfbcwf013) 
#                                        RETURNING l_success,l_sfbcwf_2.sfbcwf048  #??????
#                                     LET l_sfbcwf_2.sfbcwf049 = l_sfbcwf_2.sfbcwf023 * l_bmba012 / l_bmba011            
#                                     #??QPA????
#                                     CALL s_bsft001_wf_02_qpa(l_sfbcwf_2.sfbcwf023,l_sfbcwf_2.sfbcwf049) RETURNING l_sfbcwf_2.sfbcwf010,l_sfbcwf_2.sfbcwf011
#                                     
#                                     UPDATE sfbcwf_t SET sfbcwf010 = l_sfbcwf_2.sfbcwf010, 
#                                                         sfbcwf011 = l_sfbcwf_2.sfbcwf011,
#                                                         sfbcwf023 = l_sfbcwf_2.sfbcwf023,
#                                                         sfbcwf024 = l_sfbcwf_2.sfbcwf024,
#                                                         sfbcwf013 = l_sfbcwf_2.sfbcwf013,
#                                                         sfbcwf019 = l_sfbcwf_2.sfbcwf019,
#                                                         sfbcwf020 = l_sfbcwf_2.sfbcwf020,
#                                                         sfbcwf029 = l_sfbcwf_2.sfbcwf029,         
#                                                         sfbcwf047 = l_sfbcwf_2.sfbcwf047, 
#                                                         sfbcwf048 = l_sfbcwf_2.sfbcwf048,
#                                                         sfbcwf049 = l_sfbcwf_2.sfbcwf049
#                                      WHERE sfbcwfent = g_enterprise AND sfbcwfsite = g_site AND sfbcwfdocno = g_sfajwf_m.sfajwfdocno
#                                        AND sfbcwfseq1 = l_sfbcwf_2.sfbcwfseq1 AND sfbcwfseq2 = l_sfbcwf_2.sfbcwfseq2
#                                     #240725-00004#1 add--e
#                                     IF SQLCA.sqlcode THEN
#                                        INITIALIZE g_errparam TO NULL
#                                        LET g_errparam.extend = "UPDATE sfbcwf_t:",SQLERRMESSAGE
#                                        LET g_errparam.code   = SQLCA.sqlcode
#                                        LET g_errparam.popup  = TRUE
#                                        CALL cl_err()
#                                        EXIT FOREACH
#                                     END IF
#                                  END IF
#                              END FOREACH
#                           END IF
                           #240423-00009#2 --e   
                           #241104-00004#1 mark--e 
                           #241104-00004#1 add--s  #QTB20250618043 mark
#                           IF g_sfakwf2_d[l_ac].sfbcwf043 = 'Y' THEN
#                              CALL bsft001_wf_up_fc() RETURNING l_success 
#                              IF NOT l_success THEN
#                              END IF
#                           END IF
                           #241104-00004#1 add--e                             
                        END IF
                     END IF
                     
                                       
                  END IF 
                  CALL bsft001_wf_upd_sfakwf(g_detail_idx,l_ac) RETURNING l_success  #241030-00001#1 add  #241212-00001#1 add ,l_ac
                  CALL s_icd_wf_ins_b_fill2(g_site,g_sfajwf_m.sfajwfdocno,'-1')       
#                  CALL bsft001_wf_b_fill2('3')  #240530-00021#1 add  ???????????????
               END IF             
               #END add-point
            END IF
 
 
 
 
        
         BEFORE INPUT
            #???????idx??g_detail_idx
            LET g_detail_idx_tmp = g_detail_idx
            LET g_detail_idx = g_detail_idx_list[1]
            #??????????
            IF g_detail_idx = 0 OR g_sfakwf_d.getLength() = 0 THEN
               NEXT FIELD sfakwfseq
            END IF
            #???????????
            IF cl_null(g_sfakwf_d[g_detail_idx].sfakwfseq) THEN
               NEXT FIELD sfakwfseq
            END IF
            #add-point:????? name="input.body2.before_input2"
            
            #end add-point
            IF g_insert = 'Y' AND NOT cl_null(g_insert) THEN 
              CALL FGL_SET_ARR_CURR(g_sfakwf2_d.getLength()+1) 
              LET g_insert = 'N' 
           END IF 
 
            #????????2???????
            IF g_loc = 'd' AND g_rec_b != 0 THEN
               CALL FGL_SET_ARR_CURR(g_idx_group.getValue("'4',"))
            END IF
            LET g_loc = 'd'
            LET g_rec_b = g_sfakwf2_d.getLength()
            #add-point:????? name="input.body2.before_input"
            #230921-00006#7 add--s
            CALL s_transaction_begin()
            CALL cl_err_collect_init()   #181112-00058#1 add
            #????
            SELECT COUNT(1) INTO l_cnt FROM sfbcwf_t 
             WHERE sfbcwfent = g_enterprise
               AND sfbcwfsite = g_site
               AND sfbcwfdocno = g_sfajwf_m.sfajwfdocno
               AND sfbcwfseq = g_sfakwf_d[g_detail_idx].sfakwfseq         
            IF l_cnt = 0 THEN                
#               CALL s_bsft001_wf_02(g_sfajwf_m.sfajwfdocno,g_sfakwf_d[g_detail_idx].sfakwfseq,g_sfajwf_m.sfajwf003,g_sfakwf_d[g_detail_idx].sfakwf001,
#                                          #??                #????                             #????               #????               
#            
#                                 g_sfakwf_d[g_detail_idx].sfakwf043,'N','','','','') 
#                                                  #BOM????    #?????Y/N)      #??????             #??DATECODE                  #??????             #??????
#
#                 RETURNING l_success,l_num
               CALL bsft001_wf_ins_sfbcwf() RETURNING l_success 
               CALL bsft001_wf_b_fill2('3') #241104-00004#1 add
               CALL s_icd_wf_ins_b_fill2(g_site,g_sfajwf_m.sfajwfdocno,'-1')
            END IF      
#            
            IF l_success THEN
               CALL s_transaction_end('Y','0')
            ELSE
               CALL s_transaction_end('N','0')
            END IF
            CALL cl_err_collect_show()   #181112-00058#1 add
            CALL bsft001_wf_b_fill2('3')
            LET g_rec_b = g_sfakwf2_d.getLength() 
            #230921-00006#7 add--e
            CALL bsft001_wf_set_no_require()   #240709-00009#1 add
            CALL bsft001_wf_set_require()      #240709-00009#1 add
            #end add-point
            
         BEFORE INSERT
            
            IF s_transaction_chk("N",0) THEN
               CALL s_transaction_begin()
            END IF
            LET l_insert = TRUE
            LET l_n = ARR_COUNT()
            CALL bsft001_wf_idx_chk()   #(ver:83)
            LET l_cmd = 'a'
            INITIALIZE g_sfakwf2_d[l_ac].* TO NULL 
            INITIALIZE g_sfakwf2_d_t.* TO NULL 
            INITIALIZE g_sfakwf2_d_o.* TO NULL 
            #??????(??2)
            
            #??????(??2)
                  LET g_sfakwf2_d[l_ac].sfbcwfseq1 = "0"
      LET g_sfakwf2_d[l_ac].sfbcwfseq2 = "0"
      LET g_sfakwf2_d[l_ac].sfbcwf022 = "0"
      LET g_sfakwf2_d[l_ac].sfbcwf007 = "0"
      LET g_sfakwf2_d[l_ac].sfbcwf010 = "1"
      LET g_sfakwf2_d[l_ac].sfbcwf011 = "1"
      LET g_sfakwf2_d[l_ac].sfbcwf012 = "0"
      LET g_sfakwf2_d[l_ac].sfbcwf023 = "0"
      LET g_sfakwf2_d[l_ac].sfbcwf024 = "0"
      LET g_sfakwf2_d[l_ac].sfbcwf013 = "0"
      LET g_sfakwf2_d[l_ac].sfbcwf047 = "0"
      LET g_sfakwf2_d[l_ac].sfbcwf048 = "0"
      LET g_sfakwf2_d[l_ac].number5 = "0"
      LET g_sfakwf2_d[l_ac].number6 = "0"
      LET g_sfakwf2_d[l_ac].sfbcwf015 = "0"
      LET g_sfakwf2_d[l_ac].sfbcwf016 = "0"
      LET g_sfakwf2_d[l_ac].sfbcwf025 = "0"
      LET g_sfakwf2_d[l_ac].sfbcwf017 = "0"
      LET g_sfakwf2_d[l_ac].sfbcwf018 = "0"
      LET g_sfakwf2_d[l_ac].sfbcwf035 = "0"
      LET g_sfakwf2_d[l_ac].sfbcwf049 = "0"
 
            #add-point:modify?before?? name="input.body2.insert.before_bak"
            CALL cl_get_doc_para(g_enterprise,g_site,g_ooba002,'D-MFG-0032') RETURNING g_para
            LET g_sfakwf2_d[l_ac].sfbcwf022 = '1'
            LET g_sfakwf2_d[l_ac].sfbcwf021 = ' '
            LET g_sfakwf2_d[l_ac].sfbcwf008 = "3"  #????
            LET g_sfakwf2_d[l_ac].sfbcwf028 = "N"  #???
            LET g_sfakwf2_d[l_ac].sfbcwf026 = '1'  #SET????
            #???
            IF g_sfajwf_m.sfajwf004 = '1' THEN
               LET g_sfakwf2_d[l_ac].sfbcwf009 = "N"
            END IF 
            IF g_sfajwf_m.sfajwf004 = '2' THEN
               LET g_sfakwf2_d[l_ac].sfbcwf009 = "Y"
            END IF
            #??????
            LET g_sfakwf2_d[l_ac].sfbcwf023 = g_sfakwf_d[g_detail_idx].sfakwf006 * g_sfakwf2_d[l_ac].sfbcwf010 / g_sfakwf2_d[l_ac].sfbcwf011
            #????
            LET g_sfakwf2_d[l_ac].sfbcwf013 = g_sfakwf2_d[l_ac].sfbcwf023 + g_sfakwf2_d[l_ac].sfbcwf024
            #????
            LET g_sfakwf2_d[l_ac].number1 = g_sfakwf2_d[l_ac].sfbcwf013 - g_sfakwf2_d[l_ac].sfbcwf015 - g_sfakwf2_d[l_ac].sfbcwf016 #170620-00066#1 add ????????            
            #????
            SELECT MAX(sfbcwfseq1) INTO g_sfakwf2_d[l_ac].sfbcwfseq1 FROM sfbcwf_t
             WHERE sfbcwfent = g_enterprise
               AND sfbcwfsite = g_site
               AND sfbcwfdocno = g_sfajwf_m.sfajwfdocno
#               AND sfbcwfseq = g_sfakwf_d[g_detail_idx].sfakwfseq  #241105-16320#1 mark
            CALL s_aooi200_get_slip(g_sfajwf_m.sfajwfdocno) RETURNING l_success,l_ooba002
            CALL s_aooi200_get_doc_default(g_site,'1',l_ooba002,'sfbcwf009',g_sfakwf2_d[l_ac].sfbcwf009)
            RETURNING g_sfakwf2_d[l_ac].sfbcwf009           
            CALL cl_get_doc_para(g_enterprise,g_site,l_ooba002,'D-MFG-0049')  RETURNING l_sys
            IF cl_null(l_sys) OR l_sys = 0 THEN LET l_sys = 1 END IF  
            IF cl_null(g_sfakwf2_d[l_ac].sfbcwfseq1) THEN 
               LET g_sfakwf2_d[l_ac].sfbcwfseq1 = l_sys                 
            ELSE  
               LET g_sfakwf2_d[l_ac].sfbcwfseq1 = g_sfakwf2_d[l_ac].sfbcwfseq1+l_sys
            END IF   
            SELECT MAX(sfbcwfseq2)+1 INTO g_sfakwf2_d[l_ac].sfbcwfseq2 FROM sfbcwf_t
             WHERE sfbcwfent = g_enterprise
               AND sfbcwfsite = g_site
               AND sfbcwfdocno = g_sfajwf_m.sfajwfdocno
               AND sfbcwfseq = g_sfakwf_d[g_detail_idx].sfakwfseq
               AND sfbcwfseq1 = g_sfakwf2_d[l_ac].sfbcwfseq1
            IF cl_null(g_sfakwf2_d[l_ac].sfbcwfseq2) THEN
               LET g_sfakwf2_d[l_ac].sfbcwfseq2 = 0 
            END IF 
            #??????
            CALL s_aooi200_get_doc_default(g_site,'1',l_ooba002,'sfbcwf019',g_sfakwf2_d[l_ac].sfbcwf019)
                 RETURNING g_sfakwf2_d[l_ac].sfbcwf019
            IF cl_null(g_sfakwf2_d[l_ac].sfbcwf019) THEN
               CALL cl_get_doc_para(g_enterprise,g_site,l_ooba002,'D-MFG-0076')
                    RETURNING g_sfakwf2_d[l_ac].sfbcwf019
            END IF
            #sfbcwf019???????sfbcwf020??????
            IF l_imafwf201 MATCHES '[01234]' THEN
               IF NOT cl_null(g_sfajwf_m.sfajwf008) THEN
                  LET g_sfakwf2_d[l_ac].sfbcwf019 = g_sfajwf_m.sfajwf008
               END IF
               IF cl_null(g_sfajwf_m.sfajwf009) THEN
                  LET g_sfakwf2_d[l_ac].sfbcwf020 = g_sfajwf_m.sfajwf009
               END IF
            ELSE
               IF cl_null(g_sfajwf_m.sfajwf010) THEN
                  LET g_sfakwf2_d[l_ac].sfbcwf019 = g_sfajwf_m.sfajwf010
               END IF
               IF cl_null(g_sfajwf_m.sfajwf011) THEN
                  LET g_sfakwf2_d[l_ac].sfbcwf020 = g_sfajwf_m.sfajwf011
               END IF
            END IF
            
            #241120-00001#1 add--s
            IF cl_null(g_sfakwf2_d[l_ac].sfbcwf030) THEN
               LET g_sfakwf2_d[l_ac].sfbcwf030 = ' '
            END IF
            #241120-00001#1 add--e
            #250120-00001#1 add--s
            IF cl_null(g_sfakwf2_d[l_ac].sfbcwf002) THEN
               LET g_sfakwf2_d[l_ac].sfbcwf002 = ' '
            END IF
            #250120-00001#1 add--e
            #end add-point
            LET g_sfakwf2_d_t.* = g_sfakwf2_d[l_ac].*     #?????
            LET g_sfakwf2_d_o.* = g_sfakwf2_d[l_ac].*     #?????
            CALL cl_show_fld_cont()
            CALL bsft001_wf_set_entry_b(l_cmd)
            #add-point:modify?after_set_entry_b name="input.body2.insert.after_set_entry_b"
            LET l_flag_kz = lb_reproduce #250220-00015#1 add
            #end add-point
            CALL bsft001_wf_set_no_entry_b(l_cmd)
            IF lb_reproduce THEN
               LET lb_reproduce = FALSE
               LET g_sfakwf2_d[li_reproduce_target].* = g_sfakwf2_d[li_reproduce].*
 
               LET g_sfakwf2_d[li_reproduce_target].sfbcwfseq1 = NULL
               LET g_sfakwf2_d[li_reproduce_target].sfbcwfseq2 = NULL
            END IF
            
 
            #add-point:modify?before insert name="input.body2.before_insert"
            #250220-00015#1 add ---s
            IF l_flag_kz THEN
               IF cl_null(g_sfakwf2_d[li_reproduce_target].sfbcwfseq1) THEN
                  LET l_flag_kz = FALSE
                  SELECT MAX(sfbcwfseq1)+1 INTO g_sfakwf2_d[li_reproduce_target].sfbcwfseq1 FROM sfbcwf_t
                   WHERE sfbcwfent = g_enterprise
                     AND sfbcwfsite = g_site
                     AND sfbcwfdocno = g_sfajwf_m.sfajwfdocno
                     AND sfbcwfseq = g_sfakwf_d[g_detail_idx].sfakwfseq  
                  IF cl_null(g_sfakwf2_d[li_reproduce_target].sfbcwfseq1) THEN LET g_sfakwf2_d[li_reproduce_target].sfbcwfseq1 = 1 END IF
                  SELECT MAX(sfbcwfseq2)+1 INTO g_sfakwf2_d[li_reproduce_target].sfbcwfseq2 FROM sfbcwf_t
                   WHERE sfbcwfent = g_enterprise
                     AND sfbcwfsite = g_site
                     AND sfbcwfdocno = g_sfajwf_m.sfajwfdocno
                     AND sfbcwfseq = g_sfakwf_d[g_detail_idx].sfakwfseq
                     AND sfbcwfseq1 = g_sfakwf2_d[li_reproduce_target].sfbcwfseq1
                  IF cl_null(g_sfakwf2_d[li_reproduce_target].sfbcwfseq2) THEN
                     LET g_sfakwf2_d[li_reproduce_target].sfbcwfseq2 = 0 
                  END IF 
               END IF
            END IF
            #250220-00015#1 add ---e
            #end add-point  
            
         BEFORE ROW
            #add-point:modify?before row2 name="input.body2.before_row2"

            #end add-point  
            LET l_insert = FALSE
            LET l_cmd = ''
            LET l_ac_t = l_ac 
            LET l_ac = ARR_CURR()
            LET g_detail_idx2 = l_ac
            LET g_detail_idx_list[2] = l_ac
            LET g_current_page = 2
            
            LET l_lock_sw = 'N'            #DEFAULT
            LET l_n = ARR_COUNT()
            DISPLAY l_ac TO FORMONLY.idx
         
            CALL s_transaction_begin()
            OPEN bsft001_wf_cl USING g_enterprise, g_site,g_sfajwf_m.sfajwfdocno
            #(ver:78) ---start---
            IF SQLCA.SQLCODE THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "OPEN bsft001_wf_cl:",SQLERRMESSAGE 
               LET g_errparam.code = SQLCA.SQLCODE
               LET g_errparam.popup = TRUE 
               CLOSE bsft001_wf_cl
               CALL s_transaction_end('N','0')
               CALL cl_err()
               RETURN
            END IF
            #(ver:78) --- end ---
            
            #200804-00006 ---start---
            FETCH bsft001_wf_cl
            IF SQLCA.SQLCODE AND SQLCA.SQLCODE <> 100 THEN
               INITIALIZE g_errparam TO NULL
               LET g_errparam.extend = "FETCH bsft001_wf_cl:",SQLERRMESSAGE
               LET g_errparam.code = SQLCA.SQLCODE
               LET g_errparam.popup = TRUE
               CLOSE bsft001_wf_cl
               #PostgreSQL???????, ????????????
               CALL s_transaction_end('N','0')
               CALL s_transaction_begin()
               CALL cl_err()
               RETURN
            END IF
            #200804-00006 --- end ---
            OPEN bsft001_wf_bcl USING g_enterprise, g_site,g_sfajwf_m.sfajwfdocno,g_sfakwf_d[g_detail_idx].sfakwfseq
            IF SQLCA.SQLCODE THEN   #(ver:78)
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "OPEN bsft001_wf_bcl:",SQLERRMESSAGE 
               LET g_errparam.code = SQLCA.SQLCODE   #(ver:78)
               LET g_errparam.popup = TRUE 
               CLOSE bsft001_wf_cl
               CLOSE bsft001_wf_bcl
               CALL s_transaction_end('N','0')
               CALL cl_err()
               RETURN
            END IF
            #200804-00006 ---start---
            FETCH bsft001_wf_bcl
            IF SQLCA.SQLCODE AND SQLCA.SQLCODE <> 100 THEN
               INITIALIZE g_errparam TO NULL
               LET g_errparam.extend = "FETCH bsft001_wf_bcl:",SQLERRMESSAGE
               LET g_errparam.code = SQLCA.SQLCODE
               LET g_errparam.popup = TRUE
               CLOSE bsft001_wf_cl
               CLOSE bsft001_wf_bcl
               #PostgreSQL???????, ????????????
               CALL s_transaction_end('N','0')
               CALL s_transaction_begin()
               CALL cl_err()
               RETURN
            END IF
            #200804-00006 --- end ---
            
            LET g_rec_b = g_sfakwf2_d.getLength()
            
            IF g_rec_b >= l_ac 
               AND g_sfakwf2_d[l_ac].sfbcwfseq1 IS NOT NULL
               AND g_sfakwf2_d[l_ac].sfbcwfseq2 IS NOT NULL
            THEN 
               LET l_cmd='u'
               LET g_sfakwf2_d_t.* = g_sfakwf2_d[l_ac].*  #BACKUP
               LET g_sfakwf2_d_o.* = g_sfakwf2_d[l_ac].*  #BACKUP
               CALL bsft001_wf_set_entry_b(l_cmd)
               #add-point:modify?after_set_entry_b name="input.body2.after_set_entry_b"

               #end add-point  
               CALL bsft001_wf_set_no_entry_b(l_cmd)
               IF NOT bsft001_wf_lock_b("sfbcwf_t","'2'") THEN
                  LET l_lock_sw='Y'
               ELSE
                  FETCH bsft001_wf_bcl3 INTO g_sfakwf2_d[l_ac].sfbcwfseq1,g_sfakwf2_d[l_ac].sfbcwfseq2,g_sfakwf2_d[l_ac].sfbcwf002,g_sfakwf2_d[l_ac].sfbcwf003,g_sfakwf2_d[l_ac].sfbcwf004,g_sfakwf2_d[l_ac].sfbcwf005,g_sfakwf2_d[l_ac].sfbcwf022,g_sfakwf2_d[l_ac].sfbcwf006,g_sfakwf2_d[l_ac].sfbcwf033,g_sfakwf2_d[l_ac].sfbcwf021, 
                      g_sfakwf2_d[l_ac].sfbcwf007,g_sfakwf2_d[l_ac].sfbcwf008,g_sfakwf2_d[l_ac].sfbcwf009,g_sfakwf2_d[l_ac].sfbcwf010,g_sfakwf2_d[l_ac].sfbcwf011,g_sfakwf2_d[l_ac].sfbcwf012,g_sfakwf2_d[l_ac].sfbcwf023,g_sfakwf2_d[l_ac].sfbcwf024,g_sfakwf2_d[l_ac].sfbcwf013,g_sfakwf2_d[l_ac].sfbcwf047, 
                      g_sfakwf2_d[l_ac].sfbcwf048,g_sfakwf2_d[l_ac].sfbcwf014,g_sfakwf2_d[l_ac].sfbcwf015,g_sfakwf2_d[l_ac].sfbcwf016,g_sfakwf2_d[l_ac].sfbcwf025,g_sfakwf2_d[l_ac].sfbcwf017,g_sfakwf2_d[l_ac].sfbcwf018,g_sfakwf2_d[l_ac].sfbcwf019,g_sfakwf2_d[l_ac].sfbcwf020,g_sfakwf2_d[l_ac].sfbcwf029, 
                      g_sfakwf2_d[l_ac].sfbcwf039,g_sfakwf2_d[l_ac].sfbcwf030,g_sfakwf2_d[l_ac].sfbcwf040,g_sfakwf2_d[l_ac].sfbcwf041,g_sfakwf2_d[l_ac].sfbcwf042,g_sfakwf2_d[l_ac].sfbcwf028,g_sfakwf2_d[l_ac].sfbcwf001,g_sfakwf2_d[l_ac].sfbcwf026,g_sfakwf2_d[l_ac].sfbcwf027,g_sfakwf2_d[l_ac].sfbcwf034, 
                      g_sfakwf2_d[l_ac].sfbcwf035,g_sfakwf2_d[l_ac].sfbcwf043,g_sfakwf2_d[l_ac].sfbcwf049
                  IF SQLCA.SQLCODE THEN
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = SQLERRMESSAGE 
                     LET g_errparam.code = SQLCA.SQLCODE 
                     LET g_errparam.popup = TRUE 
                     CALL cl_err()
                     LET l_lock_sw = "Y"
                  END IF
                  
                  #??????
                  LET g_sfakwf2_d_mask_o[l_ac].* =  g_sfakwf2_d[l_ac].*
                  CALL bsft001_wf_sfbcwf_t_mask()
                  LET g_sfakwf2_d_mask_n[l_ac].* =  g_sfakwf2_d[l_ac].*
                  
                  LET g_bfill = "N"
                  CALL bsft001_wf_show()
                  LET g_bfill = "Y"
                  
                  CALL cl_show_fld_cont()
               END IF
            ELSE
               LET l_cmd='a'
            END IF
            #add-point:modify?before row name="input.body2.before_row"
            CALL bsft001_wf_set_no_require()   #240709-00009#1 add
            CALL bsft001_wf_set_require()      #240709-00009#1 add
            #end add-point  
            #??table????(???????)
            
 
            #??table??lock
            
 
            CALL bsft001_wf_idx_chk()   #(ver:83)
            
         BEFORE DELETE                            #??????
            IF l_cmd = 'a' THEN
               LET l_cmd='d'
               #add-point:??AFTER DELETE (=d) name="input.body2.after_delete_d"
               #????/BIN??
               CALL s_transaction_end('N','0')
               CALL s_transaction_begin()
               DELETE FROM icbawf_t
                WHERE icbawfent = g_enterprise AND icbawfsite = g_site
                  AND icbawfdocno = g_sfajwf_m.sfajwfdocno
                  AND icbawfseq  = g_sfakwf2_d[l_ac].sfbcwfseq1 #??
                  AND icbawfseq1 = g_sfakwf2_d[l_ac].sfbcwfseq2 #??
                  AND icbawf032 = g_sfakwf_d[g_detail_idx].sfakwfseq  #????   
               IF SQLCA.SQLCODE THEN
                  INITIALIZE g_errparam TO NULL 
                  LET g_errparam.extend = "sfbcwf_t:",SQLERRMESSAGE 
                  LET g_errparam.code = SQLCA.SQLCODE 
                  LET g_errparam.popup = FALSE 
                  CALL cl_err()
                  CANCEL DELETE
               END IF
               CALL s_transaction_end('Y','0')
               CALL s_transaction_begin()
               #end add-point
            ELSE
               #add-point:????? name="input.body2.b_delete_ask"

               #?SET???SET???????????
               IF g_sfakwf2_d[l_ac].sfbcwf026 = '2' OR g_sfakwf2_d[l_ac].sfbcwf026 = '3' THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code =  'asf-00840'
                  LET g_errparam.extend = g_sfakwf2_d[l_ac].sfbcwfseq1
                  LET g_errparam.popup = TRUE
                  CALL cl_err()
                  CANCEL DELETE
               END IF
               
               #end add-point 
               IF NOT cl_ask_del_detail() THEN
                  CANCEL DELETE
               END IF
               IF l_lock_sw = "Y" THEN
                  INITIALIZE g_errparam TO NULL 
                  LET g_errparam.extend = "" 
                  LET g_errparam.code = -263 
                  LET g_errparam.popup = TRUE 
                  CALL cl_err()
                  CANCEL DELETE
               END IF
               
               #add-point:??2??? name="input.body2.b_delete"

               #end add-point    
 
               #??????key?
                              INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_sfajwf_m.sfajwfdocno
               LET gs_keys[2] = g_sfakwf_d[g_detail_idx].sfakwfseq
               LET gs_keys[3] = g_sfakwf2_d_t.sfbcwfseq1
               LET gs_keys[4] = g_sfakwf2_d_t.sfbcwfseq2
 
 
               #??????
               IF NOT bsft001_wf_delete_b('sfbcwf_t',gs_keys,"'2'") THEN
                  CALL s_transaction_end('N','0')
                  CLOSE bsft001_wf_bcl
                  CANCEL DELETE
               END IF
               
               #?????
               
 
               
   #161130-00056 add
  
               #add-point:??2??? name="input.body2.m_delete"
               
               #end add-point   
               
               CALL s_transaction_end('Y','0')
               CLOSE bsft001_wf_bcl
                  
               LET g_rec_b = g_rec_b-1
               #add-point:??2??? name="input.body2.a_delete"

               #end add-point
 
               LET l_count = g_sfakwf_d.getLength()
               
               #add-point:?????(<>d) name="input.body2.after_delete"

               #end add-point
            END IF 
 
         AFTER DELETE
            #???????
            IF l_ac = (g_sfakwf2_d.getLength() + 1) THEN
               CALL FGL_SET_ARR_CURR(l_ac-1)
            END IF
         
         AFTER INSERT    
            LET l_insert = FALSE
            IF INT_FLAG THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code = 9001 
               LET g_errparam.popup = FALSE 
               CALL cl_err()
               LET INT_FLAG = 0
               CANCEL INSERT
            END IF
               
            #add-point:??2??? name="input.body2.b_a_insert"
            LET l_rate = ''
            LET l_imaa006 = ''
            IF NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf006) THEN 
               #SELECT imaa006 INTO l_imaa006 FROM imaa_t      #220510-00026#1 mark
               SELECT imaa006,imaa004 INTO l_imaa006,l_imaa004 FROM imaa_t      #220510-00026#1 add
                WHERE imaaent = g_enterprise
                  AND imaa001 = g_sfakwf2_d[l_ac].sfbcwf006  
               IF NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf006) AND NOT cl_null(l_imaa006) THEN
                  CALL s_aimi190_get_convert(g_sfakwf2_d[l_ac].sfbcwf006,g_sfakwf2_d[l_ac].sfbcwf014,l_imaa006) RETURNING l_success,l_rate
                  IF l_success = FALSE THEN
                     LET g_sfakwf2_d[l_ac].sfbcwf014 = g_sfakwf2_d_t.sfbcwf014
                     INITIALIZE g_ref_fields TO NULL
                     LET g_ref_fields[1] = g_sfakwf2_d[l_ac].sfbcwf014
                     CALL ap_ref_array2(g_ref_fields,"SELECT oocal003 FROM oocal_t WHERE oocalent='"||g_enterprise||"' AND oocal001=? AND oocal002='"||g_dlang||"'","") RETURNING g_rtn_fields
                     LET g_sfakwf2_d[l_ac].sfbcwf014_desc = '', g_rtn_fields[1] , ''
                     DISPLAY BY NAME g_sfakwf2_d[l_ac].sfbcwf014_desc 
                     NEXT FIELD sfbcwf014                        
                  END IF
               END IF 
               IF cl_null(l_imaa006) THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = 'abm-00021'
                  LET g_errparam.extend = l_imaa006
                  LET g_errparam.popup = TRUE
                  CALL cl_err()

                  LET g_sfakwf2_d[l_ac].sfbcwf014 = g_sfakwf2_d_t.sfbcwf014
                  INITIALIZE g_ref_fields TO NULL
                  LET g_ref_fields[1] = g_sfakwf2_d[l_ac].sfbcwf014
                  CALL ap_ref_array2(g_ref_fields,"SELECT oocal003 FROM oocal_t WHERE oocalent='"||g_enterprise||"' AND oocal001=? AND oocal002='"||g_dlang||"'","") RETURNING g_rtn_fields
                  LET g_sfakwf2_d[l_ac].sfbcwf014_desc = '', g_rtn_fields[1] , ''
                  DISPLAY BY NAME g_sfakwf2_d[l_ac].sfbcwf014_desc 
                  NEXT FIELD sfbcwf014 
               END IF
               
               #220510-00026#1 add -S-
               IF NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf008) THEN
                  IF l_imaa004 = 'E' THEN
                     IF g_sfakwf2_d[l_ac].sfbcwf008 <> '3' AND g_sfakwf2_d[l_ac].sfbcwf008 <> '4' THEN
                        #????????????????????3.??????4.????
                        INITIALIZE g_errparam TO NULL 
                        LET g_errparam.extend = "" 
                        LET g_errparam.code   = "asf-00949" 
                        LET g_errparam.popup  = TRUE 
                        CALL cl_err()
                        NEXT FIELD sfbcwf008
                     END IF
                  END IF
               END IF
               #220510-00026#1 add -E-
            END IF 
            #241212-00001#1 add--s
            SELECT COUNT(1) INTO l_count FROM sfbcwf_t 
             WHERE sfbcwfent = g_enterprise AND sfbcwfsite = g_site AND sfbcwfdocno = g_sfajwf_m.sfajwfdocno AND sfbcwfseq = g_sfakwf_d[g_detail_idx].sfakwfseq AND sfbcwfseq1 = g_sfakwf2_d[g_detail_idx2].sfbcwfseq1 AND sfbcwfseq2 = g_sfakwf2_d[g_detail_idx2].sfbcwfseq2
            IF l_count > 0 THEN 
               CALL fgl_set_arr_curr(l_ac) 
               LET g_rec_b = g_rec_b + 1 
               LET g_detail_idx = g_detail_idx_tmp               
               ACCEPT DIALOG
            END IF            
            #241212-00001#1 add--e
            #end add-point
    
            LET l_count = 1  
            SELECT COUNT(1) INTO l_count FROM sfbcwf_t 
             WHERE sfbcwfent = g_enterprise AND sfbcwfsite = g_site AND sfbcwfdocno = g_sfajwf_m.sfajwfdocno AND sfbcwfseq = g_sfakwf_d[g_detail_idx].sfakwfseq AND sfbcwfseq1 = g_sfakwf2_d[g_detail_idx2].sfbcwfseq1 AND sfbcwfseq2 = g_sfakwf2_d[g_detail_idx2].sfbcwfseq2
                
            #?????, ??????
            IF l_count = 0 THEN 
               #add-point:??2??? name="input.body2.b_insert"

               #end add-point
            
                              INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_sfajwf_m.sfajwfdocno
               LET gs_keys[2] = g_sfakwf_d[g_detail_idx].sfakwfseq
               LET gs_keys[3] = g_sfakwf2_d[g_detail_idx2].sfbcwfseq1
               LET gs_keys[4] = g_sfakwf2_d[g_detail_idx2].sfbcwfseq2
               CALL bsft001_wf_insert_b('sfbcwf_t',gs_keys,"'2'")
                           
               #add-point:?????2 name="input.body2.a_insert"
               IF NOT cl_null(g_sfakwf2_d[l_ac].ooff013) THEN
                  CALL s_aooi360_gen('7',g_prog,g_sfajwf_m.sfajwfdocno,g_sfakwf2_d[l_ac].sfbcwfseq1,g_sfakwf2_d[l_ac].sfbcwfseq2,'','','','','','','1',g_sfakwf2_d[l_ac].ooff013) RETURNING l_success
               END IF
               #end add-point
            ELSE    
               INITIALIZE g_sfakwf_d[l_ac].* TO NULL
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = 'INSERT' 
               LET g_errparam.code = "std-00006" 
               LET g_errparam.popup = TRUE 
               CALL s_transaction_end('N','0')
               CALL cl_err()
               CANCEL INSERT
            END IF
 
            IF SQLCA.SQLCODE THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "sfbcwf_t:",SQLERRMESSAGE 
               LET g_errparam.code = SQLCA.SQLCODE 
               LET g_errparam.popup = TRUE 
               CALL s_transaction_end('N','0')                    
               CALL cl_err()
               CANCEL INSERT
            ELSE
               #?????
               #CALL bsft001_wf_b_fill()
               #??????-?/?
               
                  #161130-00056 add
               #add-point:????? name="input.body2.after_insert"
               IF NOT cl_null(g_sfakwf2_d[l_ac].ooff013) THEN
                  IF NOT s_aooi360_gen('7',g_prog,g_sfajwf_m.sfajwfdocno,g_sfakwf2_d[l_ac].sfbcwfseq1,g_sfakwf2_d[l_ac].sfbcwfseq2,' ',' ',' ',' ',' ',' ','1',g_sfakwf2_d[l_ac].ooff013) THEN
                     CALL s_transaction_end('N','0')
                     CANCEL INSERT
                  END IF
               ELSE
                  IF NOT s_aooi360_del('7',g_prog,g_sfajwf_m.sfajwfdocno,g_sfakwf2_d[l_ac].sfbcwfseq1,g_sfakwf2_d[l_ac].sfbcwfseq2,' ',' ',' ',' ',' ',' ','1') THEN
                     CALL s_transaction_end('N','0')
                     CANCEL INSERT
                  END IF
               END IF
               #end add-point
               CALL s_transaction_end('Y','0')
               #ERROR 'INSERT O.K'
               LET g_rec_b = g_rec_b + 1
            END IF
            
            #??g_detail_idx
            LET g_detail_idx = g_detail_idx_tmp
            
         ON ROW CHANGE 
            IF INT_FLAG THEN
               LET INT_FLAG = 0
               LET g_sfakwf2_d[l_ac].* = g_sfakwf2_d_t.*
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code = 9001 
               LET g_errparam.popup = FALSE 
               CLOSE bsft001_wf_bcl3
               CALL s_transaction_end('N','0')
               CALL cl_err()
               EXIT DIALOG 
            END IF
            
            IF l_lock_sw = 'Y' THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code = -263 
               LET g_errparam.popup = TRUE 
               CALL cl_err()
               LET g_sfakwf2_d[l_ac].* = g_sfakwf2_d_t.*
               EXIT DIALOG   #210416-00007
            ELSE
               #add-point:??page2??? name="input.body2.b_update"
               LET l_rate = ''
               LET l_imaa006 = ''
               IF NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf006) THEN 
                  #SELECT imaa006 INTO l_imaa006 FROM imaa_t       #220510-00026#1 mark
                  SELECT imaa006,imaa004 INTO l_imaa006,l_imaa004 FROM imaa_t      #220510-00026#1 add
                   WHERE imaaent = g_enterprise
                     AND imaa001 = g_sfakwf2_d[l_ac].sfbcwf006  
                  IF NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf006) AND NOT cl_null(l_imaa006) THEN
                     CALL s_aimi190_get_convert(g_sfakwf2_d[l_ac].sfbcwf006,g_sfakwf2_d[l_ac].sfbcwf014,l_imaa006) RETURNING l_success,l_rate
                     IF l_success = FALSE THEN
                        LET g_sfakwf2_d[l_ac].sfbcwf014 = g_sfakwf2_d_t.sfbcwf014
                        INITIALIZE g_ref_fields TO NULL
                        LET g_ref_fields[1] = g_sfakwf2_d[l_ac].sfbcwf014
                        CALL ap_ref_array2(g_ref_fields,"SELECT oocal003 FROM oocal_t WHERE oocalent='"||g_enterprise||"' AND oocal001=? AND oocal002='"||g_dlang||"'","") RETURNING g_rtn_fields
                        LET g_sfakwf2_d[l_ac].sfbcwf014_desc = '', g_rtn_fields[1] , ''
                        DISPLAY BY NAME g_sfakwf2_d[l_ac].sfbcwf014_desc 
                        NEXT FIELD sfbcwf006                       
                     END IF
                  END IF 
                  IF cl_null(l_imaa006) THEN
                     INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = 'abm-00021'
                  LET g_errparam.extend = l_imaa006
                  LET g_errparam.popup = TRUE
                  CALL cl_err()

                     LET g_sfakwf2_d[l_ac].sfbcwf014 = g_sfakwf2_d_t.sfbcwf014
                     INITIALIZE g_ref_fields TO NULL
                     LET g_ref_fields[1] = g_sfakwf2_d[l_ac].sfbcwf014
                     CALL ap_ref_array2(g_ref_fields,"SELECT oocal003 FROM oocal_t WHERE oocalent='"||g_enterprise||"' AND oocal001=? AND oocal002='"||g_dlang||"'","") RETURNING g_rtn_fields
                     LET g_sfakwf2_d[l_ac].sfbcwf014_desc = '', g_rtn_fields[1] , ''
                     DISPLAY BY NAME g_sfakwf2_d[l_ac].sfbcwf014_desc 
                     NEXT FIELD sfbcwf006
                  END IF
                  #220510-00026#1 add -S-
                  IF NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf008) THEN
                     IF l_imaa004 = 'E' THEN
                        IF g_sfakwf2_d[l_ac].sfbcwf008 <> '3' AND g_sfakwf2_d[l_ac].sfbcwf008 <> '4' THEN
                           #????????????????????3.??????4.????
                           INITIALIZE g_errparam TO NULL 
                           LET g_errparam.extend = "" 
                           LET g_errparam.code   = "asf-00949" 
                           LET g_errparam.popup  = TRUE 
                           CALL cl_err()
                           NEXT FIELD sfbcwf008
                        END IF
                     END IF
                  END IF
                  #220510-00026#1 add -E-
               END IF 
               
               #160727-00025#1---s
               IF cl_null(g_sfakwf2_d[l_ac].sfbcwf002) THEN
                  LET g_sfakwf2_d[l_ac].sfbcwf002 = ' '             
               END IF
               #241212-00001#1 add--s
               IF g_sfakwf2_d_o.sfbcwf006   <> g_sfakwf2_d[l_ac].sfbcwf006   OR
                  g_sfakwf2_d_o.sfbcwf021   <> g_sfakwf2_d[l_ac].sfbcwf021   OR
                  g_sfakwf2_d_o.sfbcwf019   <> g_sfakwf2_d[l_ac].sfbcwf019   OR
                  g_sfakwf2_d_o.sfbcwf020   <> g_sfakwf2_d[l_ac].sfbcwf020   OR
                  g_sfakwf2_d_o.sfbcwf029   <> g_sfakwf2_d[l_ac].sfbcwf029   OR
                  g_sfakwf2_d_o.sfbcwf040 <> g_sfakwf2_d[l_ac].sfbcwf040 OR
                  g_sfakwf2_d_o.sfbcwf041 <> g_sfakwf2_d[l_ac].sfbcwf041 OR
                  g_sfakwf2_d_o.sfbcwf042 <> g_sfakwf2_d[l_ac].sfbcwf042 OR
                  g_sfakwf2_d_o.sfbcwf014   <> g_sfakwf2_d[l_ac].sfbcwf014   THEN
                  IF s_icd_wf_icdbin_chk(g_sfakwf2_d[l_ac].sfbcwf006)  THEN
                     IF NOT s_icd_wf_chk_icd(g_sfajwf_m.sfajwfdocno,g_sfakwf2_d[l_ac].sfbcwfseq1,g_sfakwf2_d[l_ac].sfbcwfseq2,'-1') THEN                
                        LET g_sfakwf2_d[l_ac].sfbcwf019 = g_sfakwf2_d_o.sfbcwf019
                        NEXT FIELD sfbcwf006
                     END IF                                       
                  END IF  
               END IF              
               #241212-00001#1 add--e
               #end add-point
               
               #?????/??????(??2)
               
               
               #???????
               CALL bsft001_wf_sfbcwf_t_mask_restore('restore_mask_o')
               
               UPDATE sfbcwf_t SET (sfbcwfdocno,sfbcwfseq,sfbcwfseq1,sfbcwfseq2,sfbcwf002,sfbcwf003,sfbcwf004,sfbcwf005,sfbcwf022,sfbcwf006,sfbcwf033,sfbcwf021,sfbcwf007,sfbcwf008,sfbcwf009,sfbcwf010,sfbcwf011,sfbcwf012,sfbcwf023,sfbcwf024,sfbcwf013,sfbcwf047,sfbcwf048,sfbcwf014,sfbcwf015,sfbcwf016, 
                   sfbcwf025,sfbcwf017,sfbcwf018,sfbcwf019,sfbcwf020,sfbcwf029,sfbcwf039,sfbcwf030,sfbcwf040,sfbcwf041,sfbcwf042,sfbcwf028,sfbcwf001,sfbcwf026,sfbcwf027,sfbcwf034,sfbcwf035,sfbcwf043,sfbcwf049) = (g_sfajwf_m.sfajwfdocno,g_sfakwf_d[g_detail_idx].sfakwfseq,g_sfakwf2_d[l_ac].sfbcwfseq1, 
                   g_sfakwf2_d[l_ac].sfbcwfseq2,g_sfakwf2_d[l_ac].sfbcwf002,g_sfakwf2_d[l_ac].sfbcwf003,g_sfakwf2_d[l_ac].sfbcwf004,g_sfakwf2_d[l_ac].sfbcwf005,g_sfakwf2_d[l_ac].sfbcwf022,g_sfakwf2_d[l_ac].sfbcwf006,g_sfakwf2_d[l_ac].sfbcwf033,g_sfakwf2_d[l_ac].sfbcwf021,g_sfakwf2_d[l_ac].sfbcwf007, 
                   g_sfakwf2_d[l_ac].sfbcwf008,g_sfakwf2_d[l_ac].sfbcwf009,g_sfakwf2_d[l_ac].sfbcwf010,g_sfakwf2_d[l_ac].sfbcwf011,g_sfakwf2_d[l_ac].sfbcwf012,g_sfakwf2_d[l_ac].sfbcwf023,g_sfakwf2_d[l_ac].sfbcwf024,g_sfakwf2_d[l_ac].sfbcwf013,g_sfakwf2_d[l_ac].sfbcwf047,g_sfakwf2_d[l_ac].sfbcwf048,g_sfakwf2_d[l_ac].sfbcwf014, 
                   g_sfakwf2_d[l_ac].sfbcwf015,g_sfakwf2_d[l_ac].sfbcwf016,g_sfakwf2_d[l_ac].sfbcwf025,g_sfakwf2_d[l_ac].sfbcwf017,g_sfakwf2_d[l_ac].sfbcwf018,g_sfakwf2_d[l_ac].sfbcwf019,g_sfakwf2_d[l_ac].sfbcwf020,g_sfakwf2_d[l_ac].sfbcwf029,g_sfakwf2_d[l_ac].sfbcwf039,g_sfakwf2_d[l_ac].sfbcwf030,g_sfakwf2_d[l_ac].sfbcwf040, 
                   g_sfakwf2_d[l_ac].sfbcwf041,g_sfakwf2_d[l_ac].sfbcwf042,g_sfakwf2_d[l_ac].sfbcwf028,g_sfakwf2_d[l_ac].sfbcwf001,g_sfakwf2_d[l_ac].sfbcwf026,g_sfakwf2_d[l_ac].sfbcwf027,g_sfakwf2_d[l_ac].sfbcwf034,g_sfakwf2_d[l_ac].sfbcwf035,g_sfakwf2_d[l_ac].sfbcwf043,g_sfakwf2_d[l_ac].sfbcwf049)  
                   #??????
                WHERE sfbcwfent = g_enterprise AND sfbcwfsite = g_site AND sfbcwfdocno = g_sfajwfdocno_t AND sfbcwfseq = g_sfakwf_d[g_detail_idx].sfakwfseq AND sfbcwfseq1 = g_sfakwf2_d_t.sfbcwfseq1 AND sfbcwfseq2 = g_sfakwf2_d_t.sfbcwfseq2
                  
               #add-point:??page2??? name="input.body2.m_update"

               #end add-point
                  
               CASE
                  WHEN SQLCA.sqlerrd[3] = 0  #???????
                     LET g_sfakwf2_d[l_ac].* = g_sfakwf2_d_t.*
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = "sfbcwf_t" 
                     LET g_errparam.code = "std-00009" 
                     LET g_errparam.popup = TRUE 
                     CALL s_transaction_end('N','0')
                     CALL cl_err()
                     EXIT DIALOG   #210416-00007
                     
                  WHEN SQLCA.SQLCODE #????
                     LET g_sfakwf2_d[l_ac].* = g_sfakwf2_d_t.*
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = "sfbcwf_t:",SQLERRMESSAGE 
                     LET g_errparam.code = SQLCA.SQLCODE 
                     LET g_errparam.popup = TRUE 
                     CALL s_transaction_end('N','0')
                     CALL cl_err()
                     EXIT DIALOG   #210416-00007
                     
                  OTHERWISE
                     #??????-?/?
                     
                        #161130-00056 add
                                    INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_sfajwf_m.sfajwfdocno
               LET gs_keys_bak[1] = g_sfajwfdocno_t
               LET gs_keys[2] = g_sfakwf_d[g_detail_idx].sfakwfseq
               LET gs_keys_bak[2] = g_sfakwf_d[g_detail_idx].sfakwfseq
               LET gs_keys[3] = g_sfakwf2_d[g_detail_idx2].sfbcwfseq1
               LET gs_keys_bak[3] = g_sfakwf2_d_t.sfbcwfseq1
               LET gs_keys[4] = g_sfakwf2_d[g_detail_idx2].sfbcwfseq2
               LET gs_keys_bak[4] = g_sfakwf2_d_t.sfbcwfseq2
               CALL bsft001_wf_update_b('sfbcwf_t',gs_keys,gs_keys_bak,"'2'")
               END CASE
               
               #210416-00007 ????add-point ---start---
               #add-point:??page2????????? name="input.body2.a_update_b_mask"
               IF NOT cl_null(g_sfakwf2_d[l_ac].ooff013) THEN
                  IF NOT s_aooi360_gen('7',g_prog,g_sfajwf_m.sfajwfdocno,g_sfakwf2_d[l_ac].sfbcwfseq1,g_sfakwf2_d[l_ac].sfbcwfseq2,' ',' ',' ',' ',' ',' ','1',g_sfakwf2_d[l_ac].ooff013) THEN
                     CALL s_transaction_end('N','0')
                  END IF
               ELSE
                  IF NOT s_aooi360_del('7',g_prog,g_sfajwf_m.sfajwfdocno,g_sfakwf2_d[l_ac].sfbcwfseq1,g_sfakwf2_d[l_ac].sfbcwfseq2,' ',' ',' ',' ',' ',' ','1') THEN
                     CALL s_transaction_end('N','0')
                  END IF
               END IF
               #end add-point
               #210416-00007 ????add-point --- end ---
               #?????????
               CALL bsft001_wf_sfbcwf_t_mask_restore('restore_mask_n')
               
               #??????(????)
               LET g_log1 = util.JSON.stringify(g_sfajwf_m),util.JSON.stringify(g_sfakwf2_d_t)
               LET g_log2 = util.JSON.stringify(g_sfajwf_m),util.JSON.stringify(g_sfakwf2_d[l_ac])
               IF NOT cl_log_modified_record_d(g_log1,g_log2) THEN 
                  CALL s_transaction_end('N','0')
                  EXIT DIALOG   #210416-00007
               END IF
               
               #add-point:??page2??? name="input.body2.a_update"

               #end add-point
            END IF
         
                  #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwfseq1
            #add-point:BEFORE FIELD sfbcwfseq1 name="input.b.page2.sfbcwfseq1"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwfseq1
            
            #add-point:AFTER FIELD sfbcwfseq1 name="input.a.page2.sfbcwfseq1"
            #?? a05 ??????(Version:3)
            #???????
#            IF  g_sfajwf_m.sfajwfdocno IS NOT NULL AND g_sfakwf_d[g_detail_idx].sfakwfseq IS NOT NULL AND g_sfakwf2_d[g_detail_idx2].sfbcwfseq1 IS NOT NULL AND g_sfakwf2_d[g_detail_idx2].sfbcwfseq2 IS NOT NULL THEN 
#               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_sfajwf_m.sfajwfdocno != g_sfajwfdocno_t OR g_sfakwf_d[g_detail_idx].sfakwfseq != g_sfakwf_d[g_detail_idx].sfakwfseq OR g_sfakwf2_d[g_detail_idx2].sfbcwfseq1 != g_sfakwf2_d_t.sfbcwfseq1 OR g_sfakwf2_d[g_detail_idx2].sfbcwfseq2 != g_sfakwf2_d_t.sfbcwfseq2)) THEN 
#                  IF NOT ap_chk_notDup("","SELECT COUNT(1) FROM sfbcwf_t WHERE "||"sfbcwfent = " ||g_enterprise|| " AND sfbcwfsite = '" ||g_site|| "' AND "||"sfbcwfdocno = '"||g_sfajwf_m.sfajwfdocno ||"' AND "|| "sfbcwfseq = '"||g_sfakwf_d[g_detail_idx].sfakwfseq ||"' AND "|| "sfbcwfseq1 = '"||g_sfakwf2_d[g_detail_idx2].sfbcwfseq1 ||"' AND "|| "sfbcwfseq2 = '"||g_sfakwf2_d[g_detail_idx2].sfbcwfseq2 ||"'",'std-00004',0) THEN 
#                     NEXT FIELD CURRENT
#                  END IF
#               END IF
#            END IF
            IF NOT cl_ap_chk_Range(g_sfakwf2_d[l_ac].sfbcwfseq1,"0","0","","","azz-00079",1) THEN
               LET g_sfakwf2_d[g_detail_idx2].sfbcwfseq1 = g_sfakwf2_d_t.sfbcwfseq1
               NEXT FIELD sfbcwfseq1
            END IF

            IF NOT cl_null(g_sfakwf2_d[g_detail_idx2].sfbcwfseq1) AND (cl_null(g_sfakwf2_d_t.sfbcwfseq1) OR g_sfakwf2_d[g_detail_idx2].sfbcwfseq1 != g_sfakwf2_d_t.sfbcwfseq1) THEN
               SELECT MAX(sfbcwfseq2)+1 INTO g_sfakwf2_d[g_detail_idx2].sfbcwfseq2 FROM sfbcwf_t
                WHERE sfbcwfent = g_enterprise
                  AND sfbcwfsite = g_site
                  AND sfbcwfdocno = g_sfajwf_m.sfajwfdocno
                  AND sfbcwfseq = g_sfakwf_d[g_detail_idx].sfakwfseq
                  AND sfbcwfseq1 = g_sfakwf2_d[g_detail_idx2].sfbcwfseq1
               IF cl_null(g_sfakwf2_d[g_detail_idx2].sfbcwfseq2) THEN
                  LET g_sfakwf2_d[g_detail_idx2].sfbcwfseq2 = 0 
               END IF 
            END IF
            IF  g_sfajwf_m.sfajwfdocno IS NOT NULL AND g_sfakwf_d[g_detail_idx].sfakwfseq IS NOT NULL AND g_sfakwf2_d[g_detail_idx2].sfbcwfseq1 IS NOT NULL AND g_sfakwf2_d[g_detail_idx2].sfbcwfseq2 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_sfajwf_m.sfajwfdocno != g_sfajwfdocno_t OR g_sfakwf_d[g_detail_idx].sfakwfseq != g_sfakwf_d[g_detail_idx].sfakwfseq OR g_sfakwf2_d[g_detail_idx2].sfbcwfseq1 != g_sfakwf2_d_t.sfbcwfseq1 OR g_sfakwf2_d[g_detail_idx2].sfbcwfseq2 != g_sfakwf2_d_t.sfbcwfseq2)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(1) FROM sfbcwf_t WHERE "||"sfbcwfent = " ||g_enterprise|| " AND sfbcwfsite = '" ||g_site|| "' AND "||"sfbcwfdocno = '"||g_sfajwf_m.sfajwfdocno ||"' AND "|| "sfbcwfseq = '"||g_sfakwf_d[g_detail_idx].sfakwfseq ||"' AND "|| "sfbcwfseq1 = '"||g_sfakwf2_d[g_detail_idx2].sfbcwfseq1 ||"' AND "|| "sfbcwfseq2 = '"||g_sfakwf2_d[g_detail_idx2].sfbcwfseq2 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

            IF g_sfakwf2_d[g_detail_idx2].sfbcwfseq1 != g_sfakwf2_d_t.sfbcwfseq1 THEN
               IF NOT bsft001_wf_sfbcwfseq1(l_cmd,'') THEN  #170428-00012#1 add ,''
                  LET g_sfakwf2_d[g_detail_idx2].sfbcwfseq1 = g_sfakwf2_d_t.sfbcwfseq1
                  NEXT FIELD CURRENT
               END IF       
            END IF
            #?????
#           IF NOT cl_null(g_sfajwf_m.sfajwfdocno) AND NOT cl_null(g_sfakwf2_d[g_detail_idx].sfbcwfseq1) AND NOT cl_null(g_sfakwf2_d[g_detail_idx].sfbcwfseq2) THEN
#              CALL s_asft300_07(g_sfajwf_m.sfajwfdocno,g_sfakwf2_d[g_detail_idx].sfbcwfseq1,g_sfakwf2_d[g_detail_idx].sfbcwfseq2) RETURNING l_success,g_sfakwf2_d[g_detail_idx].number2
#           END IF
            IF  g_sfajwf_m.sfajwfdocno IS NOT NULL AND g_sfakwf_d[g_detail_idx].sfakwfseq IS NOT NULL AND g_sfakwf2_d[g_detail_idx2].sfbcwfseq1 IS NOT NULL AND g_sfakwf2_d[g_detail_idx2].sfbcwfseq2 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_sfajwf_m.sfajwfdocno != g_sfajwfdocno_t OR g_sfakwf_d[g_detail_idx].sfakwfseq != g_sfakwf_d[g_detail_idx].sfakwfseq OR g_sfakwf2_d[g_detail_idx2].sfbcwfseq1 != g_sfakwf2_d_t.sfbcwfseq1 OR g_sfakwf2_d[g_detail_idx2].sfbcwfseq2 != g_sfakwf2_d_t.sfbcwfseq2)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(1) FROM sfbcwf_t WHERE "||"sfbcwfent = " ||g_enterprise|| " AND sfbcwfsite = '" ||g_site|| "' AND "||"sfbcwfdocno = '"||g_sfajwf_m.sfajwfdocno ||"' AND "|| "sfbcwfseq = '"||g_sfakwf_d[g_detail_idx].sfakwfseq ||"' AND "|| "sfbcwfseq1 = '"||g_sfakwf2_d[g_detail_idx2].sfbcwfseq1 ||"' AND "|| "sfbcwfseq2 = '"||g_sfakwf2_d[g_detail_idx2].sfbcwfseq2 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfbcwfseq1
            #add-point:ON CHANGE sfbcwfseq1 name="input.g.page2.sfbcwfseq1"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwfseq2
            #add-point:BEFORE FIELD sfbcwfseq2 name="input.b.page2.sfbcwfseq2"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwfseq2
            
            #add-point:AFTER FIELD sfbcwfseq2 name="input.a.page2.sfbcwfseq2"
            #?? a05 ??????(Version:3)
      
            IF NOT cl_ap_chk_Range(g_sfakwf2_d[l_ac].sfbcwfseq2,"0","1","","","azz-00079",1) THEN
               LET g_sfakwf2_d[g_detail_idx2].sfbcwfseq2 = g_sfakwf2_d_t.sfbcwfseq2
               NEXT FIELD sfbcwfseq2
            END IF


            #???????
            IF  g_sfajwf_m.sfajwfdocno IS NOT NULL AND g_sfakwf_d[g_detail_idx].sfakwfseq IS NOT NULL AND g_sfakwf2_d[g_detail_idx2].sfbcwfseq1 IS NOT NULL AND g_sfakwf2_d[g_detail_idx2].sfbcwfseq2 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_sfajwf_m.sfajwfdocno != g_sfajwfdocno_t OR g_sfakwf_d[g_detail_idx].sfakwfseq != g_sfakwf_d[g_detail_idx].sfakwfseq OR g_sfakwf2_d[g_detail_idx2].sfbcwfseq1 != g_sfakwf2_d_t.sfbcwfseq1 OR g_sfakwf2_d[g_detail_idx2].sfbcwfseq2 != g_sfakwf2_d_t.sfbcwfseq2)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(1) FROM sfbcwf_t WHERE "||"sfbcwfent = " ||g_enterprise|| " AND sfbcwfsite = '" ||g_site|| "' AND "||"sfbcwfdocno = '"||g_sfajwf_m.sfajwfdocno ||"' AND "|| "sfbcwfseq = '"||g_sfakwf_d[g_detail_idx].sfakwfseq ||"' AND "|| "sfbcwfseq1 = '"||g_sfakwf2_d[g_detail_idx2].sfbcwfseq1 ||"' AND "|| "sfbcwfseq2 = '"||g_sfakwf2_d[g_detail_idx2].sfbcwfseq2 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF
            #?????
#            IF NOT cl_null(g_sfajwf_m.sfajwfdocno) AND NOT cl_null(g_sfakwf2_d[g_detail_idx].sfbcwfseq1) AND NOT cl_null(g_sfakwf2_d[g_detail_idx].sfbcwfseq2) THEN
#               CALL s_asft300_07(g_sfajwf_m.sfajwfdocno,g_sfakwf2_d[g_detail_idx].sfbcwfseq1,g_sfakwf2_d[g_detail_idx].sfbcwfseq2) RETURNING l_success,g_sfakwf2_d[g_detail_idx].number2
#            END IF
            
            IF g_sfakwf2_d[l_ac].sfbcwfseq2 != 0 THEN
               LET g_sfakwf2_d[g_detail_idx2].sfbcwf010 = 0
               LET g_sfakwf2_d[g_detail_idx2].sfbcwf011 = 0
            END IF
            CALL bsft001_wf_set_entry_b(l_cmd)
            CALL bsft001_wf_set_no_entry_b(l_cmd)



            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfbcwfseq2
            #add-point:ON CHANGE sfbcwfseq2 name="input.g.page2.sfbcwfseq2"

            #END add-point 
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf002
            
            #add-point:AFTER FIELD sfbcwf002 name="input.a.page2.sfbcwf002"
#            INITIALIZE g_ref_fields TO NULL
#            LET g_ref_fields[1] = g_sfakwf2_d[l_ac].sfbcwf002
#            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent="||g_enterprise||" AND oocql001='215' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
#            LET g_sfakwf2_d[l_ac].sfbcwf002_desc = '', g_rtn_fields[1] , ''
#            DISPLAY BY NAME g_sfakwf2_d[l_ac].sfbcwf002_desc

            IF NOT cl_null(g_sfakwf2_d[g_detail_idx2].sfbcwf002) THEN
               IF cl_null(g_sfakwf2_d_t.sfbcwf002) OR g_sfakwf2_d[g_detail_idx2].sfbcwf002 != g_sfakwf2_d_t.sfbcwf002 THEN
                  #????????
                  IF NOT s_azzi650_chk_exist('215',g_sfakwf2_d[g_detail_idx2].sfbcwf002) THEN
                     LET g_sfakwf2_d[g_detail_idx2].sfbcwf002 = g_sfakwf2_d_t.sfbcwf002
                     INITIALIZE g_chkparam.* TO NULL
                     LET g_chkparam.arg1 = '215'
                     LET g_chkparam.arg2 = g_sfakwf2_d[l_ac].sfbcwf002
                     CALL cl_ref_val("v_oocql002")
                     LET g_sfakwf2_d[l_ac].sfbcwf002_desc = g_chkparam.return1
                     DISPLAY BY NAME g_sfakwf2_d[l_ac].sfbcwf002_desc
                     NEXT FIELD sfbcwf002
                  END IF
                  IF NOT bsft001_wf_sfbcwfseq1(l_cmd,'sfbcwf002') THEN  #170428-00012#1 add ,'sfbcwf002'
                     LET g_sfakwf2_d[g_detail_idx2].sfbcwf002 = g_sfakwf2_d_t.sfbcwf002
                     INITIALIZE g_chkparam.* TO NULL
                     LET g_chkparam.arg1 = '215'
                     LET g_chkparam.arg2 = g_sfakwf2_d[l_ac].sfbcwf002
                     CALL cl_ref_val("v_oocql002")
                     LET g_sfakwf2_d[l_ac].sfbcwf002_desc = g_chkparam.return1
                     DISPLAY BY NAME g_sfakwf2_d[l_ac].sfbcwf002_desc
                     NEXT FIELD sfbcwf002
                  END IF
                  #160908-00025#1-s-add
                  IF NOT bsft001_wf_sfbcwfseq1_2(l_cmd) THEN
                     LET g_sfakwf2_d[g_detail_idx2].sfbcwf002 = g_sfakwf2_d_t.sfbcwf002
                     INITIALIZE g_chkparam.* TO NULL
                     LET g_chkparam.arg1 = '215'
                     LET g_chkparam.arg2 = g_sfakwf2_d[l_ac].sfbcwf002
                     CALL cl_ref_val("v_oocql002")
                     LET g_sfakwf2_d[l_ac].sfbcwf002_desc = g_chkparam.return1
                     DISPLAY BY NAME g_sfakwf2_d[l_ac].sfbcwf002_desc
                     NEXT FIELD sfbcwf002
                  END IF
                  #160908-00025#1-e-add
               END IF
            ELSE
               LET g_sfakwf2_d[g_detail_idx2].sfbcwf002 = ' '             
            END IF
            INITIALIZE g_chkparam.* TO NULL
            LET g_chkparam.arg1 = '215'
            LET g_chkparam.arg2 = g_sfakwf2_d[l_ac].sfbcwf002
            CALL cl_ref_val("v_oocql002")
            LET g_sfakwf2_d[l_ac].sfbcwf002_desc = g_chkparam.return1
            DISPLAY BY NAME g_sfakwf2_d[l_ac].sfbcwf002_desc  
            #END add-point
            
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf002
            #add-point:BEFORE FIELD sfbcwf002 name="input.b.page2.sfbcwf002"

            #END add-point
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfbcwf002
            #add-point:ON CHANGE sfbcwf002 name="input.g.page2.sfbcwf002"

            #END add-point 
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf003
            
            #add-point:AFTER FIELD sfbcwf003 name="input.a.page2.sfbcwf003"
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_sfakwf2_d[l_ac].sfbcwf003
            CALL ap_ref_array2(g_ref_fields,"SELECT oocql004 FROM oocql_t WHERE oocqlent="||g_enterprise||" AND oocql001='221' AND oocql002=? AND oocql003='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_sfakwf2_d[l_ac].sfbcwf003_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_sfakwf2_d[l_ac].sfbcwf003_desc
            
            IF NOT cl_null(g_sfakwf2_d[g_detail_idx2].sfbcwf003) THEN
               IF cl_null(g_sfakwf2_d_t.sfbcwf003) OR g_sfakwf2_d[g_detail_idx2].sfbcwf003 != g_sfakwf2_d_t.sfbcwf003 THEN
                  #????????
                  IF NOT s_azzi650_chk_exist('221',g_sfakwf2_d[g_detail_idx2].sfbcwf003) THEN
                     LET g_sfakwf2_d[g_detail_idx2].sfbcwf003 = g_sfakwf2_d_t.sfbcwf003
                     INITIALIZE g_chkparam.* TO NULL
                     LET g_chkparam.arg1 = '221'
                     LET g_chkparam.arg2 = g_sfakwf2_d[l_ac].sfbcwf003
                     CALL cl_ref_val("v_oocql002")
                     LET g_sfakwf2_d[l_ac].sfbcwf003_desc = g_chkparam.return1
                     DISPLAY BY NAME g_sfakwf2_d[l_ac].sfbcwf003_desc                     
                     NEXT FIELD sfbcwf003
                  END IF   
                  IF NOT bsft001_wf_sfbcwfseq1(l_cmd,'sfbcwf003') THEN  #170428-00012#1 add ,'sfbcwf003'
                     LET g_sfakwf2_d[g_detail_idx2].sfbcwf003 = g_sfakwf2_d_t.sfbcwf003                  
                     #????
                     INITIALIZE g_chkparam.* TO NULL
                     LET g_chkparam.arg1 = '221'
                     LET g_chkparam.arg2 = g_sfakwf2_d[l_ac].sfbcwf003
                     CALL cl_ref_val("v_oocql002")
                     LET g_sfakwf2_d[l_ac].sfbcwf003_desc = g_chkparam.return1
                     DISPLAY BY NAME g_sfakwf2_d[l_ac].sfbcwf003_desc                     
                     NEXT FIELD sfbcwf003
                  END IF
                  #160908-00025#1-s-add
                  IF NOT bsft001_wf_sfbcwfseq1_2(l_cmd) THEN
                     LET g_sfakwf2_d[g_detail_idx2].sfbcwf003 = g_sfakwf2_d_t.sfbcwf003                  
                     #????
                     INITIALIZE g_chkparam.* TO NULL
                     LET g_chkparam.arg1 = '221'
                     LET g_chkparam.arg2 = g_sfakwf2_d[l_ac].sfbcwf003
                     CALL cl_ref_val("v_oocql002")
                     LET g_sfakwf2_d[l_ac].sfbcwf003_desc = g_chkparam.return1
                     DISPLAY BY NAME g_sfakwf2_d[l_ac].sfbcwf003_desc                     
                     NEXT FIELD sfbcwf003
                  END IF
                  #160908-00025#1-e-add
                  #250117-00001#1 add--s
                  CALL bsft001_wf_get_sfbcwf003()
                  #250117-00001#1 add--e
               END IF
            ELSE
               LET g_sfakwf2_d[g_detail_idx2].sfbcwf003 = ' '            
            END IF                  
            #????
            INITIALIZE g_chkparam.* TO NULL
            LET g_chkparam.arg1 = '221'
            LET g_chkparam.arg2 = g_sfakwf2_d[l_ac].sfbcwf003
            CALL cl_ref_val("v_oocql002")
            LET g_sfakwf2_d[l_ac].sfbcwf003_desc = g_chkparam.return1
            DISPLAY BY NAME g_sfakwf2_d[l_ac].sfbcwf003_desc

            #END add-point
            
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf003
            #add-point:BEFORE FIELD sfbcwf003 name="input.b.page2.sfbcwf003"

            #END add-point
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfbcwf003
            #add-point:ON CHANGE sfbcwf003 name="input.g.page2.sfbcwf003"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf004
            #add-point:BEFORE FIELD sfbcwf004 name="input.b.page2.sfbcwf004"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf004
            
            #add-point:AFTER FIELD sfbcwf004 name="input.a.page2.sfbcwf004"
            IF NOT cl_null(g_sfakwf2_d[g_detail_idx2].sfbcwf004) THEN
               IF cl_null(g_sfakwf2_d_t.sfbcwf004) OR g_sfakwf2_d[g_detail_idx2].sfbcwf004 != g_sfakwf2_d_t.sfbcwf004 THEN
                  IF NOT bsft001_wf_sfbcwfseq1(l_cmd,'sfbcwf004') THEN  #170428-00012#1 add ,'sfbcwf004'
                     LET g_sfakwf2_d[g_detail_idx2].sfbcwf004 = g_sfakwf2_d_t.sfbcwf004
                     NEXT FIELD sfbcwf004
                  END IF
                  #160908-00025#1-s-add
                  IF NOT bsft001_wf_sfbcwfseq1_2(l_cmd) THEN
                     LET g_sfakwf2_d[g_detail_idx2].sfbcwf004 = g_sfakwf2_d_t.sfbcwf004
                     NEXT FIELD sfbcwf004
                  END IF
                  #160908-00025#1-e-add
               END IF
            ELSE
               LET g_sfakwf2_d[g_detail_idx2].sfbcwf004 = ' '
            END IF      
            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfbcwf004
            #add-point:ON CHANGE sfbcwf004 name="input.g.page2.sfbcwf004"

            #END add-point 
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf005
            
            #add-point:AFTER FIELD sfbcwf005 name="input.a.page2.sfbcwf005"
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_sfakwf2_d[l_ac].sfbcwf005
            CALL ap_ref_array2(g_ref_fields,"SELECT imaal003 FROM imaal_t WHERE imaalent="||g_enterprise||" AND imaal001=? AND imaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_sfakwf2_d[l_ac].sfbcwf005_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_sfakwf2_d[l_ac].sfbcwf005_desc

            IF NOT cl_null(g_sfakwf2_d[g_detail_idx2].sfbcwf005) THEN
               IF cl_null(g_sfakwf2_d_t.sfbcwf005) OR g_sfakwf2_d[g_detail_idx2].sfbcwf005 != g_sfakwf2_d_t.sfbcwf005 THEN
                  #??g_chkparam.*?????????????????????????????
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_sfakwf2_d[l_ac].sfbcwf005
                  #??????????library
                  IF cl_chk_exist("v_imaa001") THEN
                     IF NOT cl_chk_exist("v_imaf001_1") THEN
                        LET g_sfakwf2_d[l_ac].sfbcwf005 = g_sfakwf2_d_t.sfbcwf005
                        NEXT FIELD CURRENT
                     END IF
                  ELSE
                     LET g_sfakwf2_d[l_ac].sfbcwf005 = g_sfakwf2_d_t.sfbcwf005
                     NEXT FIELD CURRENT
                  END IF
                   
                  #160623-00009#1-add-(S)
                  IF NOT bsft001_wf_sfbcwf005_chk(g_sfakwf2_d[l_ac].sfbcwf005) THEN
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.extend = ""
                     LET g_errparam.code   = "ain-00530" #???????'X???'?
                     LET g_errparam.popup  = TRUE
                     LET g_sfakwf2_d[l_ac].sfbcwf005 = g_sfakwf2_d_t.sfbcwf005
                     CALL cl_err()       
                     NEXT FIELD CURRENT
                  END IF
                  #160623-00009#1-add-(E)
                  
                  #170618-00477#4-s-add
                  #??????
                  LET l_imaf016 = ''
                  SELECT imaf016 INTO l_imaf016
                    FROM imaf_t 
                   WHERE imafent = g_enterprise
                     AND imafsite = g_site
                     AND imaf001 = g_sfakwf2_d[l_ac].sfbcwf005
                  #?????????????
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.err_str[1] = "abm-00250|",l_imaf016,"|",g_sfakwf2_d[l_ac].sfbcwf005
                  LET g_chkparam.arg1 = l_imaf016
                  IF NOT cl_chk_exist("v_oocq002_210_1") THEN
                     LET g_sfakwf2_d[l_ac].sfbcwf006 = g_sfakwf2_d_t.sfbcwf006
                     NEXT FIELD CURRENT
                  END IF 
                  #170618-00477#4-e-add
               
                  CALL s_aooi200_get_slip(g_sfajwf_m.sfajwfdocno) RETURNING l_success,l_ooba002
                  LET l_flag = cl_get_doc_para(g_enterprise,g_site,l_ooba002,'D-MFG-0024')
                  IF l_flag <> '2' THEN
                     CALL cl_err_collect_init()   #181112-00058#1 add
                     #160512-00016#14 20160527 modify by ming -----(S) 
                     #CALL s_asft300_02_bom(0,g_sfaa_m.sfaa010,g_sfaa_m.sfaa011,g_sfaa_m.sfaa013,1,1,g_sfaa_m.sfaa015,'Y',g_sfakwf2_d[l_ac].sfbcwf005,g_sfakwf2_d[l_ac].sfbcwf021,'')
                     #     RETURNING l_bmba
                     CALL s_bsft001_wf_02_bom(0,g_sfakwf_d[g_detail_idx].sfakwf001,g_sfakwf_d[g_detail_idx].sfakwf002,g_sfakwf_d[g_detail_idx].sfakwf007,1,1,g_sfakwf_d[g_detail_idx].sfakwf043,'Y',g_sfakwf2_d[l_ac].sfbcwf005,g_sfakwf2_d[l_ac].sfbcwf021,'',g_sfakwf2_d[l_ac].sfbcwf033)
                          RETURNING l_bmba
                     #160512-00016#14 20160527 modify by ming -----(E) 
                    
                     IF g_sfajwf_m.sfajwf003 <> '2' THEN        #161124-00021#1 add
                        IF l_bmba.getLength() = 0 THEN
                           CASE l_flag
                              #?????????1?????bom???????
                              WHEN '1'
                                 INITIALIZE g_errparam TO NULL
                                 LET g_errparam.code = 'asf-00334'
                                 LET g_errparam.extend = g_sfakwf2_d[l_ac].sfbcwf005
                                 LET g_errparam.popup = TRUE
                                 CALL cl_err()
                                 LET g_sfakwf2_d[l_ac].sfbcwf005 = g_sfakwf2_d_t.sfbcwf005
                                 CALL cl_err_collect_show()   #181203-00045#1 add
                                 NEXT FIELD CURRENT
                              #?????????3?????bom???
                              WHEN '3'
                                 INITIALIZE g_errparam TO NULL
                                 LET g_errparam.code = 'asf-00335'
                                 LET g_errparam.extend = g_sfakwf2_d[l_ac].sfbcwf005
                                 LET g_errparam.popup = TRUE
                                 CALL cl_err()
                           END CASE
                        END IF
                     END IF          #161124-00021#1 add
                     CALL cl_err_collect_show()   #181112-00058#1 add
                  END IF
                  #170310-00015#1 add --(S)--
                  IF g_sfakwf2_d[g_detail_idx2].sfbcwf002 IS NULL THEN LET g_sfakwf2_d[g_detail_idx2].sfbcwf002 = ' ' END IF 
                  IF g_sfakwf2_d[g_detail_idx2].sfbcwf003 IS NULL THEN LET g_sfakwf2_d[g_detail_idx2].sfbcwf003 = ' ' END IF
                  IF g_sfakwf2_d[g_detail_idx2].sfbcwf004 IS NULL THEN LET g_sfakwf2_d[g_detail_idx2].sfbcwf004 = ' ' END IF                     

                  #??????
                  #IF cl_null(g_sfakwf2_d[l_ac].sfbcwf006) THEN   #20151020 by stellar mark:?????BOM?????????????????????BOM????
                     LET g_sfakwf2_d[l_ac].sfbcwf006 = g_sfakwf2_d[l_ac].sfbcwf005
                     CALL bsft001_wf_sfbcwf006_desc()
                  #END IF   #20151020 by stellar mark
                  #190603-00034#1---add---(S)
                  #??????
                  CALL bsft001_wf_get_sfbcwf001()
                  #190603-00034#1---add---(E)
                  #210617-00015#1 add---start---
                  IF NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf001) THEN
                     SELECT imaal003,imaal004 INTO g_sfakwf2_d[l_ac].sfbcwf001_desc,g_sfakwf2_d[l_ac].sfbcwf001_desc_1
                       FROM imaal_t
                      WHERE imaalent = g_enterprise
                        AND imaal001 = g_sfakwf2_d[l_ac].sfbcwf001
                        AND imaal002 = g_dlang
                     DISPLAY BY NAME g_sfakwf2_d[l_ac].sfbcwf001_desc,g_sfakwf2_d[l_ac].sfbcwf001_desc_1
                  END IF
                  #210617-00015#1 add---end---
               END IF
            #170504-00016#1-S   
            ELSE
               LET g_sfakwf2_d[g_detail_idx2].sfbcwf005_desc = ' '
               LET g_sfakwf2_d[g_detail_idx2].sfbcwf005_desc_1 = ' '
            #170504-00016#1-E
            END IF
            CALL bsft001_wf_b_desc() #200623-00043#1---add
            #161205-00018#1 add--------s-------               
            CALL bsft001_wf_set_entry_b(l_cmd)
            CALL bsft001_wf_set_no_entry_b(l_cmd)
            #161205-00018#1 add---------e------
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_sfakwf2_d[g_detail_idx2].sfbcwf005
            CALL ap_ref_array2(g_ref_fields,"SELECT imaal003,imaal004 FROM imaal_t WHERE imaalent='"||g_enterprise||"' AND imaal001=? AND imaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_sfakwf2_d[g_detail_idx2].sfbcwf005_desc = '', g_rtn_fields[1] , ''
            LET g_sfakwf2_d[g_detail_idx2].sfbcwf005_desc_1 = '', g_rtn_fields[2] , ''
            DISPLAY BY NAME g_sfakwf2_d[g_detail_idx2].sfbcwf005_desc
            DISPLAY BY NAME g_sfakwf2_d[g_detail_idx2].sfbcwf005_desc_1           
            #201018-00001#1---add---s
            IF g_sfajwf_m.sfajwf004 = '2' THEN
               LET g_sfakwf2_d[l_ac].sfbcwf009 = "Y"
            END IF
            DISPLAY BY NAME g_sfakwf2_d[l_ac].sfbcwf009
            #END add-point
            
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf005
            #add-point:BEFORE FIELD sfbcwf005 name="input.b.page2.sfbcwf005"

            #END add-point
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfbcwf005
            #add-point:ON CHANGE sfbcwf005 name="input.g.page2.sfbcwf005"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf022
            #add-point:BEFORE FIELD sfbcwf022 name="input.b.page2.sfbcwf022"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf022
            
            #add-point:AFTER FIELD sfbcwf022 name="input.a.page2.sfbcwf022"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfbcwf022
            #add-point:ON CHANGE sfbcwf022 name="input.g.page2.sfbcwf022"

            #END add-point 
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf006
            
            #add-point:AFTER FIELD sfbcwf006 name="input.a.page2.sfbcwf006"
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_sfakwf2_d[l_ac].sfbcwf006
            CALL ap_ref_array2(g_ref_fields,"SELECT imaal003 FROM imaal_t WHERE imaalent="||g_enterprise||" AND imaal001=? AND imaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_sfakwf2_d[l_ac].sfbcwf006_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_sfakwf2_d[l_ac].sfbcwf006_desc

            IF NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf006) AND (cl_null(g_sfakwf2_d_o.sfbcwf006) OR g_sfakwf2_d[l_ac].sfbcwf006 != g_sfakwf2_d_o.sfbcwf006) THEN #201225-00004#1 add
               #??g_chkparam.*?????????????????????????????
               INITIALIZE g_chkparam.* TO NULL
               LET g_chkparam.arg1 = g_sfakwf2_d[l_ac].sfbcwf006

               #??????????library
               IF cl_chk_exist("v_imaa001") THEN
                  IF NOT cl_chk_exist("v_imaf001_1") THEN
                     LET g_sfakwf2_d[l_ac].sfbcwf006 = g_sfakwf2_d_t.sfbcwf006
                     NEXT FIELD CURRENT
                  END IF
               ELSE
                  LET g_sfakwf2_d[l_ac].sfbcwf006 = g_sfakwf2_d_t.sfbcwf006
                  NEXT FIELD CURRENT
               END IF
               
               #160623-00009#1-add-(S)
               IF NOT bsft001_wf_sfbcwf005_chk(g_sfakwf2_d[l_ac].sfbcwf006) THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.extend = ""
                  LET g_errparam.code   = "ain-00530" #???????'X???'?
                  LET g_errparam.popup  = TRUE
                  LET g_sfakwf2_d[l_ac].sfbcwf006 = g_sfakwf2_d_t.sfbcwf006
                  CALL cl_err()  
                  NEXT FIELD CURRENT
               END IF
               #160623-00009#1-add-(E)
               
               #170618-00477#4-s-add
               #??????
               LET l_imaf016 = ''
               SELECT imaf016 INTO l_imaf016
                 FROM imaf_t 
                WHERE imafent = g_enterprise
                  AND imafsite = g_site
                  AND imaf001 = g_sfakwf2_d[l_ac].sfbcwf006
               #?????????????
               INITIALIZE g_chkparam.* TO NULL
               LET g_chkparam.err_str[1] = "abm-00250|",l_imaf016,"|",g_sfakwf2_d[l_ac].sfbcwf006
               LET g_chkparam.arg1 = l_imaf016
               IF NOT cl_chk_exist("v_oocq002_210_1") THEN
                  LET g_sfakwf2_d[l_ac].sfbcwf006 = g_sfakwf2_d_t.sfbcwf006
                  NEXT FIELD CURRENT
               END IF 
               #170618-00477#4-e-add
          
               CALL s_aooi200_get_slip(g_sfajwf_m.sfajwfdocno) RETURNING l_success,l_ooba002
               LET l_flag = cl_get_doc_para(g_enterprise,g_site,l_ooba002,'D-MFG-0024')
               IF l_flag <> '2' THEN
                  CALL cl_err_collect_init()   #181112-00058#1 add
                  #160512-00016#14 20160527 modify by ming -----(S) 
                  #CALL s_asft300_02_bom(0,g_sfakwf_d[l_ac].sfakwf001,g_sfakwf_d[l_ac].sfakwf002,g_sfaa_m.sfaa013,1,1,g_sfaa_m.sfaa015,'Y',g_sfakwf2_d[l_ac].sfbcwf006,g_sfakwf2_d[l_ac].sfbcwf021,'')
                  #     RETURNING l_bmba
                  CALL s_bsft001_wf_02_bom(0,g_sfakwf_d[g_detail_idx].sfakwf001,g_sfakwf_d[g_detail_idx].sfakwf002,g_sfakwf_d[g_detail_idx].sfakwf007,1,1,g_sfakwf_d[g_detail_idx].sfakwf043,'Y',g_sfakwf2_d[l_ac].sfbcwf005,g_sfakwf2_d[l_ac].sfbcwf021,'',g_sfakwf2_d[l_ac].sfbcwf033)
                       RETURNING l_bmba
                  #160512-00016#14 20160527 modify by ming -----(E) 
                  IF g_sfajwf_m.sfajwf003 <> '2' THEN        #161124-00021#1 add
                     IF l_bmba.getLength() = 0 THEN
                        CASE l_flag
                           #?????????1?????bom???????
                           WHEN '1'
                              INITIALIZE g_errparam TO NULL
                              LET g_errparam.code = 'asf-00334'
                              LET g_errparam.extend = g_sfakwf2_d[l_ac].sfbcwf006
                              LET g_errparam.popup = TRUE
                              CALL cl_err()
                              LET g_sfakwf2_d[l_ac].sfbcwf006 = g_sfakwf2_d_t.sfbcwf006
                              CALL cl_err_collect_show()   #181203-00045#1 add
                              NEXT FIELD CURRENT
                           #?????????3?????bom???
                           WHEN '3'
                              INITIALIZE g_errparam TO NULL
                              LET g_errparam.code = 'asf-00335'
                              LET g_errparam.extend = g_sfakwf2_d[l_ac].sfbcwf006
                              LET g_errparam.popup = TRUE
                              CALL cl_err()
                         END CASE
                     END IF
                  END IF        #161124-00021#1 add
                  CALL cl_err_collect_show()   #181112-00058#1 add
               END IF 
               
               #160908-00025#1-s-add
               IF NOT bsft001_wf_sfbcwfseq1_2(l_cmd) THEN
                  LET g_sfakwf2_d[g_detail_idx].sfbcwf006 = g_sfakwf2_d_t.sfbcwf006
                  NEXT FIELD sfbcwf006
               END IF
               #160908-00025#1-e-add
               
               CALL bsft001_wf_sfbcwf006_desc()
               
               #201225-00004#1 add -S
               IF g_sfakwf2_d[l_ac].sfbcwfseq2 = 0 THEN
                  LET l_n1 = 0
                  SELECT COUNT(1) INTO l_n1 FROM bmea_t
                   WHERE bmeaent = g_enterprise 
                     AND bmeasite = g_site
                     AND ((bmea001 = g_sfakwf2_d[l_ac].sfbcwf001 AND bmea003 = g_sfakwf2_d[l_ac].sfbcwf005 AND bmea004 = g_sfakwf2_d[l_ac].sfbcwf002 
                              AND bmea005 = g_sfakwf2_d[l_ac].sfbcwf003 AND bmea006 = g_sfakwf2_d[l_ac].sfbcwf004 AND bmea002 = g_sfakwf_d[g_detail_idx].sfakwf002) 
                         OR (bmea003 = g_sfakwf2_d[l_ac].sfbcwf005 AND bmea001 = 'ALL'))
                     AND (bmea010 IS NULL OR bmea010 > g_sfajwf_m.sfajwfdocdt)
                     AND bmea008 = g_sfakwf2_d[l_ac].sfbcwf006
                     AND bmea009 <= g_sfajwf_m.sfajwfdocdt
                     
                  IF cl_null(l_n1) THEN LET l_n1 = 0 END IF
                  
                  IF g_sfakwf2_d[l_ac].sfbcwf006 = g_sfakwf2_d_t.sfbcwf006 OR l_n1 < 1 THEN
                     LET g_sfakwf2_d[l_ac].sfbcwf013 = g_sfakwf2_d_t.sfbcwf013
                     LET g_sfakwf2_d[l_ac].sfbcwf022 = g_sfakwf2_d_t.sfbcwf022
                     LET g_sfakwf2_d[l_ac].sfbcwf023 = g_sfakwf2_d_t.sfbcwf023
                     LET g_sfakwf2_d[l_ac].sfbcwf024 = g_sfakwf2_d_t.sfbcwf024
                     LET g_sfakwf2_d[l_ac].sfbcwf010 = g_sfakwf2_d_t.sfbcwf010
                     LET g_sfakwf2_d[l_ac].sfbcwf011 = g_sfakwf2_d_t.sfbcwf011
                  ELSE
                     LET l_sfbcwf022_bom = ''
                     LET l_sfbcwf013_bom = ''
                     LET l_bmea011 = ''
                     LET l_bmea012 = ''
                     LET l_bmea013 = ''
                     
                     LET l_n1 = 0
                     SELECT COUNT(1) INTO l_n1 FROM bmea_t
                      WHERE bmeaent = g_enterprise 
                        AND bmeasite = g_site
                        AND ((bmea001 = g_sfakwf2_d_t.sfbcwf001 AND bmea003 = g_sfakwf2_d_t.sfbcwf005 AND bmea004 = g_sfakwf2_d_t.sfbcwf002 
                                 AND bmea005 = g_sfakwf2_d_t.sfbcwf003 AND bmea006 = g_sfakwf2_d_t.sfbcwf004 AND bmea002 = g_sfakwf_d[g_detail_idx].sfakwf002) 
                            OR (bmea003 = g_sfakwf2_d_t.sfbcwf005 AND bmea001 = 'ALL'))
                        AND (bmea010 IS NULL OR bmea010 > g_sfajwf_m.sfajwfdocdt)
                        AND bmea008 = g_sfakwf2_d_t.sfbcwf006
                        AND bmea009 <= g_sfajwf_m.sfajwfdocdt
                     IF cl_null(l_n1) THEN LET l_n1 = 0 END IF
                     
                     IF l_n1 > 0 THEN
                        #?????
                        SELECT bmea011,bmea012,bmea013 INTO l_bmea011,l_bmea012,l_bmea013
                          FROM bmea_t
                         WHERE bmeaent = g_enterprise 
                           AND bmeasite = g_site
                           AND ((bmea001 = g_sfakwf2_d_t.sfbcwf001 AND bmea003 = g_sfakwf2_d_t.sfbcwf005 AND bmea004 = g_sfakwf2_d_t.sfbcwf002 
                                    AND bmea005 = g_sfakwf2_d_t.sfbcwf003 AND bmea006 = g_sfakwf2_d_t.sfbcwf004 AND bmea002 = g_sfakwf_d[g_detail_idx].sfakwf002) 
                               OR (bmea003 = g_sfakwf2_d_t.sfbcwf005 AND bmea001 = 'ALL'))
                           AND (bmea010 IS NULL OR bmea010 > g_sfajwf_m.sfajwfdocdt)
                           AND bmea008 = g_sfakwf2_d_t.sfbcwf006
                           AND bmea009 <= g_sfajwf_m.sfajwfdocdt
                           AND rownum = 1
                        
                        LET l_sfbcwf022_bom = l_bmea011/l_bmea012 
                        
                        #?????????abmm207???????
                        IF NOT cl_null(l_bmea013) AND l_bmea013 <> g_sfakwf2_d_t.sfbcwf014 THEN  
                           CALL s_aooi250_convert_qty(g_sfakwf2_d_t.sfbcwf006,g_sfakwf2_d_t.sfbcwf014,l_bmea013,g_sfakwf2_d_t.sfbcwf013)
                              RETURNING l_success,l_sfbcwf013_bom
                           CALL s_aooi250_convert_qty(g_sfakwf2_d_t.sfbcwf006,g_sfakwf2_d_t.sfbcwf014,l_bmea013,g_sfakwf2_d_t.sfbcwf023)
                              RETURNING l_success,l_sfbcwf023_bom
                        ELSE
                           LET l_sfbcwf013_bom = g_sfakwf2_d_t.sfbcwf013
                           LET l_sfbcwf023_bom = g_sfakwf2_d_t.sfbcwf023
                        END IF
                                                
                     ELSE
                        LET l_sfbcwf022_bom = 1
                        LET l_sfbcwf013_bom = g_sfakwf2_d_t.sfbcwf013
                        LET l_sfbcwf023_bom = g_sfakwf2_d_t.sfbcwf023
                     END IF
                     
                     #???BOM???
                     LET l_sfbcwf013_bom = l_sfbcwf013_bom /l_sfbcwf022_bom
                     LET l_sfbcwf023_bom = l_sfbcwf023_bom /l_sfbcwf022_bom
                     
                     #?BOM????????????????
                     SELECT imae081 
                       INTO l_imae081
                       FROM imae_t
                      WHERE imaeent = g_enterprise
                        AND imaesite = g_site
                        AND imae001 = g_sfakwf2_d_t.sfbcwf006        
                     IF NOT cl_null(l_imae081) AND l_imae081 <> g_sfakwf2_d_t.sfbcwf014 THEN  
                        CALL s_aooi250_convert_qty(g_sfakwf2_d_t.sfbcwf006,l_imae081,g_sfakwf2_d_t.sfbcwf014,l_sfbcwf013_bom)
                           RETURNING l_success,l_sfbcwf013_bom
                        CALL s_aooi250_convert_qty(g_sfakwf2_d_t.sfbcwf006,l_imae081,g_sfakwf2_d_t.sfbcwf014,l_sfbcwf023_bom)
                           RETURNING l_success,l_sfbcwf023_bom
                     END IF
                     
                     #?????
                     LET l_bmea011 = ''
                     LET l_bmea012 = ''
                     LET l_bmea013 = ''
                     SELECT bmea011,bmea012,bmea013 INTO l_bmea011,l_bmea012,l_bmea013
                       FROM bmea_t
                      WHERE bmeaent = g_enterprise 
                        AND bmeasite = g_site
                        AND ((bmea001 = g_sfakwf2_d[l_ac].sfbcwf001 AND bmea003 = g_sfakwf2_d[l_ac].sfbcwf005 AND bmea004 = g_sfakwf2_d[l_ac].sfbcwf002 
                                 AND bmea005 = g_sfakwf2_d[l_ac].sfbcwf003 AND bmea006 = g_sfakwf2_d[l_ac].sfbcwf004 AND bmea002 = g_sfakwf_d[g_detail_idx].sfakwf002) 
                            OR (bmea003 = g_sfakwf2_d[l_ac].sfbcwf005 AND bmea001 = 'ALL'))
                        AND (bmea010 IS NULL OR bmea010 > g_sfajwf_m.sfajwfdocdt)
                        AND bmea008 = g_sfakwf2_d[l_ac].sfbcwf006
                        AND bmea009 <= g_sfajwf_m.sfajwfdocdt
                        AND rownum = 1
                     
                     #???
                     LET l_sfbcwf022_bom = l_bmea011/l_bmea012  
                     IF cl_null(l_sfbcwf022_bom) THEN LET l_sfbcwf022_bom = 1 END IF
                     
                     #????abmm207?????
                     LET l_sfbcwf013_bom = l_sfbcwf013_bom * l_sfbcwf022_bom
                     LET l_sfbcwf023_bom = l_sfbcwf023_bom * l_sfbcwf022_bom
                     #?????abmm207????????????????
                     IF NOT cl_null(l_bmea013) AND l_bmea013 <> g_sfakwf2_d[l_ac].sfbcwf014 THEN  
                        CALL s_aooi250_convert_qty(g_sfakwf2_d[l_ac].sfbcwf006,l_bmea013,g_sfakwf2_d[l_ac].sfbcwf014,l_sfbcwf013_bom)
                           RETURNING l_success,l_sfbcwf013_bom
                        CALL s_aooi250_convert_qty(g_sfakwf2_d[l_ac].sfbcwf006,l_bmea013,g_sfakwf2_d[l_ac].sfbcwf014,l_sfbcwf023_bom)
                           RETURNING l_success,l_sfbcwf023_bom
                     ELSE 
                        LET l_sfbcwf013_bom = l_sfbcwf013_bom
                        LET l_sfbcwf023_bom = l_sfbcwf023_bom
                     END IF
                     
                     LET g_sfakwf2_d[l_ac].sfbcwf013 = l_sfbcwf013_bom
                     LET g_sfakwf2_d[l_ac].sfbcwf022 = l_sfbcwf022_bom
                     LET g_sfakwf2_d[l_ac].sfbcwf023 = l_sfbcwf023_bom
                     CALL bsft001_wf_sfbcwf023_qpa(g_sfakwf2_d[l_ac].sfbcwf023) RETURNING g_sfakwf2_d[l_ac].sfbcwf010,g_sfakwf2_d[l_ac].sfbcwf011
                  END IF
               END IF
               #201225-00004#1 add -E
               
               #??????
              #CALL s_bsft001_wf_03(g_sfakwf2_d[l_ac].sfbcwf006,g_sfakwf2_d[l_ac].sfbcwf013) RETURNING l_success,l_sfbcwf013   #190116-00052#1 mark
               #190116-00052#1 add --(S)--
               #????????,??????????????(imae081)????,?????????????
               SELECT imae081 
                 INTO l_imae081
                 FROM imae_t
                WHERE imaeent = g_enterprise
                  AND imaesite = g_site
                  AND imae001 = g_sfakwf2_d[l_ac].sfbcwf006        
               IF NOT cl_null(l_imae081) AND l_imae081 <> g_sfakwf2_d[l_ac].sfbcwf014 THEN  
                  CALL s_aooi250_convert_qty(g_sfakwf2_d[l_ac].sfbcwf006,g_sfakwf2_d[l_ac].sfbcwf014,l_imae081,g_sfakwf2_d[l_ac].sfbcwf013)
                     RETURNING l_success,l_sfbcwf013_1
               ELSE
                  LET l_sfbcwf013_1 = g_sfakwf2_d[l_ac].sfbcwf013
               END IF
               
               CALL s_bsft001_wf_03(g_sfakwf2_d[l_ac].sfbcwf006,l_sfbcwf013_1) RETURNING l_success,l_sfbcwf013
               #190116-00052#1 add --(E)--
               IF l_success THEN
                  #190116-00052#1 add --(S)--
                  #??????????????(imae081)????,??????????????????????
                  IF NOT cl_null(l_imae081) AND l_imae081 <> g_sfakwf2_d[l_ac].sfbcwf014 THEN  
                     CALL s_aooi250_convert_qty(g_sfakwf2_d[l_ac].sfbcwf006,l_imae081,g_sfakwf2_d[l_ac].sfbcwf014,l_sfbcwf013)
                        RETURNING l_success,l_sfbcwf013
                  END IF
                  #190116-00052#1 add --(E)--
                  LET g_sfakwf2_d[l_ac].sfbcwf013=l_sfbcwf013

                  #170710-00016#1 --s add
                  CALL s_aooi250_get_msg(g_sfakwf2_d[l_ac].sfbcwf014) RETURNING l_success,l_ooca002,l_ooca004
                  IF l_success THEN
                     #???????????
                     CALL s_num_round('4',g_sfakwf2_d[l_ac].sfbcwf013,l_ooca002) RETURNING g_sfakwf2_d[l_ac].sfbcwf013
                  END IF
                  #170710-00016#1 --e add
               ELSE
                  LET g_sfakwf2_d[l_ac].sfbcwf013=g_sfakwf2_d_t.sfbcwf013
               END IF               
               
               LET g_sfakwf2_d[l_ac].sfbcwf024 = g_sfakwf2_d[l_ac].sfbcwf013 - g_sfakwf2_d[l_ac].sfbcwf023
               
               #?????????
               CALL bsft001_wf_set_entry_b(l_cmd)
               CALL bsft001_wf_set_no_entry_b(l_cmd)
               SELECT imaa005 INTO l_imaa005 FROM imaa_t WHERE imaaent = g_enterprise AND imaa001 = g_sfakwf2_d[l_ac].sfbcwf006
               IF NOT cl_null(l_imaa005) THEN
                  IF s_feature_auto_chk(g_sfakwf2_d[l_ac].sfbcwf006) THEN #160314-00009#16 add
                     IF l_cmd = 'a' THEN 
                        CALL l_inam.clear()          
                        CALL s_feature_multi(g_sfakwf2_d[l_ac].sfbcwf006,'','',g_site,g_sfajwf_m.sfajwfdocno) RETURNING l_success,l_inam
                        LET g_sfakwf2_d[l_ac].sfbcwf021 = l_inam[1].inam002
                        LET g_sfakwf2_d[l_ac].sfbcwf023 = l_inam[1].inam004
                        LET g_sfakwf2_d[l_ac].sfbcwf013 = g_sfakwf2_d[l_ac].sfbcwf023 + g_sfakwf2_d[l_ac].sfbcwf024
                        
                        #??QPA????
                        CALL bsft001_wf_sfbcwf023_qpa(g_sfakwf2_d[l_ac].sfbcwf023) RETURNING g_sfakwf2_d[l_ac].sfbcwf010,g_sfakwf2_d[l_ac].sfbcwf011
                        #??????
                       #CALL s_bsft001_wf_03(g_sfakwf2_d[l_ac].sfbcwf006,g_sfakwf2_d[l_ac].sfbcwf013) RETURNING l_success,l_sfbcwf013   #190116-00052#1 mark
                        #190116-00052#1 add --(S)--
                        #????????,??????????????(imae081)????,?????????????
                        SELECT imae081 
                          INTO l_imae081
                          FROM imae_t
                         WHERE imaeent = g_enterprise
                           AND imaesite = g_site
                           AND imae001 = g_sfakwf2_d[l_ac].sfbcwf006        
                        IF NOT cl_null(l_imae081) AND l_imae081 <> g_sfakwf2_d[l_ac].sfbcwf014 THEN  
                           CALL s_aooi250_convert_qty(g_sfakwf2_d[l_ac].sfbcwf006,g_sfakwf2_d[l_ac].sfbcwf014,l_imae081,g_sfakwf2_d[l_ac].sfbcwf013)
                              RETURNING l_success,l_sfbcwf013_1
                        ELSE
                           LET l_sfbcwf013_1 = g_sfakwf2_d[l_ac].sfbcwf013
                        END IF
                        CALL s_bsft001_wf_03(g_sfakwf2_d[l_ac].sfbcwf006,l_sfbcwf013_1) RETURNING l_success,l_sfbcwf013
                        #190116-00052#1 add --(E)--
                        IF l_success THEN
                           #190116-00052#1 add --(S)--
                           #??????????????(imae081)????,??????????????????????
                           IF NOT cl_null(l_imae081) AND l_imae081 <> g_sfakwf2_d[l_ac].sfbcwf014 THEN  
                              CALL s_aooi250_convert_qty(g_sfakwf2_d[l_ac].sfbcwf006,l_imae081,g_sfakwf2_d[l_ac].sfbcwf014,l_sfbcwf013)
                                 RETURNING l_success,l_sfbcwf013
                           END IF
                           #190116-00052#1 add --(E)--
                           LET g_sfakwf2_d[l_ac].sfbcwf013=l_sfbcwf013
                           
                           #170710-00016#1 --s add
                           CALL s_aooi250_get_msg(g_sfakwf2_d[l_ac].sfbcwf014) RETURNING l_success,l_ooca002,l_ooca004
                           IF l_success THEN
                              #???????????
                              CALL s_num_round('4',g_sfakwf2_d[l_ac].sfbcwf013,l_ooca002) RETURNING g_sfakwf2_d[l_ac].sfbcwf013
                           END IF
                           #170710-00016#1 --e add
                        END IF
                        
                        LET g_sfakwf2_d[l_ac].sfbcwf024 = g_sfakwf2_d[l_ac].sfbcwf013 - g_sfakwf2_d[l_ac].sfbcwf023                    
                     END IF
                  END IF #160314-00009#16  add
               END IF
               
               #??????
               IF NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf021) THEN            
                  IF NOT s_feature_check(g_sfakwf2_d[l_ac].sfbcwf006,g_sfakwf2_d[l_ac].sfbcwf021) THEN
                     NEXT FIELD sfbcwf021
                  END IF
                  #????????
                  CALL s_feature_description(g_sfakwf2_d[l_ac].sfbcwf006,g_sfakwf2_d[l_ac].sfbcwf021)
                     RETURNING l_success,g_sfakwf2_d[l_ac].sfbcwf021_desc
                  IF NOT l_success THEN
                     LET g_sfakwf2_d[l_ac].sfbcwf021_desc = ''
                  END IF
               ELSE
                  LET g_sfakwf2_d[l_ac].sfbcwf021_desc = ''
               END IF
               DISPLAY BY NAME g_sfakwf2_d[l_ac].sfbcwf021_desc
               
               #???????????
               CALL bsft001_wf_get_incgwf_inan_qty(g_sfakwf2_d[l_ac].sfbcwf006,g_sfakwf2_d[l_ac].sfbcwf021,g_sfakwf2_d[l_ac].sfbcwf014,g_sfakwf2_d[l_ac].sfbcwf019,g_sfakwf2_d[l_ac].sfbcwf020,g_sfakwf2_d[l_ac].sfbcwf029,g_sfakwf2_d[l_ac].sfbcwf030) 
                  RETURNING g_sfakwf2_d[l_ac].number5,g_sfakwf2_d[l_ac].number6
            END IF
            #170504-00016#1-S add
            IF cl_null(g_sfakwf2_d[l_ac].sfbcwf006) THEN
               LET g_sfakwf2_d[l_ac].sfbcwf006_desc = ' '
               LET g_sfakwf2_d[l_ac].sfbcwf006_desc_1 = ' '
            END IF
            #170504-00016#1-E add
            #201018-00001#1---add---s
            IF g_sfajwf_m.sfajwf004 = '2' THEN
               LET g_sfakwf2_d[l_ac].sfbcwf009 = "Y"
            END IF
            DISPLAY BY NAME g_sfakwf2_d[l_ac].sfbcwf009
            #201018-00001#1---add---e       
            LET g_sfakwf2_d_o.* = g_sfakwf2_d[l_ac].*   
            #END add-point
            
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf006
            #add-point:BEFORE FIELD sfbcwf006 name="input.b.page2.sfbcwf006"

            #END add-point
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfbcwf006
            #add-point:ON CHANGE sfbcwf006 name="input.g.page2.sfbcwf006"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf033
            #add-point:BEFORE FIELD sfbcwf033 name="input.b.page2.sfbcwf033"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf033
            
            #add-point:AFTER FIELD sfbcwf033 name="input.a.page2.sfbcwf033"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfbcwf033
            #add-point:ON CHANGE sfbcwf033 name="input.g.page2.sfbcwf033"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD imaf013
            #add-point:BEFORE FIELD imaf013 name="input.b.page2.imaf013"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD imaf013
            
            #add-point:AFTER FIELD imaf013 name="input.a.page2.imaf013"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE imaf013
            #add-point:ON CHANGE imaf013 name="input.g.page2.imaf013"

            #END add-point 
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf021
            
            #add-point:AFTER FIELD sfbcwf021 name="input.a.page2.sfbcwf021"
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_sfakwf2_d[l_ac].sfbcwf021
            CALL ap_ref_array2(g_ref_fields,"SELECT imecl005 FROM imecl_t WHERE imeclent="||g_enterprise||" AND imecl003=? AND imecl004='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_sfakwf2_d[l_ac].sfbcwf021_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_sfakwf2_d[l_ac].sfbcwf021_desc

            IF NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf006) AND NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf021) THEN
               #??????
               #161209-00038#3-s
               #IF NOT s_feature_check(g_sfakwf2_d[l_ac].sfbcwf006,g_sfakwf2_d[l_ac].sfbcwf021) THEN
               IF NOT bsft001_wf_sfbcwf021_chk() THEN
               #161209-00038#3-e
                  LET g_sfakwf2_d[l_ac].sfbcwf021 = g_sfakwf2_d_t.sfbcwf021
                  NEXT FIELD sfbcwf021
               END IF
               #--151224-00025#4 add start--
               IF NOT s_feature_direct_input(g_sfakwf2_d[l_ac].sfbcwf006,g_sfakwf2_d[l_ac].sfbcwf021,g_sfakwf2_d_t.sfbcwf021,g_sfajwf_m.sfajwfdocno,g_site) THEN
                  NEXT FIELD CURRENT
               END IF
               #--151224-00025#4 add end--
               #????????
               CALL s_feature_description(g_sfakwf2_d[l_ac].sfbcwf006,g_sfakwf2_d[l_ac].sfbcwf021)
                  RETURNING l_success,g_sfakwf2_d[l_ac].sfbcwf021_desc
               IF NOT l_success THEN
                  LET g_sfakwf2_d[l_ac].sfbcwf021_desc = ''
               END IF
               #???????????
               CALL bsft001_wf_get_incgwf_inan_qty(g_sfakwf2_d[l_ac].sfbcwf006,g_sfakwf2_d[l_ac].sfbcwf021,g_sfakwf2_d[l_ac].sfbcwf014,g_sfakwf2_d[l_ac].sfbcwf019,g_sfakwf2_d[l_ac].sfbcwf020,g_sfakwf2_d[l_ac].sfbcwf029,g_sfakwf2_d[l_ac].sfbcwf030) 
                  RETURNING g_sfakwf2_d[l_ac].number5,g_sfakwf2_d[l_ac].number6
            ELSE 
               LET g_sfakwf2_d[l_ac].sfbcwf021_desc = ''
            END IF

            DISPLAY BY NAME g_sfakwf2_d[l_ac].sfbcwf021_desc
            #END add-point
            
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf021
            #add-point:BEFORE FIELD sfbcwf021 name="input.b.page2.sfbcwf021"

            #END add-point
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfbcwf021
            #add-point:ON CHANGE sfbcwf021 name="input.g.page2.sfbcwf021"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf007
            #add-point:BEFORE FIELD sfbcwf007 name="input.b.page2.sfbcwf007"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf007
            
            #add-point:AFTER FIELD sfbcwf007 name="input.a.page2.sfbcwf007"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfbcwf007
            #add-point:ON CHANGE sfbcwf007 name="input.g.page2.sfbcwf007"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf008
            #add-point:BEFORE FIELD sfbcwf008 name="input.b.page2.sfbcwf008"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf008
            
            #add-point:AFTER FIELD sfbcwf008 name="input.a.page2.sfbcwf008"
            #161213-00010#1 add--------s------
            CALL bsft001_wf_set_entry_b(p_cmd)
            CALL bsft001_wf_set_no_entry_b(p_cmd)
            #161213-00010#1 add--------e------
            #220510-00026#1 add -S-
            IF NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf008) AND NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf006) THEN
               SELECT imaa004 INTO l_imaa004
                 FROM imaa_t
                WHERE imaaent = g_enterprise
                  AND imaa001 = g_sfakwf2_d[l_ac].sfbcwf006
               IF l_imaa004 = 'E' THEN
                  IF g_sfakwf2_d[l_ac].sfbcwf008 <> '3' AND g_sfakwf2_d[l_ac].sfbcwf008 <> '4' THEN
                     #????????????????????3.??????4.????
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = "" 
                     LET g_errparam.code   = "asf-00949" 
                     LET g_errparam.popup  = TRUE 
                     CALL cl_err()
                     NEXT FIELD sfbcwf008
                  END IF
               END IF
            END IF
            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfbcwf008
            #add-point:ON CHANGE sfbcwf008 name="input.g.page2.sfbcwf008"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf009
            #add-point:BEFORE FIELD sfbcwf009 name="input.b.page2.sfbcwf009"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf009
            
            #add-point:AFTER FIELD sfbcwf009 name="input.a.page2.sfbcwf009"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfbcwf009
            #add-point:ON CHANGE sfbcwf009 name="input.g.page2.sfbcwf009"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf010
            #add-point:BEFORE FIELD sfbcwf010 name="input.b.page2.sfbcwf010"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf010
            
            #add-point:AFTER FIELD sfbcwf010 name="input.a.page2.sfbcwf010"
            #??????????????0?,QPA??????0
            IF g_sfakwf2_d[l_ac].sfbcwf008 MATCHES '[34]' AND g_sfakwf2_d[l_ac].sfbcwf023 = 0 THEN
               IF NOT cl_ap_chk_Range(g_sfakwf2_d[l_ac].sfbcwf008,"0","1","","","azz-00079",1) THEN
                  LET g_sfakwf2_d[l_ac].sfbcwf011 = g_sfakwf2_d_t.sfbcwf011
                  NEXT FIELD sfbcwf011
               END IF   
            ELSE
            #181005-00018#1 add --(E)--
               IF NOT cl_ap_chk_Range(g_sfakwf2_d[l_ac].sfbcwf010,"0","0","","","azz-00079",1) THEN
                  LET g_sfakwf2_d[l_ac].sfbcwf010 = g_sfakwf2_d_t.sfbcwf010
                  NEXT FIELD sfbcwf010
               END IF
            END IF   #181005-00018#1 add
            IF NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf010) AND NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf011) THEN
               LET g_sfakwf2_d[l_ac].sfbcwf023 = g_sfakwf_d[g_detail_idx].sfakwf006 * g_sfakwf2_d[l_ac].sfbcwf010 / g_sfakwf2_d[l_ac].sfbcwf011
               LET g_sfakwf2_d[l_ac].sfbcwf024 = 0   #190708-00064#1 by 02159 add   
               LET g_sfakwf2_d[l_ac].sfbcwf013 = g_sfakwf2_d[l_ac].sfbcwf023 + g_sfakwf2_d[l_ac].sfbcwf024
               IF NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf006) THEN
                  #??????
                 #CALL s_bsft001_wf_03(g_sfakwf2_d[l_ac].sfbcwf006,g_sfakwf2_d[l_ac].sfbcwf013) RETURNING l_success,l_sfbcwf013   #190116-00052#1 mark
                  #190116-00052#1 add --(S)--
                  #????????,??????????????(imae081)????,?????????????
                  SELECT imae081 
                    INTO l_imae081
                    FROM imae_t
                   WHERE imaeent = g_enterprise
                     AND imaesite = g_site
                     AND imae001 = g_sfakwf2_d[l_ac].sfbcwf006        
                  IF NOT cl_null(l_imae081) AND l_imae081 <> g_sfakwf2_d[l_ac].sfbcwf014 THEN  
                     CALL s_aooi250_convert_qty(g_sfakwf2_d[l_ac].sfbcwf006,g_sfakwf2_d[l_ac].sfbcwf014,l_imae081,g_sfakwf2_d[l_ac].sfbcwf013)
                        RETURNING l_success,l_sfbcwf013_1
                  ELSE
                     LET l_sfbcwf013_1 = g_sfakwf2_d[l_ac].sfbcwf013
                  END IF
                  CALL s_bsft001_wf_03(g_sfakwf2_d[l_ac].sfbcwf006,l_sfbcwf013_1) RETURNING l_success,l_sfbcwf013
                  #190116-00052#1 add --(E)--
                  IF l_success THEN
                     #190116-00052#1 add --(S)--
                     #??????????????(imae081)????,??????????????????????
                     IF NOT cl_null(l_imae081) AND l_imae081 <> g_sfakwf2_d[l_ac].sfbcwf014 THEN  
                        CALL s_aooi250_convert_qty(g_sfakwf2_d[l_ac].sfbcwf006,l_imae081,g_sfakwf2_d[l_ac].sfbcwf014,l_sfbcwf013)
                           RETURNING l_success,l_sfbcwf013
                     END IF
                     #190116-00052#1 add --(E)--
                     LET g_sfakwf2_d[l_ac].sfbcwf013=l_sfbcwf013
                     #170710-00016#1 --s add
                     CALL s_aooi250_get_msg(g_sfakwf2_d[l_ac].sfbcwf014) RETURNING l_success,l_ooca002,l_ooca004
                     IF l_success THEN
                        #???????????
                        CALL s_num_round('4',g_sfakwf2_d[l_ac].sfbcwf013,l_ooca002) RETURNING g_sfakwf2_d[l_ac].sfbcwf013
                     END IF
                     #170710-00016#1 --e add
                  ELSE
                     LET g_sfakwf2_d[l_ac].sfbcwf013=g_sfakwf2_d_t.sfbcwf013
                  END IF               
                  LET g_sfakwf2_d[l_ac].sfbcwf024 = g_sfakwf2_d[l_ac].sfbcwf013 - g_sfakwf2_d[l_ac].sfbcwf023
                  #181005-00018#1 add --(S)--
                  LET g_sfakwf2_d_o.sfbcwf013 = g_sfakwf2_d[l_ac].sfbcwf013
                  LET g_sfakwf2_d_o.sfbcwf023 = g_sfakwf2_d[l_ac].sfbcwf023
                  LET g_sfakwf2_d_o.sfbcwf024 = g_sfakwf2_d[l_ac].sfbcwf024
                  #181005-00018#1 add --(E)--
               END IF
            END IF               
            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfbcwf010
            #add-point:ON CHANGE sfbcwf010 name="input.g.page2.sfbcwf010"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf011
            #add-point:BEFORE FIELD sfbcwf011 name="input.b.page2.sfbcwf011"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf011
            
            #add-point:AFTER FIELD sfbcwf011 name="input.a.page2.sfbcwf011"
            #??????????????0?,QPA??????0
            IF g_sfakwf2_d[l_ac].sfbcwf008 MATCHES '[34]' AND g_sfakwf2_d[l_ac].sfbcwf023 = 0 THEN
               IF NOT cl_ap_chk_Range(g_sfakwf2_d[l_ac].sfbcwf008,"0","1","","","azz-00079",1) THEN
                  LET g_sfakwf2_d[l_ac].sfbcwf011 = g_sfakwf2_d_t.sfbcwf011
                  NEXT FIELD sfbcwf011
               END IF   
            ELSE
            #181005-00018#1 add --(E)--
               IF NOT cl_ap_chk_Range(g_sfakwf2_d[l_ac].sfbcwf011,"0","0","","","azz-00079",1) THEN
                  LET g_sfakwf2_d[l_ac].sfbcwf011 = g_sfakwf2_d_t.sfbcwf011
                  NEXT FIELD sfbcwf011
               END IF
            END IF   #181005-00018#1 add
            IF NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf010) AND NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf011) THEN
               LET g_sfakwf2_d[l_ac].sfbcwf023 = g_sfakwf_d[g_detail_idx].sfakwf006 * g_sfakwf2_d[l_ac].sfbcwf010 / g_sfakwf2_d[l_ac].sfbcwf011
               LET g_sfakwf2_d[l_ac].sfbcwf024 = 0   #190708-00064#1 by 02159 add
               LET g_sfakwf2_d[l_ac].sfbcwf013 = g_sfakwf2_d[l_ac].sfbcwf023 + g_sfakwf2_d[l_ac].sfbcwf024
               IF NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf006) THEN
                  #??????
                 #CALL s_asft300_03(g_sfakwf2_d[l_ac].sfbcwf006,g_sfakwf2_d[l_ac].sfbcwf013) RETURNING l_success,l_sfbcwf013   #190116-00052#1 mark
                  #190116-00052#1 add --(S)--
                  #????????,??????????????(imae081)????,?????????????
                  SELECT imae081 
                    INTO l_imae081
                    FROM imae_t
                   WHERE imaeent = g_enterprise
                     AND imaesite = g_site
                     AND imae001 = g_sfakwf2_d[l_ac].sfbcwf006        
                  IF NOT cl_null(l_imae081) AND l_imae081 <> g_sfakwf2_d[l_ac].sfbcwf014 THEN  
                     CALL s_aooi250_convert_qty(g_sfakwf2_d[l_ac].sfbcwf006,g_sfakwf2_d[l_ac].sfbcwf014,l_imae081,g_sfakwf2_d[l_ac].sfbcwf013)
                        RETURNING l_success,l_sfbcwf013_1
                  ELSE
                     LET l_sfbcwf013_1 = g_sfakwf2_d[l_ac].sfbcwf013
                  END IF
                  CALL s_bsft001_wf_03(g_sfakwf2_d[l_ac].sfbcwf006,l_sfbcwf013_1) RETURNING l_success,l_sfbcwf013
                  #190116-00052#1 add --(E)--
                  IF l_success THEN
                     #190116-00052#1 add --(S)--
                     #??????????????(imae081)????,??????????????????????
                     IF NOT cl_null(l_imae081) AND l_imae081 <> g_sfakwf2_d[l_ac].sfbcwf014 THEN  
                        CALL s_aooi250_convert_qty(g_sfakwf2_d[l_ac].sfbcwf006,l_imae081,g_sfakwf2_d[l_ac].sfbcwf014,l_sfbcwf013)
                           RETURNING l_success,l_sfbcwf013
                     END IF
                     #190116-00052#1 add --(E)--
                     LET g_sfakwf2_d[l_ac].sfbcwf013=l_sfbcwf013
                     #170710-00016#1 --s add
                     CALL s_aooi250_get_msg(g_sfakwf2_d[l_ac].sfbcwf014) RETURNING l_success,l_ooca002,l_ooca004
                     IF l_success THEN
                        #???????????
                        CALL s_num_round('4',g_sfakwf2_d[l_ac].sfbcwf013,l_ooca002) RETURNING g_sfakwf2_d[l_ac].sfbcwf013
                     END IF
                     #170710-00016#1 --e add
                  ELSE
                     LET g_sfakwf2_d[l_ac].sfbcwf013=g_sfakwf2_d_t.sfbcwf013
                  END IF               
                  LET g_sfakwf2_d[l_ac].sfbcwf024 = g_sfakwf2_d[l_ac].sfbcwf013 - g_sfakwf2_d[l_ac].sfbcwf023
                  #181005-00018#1 add --(S)--
                  LET g_sfakwf2_d_o.sfbcwf013 = g_sfakwf2_d[l_ac].sfbcwf013
                  LET g_sfakwf2_d_o.sfbcwf023 = g_sfakwf2_d[l_ac].sfbcwf023
                  LET g_sfakwf2_d_o.sfbcwf024 = g_sfakwf2_d[l_ac].sfbcwf024
                  #181005-00018#1 add --(E)--
               END IF
            END IF
            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfbcwf011
            #add-point:ON CHANGE sfbcwf011 name="input.g.page2.sfbcwf011"

            #END add-point 
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf012
            #?? a15 ??????(Version:3)
            #???????????
            IF NOT cl_ap_chk_range(g_sfakwf2_d[l_ac].sfbcwf012,"0.000","1","100","1","azz-00087",1) THEN
               NEXT FIELD sfbcwf012
            END IF 
 
 
 
            #add-point:AFTER FIELD sfbcwf012 name="input.a.page2.sfbcwf012"
            IF NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf012) THEN 
            END IF 


            #END add-point
            
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf012
            #add-point:BEFORE FIELD sfbcwf012 name="input.b.page2.sfbcwf012"

            #END add-point
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfbcwf012
            #add-point:ON CHANGE sfbcwf012 name="input.g.page2.sfbcwf012"

            #END add-point 
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf023
            #?? a15 ??????(Version:3)
            #???????????
            IF NOT cl_ap_chk_range(g_sfakwf2_d[l_ac].sfbcwf023,"0.000","1","","","azz-00079",1) THEN
               NEXT FIELD sfbcwf023
            END IF 
 
 
 
            #add-point:AFTER FIELD sfbcwf023 name="input.a.page2.sfbcwf023"
           #IF NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf023) AND (g_sfakwf2_d[l_ac].sfbcwf023 != g_sfakwf2_d_t.sfbcwf023 OR cl_null(g_sfakwf2_d_t.sfbcwf023)) THEN   #181005-00018#1 mark
            IF NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf023) AND (g_sfakwf2_d[l_ac].sfbcwf023 != g_sfakwf2_d_o.sfbcwf023 OR cl_null(g_sfakwf2_d_t.sfbcwf023)) THEN   #181005-00018#1 add
               #????
               IF NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf014) THEN
                  CALL s_aooi250_take_decimals(g_sfakwf2_d[l_ac].sfbcwf014,g_sfakwf2_d[l_ac].sfbcwf023)
                       RETURNING l_success,g_sfakwf2_d[l_ac].sfbcwf023
               END IF
               LET g_sfakwf2_d[l_ac].sfbcwf013 = g_sfakwf2_d[l_ac].sfbcwf023 + g_sfakwf2_d[l_ac].sfbcwf024
               #??????
               SELECT imaa006,imaf053,imafwf210 INTO l_imaa006,l_imaf053,l_imafwf210 FROM imaf_t 
                 LEFT OUTER JOIN imaa_t ON imaaent = g_enterprise AND imaa001 = imaf001
                WHERE imafent = g_enterprise AND imafsite = g_site
                  AND imaf001 = g_sfakwf2_d[l_ac].sfbcwf006
               IF l_imafwf210 = 'Y' AND NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf019) AND NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf029) THEN 
#                  IF cl_null(g_sfakwf2_d[l_ac].sfbcwf019) THEN
#                     INITIALIZE g_errparam TO NULL
#                     LET g_errparam.code = 'als-00013'
#                     LET g_errparam.extend = ""
#                     LET g_errparam.popup = FALSE
#                     CALL cl_err()  
#                     CALL cl_set_comp_required("sfbcwf019",TRUE)
#                     LET g_sfakwf2_d[l_ac].sfbcwf023 = 0  #?????
#                     NEXT FIELD sfbcwf019
#                  ELSE
#                     INITIALIZE g_chkparam.* TO NULL
#                     LET g_chkparam.arg1 = g_site
#                     LET g_chkparam.arg2 = g_sfakwf2_d[l_ac].sfbcwf019
#                     LET g_errshow = TRUE #????                   
#                     LET g_chkparam.err_str[1] ="aim-00065:sub-01302|aini001|",cl_get_progname("aini001",g_lang,"2"),"|:EXEPROGaini001"
#                     IF NOT cl_chk_exist("v_inaa001") THEN
#                        LET g_sfakwf2_d[l_ac].sfbcwf019 = ''
#                        CALL cl_set_comp_required("sfbcwf019",TRUE)
#                        LET g_sfakwf2_d[l_ac].sfbcwf023 = 0
#                        NEXT FIELD sfbcwf019
#                     END IF               
#                  END IF    
                  CALL s_icd_wf_out(g_site,g_sfajwf_m.sfajwfdocno,g_sfakwf2_d[l_ac].sfbcwfseq1,g_sfakwf2_d[l_ac].sfbcwfseq2,g_sfakwf2_d[l_ac].sfbcwf006,g_sfakwf2_d[l_ac].sfbcwf021,g_sfakwf2_d[l_ac].sfbcwf014,g_sfakwf2_d[l_ac].sfbcwf013,'-1',g_sfajwf_m.sfajwf001,'1','',
                              g_sfakwf2_d[l_ac].sfbcwf019,g_sfakwf2_d[l_ac].sfbcwf020,g_sfakwf2_d[l_ac].sfbcwf029,g_sfakwf2_d[l_ac].sfbcwf040,g_sfakwf2_d[l_ac].sfbcwf041,g_sfakwf2_d[l_ac].sfbcwf042,g_sfakwf2_d[l_ac].sfbcwf030,g_sfakwf_d[g_detail_idx].sfakwfseq,g_sfakwf2_d[l_ac].sfbcwf039)   
                     RETURNING l_success,l_amount,l_amount_die                  
                  IF l_success THEN
                     IF s_icd_wf_clear_flag(g_sfajwf_m.sfajwfdocno,g_sfakwf_d[g_detail_idx].sfakwfseq,'-1') THEN
                        LET g_sfakwf2_d[l_ac].sfbcwf040 = NULL 	#DATECODE
                        LET g_sfakwf2_d[l_ac].sfbcwf041 = NULL 	#????
                        LET g_sfakwf2_d[l_ac].sfbcwf042 = NULL 	#????
                     END IF 
#                     CALL s_icd_wf_clear_inbb003(g_sfajwf_m.sfajwfdocno,g_sfakwf_d[g_detail_idx].sfakwfseq,'-1') RETURNING l_success,l_icbawf003,l_icbawf018
#                     IF l_success THEN
#                        LET g_sfakwf2_d[l_ac].sfbcwf030 = l_icbawf003 	   #??????
#                        LET g_sfakwf2_d[l_ac].sfbcwf039 = l_icbawf018 	 #????	
#                     ELSE
#                        LET g_sfakwf2_d[l_ac].sfbcwf030 = NULL 	   #??????
#                        LET g_sfakwf2_d[l_ac].sfbcwf039 = NULL 	 #????	
#                     END IF
                     IF s_aint302_wf_oocawf008(g_sfakwf2_d[l_ac].sfbcwf006) THEN
                        LET l_amount_2 = l_amount_die
                     ELSE
                        LET l_amount_2 = l_amount
                     END IF 
                     SELECT imaa006,imaf053 INTO l_imaa006,l_imaf053 FROM imaf_t 
                       LEFT OUTER JOIN imaa_t ON imaaent = g_enterprise AND imaa001 = imaf001
                      WHERE imafent = g_enterprise AND imafsite = g_site
                        AND imaf001 = g_sfakwf2_d[l_ac].sfbcwf006
                     IF s_aint302_wf_oocawf008(g_sfakwf2_d[l_ac].sfbcwf006) THEN
                        IF l_imaf053 = l_imaa006 THEN   #????=????
                           LET l_sfbcwf048 =  l_amount_die  #?????? 
                        ELSE
                           LET l_sfbcwf048 =  l_amount                
                        END IF                               
                     ELSE
                        IF l_imaf053 = l_imaa006 THEN   #????=????
                           LET l_sfbcwf048 =  l_amount  #?????? 
                        ELSE
                           LET l_sfbcwf048 =  l_amount_die                
                        END IF  
                     END IF        
                     IF g_sfakwf2_d[l_ac].sfbcwf023 <> l_amount_2 OR l_sfbcwf048 <> g_sfakwf2_d_t.sfbcwf048 THEN                        
                        IF cl_ask_confirm('wf-00002') THEN   #????????????????????????????                                   
                           IF s_aint302_wf_oocawf008(g_sfakwf2_d[l_ac].sfbcwf006) THEN
                              LET g_sfakwf2_d[l_ac].sfbcwf047 = l_amount_die #????
                              IF g_sfakwf2_d[l_ac].sfbcwf014 = l_imaf053  THEN  #????=????
                                 LET g_sfakwf2_d[l_ac].sfbcwf023 = l_amount_die #?????
                              ELSE 
                                 LET g_sfakwf2_d[l_ac].sfbcwf023 = l_amount                                
                              END IF
                              IF l_imaf053 = l_imaa006 THEN   #????=????
                                 LET g_sfakwf2_d[l_ac].sfbcwf048 =  l_amount_die  #?????? 
                              ELSE
                                 LET g_sfakwf2_d[l_ac].sfbcwf048 =  l_amount                
                              END IF                               
                           ELSE
                              LET g_sfakwf2_d[l_ac].sfbcwf047 = l_amount #????
                              IF g_sfakwf2_d[l_ac].sfbcwf014 = l_imaf053  THEN 
                                 LET g_sfakwf2_d[l_ac].sfbcwf023 = l_amount 
                              ELSE                              
                                 LET g_sfakwf2_d[l_ac].sfbcwf023 = l_amount_die            
                              END IF
                              IF l_imaf053 = l_imaa006 THEN   #????=????
                                 LET g_sfakwf2_d[l_ac].sfbcwf048 =  l_amount  #?????? 
                              ELSE
                                 LET g_sfakwf2_d[l_ac].sfbcwf048 =  l_amount_die                
                              END IF  
                           END IF                                                                         
                        END IF
                     END IF
                     #????
                     IF NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf014) THEN
                        CALL s_aooi250_take_decimals(g_sfakwf2_d[l_ac].sfbcwf014,g_sfakwf2_d[l_ac].sfbcwf023)
                             RETURNING l_success,g_sfakwf2_d[l_ac].sfbcwf023
                     END IF
                     IF NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf014) THEN
                        CALL s_aooi250_take_decimals(g_sfakwf2_d[l_ac].sfbcwf014,g_sfakwf2_d[l_ac].sfbcwf024)
                             RETURNING l_success,g_sfakwf2_d[l_ac].sfbcwf024
                     END IF
                     #?????=????+??????
                     LET g_sfakwf2_d[l_ac].sfbcwf013 = g_sfakwf2_d[l_ac].sfbcwf024 + g_sfakwf2_d[l_ac].sfbcwf023
                     IF NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf014) THEN
                        CALL s_aooi250_take_decimals(g_sfakwf2_d[l_ac].sfbcwf014,g_sfakwf2_d[l_ac].sfbcwf013)
                             RETURNING l_success,g_sfakwf2_d[l_ac].sfbcwf013
                     END IF
                     #250319-00001#1 add--s
                     #??QPA????
                     CALL bsft001_wf_sfbcwf023_qpa_02(g_sfakwf2_d[l_ac].sfbcwf023,g_sfakwf2_d[l_ac].sfbcwf049) RETURNING g_sfakwf2_d[l_ac].sfbcwf010,g_sfakwf2_d[l_ac].sfbcwf011
                     #250319-00001#1 add--e
                     #241104-00004#1 add--s
                     SELECT COUNT(1) INTO l_cnt FROM bmba_t 
                      WHERE bmbaent = g_enterprise AND bmbasite = g_site AND bmba001 = g_sfakwf_d[g_detail_idx].sfakwf001 AND bmba003 = g_sfakwf2_d[l_ac].sfbcwf006
                        AND bmba002 = g_sfakwf_d[g_detail_idx].sfakwf001  AND bmba004 = g_sfakwf2_d[l_ac].sfbcwf002 AND bmbawf039 = 'Y'
                        AND bmba007 = g_sfakwf2_d[l_ac].sfbcwf003 AND bmba008 = g_sfakwf2_d[l_ac].sfbcwf004
                     IF l_cnt > 0 THEN  #?????????BOM???????????,???????????
                        SELECT bmba012,bmba011 INTO l_bmba012,l_bmba011 FROM bmba_t
                         WHERE bmbaent = g_enterprise AND bmbasite = g_site AND bmba001 = g_sfakwf_d[g_detail_idx].sfakwf001  AND bmba002 = g_sfakwf_d[g_detail_idx].sfakwf002
                           AND bmba003 = g_sfakwf2_d[l_ac].sfbcwf006 AND bmba004 = g_sfakwf2_d[l_ac].sfbcwf002
                           AND bmba007 = g_sfakwf2_d[l_ac].sfbcwf003 AND bmba008 = g_sfakwf2_d[l_ac].sfbcwf004
                        LET g_sfakwf2_d[l_ac].sfbcwf049 = g_sfakwf2_d[l_ac].sfbcwf023 * l_bmba012 / l_bmba011                              
                     ELSE
                        LET g_sfakwf2_d[l_ac].sfbcwf049 = g_sfakwf2_d[l_ac].sfbcwf023
                     END IF
                     CALL bsft001_wf_up_fc() RETURNING l_success 
                     IF NOT l_success THEN
                        NEXT FIELD sfbcwf023
                     END IF
                     #241104-00004#1 add--e 
                  END IF 
               END IF       
         
               #?????????????
               LET l_sfbcwf013 = g_sfakwf2_d[l_ac].sfbcwf013
               SELECT imae084 INTO l_imae084 FROM imae_t
                WHERE imaeent = g_enterprise AND imaesite = g_site AND imae001 = g_sfakwf2_d[l_ac].sfbcwf006
               SELECT bmbawf037,bmbawf038 INTO l_bmbawf037,l_bmbawf038 FROM bmba_t
                WHERE bmbaent = g_enterprise AND bmbasite = g_site AND bmba001 = g_sfakwf_d[g_detail_idx].sfakwf001  AND bmba002 = g_sfakwf_d[g_detail_idx].sfakwf002
                  AND bmba003 = g_sfakwf2_d[l_ac].sfbcwf006 AND bmba004 = g_sfakwf2_d[l_ac].sfbcwf002
                  AND bmba007 = g_sfakwf2_d[l_ac].sfbcwf003 AND bmba008 = g_sfakwf2_d[l_ac].sfbcwf004
               IF NOT cl_null(l_bmbawf038) THEN
                  IF g_sfakwf2_d[l_ac].sfbcwf013 < l_bmbawf038 THEN
                     LET l_sfbcwf013 = l_bmbawf038
                  ELSE
                     LET l_sfbcwf013 = g_sfakwf2_d[l_ac].sfbcwf013
                  END IF
               ELSE
                  LET l_sfbcwf013 = g_sfakwf2_d[l_ac].sfbcwf013
               END IF
               
               IF NOT cl_null(l_bmbawf037) AND l_bmbawf037 != 0 THEN
                  LET l_n_sfbcwf013 = l_sfbcwf013 / l_bmbawf037
                  IF l_sfbcwf013  != l_bmbawf037 * l_n_sfbcwf013 THEN
                     IF l_sfbcwf013 > l_bmbawf037 * l_n_sfbcwf013 THEN
                        LET l_sfbcwf013 = l_bmbawf037 * (l_n_sfbcwf013 + 1)
                     ELSE
                        LET l_sfbcwf013 = l_bmbawf037 * l_n_sfbcwf013
                     END IF
                  END IF
               END IF
               
               IF l_sfbcwf013 != g_sfakwf2_d[l_ac].sfbcwf013 AND NOT cl_null(l_imae084) AND l_imae084 != '3' THEN
                  IF l_imae084 = '1' THEN
#                     LET l_msg = cl_getmsg('asf-00465',g_lang),l_sfbcwf013 USING '---,---,---,--&.&&&'
                     LET l_msg = cl_getmsg_parm('wf-00072',g_dlang,g_sfakwf_d[g_detail_idx].sfakwf001),l_sfbcwf013 USING '---,---,---,--&.&&&'
                     IF cl_ask_promp(l_msg) THEN
                        LET g_sfakwf2_d[l_ac].sfbcwf013 = l_sfbcwf013
                        LET g_sfakwf2_d[l_ac].sfbcwf024 = g_sfakwf2_d[l_ac].sfbcwf013 - g_sfakwf2_d[l_ac].sfbcwf023
                     END IF
                  END IF
                  IF l_imae084 = '2' THEN
                     LET l_msg = cl_getmsg('asf-00466',g_lang),l_sfbcwf013 USING '---,---,---,--&.&&&'
                     IF cl_ask_promp(l_msg) THEN
                        LET g_sfakwf2_d[l_ac].sfbcwf013 = l_sfbcwf013
                        LET g_sfakwf2_d[l_ac].sfbcwf024 = g_sfakwf2_d[l_ac].sfbcwf013 - g_sfakwf2_d[l_ac].sfbcwf023
                     ELSE
                        LET g_sfakwf2_d[l_ac].sfbcwf023 = g_sfakwf2_d_t.sfbcwf023
                        LET g_sfakwf2_d[l_ac].sfbcwf013 = g_sfakwf2_d[l_ac].sfbcwf023 + g_sfakwf2_d[l_ac].sfbcwf024
                        NEXT FIELD sfbcwf023
                     END IF
                  END IF
               END IF
               
               #??QPA????
               CALL bsft001_wf_sfbcwf023_qpa(g_sfakwf2_d[l_ac].sfbcwf023) RETURNING g_sfakwf2_d[l_ac].sfbcwf010,g_sfakwf2_d[l_ac].sfbcwf011
               LET g_sfakwf2_d_o.sfbcwf023 = g_sfakwf2_d[l_ac].sfbcwf023   #181005-00018#1 add
               #??BIN?????N:???????????????????????????????
               SELECT imafwf210 INTO l_imafwf210
                 FROM imaf_t
                WHERE imafent = g_enterprise
                  AND imafsite = g_site
                  AND imaf001 = g_sfakwf2_d[l_ac].sfbcwf006
               #240725-00004#1 mark--s
#               IF l_imafwf210 = 'Y' THEN
#               ELSE
#                  LET g_sfakwf2_d[l_ac].sfbcwf016 = g_sfakwf2_d[l_ac].sfbcwf013
#               END IF
               #240725-00004#1 mark--e
               #????/??????????????????????????/????????
               IF l_imafwf210 = 'Y' THEN   
               ELSE                            
                  CALL s_aooi250_convert_qty(g_sfakwf2_d[l_ac].sfbcwf006,g_sfakwf2_d[l_ac].sfbcwf014,l_imaf053,g_sfakwf2_d[l_ac].sfbcwf013) 
                     RETURNING l_success,g_sfakwf2_d[l_ac].sfbcwf047  #????
                  CALL s_aooi250_convert_qty(g_sfakwf2_d[l_ac].sfbcwf006,g_sfakwf2_d[l_ac].sfbcwf014,l_imaa006,g_sfakwf2_d[l_ac].sfbcwf013) 
                     RETURNING l_success,g_sfakwf2_d[l_ac].sfbcwf048  #??????
               END IF 
            END IF 


            #END add-point
            
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf023
            #add-point:BEFORE FIELD sfbcwf023 name="input.b.page2.sfbcwf023"

            #END add-point
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfbcwf023
            #add-point:ON CHANGE sfbcwf023 name="input.g.page2.sfbcwf023"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf024
            #add-point:BEFORE FIELD sfbcwf024 name="input.b.page2.sfbcwf024"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf024
            
            #add-point:AFTER FIELD sfbcwf024 name="input.a.page2.sfbcwf024"
            IF NOT cl_ap_chk_Range(g_sfakwf2_d[l_ac].sfbcwf024,"0","1","","","azz-00079",1) THEN
               LET g_sfakwf2_d[l_ac].sfbcwf024 = g_sfakwf2_d_o.sfbcwf024      #170202-00008#1 modi g_sfakwf2_d_t.sfbcwf024 -> g_sfakwf2_d_o.sfbcwf024
               NEXT FIELD sfbcwf024
            END IF
            
            IF NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf024) AND (g_sfakwf2_d[l_ac].sfbcwf024 != g_sfakwf2_d_o.sfbcwf024 OR cl_null(g_sfakwf2_d_o.sfbcwf024)) THEN   #170202-00008#1 modi g_sfakwf2_d_t.sfbcwf024 -> g_sfakwf2_d_o.sfbcwf024
               #????
               IF NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf014) THEN
                  CALL s_aooi250_take_decimals(g_sfakwf2_d[l_ac].sfbcwf014,g_sfakwf2_d[l_ac].sfbcwf024)
                       RETURNING l_success,g_sfakwf2_d[l_ac].sfbcwf024
               END IF
               #210701-00004#1---add---str---
               LET l_sfbcwf013_other  = 0
               SELECT SUM(sfbcwf013/sfbcwf022) INTO l_sfbcwf013_other 
                 FROM sfbcwf_t
                WHERE sfbcwfent = g_enterprise
                  AND sfbcwfdocno = g_sfajwf_m.sfajwfdocno
                  AND sfbcwfseq1 = g_sfakwf2_d[l_ac].sfbcwfseq1
                  AND sfbcwfseq2 <> 0
               IF cl_null(l_sfbcwf013_other) THEN
                   LET l_sfbcwf013_other  = 0
               END IF
               #210701-00004#1---add---end---
              #LET g_sfakwf2_d[l_ac].sfbcwf013 = g_sfakwf2_d[l_ac].sfbcwf023 + g_sfakwf2_d[l_ac].sfbcwf024                   #210701-00004#1 mark
               LET g_sfakwf2_d[l_ac].sfbcwf013 = g_sfakwf2_d[l_ac].sfbcwf023 + g_sfakwf2_d[l_ac].sfbcwf024 - l_sfbcwf013_other #210701-00004#1 add           
               #?????????????
               LET l_sfbcwf013 = g_sfakwf2_d[l_ac].sfbcwf013
               SELECT imae084 INTO l_imae084 FROM imae_t
                WHERE imaeent = g_enterprise AND imaesite = g_site AND imae001 = g_sfakwf2_d[l_ac].sfbcwf006
               SELECT bmbawf037,bmbawf038 INTO l_bmbawf037,l_bmbawf038 FROM bmba_t
                WHERE bmbaent = g_enterprise AND bmbasite = g_site AND bmba001 = g_sfakwf_d[g_detail_idx].sfakwf001  AND bmba002 = g_sfakwf_d[g_detail_idx].sfakwf002
                  AND bmba003 = g_sfakwf2_d[l_ac].sfbcwf006 AND bmba004 = g_sfakwf2_d[l_ac].sfbcwf002
                  AND bmba007 = g_sfakwf2_d[l_ac].sfbcwf003 AND bmba008 = g_sfakwf2_d[l_ac].sfbcwf004
               IF NOT cl_null(l_bmbawf038) THEN
                  IF g_sfakwf2_d[l_ac].sfbcwf013 < l_bmbawf038 THEN
                     LET l_sfbcwf013 = l_bmbawf038
                  ELSE
                     LET l_sfbcwf013 = g_sfakwf2_d[l_ac].sfbcwf013
                  END IF
               ELSE
                  LET l_sfbcwf013 = g_sfakwf2_d[l_ac].sfbcwf013
               END IF
               
               IF NOT cl_null(l_bmbawf037) AND l_bmbawf037 != 0 THEN
                  LET l_n_sfbcwf013 = l_sfbcwf013 / l_bmbawf037
                  IF l_sfbcwf013  != l_bmbawf037 * l_n_sfbcwf013 THEN
                     IF l_sfbcwf013 > l_bmbawf037 * l_n_sfbcwf013 THEN
                        LET l_sfbcwf013 = l_bmbawf037 * (l_n_sfbcwf013 + 1)
                     ELSE
                        LET l_sfbcwf013 = l_bmbawf037 * l_n_sfbcwf013
                     END IF
                  END IF
               END IF
               
               IF l_sfbcwf013 != g_sfakwf2_d[l_ac].sfbcwf013 AND NOT cl_null(l_imae084) AND l_imae084 != '3' THEN
                  IF l_imae084 = '1' THEN
#                     LET l_msg = cl_getmsg('asf-00465',g_lang),l_sfbcwf013 USING '---,---,---,--&.&&&'
                     LET l_msg = cl_getmsg_parm('wf-00072',g_dlang,g_sfakwf_d[g_detail_idx].sfakwf001),l_sfbcwf013 USING '---,---,---,--&.&&&' 
                     IF cl_ask_promp(l_msg) THEN
                        LET g_sfakwf2_d[l_ac].sfbcwf013 = l_sfbcwf013
                        LET g_sfakwf2_d[l_ac].sfbcwf024 = g_sfakwf2_d[l_ac].sfbcwf013 - g_sfakwf2_d[l_ac].sfbcwf023
                     END IF
                  END IF
                  IF l_imae084 = '2' THEN
                     LET l_msg = cl_getmsg('asf-00466',g_lang),l_sfbcwf013 USING '---,---,---,--&.&&&'
                     IF cl_ask_promp(l_msg) THEN
                        LET g_sfakwf2_d[l_ac].sfbcwf013 = l_sfbcwf013
                        LET g_sfakwf2_d[l_ac].sfbcwf024 = g_sfakwf2_d[l_ac].sfbcwf013 - g_sfakwf2_d[l_ac].sfbcwf023
                     ELSE
                        LET g_sfakwf2_d[l_ac].sfbcwf024 = g_sfakwf2_d_o.sfbcwf024    #170202-00008#1 modi g_sfakwf2_d_t.sfbcwf024 -> g_sfakwf2_d_o.sfbcwf024
                        LET g_sfakwf2_d[l_ac].sfbcwf013 = g_sfakwf2_d[l_ac].sfbcwf023 + g_sfakwf2_d[l_ac].sfbcwf024
                       #NEXT FIELD sfaa024   #200730-00025#1 mark
                        NEXT FIELD sfbcwf024   #200730-00025#1 add
                     END IF
                  END IF
               END IF
            END IF
            #??BIN?????N:???????????????????????????????
            SELECT imafwf210 INTO l_imafwf210
              FROM imaf_t
             WHERE imafent = g_enterprise
               AND imafsite = g_site
               AND imaf001 = g_sfakwf2_d[l_ac].sfbcwf006
            #240725-00004#1 mark--s
#            IF l_imafwf210 = 'Y' THEN
#            ELSE
#               LET g_sfakwf2_d[l_ac].sfbcwf016 = g_sfakwf2_d[l_ac].sfbcwf013
#            END IF
            #240725-00004#1 mark--e
            LET g_sfakwf2_d[l_ac].number1 = g_sfakwf2_d[l_ac].sfbcwf013 - g_sfakwf2_d[l_ac].sfbcwf015 - g_sfakwf2_d[l_ac].sfbcwf016 #170620-00066#1 add
            LET g_sfakwf2_d_o.sfbcwf024 = g_sfakwf2_d[l_ac].sfbcwf024   #170202-00008#1  add
            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfbcwf024
            #add-point:ON CHANGE sfbcwf024 name="input.g.page2.sfbcwf024"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf013
            #add-point:BEFORE FIELD sfbcwf013 name="input.b.page2.sfbcwf013"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf013
            
            #add-point:AFTER FIELD sfbcwf013 name="input.a.page2.sfbcwf013"
            IF cl_null(g_sfakwf2_d[l_ac].sfbcwf013) THEN 
               LET g_sfakwf2_d[l_ac].sfbcwf013 = 0
            END IF
            IF cl_null(g_sfakwf2_d[l_ac].sfbcwf015) THEN 
               LET g_sfakwf2_d[l_ac].sfbcwf015 = 0
            END IF
            IF cl_null(g_sfakwf2_d[l_ac].sfbcwf016) THEN 
               LET g_sfakwf2_d[l_ac].sfbcwf016 = 0
            END IF 
            IF NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf013) THEN
               #????
               IF NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf014) THEN
                  CALL s_aooi250_take_decimals(g_sfakwf2_d[l_ac].sfbcwf014,g_sfakwf2_d[l_ac].sfbcwf013)
                       RETURNING l_success,g_sfakwf2_d[l_ac].sfbcwf013
               END IF
               
               IF NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf015) THEN 
                  IF g_sfakwf2_d[l_ac].sfbcwf015 > g_sfakwf2_d[l_ac].sfbcwf013 THEN
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = 'asf-00087'
                     LET g_errparam.extend = g_sfakwf2_d[l_ac].sfbcwf013
                     LET g_errparam.popup = TRUE
                     CALL cl_err()

                     NEXT FIELD sfbcwf013
                  END IF
               END IF                  
            END IF
            LET g_sfakwf2_d[l_ac].number1 = g_sfakwf2_d[l_ac].sfbcwf013 - g_sfakwf2_d[l_ac].sfbcwf015 - g_sfakwf2_d[l_ac].sfbcwf016
            IF g_sfakwf2_d[l_ac].number1 < 0 THEN
               LET g_sfakwf2_d[l_ac].number1 = 0
            END IF
            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfbcwf013
            #add-point:ON CHANGE sfbcwf013 name="input.g.page2.sfbcwf013"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf047
            #add-point:BEFORE FIELD sfbcwf047 name="input.b.page2.sfbcwf047"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf047
            
            #add-point:AFTER FIELD sfbcwf047 name="input.a.page2.sfbcwf047"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfbcwf047
            #add-point:ON CHANGE sfbcwf047 name="input.g.page2.sfbcwf047"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf048
            #add-point:BEFORE FIELD sfbcwf048 name="input.b.page2.sfbcwf048"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf048
            
            #add-point:AFTER FIELD sfbcwf048 name="input.a.page2.sfbcwf048"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfbcwf048
            #add-point:ON CHANGE sfbcwf048 name="input.g.page2.sfbcwf048"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD number5
            #add-point:BEFORE FIELD number5 name="input.b.page2.number5"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD number5
            
            #add-point:AFTER FIELD number5 name="input.a.page2.number5"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE number5
            #add-point:ON CHANGE number5 name="input.g.page2.number5"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD number6
            #add-point:BEFORE FIELD number6 name="input.b.page2.number6"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD number6
            
            #add-point:AFTER FIELD number6 name="input.a.page2.number6"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE number6
            #add-point:ON CHANGE number6 name="input.g.page2.number6"

            #END add-point 
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf014
            
            #add-point:AFTER FIELD sfbcwf014 name="input.a.page2.sfbcwf014"
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_sfakwf2_d[l_ac].sfbcwf014
            CALL ap_ref_array2(g_ref_fields,"SELECT oocal003 FROM oocal_t WHERE oocalent="||g_enterprise||" AND oocal001=? AND oocal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_sfakwf2_d[l_ac].sfbcwf014_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_sfakwf2_d[l_ac].sfbcwf014_desc
            
            IF NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf014) THEN
               INITIALIZE g_chkparam.* TO NULL
               LET g_chkparam.arg1 = g_sfakwf2_d[l_ac].sfbcwf014
               #160318-00025#4--add--str
               LET g_errshow = TRUE 
               LET g_chkparam.err_str[1] = "aim-00005:sub-01302|aooi250|",cl_get_progname("aooi250",g_lang,"2"),"|:EXEPROGaooi250"
               #160318-00025#4--add--end
               IF NOT cl_chk_exist("v_ooca001") THEN
                  LET g_sfakwf2_d[l_ac].sfbcwf014 = g_sfakwf2_d_t.sfbcwf014
                  INITIALIZE g_ref_fields TO NULL
                  LET g_ref_fields[1] = g_sfakwf2_d[l_ac].sfbcwf014
                  CALL ap_ref_array2(g_ref_fields,"SELECT oocal003 FROM oocal_t WHERE oocalent='"||g_enterprise||"' AND oocal001=? AND oocal002='"||g_dlang||"'","") RETURNING g_rtn_fields
                  LET g_sfakwf2_d[l_ac].sfbcwf014_desc = '', g_rtn_fields[1] , ''
                  DISPLAY BY NAME g_sfakwf2_d[l_ac].sfbcwf014_desc
                  NEXT FIELD sfbcwf014
               END IF
               LET l_rate = ''
               LET l_imaa006 = ''
               IF NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf006) THEN 
                  SELECT imaa006 INTO l_imaa006 FROM imaa_t
                   WHERE imaaent = g_enterprise
                     AND imaa001 = g_sfakwf2_d[l_ac].sfbcwf006  
                  IF NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf006) AND NOT cl_null(l_imaa006) THEN
                     CALL s_aimi190_get_convert(g_sfakwf2_d[l_ac].sfbcwf006,g_sfakwf2_d[l_ac].sfbcwf014,l_imaa006) RETURNING l_success,l_rate
                     IF l_success = FALSE THEN
                        LET g_sfakwf2_d[l_ac].sfbcwf014 = g_sfakwf2_d_t.sfbcwf014
                        INITIALIZE g_ref_fields TO NULL
                        LET g_ref_fields[1] = g_sfakwf2_d[l_ac].sfbcwf014
                        CALL ap_ref_array2(g_ref_fields,"SELECT oocal003 FROM oocal_t WHERE oocalent='"||g_enterprise||"' AND oocal001=? AND oocal002='"||g_dlang||"'","") RETURNING g_rtn_fields
                        LET g_sfakwf2_d[l_ac].sfbcwf014_desc = '', g_rtn_fields[1] , ''
                        DISPLAY BY NAME g_sfakwf2_d[l_ac].sfbcwf014_desc 
                        NEXT FIELD sfbcwf014                        
                     END IF
                  END IF 
                  IF cl_null(l_imaa006) THEN
                     INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = 'abm-00021'
                  LET g_errparam.extend = l_imaa006
                  LET g_errparam.popup = TRUE
                  CALL cl_err()

                     LET g_sfakwf2_d[l_ac].sfbcwf014 = g_sfakwf2_d_t.sfbcwf014
                     INITIALIZE g_ref_fields TO NULL
                     LET g_ref_fields[1] = g_sfakwf2_d[l_ac].sfbcwf014
                     CALL ap_ref_array2(g_ref_fields,"SELECT oocal003 FROM oocal_t WHERE oocalent='"||g_enterprise||"' AND oocal001=? AND oocal002='"||g_dlang||"'","") RETURNING g_rtn_fields
                     LET g_sfakwf2_d[l_ac].sfbcwf014_desc = '', g_rtn_fields[1] , ''
                     DISPLAY BY NAME g_sfakwf2_d[l_ac].sfbcwf014_desc 
                     NEXT FIELD sfbcwf014 
                  END IF
                  #?????????????????
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_sfakwf2_d[l_ac].sfbcwf006
                  LET g_chkparam.arg2 = g_sfakwf2_d[l_ac].sfbcwf014
                 
                  #??????????library
                  IF NOT cl_chk_exist("v_imao002") THEN
                     LET g_sfakwf2_d[l_ac].sfbcwf014 = g_sfakwf2_d_o.sfbcwf014   #170504-00016#1 add
                     INITIALIZE g_ref_fields TO NULL
                     LET g_ref_fields[1] = g_sfakwf2_d[l_ac].sfbcwf014                     
                     CALL ap_ref_array2(g_ref_fields,"SELECT oocal003 FROM oocal_t WHERE oocalent='"||g_enterprise||"' AND oocal001=? AND oocal002='"||g_dlang||"'","") RETURNING g_rtn_fields
                     LET g_sfakwf2_d[l_ac].sfbcwf014_desc = '', g_rtn_fields[1] , ''
                     NEXT FIELD sfbcwf014 
                  END IF
                  #???????????
                  CALL bsft001_wf_get_incgwf_inan_qty(g_sfakwf2_d[l_ac].sfbcwf006,g_sfakwf2_d[l_ac].sfbcwf021,g_sfakwf2_d[l_ac].sfbcwf014,g_sfakwf2_d[l_ac].sfbcwf019,g_sfakwf2_d[l_ac].sfbcwf020,g_sfakwf2_d[l_ac].sfbcwf029,g_sfakwf2_d[l_ac].sfbcwf030) 
                     RETURNING g_sfakwf2_d[l_ac].number5,g_sfakwf2_d[l_ac].number6
               END IF 
            #170504-00016#1-S
            ELSE
               LET g_sfakwf2_d[l_ac].sfbcwf014_desc = ''
            #170504-00016#1-E           
            END IF
            LET g_sfakwf2_d_o.sfbcwf014 = g_sfakwf2_d[l_ac].sfbcwf014   #170504-00016#1 add

            #END add-point
            
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf014
            #add-point:BEFORE FIELD sfbcwf014 name="input.b.page2.sfbcwf014"

            #END add-point
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfbcwf014
            #add-point:ON CHANGE sfbcwf014 name="input.g.page2.sfbcwf014"

            #END add-point 
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf015
            #?? a15 ??????(Version:3)
            #???????????
            IF NOT cl_ap_chk_range(g_sfakwf2_d[l_ac].sfbcwf015,"0.000","1","","","azz-00079",1) THEN
               NEXT FIELD sfbcwf015
            END IF 
 
 
 
            #add-point:AFTER FIELD sfbcwf015 name="input.a.page2.sfbcwf015"
            IF cl_null(g_sfakwf2_d[l_ac].sfbcwf015) THEN 
               LET g_sfakwf2_d[l_ac].sfbcwf015 = 0
            END IF
            IF NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf015) THEN
               IF NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf013) THEN 
                  IF g_sfakwf2_d[l_ac].sfbcwf015 > g_sfakwf2_d[l_ac].sfbcwf013 THEN
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = 'asf-00087'
                     LET g_errparam.extend = g_sfakwf2_d[l_ac].sfbcwf015
                     LET g_errparam.popup = TRUE
                     CALL cl_err()

                     LET g_sfakwf2_d[l_ac].sfbcwf015 = g_sfakwf2_d_t.sfbcwf015
                     NEXT FIELD sfbcwf015
                  END IF
               END IF 
               #170612-00017#1 --s add
               #??????????????? > 0
               IF g_sfakwf2_d[l_ac].sfbcwf015 > 0 AND g_sfajwf_m.sfajwf005 = '2' THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = 'asf-00876' #????????????????
                  LET g_errparam.extend = g_sfakwf2_d[l_ac].sfbcwf015
                  LET g_errparam.popup = TRUE
                  CALL cl_err()
                  LET g_sfakwf2_d[l_ac].sfbcwf015 = g_sfakwf2_d_t.sfbcwf015
                  NEXT FIELD sfbcwf015
               END IF
               #170612-00017#1 --e add               
            END IF
            LET g_sfakwf2_d[l_ac].number1 = g_sfakwf2_d[l_ac].sfbcwf013 - g_sfakwf2_d[l_ac].sfbcwf015 - g_sfakwf2_d[l_ac].sfbcwf016
            IF g_sfakwf2_d[l_ac].number1 < 0 THEN
               LET g_sfakwf2_d[l_ac].number1 = 0
            END IF

            #END add-point
            
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf015
            #add-point:BEFORE FIELD sfbcwf015 name="input.b.page2.sfbcwf015"

            #END add-point
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfbcwf015
            #add-point:ON CHANGE sfbcwf015 name="input.g.page2.sfbcwf015"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf016
            #add-point:BEFORE FIELD sfbcwf016 name="input.b.page2.sfbcwf016"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf016
            
            #add-point:AFTER FIELD sfbcwf016 name="input.a.page2.sfbcwf016"
            IF cl_null(g_sfakwf2_d[l_ac].sfbcwf013) THEN 
               LET g_sfakwf2_d[l_ac].sfbcwf013 = 0
            END IF
            IF cl_null(g_sfakwf2_d[l_ac].sfbcwf016) THEN 
               LET g_sfakwf2_d[l_ac].sfbcwf016 = 0
            END IF 
            #LET g_sfakwf2_d[l_ac].number1 = g_sfakwf2_d[l_ac].sfbcwf013 - g_sfakwf2_d[l_ac].sfbcwf016 #170620-00066#1 mark
            LET g_sfakwf2_d[l_ac].number1 = g_sfakwf2_d[l_ac].sfbcwf013 - g_sfakwf2_d[l_ac].sfbcwf015 - g_sfakwf2_d[l_ac].sfbcwf016 #170620-00066#1 add ????????
            IF g_sfakwf2_d[l_ac].number1 < 0 THEN
               LET g_sfakwf2_d[l_ac].number1 = 0
            END IF
            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfbcwf016
            #add-point:ON CHANGE sfbcwf016 name="input.g.page2.sfbcwf016"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf025
            #add-point:BEFORE FIELD sfbcwf025 name="input.b.page2.sfbcwf025"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf025
            
            #add-point:AFTER FIELD sfbcwf025 name="input.a.page2.sfbcwf025"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfbcwf025
            #add-point:ON CHANGE sfbcwf025 name="input.g.page2.sfbcwf025"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD number1
            #add-point:BEFORE FIELD number1 name="input.b.page2.number1"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD number1
            
            #add-point:AFTER FIELD number1 name="input.a.page2.number1"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE number1
            #add-point:ON CHANGE number1 name="input.g.page2.number1"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf017
            #add-point:BEFORE FIELD sfbcwf017 name="input.b.page2.sfbcwf017"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf017
            
            #add-point:AFTER FIELD sfbcwf017 name="input.a.page2.sfbcwf017"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfbcwf017
            #add-point:ON CHANGE sfbcwf017 name="input.g.page2.sfbcwf017"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf018
            #add-point:BEFORE FIELD sfbcwf018 name="input.b.page2.sfbcwf018"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf018
            
            #add-point:AFTER FIELD sfbcwf018 name="input.a.page2.sfbcwf018"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfbcwf018
            #add-point:ON CHANGE sfbcwf018 name="input.g.page2.sfbcwf018"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD number3
            #add-point:BEFORE FIELD number3 name="input.b.page2.number3"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD number3
            
            #add-point:AFTER FIELD number3 name="input.a.page2.number3"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE number3
            #add-point:ON CHANGE number3 name="input.g.page2.number3"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD number4
            #add-point:BEFORE FIELD number4 name="input.b.page2.number4"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD number4
            
            #add-point:AFTER FIELD number4 name="input.a.page2.number4"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE number4
            #add-point:ON CHANGE number4 name="input.g.page2.number4"

            #END add-point 
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf019
            
            #add-point:AFTER FIELD sfbcwf019 name="input.a.page2.sfbcwf019"
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_sfakwf2_d[l_ac].sfbcwf019
            CALL ap_ref_array2(g_ref_fields,"SELECT inaa002 FROM inaa_t WHERE inaaent="||g_enterprise||" AND inaasite=? AND inaa001=? ","") RETURNING g_rtn_fields
            LET g_sfakwf2_d[l_ac].sfbcwf019_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_sfakwf2_d[l_ac].sfbcwf019_desc

            IF NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf019) THEN
               IF g_sfakwf2_d[l_ac].sfbcwf019 != g_sfakwf2_d_o.sfbcwf019 OR cl_null(g_sfakwf2_d_o.sfbcwf019) THEN 
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 = g_sfakwf2_d[l_ac].sfbcwf019
                  #160318-00025#4--add--str
                  LET g_errshow = TRUE 
                  LET g_chkparam.err_str[1] = "aim-00065:sub-01302|aini001|",cl_get_progname("aini001",g_lang,"2"),"|:EXEPROGaini001"
                  #160318-00025#4--add--end
                  IF NOT cl_chk_exist("v_inaa001_2") THEN
                     LET g_sfakwf2_d[l_ac].sfbcwf019 = g_sfakwf2_d_t.sfbcwf019
                     LET g_sfakwf2_d[l_ac].sfbcwf019_desc = s_desc_get_stock_desc(g_site,g_sfakwf2_d[l_ac].sfbcwf019)
                     NEXT FIELD sfbcwf019
                  END IF
                  #???????????
                  CALL bsft001_wf_get_incgwf_inan_qty(g_sfakwf2_d[l_ac].sfbcwf006,g_sfakwf2_d[l_ac].sfbcwf021,g_sfakwf2_d[l_ac].sfbcwf014,g_sfakwf2_d[l_ac].sfbcwf019,g_sfakwf2_d[l_ac].sfbcwf020,g_sfakwf2_d[l_ac].sfbcwf029,g_sfakwf2_d[l_ac].sfbcwf030) 
                     RETURNING g_sfakwf2_d[l_ac].number5,g_sfakwf2_d[l_ac].number6
                  
                  #240325-00027#1 add--s  
                  #???????????????
                  INITIALIZE g_chkparam.* TO NULL
                  LET g_chkparam.arg1 =  g_sfakwf2_d[l_ac].sfbcwf019
                  #160318-00025#22  by 07900 --add-str
                  LET g_errshow = TRUE #????                   
                  LET g_chkparam.err_str[1] ="aim-00065:sub-01302|aini001|",cl_get_progname("aini001",g_lang,"2"),"|:EXEPROGaini001"
                  #160318-00025#22  by 07900 --add-end
                  IF cl_chk_exist_and_ref_val("v_inaa002_2") THEN
                     #?????????
                     LET  g_sfakwf2_d[l_ac].sfbcwf019_desc = g_chkparam.return1
                     LET l_inaa015 = g_chkparam.return2
                     LET l_inaa010 = g_chkparam.return3
                     IF cl_null(l_inaa015) THEN LET l_inaa015='N' END IF
                     IF cl_null(l_inaa010) THEN LET l_inaa010='N' END IF
                  ELSE
                     #?????????
                     LET g_sfakwf2_d[l_ac].sfbcwf019 = g_sfakwf2_d_t.sfbcwf019
                     LET g_sfakwf2_d[l_ac].sfbcwf019_desc = s_desc_get_stock_desc(g_site,g_sfakwf2_d[l_ac].sfbcwf019)
                     NEXT FIELD sfbcwf019
                  END IF                  
                  #??????????????
                  CALL cl_get_doc_para(g_enterprise,g_site,g_ooba002,'D-MFG-0052') RETURNING g_para
                  #1.?????????????(2???)
                  IF g_sfakwf2_d[l_ac].sfbcwf028='Y' AND l_inaa010='Y' AND g_para MATCHES '[12]' THEN
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = 'asf-00048'  #???????????
                     LET g_errparam.extend = g_sfakwf2_d[l_ac].sfbcwf019
                     LET g_errparam.popup = TRUE
                     CALL cl_err()
                     IF g_para = '1' THEN  #??
                        LET g_sfakwf2_d[l_ac].sfbcwf019 = g_sfakwf2_d_o.sfbcwf019
                        LET g_sfakwf2_d[l_ac].sfbcwf019 = g_sfakwf2_d_o.sfbcwf019
                        LET g_sfakwf2_d[l_ac].sfbcwf029 = g_sfakwf2_d_o.sfbcwf029
                        LET g_sfakwf2_d[l_ac].sfbcwf030 = g_sfakwf2_d_o.sfbcwf030
                        LET g_sfakwf2_d[l_ac].sfbcwf019_desc = s_desc_get_stock_desc(g_site,g_sfakwf2_d[l_ac].sfbcwf019)
                        NEXT FIELD CURRENT
                     END IF
                  END IF
                  #241212-00001#1 add--s
                  IF NOT s_icd_wf_chk_icd(g_sfajwf_m.sfajwfdocno,g_sfakwf2_d[l_ac].sfbcwfseq1,g_sfakwf2_d[l_ac].sfbcwfseq2,'-1') THEN                
                     LET g_sfakwf2_d[l_ac].sfbcwf019 = g_sfakwf2_d_o.sfbcwf019
                     LET g_sfakwf2_d[l_ac].sfbcwf029 = g_sfakwf2_d_o.sfbcwf029
                     LET g_sfakwf2_d[l_ac].sfbcwf020 = g_sfakwf2_d_o.sfbcwf020
                     LET g_sfakwf2_d[l_ac].sfbcwf019_desc = s_desc_get_stock_desc(g_site,g_sfakwf2_d[l_ac].sfbcwf019)
                     NEXT FIELD CURRENT
                  END IF    
                  #241212-00001#1 add--e
               END IF
               #240325-00027#1 add--e
             #170504-00016#1-S
             ELSE
                LET g_sfakwf2_d[l_ac].sfbcwf019_desc = ''
             #170504-00016#1-E
             END IF  
             #241212-00001#1 add--s
             IF NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf020) THEN
                IF g_sfakwf2_d[l_ac].sfbcwf020 != g_sfakwf2_d_o.sfbcwf020 OR cl_null(g_sfakwf2_d_o.sfbcwf020) THEN
                   IF NOT s_icd_wf_chk_icd(g_sfajwf_m.sfajwfdocno,g_sfakwf2_d[l_ac].sfbcwfseq1,g_sfakwf2_d[l_ac].sfbcwfseq2,'-1') THEN                
                      LET g_sfakwf2_d[l_ac].sfbcwf019 = g_sfakwf2_d_o.sfbcwf019
                      LET g_sfakwf2_d[l_ac].sfbcwf029 = g_sfakwf2_d_o.sfbcwf029
                      LET g_sfakwf2_d[l_ac].sfbcwf020 = g_sfakwf2_d_o.sfbcwf020
                      LET g_sfakwf2_d[l_ac].sfbcwf019_desc = s_desc_get_stock_desc(g_site,g_sfakwf2_d[l_ac].sfbcwf019)
                      NEXT FIELD CURRENT
                   END IF 
                END IF
             END IF
             IF NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf029) THEN
                IF g_sfakwf2_d[l_ac].sfbcwf029 != g_sfakwf2_d_o.sfbcwf029 OR cl_null(g_sfakwf2_d_o.sfbcwf029) THEN
                   IF NOT s_icd_wf_chk_icd(g_sfajwf_m.sfajwfdocno,g_sfakwf2_d[l_ac].sfbcwfseq1,g_sfakwf2_d[l_ac].sfbcwfseq2,'-1') THEN                
                      LET g_sfakwf2_d[l_ac].sfbcwf019 = g_sfakwf2_d_o.sfbcwf019
                      LET g_sfakwf2_d[l_ac].sfbcwf029 = g_sfakwf2_d_o.sfbcwf029
                      LET g_sfakwf2_d[l_ac].sfbcwf020 = g_sfakwf2_d_o.sfbcwf020
                      LET g_sfakwf2_d[l_ac].sfbcwf019_desc = s_desc_get_stock_desc(g_site,g_sfakwf2_d[l_ac].sfbcwf019)
                      NEXT FIELD CURRENT
                   END IF 
                END IF
             END IF
             LET g_sfakwf2_d_o.sfbcwf019 = g_sfakwf2_d[l_ac].sfbcwf019
             LET g_sfakwf2_d_o.sfbcwf020 = g_sfakwf2_d[l_ac].sfbcwf020
             LET g_sfakwf2_d_o.sfbcwf029 = g_sfakwf2_d[l_ac].sfbcwf029
             #241212-00001#1 add--e                    
             LET g_sfakwf2_d[l_ac].sfbcwf019_desc = s_desc_get_stock_desc(g_site,g_sfakwf2_d[l_ac].sfbcwf019)
             DISPLAY BY NAME g_sfakwf2_d[l_ac].sfbcwf019_desc            
             CALL bsft001_wf_set_entry_b(l_cmd)
             CALL bsft001_wf_set_no_entry_b(l_cmd)
            #END add-point
            
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf019
            #add-point:BEFORE FIELD sfbcwf019 name="input.b.page2.sfbcwf019"

            #END add-point
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfbcwf019
            #add-point:ON CHANGE sfbcwf019 name="input.g.page2.sfbcwf019"

            #END add-point 
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf020
            
            #add-point:AFTER FIELD sfbcwf020 name="input.a.page2.sfbcwf020"
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_sfakwf2_d[l_ac].sfbcwf020
            CALL ap_ref_array2(g_ref_fields,"SELECT inab003 FROM inab_t WHERE inabent="||g_enterprise||" AND inabsite=? AND inab001=? ","") RETURNING g_rtn_fields
            LET g_sfakwf2_d[l_ac].sfbcwf020_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_sfakwf2_d[l_ac].sfbcwf020_desc

            IF NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf020) THEN
                #170605-00020#11-s add                    
                SELECT inaa007 INTO l_inaa007 FROM inaa_t 
                 WHERE inaaent = g_enterprise 
                   AND inaasite = g_site 
                   AND inaa001 = g_sfakwf2_d[l_ac].sfbcwf019                    
                #?[T:?????].[C:????]='1'(??????-????)??????????????
                IF l_inaa007 = '1' THEN   
                   #170605-00020#11-s add        
                   INITIALIZE g_chkparam.* TO NULL
                   LET g_chkparam.arg1 = g_site
                   LET g_chkparam.arg2 = g_sfakwf2_d[l_ac].sfbcwf019
                   LET g_chkparam.arg3 = g_sfakwf2_d[l_ac].sfbcwf020
                   #160318-00025#4--add--str
                   LET g_errshow = TRUE 
                   LET g_chkparam.err_str[1] = "aim-00063:sub-01302|aini002|",cl_get_progname("aini002",g_lang,"2"),"|:EXEPROGaini002"
                   #160318-00025#4--add--end
                   IF NOT cl_chk_exist("v_inab002") THEN
                      LET g_sfakwf2_d[l_ac].sfbcwf020 = g_sfakwf2_d_t.sfbcwf020
                      LET g_sfakwf2_d[l_ac].sfbcwf020_desc = s_desc_get_locator_desc(g_site,g_sfakwf2_d[l_ac].sfbcwf019,g_sfakwf2_d[l_ac].sfbcwf020)
                      NEXT FIELD sfbcwf020
                   END IF
                END IF  #170605-00020#11 add
                #241212-00001#1 add--s
                IF g_sfakwf2_d[l_ac].sfbcwf020 != g_sfakwf2_d_o.sfbcwf020 OR cl_null(g_sfakwf2_d_o.sfbcwf020) THEN
                   IF NOT s_icd_wf_chk_icd(g_sfajwf_m.sfajwfdocno,g_sfakwf2_d[l_ac].sfbcwfseq1,g_sfakwf2_d[l_ac].sfbcwfseq2,'-1') THEN                
                      LET g_sfakwf2_d[l_ac].sfbcwf020 = g_sfakwf2_d_o.sfbcwf020
                      NEXT FIELD CURRENT
                   END IF    
                END IF   
                #241212-00001#1 add--e
                #???????????
                CALL bsft001_wf_get_incgwf_inan_qty(g_sfakwf2_d[l_ac].sfbcwf006,g_sfakwf2_d[l_ac].sfbcwf021,g_sfakwf2_d[l_ac].sfbcwf014,g_sfakwf2_d[l_ac].sfbcwf019,g_sfakwf2_d[l_ac].sfbcwf020,g_sfakwf2_d[l_ac].sfbcwf029,g_sfakwf2_d[l_ac].sfbcwf030) 
                  RETURNING g_sfakwf2_d[l_ac].number5,g_sfakwf2_d[l_ac].number6                
             #170504-00016#1-S
             ELSE
                LET g_sfakwf2_d[l_ac].sfbcwf020_desc = ''
             #170504-00016#1-E             
             END IF
             #241212-00001#1 add--s
             LET g_sfakwf2_d_o.sfbcwf019 = g_sfakwf2_d[l_ac].sfbcwf019
             LET g_sfakwf2_d_o.sfbcwf020 = g_sfakwf2_d[l_ac].sfbcwf020
             LET g_sfakwf2_d_o.sfbcwf029 = g_sfakwf2_d[l_ac].sfbcwf029
             #241212-00001#1 add--e                
             LET g_sfakwf2_d[l_ac].sfbcwf020_desc = s_desc_get_locator_desc(g_site,g_sfakwf2_d[l_ac].sfbcwf019,g_sfakwf2_d[l_ac].sfbcwf020)
             DISPLAY BY NAME g_sfakwf2_d[l_ac].sfbcwf020_desc  
            #END add-point
            
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf020
            #add-point:BEFORE FIELD sfbcwf020 name="input.b.page2.sfbcwf020"

            #END add-point
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfbcwf020
            #add-point:ON CHANGE sfbcwf020 name="input.g.page2.sfbcwf020"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf029
            #add-point:BEFORE FIELD sfbcwf029 name="input.b.page2.sfbcwf029"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf029
            
            #add-point:AFTER FIELD sfbcwf029 name="input.a.page2.sfbcwf029"
            IF g_sfbcwf029_switch = 'Y' THEN
               IF NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf029) THEN
                  IF g_sfakwf2_d[l_ac].sfbcwf029 != g_sfakwf2_d_o.sfbcwf029 OR cl_null(g_sfakwf2_d_o.sfbcwf029) THEN
                     #??????????
                     #IF g_prog[1,6]='asft31' AND NOT cl_null(g_sfakwf2_d[l_ac].sfdc007) AND NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf019) THEN  #???? ??  #170512-00023#1 mark
                     #241212-00001#1 add--s
                     IF NOT s_icd_wf_chk_icd(g_sfajwf_m.sfajwfdocno,g_sfakwf2_d[l_ac].sfbcwfseq1,g_sfakwf2_d[l_ac].sfbcwfseq2,'-1') THEN                
                        LET g_sfakwf2_d[l_ac].sfbcwf029 = g_sfakwf2_d_o.sfbcwf029
                        NEXT FIELD CURRENT
                     END IF    
                     #241212-00001#1 add--e
                     IF cl_null(g_sfakwf2_d[l_ac].sfbcwf030) THEN LET g_sfakwf2_d[l_ac].sfbcwf030= ' ' END IF  #??????
                     IF cl_null(g_sfakwf2_d[l_ac].sfbcwf020) THEN LET g_sfakwf2_d[l_ac].sfbcwf020= ' ' END IF  #??
                     IF cl_null(g_sfakwf2_d[l_ac].sfbcwf029) THEN LET g_sfakwf2_d[l_ac].sfbcwf029= ' ' END IF  #??
                     #170512-00023#1-s
                     CALL s_aooi200_get_slip(g_sfajwf_m.sfajwfdocno) RETURNING l_success,g_ooba002
                     CALL cl_get_doc_para(g_enterprise,g_site,g_ooba002,'D-BAS-0070') RETURNING g_para
#                     IF g_prog[1,6]='asft31' AND NOT cl_null(g_sfakwf2_d[l_ac].sfdc007) AND g_para = 'Y' THEN
#                     #170512-00023#1-e
#                        #????????????????????????????????????-???????????????
#                        #                           ??   ????                ????                ??????
#                        CALL s_inventory_check_inan(g_site,g_sfakwf2_d[l_ac].sfbcwf006,g_sfakwf2_d[l_ac].sfbcwf021,g_sfakwf2_d[l_ac].sfbcwf030,
#                        #                           ??                   ??                    ??
#                                                    g_sfakwf2_d[l_ac].sfbcwf019,g_sfakwf2_d[l_ac].sfbcwf020,g_sfakwf2_d[l_ac].sfbcwf029,
#                        #                           ????                ????
#                                                    g_sfakwf2_d[l_ac].sfbcwf014,g_sfakwf2_d[l_ac].sfdc007,
#                        #                           ????                     ??                   ??
#                                                    g_sfajwf_m.sfajwfdocno,g_sfakwf2_d[l_ac].sfdcseq,'0',
#                        #                           ????     ???? 
#                                                    '','','') #160408-00035#9-add   #170724-00041#4 by sakura add ????,''
#                             RETURNING l_success,l_flag2
#                        IF NOT l_flag2 THEN
#                           LET g_sfakwf2_d[l_ac].sfbcwf019 = g_sfakwf2_d_o.sfbcwf019
#                           LET g_sfakwf2_d[l_ac].sfbcwf020 = g_sfakwf2_d_o.sfbcwf020
#                           LET g_sfakwf2_d[l_ac].sfbcwf029 = g_sfakwf2_d_o.sfbcwf029
#                           LET g_sfakwf2_d[l_ac].sfbcwf030 = g_sfakwf2_d_o.sfbcwf030
#                           NEXT FIELD CURRENT
#                        END IF
#                     END IF
                     #170829-00031#1 add --(S)--
                     CALL cl_get_doc_para(g_enterprise,g_site,g_ooba002,'D-MFG-0058') RETURNING g_para
                     IF cl_null(g_para) THEN LET g_para = 'N' END IF
                     #??????????????????????????
                     # IF g_prog[1,6]='asft32' AND g_para = 'Y' AND NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf029) THEN
                     #    #                            ????                ????               ????                
                     #    IF NOT s_asft310_chk_sfdd005(g_sfakwf2_d[l_ac].sfdc001,g_sfakwf2_d[l_ac].sfdc002,g_sfakwf2_d[l_ac].sfdc003,
                     #    #                            ?????                ??                   ??
                     #                                 g_sfda_m.sfdadocno,g_sfakwf2_d[l_ac].sfdcseq,'0',
                     #    #                            ????                ????
                     #                                 g_sfakwf2_d[l_ac].sfbcwf006,g_sfakwf2_d[l_ac].sfbcwf021,
                     #    #                            ??                   ??
                     #                                 g_sfakwf2_d[l_ac].sfbcwf029,g_sfakwf2_d[l_ac].sfdc007) THEN                  
                     #       LET g_sfakwf2_d[l_ac].sfbcwf029 = g_sfakwf2_d_o.sfbcwf029
                     #       NEXT FIELD CURRENT                   
                     #    END IF                         
                     # END IF
                     #170829-00031#1 add --(E)--
                     #180130-00007#1 add --(S)--
                     CALL bsft001_wf_get_incgwf_inan_qty(g_sfakwf2_d[l_ac].sfbcwf006,g_sfakwf2_d[l_ac].sfbcwf021,g_sfakwf2_d[l_ac].sfbcwf014,g_sfakwf2_d[l_ac].sfbcwf019,g_sfakwf2_d[l_ac].sfbcwf020,g_sfakwf2_d[l_ac].sfbcwf029,g_sfakwf2_d[l_ac].sfbcwf030) 
                        RETURNING g_sfakwf2_d[l_ac].number5,g_sfakwf2_d[l_ac].number6
                     #180130-00007#1 add --(E)--  
                  END IF
               END IF
            END IF
            LET g_sfakwf2_d_o.sfbcwf019 = g_sfakwf2_d[l_ac].sfbcwf019
            LET g_sfakwf2_d_o.sfbcwf020 = g_sfakwf2_d[l_ac].sfbcwf020
            LET g_sfakwf2_d_o.sfbcwf029 = g_sfakwf2_d[l_ac].sfbcwf029
            LET g_sfakwf2_d_o.sfbcwf030 = g_sfakwf2_d[l_ac].sfbcwf030
            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfbcwf029
            #add-point:ON CHANGE sfbcwf029 name="input.g.page2.sfbcwf029"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf039
            #add-point:BEFORE FIELD sfbcwf039 name="input.b.page2.sfbcwf039"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf039
            
            #add-point:AFTER FIELD sfbcwf039 name="input.a.page2.sfbcwf039"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfbcwf039
            #add-point:ON CHANGE sfbcwf039 name="input.g.page2.sfbcwf039"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf030
            #add-point:BEFORE FIELD sfbcwf030 name="input.b.page2.sfbcwf030"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf030
            
            #add-point:AFTER FIELD sfbcwf030 name="input.a.page2.sfbcwf030"
            #??????????????????????????????????????????????????????
            IF g_sfbcwf030_switch = 'Y' THEN
               IF NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf030) THEN
                  IF g_sfakwf2_d[l_ac].sfbcwf030 != g_sfakwf2_d_o.sfbcwf030 OR cl_null(g_sfakwf2_d_o.sfbcwf030) THEN
                  END IF
                  #180130-00007#1 add --(S)--
                  CALL bsft001_wf_get_incgwf_inan_qty(g_sfakwf2_d[l_ac].sfbcwf006,g_sfakwf2_d[l_ac].sfbcwf021,g_sfakwf2_d[l_ac].sfbcwf014,g_sfakwf2_d[l_ac].sfbcwf019,g_sfakwf2_d[l_ac].sfbcwf020,g_sfakwf2_d[l_ac].sfbcwf029,g_sfakwf2_d[l_ac].sfbcwf030) 
                     RETURNING g_sfakwf2_d[l_ac].number5,g_sfakwf2_d[l_ac].number6
                  #180130-00007#1 add --(E)--  
               END IF
            END IF
            LET g_sfakwf2_d_o.sfbcwf019 = g_sfakwf2_d[l_ac].sfbcwf019
            LET g_sfakwf2_d_o.sfbcwf020 = g_sfakwf2_d[l_ac].sfbcwf020
            LET g_sfakwf2_d_o.sfbcwf029 = g_sfakwf2_d[l_ac].sfbcwf029
            LET g_sfakwf2_d_o.sfbcwf030 = g_sfakwf2_d[l_ac].sfbcwf030
            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfbcwf030
            #add-point:ON CHANGE sfbcwf030 name="input.g.page2.sfbcwf030"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf040
            #add-point:BEFORE FIELD sfbcwf040 name="input.b.page2.sfbcwf040"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf040
            
            #add-point:AFTER FIELD sfbcwf040 name="input.a.page2.sfbcwf040"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfbcwf040
            #add-point:ON CHANGE sfbcwf040 name="input.g.page2.sfbcwf040"

            #END add-point 
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf041
            
            #add-point:AFTER FIELD sfbcwf041 name="input.a.page2.sfbcwf041"
            #240423-00009#2 --s
            #??????
            IF NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf041) THEN
               SELECT wfagwfl003 INTO g_sfakwf2_d[l_ac].sfbcwf041_desc FROM wfagwfl_t
                 WHERE wfagwflent = g_enterprise AND wfagwfl001 = g_sfakwf2_d[l_ac].sfbcwf041 AND wfagwfl002 = g_dlang
               DISPLAY g_sfakwf2_d[l_ac].sfbcwf041_desc TO sfbcwf041_desc
            END IF
            #240423-00009#2 --e

            #END add-point
            
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf041
            #add-point:BEFORE FIELD sfbcwf041 name="input.b.page2.sfbcwf041"

            #END add-point
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfbcwf041
            #add-point:ON CHANGE sfbcwf041 name="input.g.page2.sfbcwf041"

            #END add-point 
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf042
            
            #add-point:AFTER FIELD sfbcwf042 name="input.a.page2.sfbcwf042"
            #240423-00009#2 --s
            #??????
            IF NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf042) THEN
               SELECT wfaiwfl003 INTO g_sfakwf2_d[l_ac].sfbcwf042_desc FROM wfaiwfl_t
                 WHERE wfaiwflent = g_enterprise AND wfaiwfl001 = g_sfakwf2_d[l_ac].sfbcwf042 AND wfaiwfl002 = g_dlang
                 DISPLAY g_sfakwf2_d[l_ac].sfbcwf042_desc TO sfbcwf042_desc
            END IF 
            #240423-00009#2 --e

            #END add-point
            
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf042
            #add-point:BEFORE FIELD sfbcwf042 name="input.b.page2.sfbcwf042"

            #END add-point
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfbcwf042
            #add-point:ON CHANGE sfbcwf042 name="input.g.page2.sfbcwf042"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf028
            #add-point:BEFORE FIELD sfbcwf028 name="input.b.page2.sfbcwf028"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf028
            
            #add-point:AFTER FIELD sfbcwf028 name="input.a.page2.sfbcwf028"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfbcwf028
            #add-point:ON CHANGE sfbcwf028 name="input.g.page2.sfbcwf028"

            #END add-point 
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf001
            
            #add-point:AFTER FIELD sfbcwf001 name="input.a.page2.sfbcwf001"
#            INITIALIZE g_ref_fields TO NULL
#            LET g_ref_fields[1] = g_sfakwf2_d[l_ac].sfbcwf001
#            CALL ap_ref_array2(g_ref_fields,"SELECT imaal003 FROM imaal_t WHERE imaalent="||g_enterprise||" AND imaal001=? AND imaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
#            LET g_sfakwf2_d[l_ac].sfbcwf001_desc = '', g_rtn_fields[1] , ''
#            DISPLAY BY NAME g_sfakwf2_d[l_ac].sfbcwf001_desc

            IF cl_null(g_sfakwf2_d[l_ac].sfbcwf001) THEN 
               LET g_sfakwf2_d[l_ac].sfbcwf001_desc = ''
               LET g_sfakwf2_d[l_ac].sfbcwf001_desc_1 = ''
            END IF 
            #170504-00016#1-E add            
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_sfakwf2_d[l_ac].sfbcwf001
            CALL ap_ref_array2(g_ref_fields,"SELECT imaal003,imaal004 FROM imaal_t WHERE imaalent='"||g_enterprise||"' AND imaal001=? AND imaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_sfakwf2_d[l_ac].sfbcwf001_desc = '', g_rtn_fields[1] , ''
            LET g_sfakwf2_d[l_ac].sfbcwf001_desc_1 = '', g_rtn_fields[2] , ''
            DISPLAY BY NAME g_sfakwf2_d[l_ac].sfbcwf001_desc
            DISPLAY BY NAME g_sfakwf2_d[l_ac].sfbcwf001_desc_1   
            #END add-point
            
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf001
            #add-point:BEFORE FIELD sfbcwf001 name="input.b.page2.sfbcwf001"

            #END add-point
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfbcwf001
            #add-point:ON CHANGE sfbcwf001 name="input.g.page2.sfbcwf001"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf026
            #add-point:BEFORE FIELD sfbcwf026 name="input.b.page2.sfbcwf026"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf026
            
            #add-point:AFTER FIELD sfbcwf026 name="input.a.page2.sfbcwf026"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfbcwf026
            #add-point:ON CHANGE sfbcwf026 name="input.g.page2.sfbcwf026"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf027
            #add-point:BEFORE FIELD sfbcwf027 name="input.b.page2.sfbcwf027"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf027
            
            #add-point:AFTER FIELD sfbcwf027 name="input.a.page2.sfbcwf027"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfbcwf027
            #add-point:ON CHANGE sfbcwf027 name="input.g.page2.sfbcwf027"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD ooff013
            #add-point:BEFORE FIELD ooff013 name="input.b.page2.ooff013"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD ooff013
            
            #add-point:AFTER FIELD ooff013 name="input.a.page2.ooff013"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE ooff013
            #add-point:ON CHANGE ooff013 name="input.g.page2.ooff013"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf043
            #add-point:BEFORE FIELD sfbcwf043 name="input.b.page2.sfbcwf043"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf043
            
            #add-point:AFTER FIELD sfbcwf043 name="input.a.page2.sfbcwf043"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfbcwf043
            #add-point:ON CHANGE sfbcwf043 name="input.g.page2.sfbcwf043"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfbcwf049
            #add-point:BEFORE FIELD sfbcwf049 name="input.b.page2.sfbcwf049"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfbcwf049
            
            #add-point:AFTER FIELD sfbcwf049 name="input.a.page2.sfbcwf049"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfbcwf049
            #add-point:ON CHANGE sfbcwf049 name="input.g.page2.sfbcwf049"

            #END add-point 
 
 
 
                  #Ctrlp:input.c.page2.sfbcwfseq1
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwfseq1
            #add-point:ON ACTION controlp INFIELD sfbcwfseq1 name="input.c.page2.sfbcwfseq1"

            #END add-point
 
 
         #Ctrlp:input.c.page2.sfbcwfseq2
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwfseq2
            #add-point:ON ACTION controlp INFIELD sfbcwfseq2 name="input.c.page2.sfbcwfseq2"

            #END add-point
 
 
         #Ctrlp:input.c.page2.sfbcwf002
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf002
            #add-point:ON ACTION controlp INFIELD sfbcwf002 name="input.c.page2.sfbcwf002"
            #?? a07 ??????(Version:3)   
            #??i?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
 
            LET g_qryparam.default1 = g_sfakwf2_d[l_ac].sfbcwf002             #??default?
            LET g_qryparam.default2 = "" #g_sfakwf2_d[l_ac].oocql004 #??
            #??arg
            LET g_qryparam.arg1 = "215"

 
            CALL q_oocq002()                                #????
 
            LET g_sfakwf2_d[l_ac].sfbcwf002 = g_qryparam.return1              
            #LET g_sfakwf2_d[l_ac].oocql004 = g_qryparam.return2 
            DISPLAY g_sfakwf2_d[l_ac].sfbcwf002 TO sfbcwf002              #
            #DISPLAY g_sfakwf2_d[l_ac].oocql004 TO oocql004 #??
            NEXT FIELD sfbcwf002                          #?????

            #END add-point
 
 
         #Ctrlp:input.c.page2.sfbcwf003
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf003
            #add-point:ON ACTION controlp INFIELD sfbcwf003 name="input.c.page2.sfbcwf003"
            #?? a07 ??????(Version:3)   
            #??i?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
 
            LET g_qryparam.default1 = g_sfakwf2_d[l_ac].sfbcwf003             #??default?
            LET g_qryparam.default2 = "" #g_sfakwf2_d[l_ac].oocql004 #??
            #??arg
            LET g_qryparam.arg1 = "" #s
            #LET g_qryparam.where = " ecbb001 = '",g_sfakwf_d[l_ac].sfakwf001,"' AND ecbb002 = '",g_sfaa_m.sfaa016,"' "
            LET g_qryparam.where = " ecbb001 = '",g_sfakwf_d[g_detail_idx].sfakwf001,"' "
 
            CALL q_ecbb004()                                #????
 
            LET g_sfakwf2_d[l_ac].sfbcwf003 = g_qryparam.return1              
            LET g_sfakwf2_d[l_ac].sfbcwf004 = g_qryparam.return2 
            LET g_qryparam.where = ""
            DISPLAY g_sfakwf2_d[l_ac].sfbcwf003 TO sfbcwf003              #
            DISPLAY g_sfakwf2_d[l_ac].sfbcwf004 TO sfbcwf004 #??
            NEXT FIELD sfbcwf003                          #?????

            #END add-point
 
 
         #Ctrlp:input.c.page2.sfbcwf004
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf004
            #add-point:ON ACTION controlp INFIELD sfbcwf004 name="input.c.page2.sfbcwf004"

            #END add-point
 
 
         #Ctrlp:input.c.page2.sfbcwf005
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf005
            #add-point:ON ACTION controlp INFIELD sfbcwf005 name="input.c.page2.sfbcwf005"
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_sfakwf2_d[l_ac].sfbcwf005
            #161124-00021#1 add------s---           
            IF g_sfajwf_m.sfajwf003='2' THEN
               LET g_qryparam.where = " imaa004 <> 'X' "
               #170618-00477#4-s-add
               #?????????
               LET g_qryparam.where = g_qryparam.where," AND EXISTS (SELECT imaf001 ",
                                                       "               FROM imaf_t,oocq_t ",
                                                       "              WHERE imafent = oocqent",
                                                       "                AND imafent = ",g_enterprise,                
                                                       "                AND imafsite = '",g_site,"'",
                                                       "                AND imaf016 = oocq002",
                                                       "                AND imaf001 = imaa001",
                                                       "                AND oocq001 = '210' ",
                                                       "                AND oocq009 = 'N' AND oocqstus = 'Y' ) "  
               #170618-00477#4-e-add
               CALL q_imaa001_10()
            ELSE
            #161124-00021#1 add------e---
               LET g_qryparam.arg1 = g_sfakwf_d[g_detail_idx].sfakwf001
               LET g_qryparam.arg2 = g_sfakwf_d[g_detail_idx].sfakwf003
               #160623-00009#1-add-(S)
               LET g_qryparam.where = " bmba003 IN (SELECT imaa001 FROM imaa_t ",
                                      "              WHERE imaaent = '",g_enterprise,"'",
                                      "                AND imaa004 <> 'X') "
               #160623-00009#1-add-(E)
               #170618-00477#4-s-add
               #?????????
               LET g_qryparam.where = g_qryparam.where," AND EXISTS (SELECT imaf001 ",
                                                       "               FROM imaf_t,oocq_t ",
                                                       "              WHERE imafent = oocqent",
                                                       "                AND imafent = ",g_enterprise,                
                                                       "                AND imafsite = '",g_site,"'",
                                                       "                AND imaf016 = oocq002",
                                                       "                AND imaf001 = bmba003",
                                                       "                AND oocq001 = '210' ",
                                                       "                AND oocq009 = 'N' AND oocqstus = 'Y' ) "                                                             
               #170618-00477#4-e-add
               IF NOT cl_null(g_sfakwf_d[g_detail_idx].sfakwf043) THEN
                  LET g_qryparam.arg3 = g_sfakwf_d[g_detail_idx].sfakwf043
               ELSE
                 #LET g_qryparam.arg3 = cl_get_today()     #181009-00009#1 mark
                  LET g_qryparam.arg3 = cl_get_current()   #181009-00009#1 add
               END IF
               CALL q_bmba003_2()
            END IF #161124-00021#1 add
            LET g_sfakwf2_d[l_ac].sfbcwf005 = g_qryparam.return1 
            #?????????1?????bom??????????
            CALL s_aooi200_get_slip(g_sfajwf_m.sfajwfdocno) RETURNING l_success,l_ooba002
            IF cl_get_doc_para(g_enterprise,g_site,l_ooba002,'D-MFG-0024') != '1' THEN
               IF cl_null(g_sfakwf2_d[l_ac].sfbcwf005) THEN
                  LET g_qryparam.where = ""  #160727-00025#1      
                  CALL q_imaf001_6()
                  LET g_sfakwf2_d[l_ac].sfbcwf005 = g_qryparam.return1
               END IF
            END IF
            
            NEXT FIELD sfbcwf005
            #END add-point
 
 
         #Ctrlp:input.c.page2.sfbcwf022
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf022
            #add-point:ON ACTION controlp INFIELD sfbcwf022 name="input.c.page2.sfbcwf022"

            #END add-point
 
 
         #Ctrlp:input.c.page2.sfbcwf006
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf006
            #add-point:ON ACTION controlp INFIELD sfbcwf006 name="input.c.page2.sfbcwf006"
            #?? a07 ??????(Version:3)   
            #??i?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
 
            LET g_qryparam.default1 = g_sfakwf2_d[l_ac].sfbcwf006             #??default?

            #??arg
            LET g_qryparam.arg1 = g_site
            LET g_qryparam.arg2 = g_sfakwf_d[g_detail_idx].sfakwf001
            LET g_qryparam.arg3 = g_sfakwf_d[g_detail_idx].sfakwf002
            LET g_qryparam.arg4 = g_sfakwf2_d[l_ac].sfbcwf005
            LET g_qryparam.arg5 = g_sfakwf2_d[l_ac].sfbcwf002
            LET g_qryparam.arg6 = g_sfakwf2_d[l_ac].sfbcwf003
            LET g_qryparam.arg7 = g_sfakwf2_d[l_ac].sfbcwf004
            IF g_qryparam.arg3 IS NULL THEN LET g_qryparam.arg3 = ' ' END IF
            IF g_qryparam.arg5 IS NULL THEN LET g_qryparam.arg5 = ' ' END IF
            IF g_qryparam.arg6 IS NULL THEN LET g_qryparam.arg6 = ' ' END IF
            IF g_qryparam.arg7 IS NULL THEN LET g_qryparam.arg7 = ' ' END IF
            
            #160623-00009#1-add-(S)
            LET g_qryparam.where = " bmea008 IN (SELECT imaa001 FROM imaa_t ",
                                   "              WHERE imaaent = '",g_enterprise,"'",
                                   "                AND imaa004 <> 'X') "
            #160623-00009#1-add-(E)
            #170618-00477#4-s-add
            #?????????
            LET g_qryparam.where = g_qryparam.where," AND EXISTS (SELECT imaf001 ",
                                                    "               FROM imaf_t,oocq_t ",
                                                    "              WHERE imafent = oocqent",
                                                    "                AND imafent = ",g_enterprise,                
                                                    "                AND imafsite = '",g_site,"'",
                                                    "                AND imaf016 = oocq002",
                                                    "                AND imaf001 = bmea008",
                                                    "                AND oocq001 = '210' ",
                                                    "                AND oocq009 = 'N' AND oocqstus = 'Y' ) "                                                             
            #170618-00477#4-e-add
            #220216-00008#1-s
            LET g_qryparam.where = g_qryparam.where," AND bmea009 <= '",g_sfajwf_m.sfajwfdocdt,"' ",
                                                    " AND (bmea010 > '",g_sfajwf_m.sfajwfdocdt,"' OR bmea010 IS NULL) "
            #220216-00008#1-e
            #220519-00022#1-s
             #????????
#            LET g_qryparam.where = g_qryparam.where," AND (bmea014 = 'N' OR (bmea014 = 'Y' ",
#                                                    " AND EXISTS (SELECT 1 FROM bmeb_t WHERE bmebent=bmeaent AND bmebsite=bmeasite ",
#                                                    " AND bmeb001=bmea001 AND bmeb002=bmea002 AND bmeb003=bmea003 AND bmeb004=bmea004 ",
#                                                    " AND bmeb005=bmea005 AND bmeb006=bmea006 AND bmeb007=bmea007 AND bmeb008=bmea008 ",
#                                                    " AND bmeb009='",g_sfaa_m.sfaa009,"' AND bmeb010=bmea019))) "
            #220519-00022#1-e
 
            CALL q_bmea008_2()                                #????
 
            LET g_sfakwf2_d[l_ac].sfbcwf006 = g_qryparam.return1              

            DISPLAY g_sfakwf2_d[l_ac].sfbcwf006 TO sfbcwf006              #

            NEXT FIELD sfbcwf006                          #?????



            #END add-point
 
 
         #Ctrlp:input.c.page2.sfbcwf033
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf033
            #add-point:ON ACTION controlp INFIELD sfbcwf033 name="input.c.page2.sfbcwf033"

            #END add-point
 
 
         #Ctrlp:input.c.page2.imaf013
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD imaf013
            #add-point:ON ACTION controlp INFIELD imaf013 name="input.c.page2.imaf013"

            #END add-point
 
 
         #Ctrlp:input.c.page2.sfbcwf021
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf021
            #add-point:ON ACTION controlp INFIELD sfbcwf021 name="input.c.page2.sfbcwf021"

            #END add-point
 
 
         #Ctrlp:input.c.page2.sfbcwf007
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf007
            #add-point:ON ACTION controlp INFIELD sfbcwf007 name="input.c.page2.sfbcwf007"

            #END add-point
 
 
         #Ctrlp:input.c.page2.sfbcwf008
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf008
            #add-point:ON ACTION controlp INFIELD sfbcwf008 name="input.c.page2.sfbcwf008"

            #END add-point
 
 
         #Ctrlp:input.c.page2.sfbcwf009
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf009
            #add-point:ON ACTION controlp INFIELD sfbcwf009 name="input.c.page2.sfbcwf009"

            #END add-point
 
 
         #Ctrlp:input.c.page2.sfbcwf010
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf010
            #add-point:ON ACTION controlp INFIELD sfbcwf010 name="input.c.page2.sfbcwf010"

            #END add-point
 
 
         #Ctrlp:input.c.page2.sfbcwf011
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf011
            #add-point:ON ACTION controlp INFIELD sfbcwf011 name="input.c.page2.sfbcwf011"

            #END add-point
 
 
         #Ctrlp:input.c.page2.sfbcwf012
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf012
            #add-point:ON ACTION controlp INFIELD sfbcwf012 name="input.c.page2.sfbcwf012"

            #END add-point
 
 
         #Ctrlp:input.c.page2.sfbcwf023
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf023
            #add-point:ON ACTION controlp INFIELD sfbcwf023 name="input.c.page2.sfbcwf023"

            #END add-point
 
 
         #Ctrlp:input.c.page2.sfbcwf024
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf024
            #add-point:ON ACTION controlp INFIELD sfbcwf024 name="input.c.page2.sfbcwf024"

            #END add-point
 
 
         #Ctrlp:input.c.page2.sfbcwf013
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf013
            #add-point:ON ACTION controlp INFIELD sfbcwf013 name="input.c.page2.sfbcwf013"

            #END add-point
 
 
         #Ctrlp:input.c.page2.sfbcwf047
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf047
            #add-point:ON ACTION controlp INFIELD sfbcwf047 name="input.c.page2.sfbcwf047"

            #END add-point
 
 
         #Ctrlp:input.c.page2.sfbcwf048
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf048
            #add-point:ON ACTION controlp INFIELD sfbcwf048 name="input.c.page2.sfbcwf048"

            #END add-point
 
 
         #Ctrlp:input.c.page2.number5
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD number5
            #add-point:ON ACTION controlp INFIELD number5 name="input.c.page2.number5"

            #END add-point
 
 
         #Ctrlp:input.c.page2.number6
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD number6
            #add-point:ON ACTION controlp INFIELD number6 name="input.c.page2.number6"

            #END add-point
 
 
         #Ctrlp:input.c.page2.sfbcwf014
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf014
            #add-point:ON ACTION controlp INFIELD sfbcwf014 name="input.c.page2.sfbcwf014"
            #?? a07 ??????(Version:3)   
            #??i?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
 
            LET g_qryparam.default1 = g_sfakwf2_d[l_ac].sfbcwf014             #??default?

            #??arg
            LET g_qryparam.arg1 = g_sfakwf2_d[l_ac].sfbcwf006 #??

 
            CALL q_imao002()                                #????
 
            LET g_sfakwf2_d[l_ac].sfbcwf014 = g_qryparam.return1              

            DISPLAY g_sfakwf2_d[l_ac].sfbcwf014 TO sfbcwf014              #

            NEXT FIELD sfbcwf014                          #????? 
            #END add-point
 
 
         #Ctrlp:input.c.page2.sfbcwf015
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf015
            #add-point:ON ACTION controlp INFIELD sfbcwf015 name="input.c.page2.sfbcwf015"

            #END add-point
 
 
         #Ctrlp:input.c.page2.sfbcwf016
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf016
            #add-point:ON ACTION controlp INFIELD sfbcwf016 name="input.c.page2.sfbcwf016"

            #END add-point
 
 
         #Ctrlp:input.c.page2.sfbcwf025
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf025
            #add-point:ON ACTION controlp INFIELD sfbcwf025 name="input.c.page2.sfbcwf025"

            #END add-point
 
 
         #Ctrlp:input.c.page2.number1
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD number1
            #add-point:ON ACTION controlp INFIELD number1 name="input.c.page2.number1"

            #END add-point
 
 
         #Ctrlp:input.c.page2.sfbcwf017
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf017
            #add-point:ON ACTION controlp INFIELD sfbcwf017 name="input.c.page2.sfbcwf017"

            #END add-point
 
 
         #Ctrlp:input.c.page2.sfbcwf018
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf018
            #add-point:ON ACTION controlp INFIELD sfbcwf018 name="input.c.page2.sfbcwf018"

            #END add-point
 
 
         #Ctrlp:input.c.page2.number3
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD number3
            #add-point:ON ACTION controlp INFIELD number3 name="input.c.page2.number3"

            #END add-point
 
 
         #Ctrlp:input.c.page2.number4
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD number4
            #add-point:ON ACTION controlp INFIELD number4 name="input.c.page2.number4"

            #END add-point
 
 
         #Ctrlp:input.c.page2.sfbcwf019
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf019
            #add-point:ON ACTION controlp INFIELD sfbcwf019 name="input.c.page2.sfbcwf019"
            #?? a07 ??????(Version:3)   
            #??i?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = "i"
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_sfakwf2_d[l_ac].sfbcwf019 #??????
            LET g_qryparam.default2 = g_sfakwf2_d[l_ac].sfbcwf020 #??????
            LET g_qryparam.default3 = g_sfakwf2_d[l_ac].sfbcwf029 #??????
            LET g_qryparam.default4 = g_sfakwf2_d[l_ac].sfbcwf030 #????????

            #??arg
            LET g_qryparam.arg1 = g_sfakwf2_d[l_ac].sfbcwf006
            IF cl_null(g_sfakwf2_d[l_ac].sfbcwf021) THEN
               LET g_qryparam.arg2 = ' '
            ELSE
               LET g_qryparam.arg2 = g_sfakwf2_d[l_ac].sfbcwf021
            END IF

            #????????
            LET g_qryparam.where = "1=1 "
            #add 150107
            LET l_sfbcwf019=''
            LET l_sfbcwf020=''
            LET l_sfbcwf029=''
            LET l_sfbcwf030=''
            SELECT sfbcwf019,sfbcwf020,sfbcwf029,sfbcwf030
              INTO l_sfbcwf019,l_sfbcwf020,l_sfbcwf029,l_sfbcwf030
              FROM sfbcwf_t
             WHERE sfbcwfent  = g_enterprise
               AND sfbcwfdocno= g_sfajwf_m.sfajwfdocno
               AND sfbcwfseq  = g_sfakwf_d[g_detail_idx].sfakwfseq
               AND sfbcwfseq1 = g_sfakwf2_d[l_ac].sfbcwfseq1
               AND sfbcwfseq2 = g_sfakwf2_d[l_ac].sfbcwfseq2
            IF g_sfbcwf020_switch = 'N' THEN
               IF cl_null(g_sfakwf2_d[l_ac].sfbcwf020) THEN
                  #mod 150107
                  #LET g_qryparam.where = g_qryparam.where ," AND inag005 = ' ' "
                  IF NOT cl_null(l_sfbcwf020) THEN
                     LET g_qryparam.where = g_qryparam.where ," AND inag005 = '",l_sfbcwf020,"' "
                  ELSE
                     LET g_qryparam.where = g_qryparam.where ," AND inag005 = ' ' "
                  END IF
                  #mod 150107 end
               ELSE
                  LET g_qryparam.where = g_qryparam.where ," AND inag005 = '",g_sfakwf2_d[l_ac].sfbcwf020,"' "
               END IF
            END IF
            IF g_sfbcwf029_switch = 'N' THEN
               IF cl_null(g_sfakwf2_d[l_ac].sfbcwf029) THEN
                  #mod 150107
                  #LET g_qryparam.where = g_qryparam.where ," AND inag006 = ' ' "
                  IF NOT cl_null(l_sfbcwf029) THEN
                     LET g_qryparam.where = g_qryparam.where ," AND inag006 = '",l_sfbcwf029,"' "
                  ELSE
                     LET g_qryparam.where = g_qryparam.where ," AND inag006 = ' ' "
                  END IF
                  #mod 150107 end
               ELSE
                  LET g_qryparam.where = g_qryparam.where ," AND inag006 = '",g_sfakwf2_d[l_ac].sfbcwf029,"' "
               END IF
            END IF
            IF g_sfbcwf030_switch = 'N' THEN
               IF cl_null(g_sfakwf2_d[l_ac].sfbcwf030) THEN
                  #mod 150107
                  #LET g_qryparam.where = g_qryparam.where ," AND inag003 = ' ' "
                  IF NOT cl_null(l_sfbcwf030) THEN
                     LET g_qryparam.where = g_qryparam.where ," AND inag003 = '",l_sfbcwf030,"' "
                  ELSE
                     LET g_qryparam.where = g_qryparam.where ," AND inag003 = ' ' "
                  END IF
                  #mod 150107 end
               ELSE
                  LET g_qryparam.where = g_qryparam.where ," AND inag003 = '",g_sfakwf2_d[l_ac].sfbcwf030,"' "
               END IF
            END IF
            #mod 141118 --end
            LET g_qryparam.where = g_qryparam.where ," AND inag008 > 0 "   #190110-00019#1 add
            #?????
            CALL s_control_get_doc_sql("inag004",g_sfajwf_m.sfajwfdocno,'6')
                 RETURNING l_success,l_where
            IF l_success THEN
               LET g_qryparam.where = g_qryparam.where ," AND ",l_where
            END IF
            #??VMI???
            LET g_qryparam.where = g_qryparam.where,
                                   "  AND NOT EXISTS( SELECT 1 FROM inac_t WHERE inacent = inaaent AND inac001 = inaa001 ",
                                   "  AND inac003 ='",l_para_data_2,"' AND (inac002 IS NULL OR inac002 = ' '))"

               
            #CALL q_inag004_16()                                #????  #240423-00009#2 mark
            CALL q_inag004_16_wf()   #240423-00009#2  add 
 
            LET g_sfakwf2_d[l_ac].sfbcwf019 = g_qryparam.return1              
            LET g_sfakwf2_d[l_ac].sfbcwf020 = g_qryparam.return2
            LET g_sfakwf2_d[l_ac].sfbcwf029 = g_qryparam.return3
            LET g_sfakwf2_d[l_ac].sfbcwf030 = g_qryparam.return4   
            DISPLAY g_sfakwf2_d[l_ac].sfbcwf019 TO sfbcwf019
            DISPLAY g_sfakwf2_d[l_ac].sfbcwf020 TO sfbcwf020
            DISPLAY g_sfakwf2_d[l_ac].sfbcwf029 TO sfbcwf029 
            DISPLAY g_sfakwf2_d[l_ac].sfbcwf030 TO sfbcwf030 
            LET g_sfakwf2_d[l_ac].sfbcwf019_desc = s_desc_get_stock_desc(g_site,g_sfakwf2_d[l_ac].sfbcwf019)
            LET g_sfakwf2_d[l_ac].sfbcwf020_desc = s_desc_get_locator_desc(g_site,g_sfakwf2_d[l_ac].sfbcwf019,g_sfakwf2_d[l_ac].sfbcwf020)
            #180130-00007#1 add --(S)--
            CALL bsft001_wf_get_incgwf_inan_qty(g_sfakwf2_d[l_ac].sfbcwf006,g_sfakwf2_d[l_ac].sfbcwf021,g_sfakwf2_d[l_ac].sfbcwf014,g_sfakwf2_d[l_ac].sfbcwf019,g_sfakwf2_d[l_ac].sfbcwf020,g_sfakwf2_d[l_ac].sfbcwf029,g_sfakwf2_d[l_ac].sfbcwf030) 
               RETURNING g_sfakwf2_d[l_ac].number1,g_sfakwf2_d[l_ac].number2
            #???????????
            CALL bsft001_wf_get_incgwf_inan_qty(g_sfakwf2_d[l_ac].sfbcwf006,g_sfakwf2_d[l_ac].sfbcwf021,g_sfakwf2_d[l_ac].sfbcwf014,g_sfakwf2_d[l_ac].sfbcwf019,g_sfakwf2_d[l_ac].sfbcwf020,g_sfakwf2_d[l_ac].sfbcwf029,g_sfakwf2_d[l_ac].sfbcwf030) 
                  RETURNING g_sfakwf2_d[l_ac].number5,g_sfakwf2_d[l_ac].number6
            #180130-00007#1 add --(E)--      
            NEXT FIELD sfbcwf019                          #?????

            #END add-point
 
 
         #Ctrlp:input.c.page2.sfbcwf020
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf020
            #add-point:ON ACTION controlp INFIELD sfbcwf020 name="input.c.page2.sfbcwf020"
            #?? a07 ??????(Version:3)   
            #??i?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = "i"
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_sfakwf2_d[l_ac].sfbcwf019
            LET g_qryparam.default2 = g_sfakwf2_d[l_ac].sfbcwf020
            LET g_qryparam.default3 = g_sfakwf2_d[l_ac].sfbcwf029
            LET g_qryparam.default4 = g_sfakwf2_d[l_ac].sfbcwf030

            #??arg
            LET g_qryparam.arg1 = g_sfakwf2_d[l_ac].sfbcwf006
            IF cl_null(g_sfakwf2_d[l_ac].sfbcwf021) THEN
               LET g_qryparam.arg2 = ' '
            ELSE
               LET g_qryparam.arg2 = g_sfakwf2_d[l_ac].sfbcwf021
            END IF
            #????????
            LET g_qryparam.where = "1=1 "
            #add 150107
            LET l_sfbcwf019=''
            LET l_sfbcwf020=''
            LET l_sfbcwf029=''
            LET l_sfbcwf030=''
            SELECT sfbcwf019,sfbcwf020,sfbcwf029,sfbcwf030
              INTO l_sfbcwf019,l_sfbcwf020,l_sfbcwf029,l_sfbcwf030
              FROM sfbcwf_t
             WHERE sfbcwfent  = g_enterprise
               AND sfbcwfdocno= g_sfajwf_m.sfajwfdocno
               AND sfbcwfseq  = g_sfakwf_d[g_detail_idx].sfakwfseq
               AND sfbcwfseq1 = g_sfakwf2_d[l_ac].sfbcwfseq1
               AND sfbcwfseq2 = g_sfakwf2_d[l_ac].sfbcwfseq2
            #add 150107 end
            IF g_sfbcwf019_switch = 'N' THEN
               IF cl_null(g_sfakwf2_d[l_ac].sfbcwf019) THEN
                  #mod 150107
                  #LET g_qryparam.where = g_qryparam.where ," AND inag004 = ' ' "
                  IF NOT cl_null(l_sfbcwf019) THEN
                     LET g_qryparam.where = g_qryparam.where ," AND inag004 = '",l_sfbcwf019,"' "
                  ELSE
                     LET g_qryparam.where = g_qryparam.where ," AND inag004 = ' ' "
                  END IF
                  #mod 150107 end
               ELSE
                  LET g_qryparam.where = g_qryparam.where ," AND inag004 = '",g_sfakwf2_d[l_ac].sfbcwf019,"' "
               END IF
            #170818-00020#1 add --(S)--
            ELSE
               IF NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf019) THEN
                  LET g_qryparam.where = g_qryparam.where ," AND inag004 = '",g_sfakwf2_d[l_ac].sfbcwf019,"' "
               END IF
            #170818-00020#1 add --(E)--    
            END IF
            IF g_sfbcwf029_switch = 'N' THEN
               IF cl_null(g_sfakwf2_d[l_ac].sfbcwf029) THEN
                  #mod 150107
                  #LET g_qryparam.where = g_qryparam.where ," AND inag006 = ' ' "
                  IF NOT cl_null(l_sfbcwf029) THEN
                     LET g_qryparam.where = g_qryparam.where ," AND inag006 = '",l_sfbcwf029,"' "
                  ELSE
                     LET g_qryparam.where = g_qryparam.where ," AND inag006 = ' ' "
                  END IF
                  #mod 150107 end
               ELSE
                  LET g_qryparam.where = g_qryparam.where ," AND inag006 = '",g_sfakwf2_d[l_ac].sfbcwf029,"' "
               END IF
            #170818-00020#1 add --(S)--
            ELSE
               IF NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf029) THEN
                  LET g_qryparam.where = g_qryparam.where ," AND inag006 = '",g_sfakwf2_d[l_ac].sfbcwf029,"' "
               END IF
            #170818-00020#1 add --(E)--       
            END IF
            IF g_sfbcwf030_switch = 'N' THEN
               IF cl_null(g_sfakwf2_d[l_ac].sfbcwf030) THEN
                  #mod 150107
                  #LET g_qryparam.where = g_qryparam.where ," AND inag003 = ' ' "
                  IF NOT cl_null(l_sfbcwf030) THEN
                     LET g_qryparam.where = g_qryparam.where ," AND inag003 = '",l_sfbcwf030,"' "
                  ELSE
                     LET g_qryparam.where = g_qryparam.where ," AND inag003 = ' ' "
                  END IF
                  #mod 150107 end
               ELSE
                  LET g_qryparam.where = g_qryparam.where ," AND inag003 = '",g_sfakwf2_d[l_ac].sfbcwf030,"' "
               END IF
            #170818-00020#1 add --(S)--
            ELSE
               IF NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf030) THEN
                  LET g_qryparam.where = g_qryparam.where ," AND inag003 = '",g_sfakwf2_d[l_ac].sfbcwf030,"' "
               END IF
            #170818-00020#1 add --(E)--       
            END IF
            #mod 141118 --end
            #???
            CALL s_control_get_doc_sql("inag004",g_sfajwf_m.sfajwfdocno,'6')
                 RETURNING l_success,l_where
            IF l_success THEN
               LET g_qryparam.where = g_qryparam.where ," AND ",l_where
            END IF
            #180315-00005#1 add-------e-----
            #191219-00008#1-(S) add
            #??VMI???
            LET g_qryparam.where = g_qryparam.where,
                                   "  AND NOT EXISTS( SELECT 1 FROM inac_t WHERE inacent = inaaent AND inac001 = inaa001 ",
                                   "  AND inac003 ='",l_para_data_2,"' AND (inac002 IS NULL OR inac002 = ' '))"
            #191219-00008#1-(E) add
 
            #CALL q_inag004_16()                                #????  #240423-00009#2 mark
            CALL q_inag004_16_wf()   #240423-00009#2  add 
 
            LET g_sfakwf2_d[l_ac].sfbcwf019 = g_qryparam.return1
            LET g_sfakwf2_d[l_ac].sfbcwf020 = g_qryparam.return2
            LET g_sfakwf2_d[l_ac].sfbcwf029 = g_qryparam.return3
            LET g_sfakwf2_d[l_ac].sfbcwf030 = g_qryparam.return4         
            DISPLAY g_sfakwf2_d[l_ac].sfbcwf019 TO sfbcwf019
            DISPLAY g_sfakwf2_d[l_ac].sfbcwf020 TO sfbcwf020
            DISPLAY g_sfakwf2_d[l_ac].sfbcwf029 TO sfbcwf029 
            DISPLAY g_sfakwf2_d[l_ac].sfbcwf030 TO sfbcwf030 
            LET g_sfakwf2_d[l_ac].sfbcwf019_desc = s_desc_get_stock_desc(g_site,g_sfakwf2_d[l_ac].sfbcwf019)
            LET g_sfakwf2_d[l_ac].sfbcwf020_desc = s_desc_get_locator_desc(g_site,g_sfakwf2_d[l_ac].sfbcwf019,g_sfakwf2_d[l_ac].sfbcwf020)
            #180130-00007#1 add --(S)--
            CALL bsft001_wf_get_incgwf_inan_qty(g_sfakwf2_d[l_ac].sfbcwf006,g_sfakwf2_d[l_ac].sfbcwf021,g_sfakwf2_d[l_ac].sfbcwf014,g_sfakwf2_d[l_ac].sfbcwf019,g_sfakwf2_d[l_ac].sfbcwf020,g_sfakwf2_d[l_ac].sfbcwf029,g_sfakwf2_d[l_ac].sfbcwf030) 
               RETURNING g_sfakwf2_d[l_ac].number1,g_sfakwf2_d[l_ac].number2  
            #???????????
            CALL bsft001_wf_get_incgwf_inan_qty(g_sfakwf2_d[l_ac].sfbcwf006,g_sfakwf2_d[l_ac].sfbcwf021,g_sfakwf2_d[l_ac].sfbcwf014,g_sfakwf2_d[l_ac].sfbcwf019,g_sfakwf2_d[l_ac].sfbcwf020,g_sfakwf2_d[l_ac].sfbcwf029,g_sfakwf2_d[l_ac].sfbcwf030) 
                  RETURNING g_sfakwf2_d[l_ac].number5,g_sfakwf2_d[l_ac].number6
            #180130-00007#1 add --(E)--     
            NEXT FIELD sfbcwf020                          #?????



            #END add-point
 
 
         #Ctrlp:input.c.page2.sfbcwf029
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf029
            #add-point:ON ACTION controlp INFIELD sfbcwf029 name="input.c.page2.sfbcwf029"
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = "i"
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_sfakwf2_d[l_ac].sfbcwf019
            LET g_qryparam.default2 = g_sfakwf2_d[l_ac].sfbcwf020
            LET g_qryparam.default3 = g_sfakwf2_d[l_ac].sfbcwf029
            LET g_qryparam.default4 = g_sfakwf2_d[l_ac].sfbcwf030
            #mod 141118 q_inag004_13???????
            #LET g_qryparam.where = " inag001 ='",g_sfakwf2_d[l_ac].sfdc004,"'"
            LET g_qryparam.arg1 = g_sfakwf2_d[l_ac].sfbcwf006
            IF cl_null(g_sfakwf2_d[l_ac].sfbcwf021) THEN
               LET g_qryparam.arg2 = ' '
            ELSE
               LET g_qryparam.arg2 = g_sfakwf2_d[l_ac].sfbcwf021
            END IF
            #????????
            LET g_qryparam.where = "1=1 "
            #170912-00040#1-s
            CALL s_aooi200_get_slip(g_sfajwf_m.sfajwfdocno) RETURNING l_success,g_ooba002
            CALL cl_get_doc_para(g_enterprise,g_site,g_ooba002,'D-MFG-0058') RETURNING g_para
            IF cl_null(g_para) THEN LET g_para = 'N' END IF
            IF g_prog[1,6]='asft32' AND g_para = 'Y' THEN
#               LET g_qryparam.default1 = g_sfakwf2_d[l_ac].sfbcwf029  #170920-00006#1
#               LET g_qryparam.arg3 = g_sfajwf_m.sfajwfdocno
#               LET g_qryparam.arg4 = g_sfakwf2_d[l_ac].sfbcwfdocno   #190412-00037#1 add
#              #CALL q_sfdd005_1() #230302-00035#1 mark
#               CALL q_sfdd005_3() #230302-00035#1 add
#               LET g_sfakwf2_d[l_ac].sfbcwf029 = g_qryparam.return1
#               DISPLAY g_sfakwf2_d[l_ac].sfbcwf029 TO sfbcwf029
            ELSE
            #170912-00040#1-e
            #add 150107
            LET l_sfbcwf019=''
            LET l_sfbcwf020=''
            LET l_sfbcwf029=''
            LET l_sfbcwf030=''
            SELECT sfbcwf019,sfbcwf020,sfbcwf029,sfbcwf030
              INTO l_sfbcwf019,l_sfbcwf020,l_sfbcwf029,l_sfbcwf030
              FROM sfbcwf_t
             WHERE sfbcwfent  = g_enterprise
               AND sfbcwfdocno= g_sfajwf_m.sfajwfdocno
               AND sfbcwfseq  = g_sfakwf_d[g_detail_idx].sfakwfseq
               AND sfbcwfseq1 = g_sfakwf2_d[l_ac].sfbcwfseq1
               AND sfbcwfseq2 = g_sfakwf2_d[l_ac].sfbcwfseq2
            #add 150107 end
            IF g_sfbcwf019_switch = 'N' THEN
               IF cl_null(g_sfakwf2_d[l_ac].sfbcwf019) THEN
                  #mod 150107
                  #LET g_qryparam.where = g_qryparam.where ," AND inag004 = ' ' "
                  IF NOT cl_null(l_sfbcwf019) THEN
                     LET g_qryparam.where = g_qryparam.where ," AND inag004 = '",l_sfbcwf019,"' "
                  ELSE
                     LET g_qryparam.where = g_qryparam.where ," AND inag004 = ' ' "
                  END IF
                  #mod 150107 end
               ELSE
                  LET g_qryparam.where = g_qryparam.where ," AND inag004 = '",g_sfakwf2_d[l_ac].sfbcwf019,"' "
               END IF
            #170818-00020#1 add --(S)--
            ELSE
               IF NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf019) THEN
                  LET g_qryparam.where = g_qryparam.where ," AND inag004 = '",g_sfakwf2_d[l_ac].sfbcwf019,"' "
               END IF
            #170818-00020#1 add --(E)--       
            END IF
            IF g_sfbcwf020_switch = 'N' THEN
               IF cl_null(g_sfakwf2_d[l_ac].sfbcwf020) THEN
                  #mod 150107
                  #LET g_qryparam.where = g_qryparam.where ," AND inag005 = ' ' "
                  IF NOT cl_null(l_sfbcwf020) THEN
                     LET g_qryparam.where = g_qryparam.where ," AND inag005 = '",l_sfbcwf020,"' "
                  ELSE
                     LET g_qryparam.where = g_qryparam.where ," AND inag005 = ' ' "
                  END IF
                  #mod 150107 end
               ELSE
                  LET g_qryparam.where = g_qryparam.where ," AND inag005 = '",g_sfakwf2_d[l_ac].sfbcwf020,"' "
               END IF
            #170818-00020#1 add --(S)--
            ELSE
               IF NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf020) THEN
                  LET g_qryparam.where = g_qryparam.where ," AND inag005 = '",g_sfakwf2_d[l_ac].sfbcwf020,"' "
               END IF
            #170818-00020#1 add --(E)--       
            END IF
            IF g_sfbcwf030_switch = 'N' THEN
               IF cl_null(g_sfakwf2_d[l_ac].sfbcwf030) THEN
                  #mod 150107
                  #LET g_qryparam.where = g_qryparam.where ," AND inag003 = ' ' "
                  IF NOT cl_null(l_sfbcwf030) THEN
                     LET g_qryparam.where = g_qryparam.where ," AND inag003 = '",l_sfbcwf030,"' "
                  ELSE
                     LET g_qryparam.where = g_qryparam.where ," AND inag003 = ' ' "
                  END IF
                  #mod 150107 end
               ELSE
                  LET g_qryparam.where = g_qryparam.where ," AND inag003 = '",g_sfakwf2_d[l_ac].sfbcwf030,"' "
               END IF
            #170818-00020#1 add --(S)--
            ELSE
               IF NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf030) THEN
                  LET g_qryparam.where = g_qryparam.where ," AND inag003 = '",g_sfakwf2_d[l_ac].sfbcwf030,"' "
               END IF
            #170818-00020#1 add --(E)--       
            END IF
            #mod 141118 --end
            #???
            CALL s_control_get_doc_sql("inag004",g_sfajwf_m.sfajwfdocno,'6')
                 RETURNING l_success,l_where
            IF l_success THEN
               LET g_qryparam.where = g_qryparam.where ," AND ",l_where
            END IF
            #180315-00005#1 add-------e-----
            #170704-00048#1-s
            #191219-00008#1-(S) add
            #??VMI???
            LET g_qryparam.where = g_qryparam.where,
                                   "  AND NOT EXISTS( SELECT 1 FROM inac_t WHERE inacent = inaaent AND inac001 = inaa001 ",
                                   "  AND inac003 ='",l_para_data_2,"' AND (inac002 IS NULL OR inac002 = ' '))"
            #191219-00008#1-(E) add
            #CALL q_inag004_16()  #240423-00009#2 mark
            CALL q_inag004_16_wf()   #240423-00009#2  add
            #170704-00048#1-e
            LET g_sfakwf2_d[l_ac].sfbcwf019 = g_qryparam.return1
            LET g_sfakwf2_d[l_ac].sfbcwf020 = g_qryparam.return2
            LET g_sfakwf2_d[l_ac].sfbcwf029 = g_qryparam.return3
            LET g_sfakwf2_d[l_ac].sfbcwf030 = g_qryparam.return4
            DISPLAY g_sfakwf2_d[l_ac].sfbcwf019 TO sfbcwf019
            DISPLAY g_sfakwf2_d[l_ac].sfbcwf020 TO sfbcwf020
            DISPLAY g_sfakwf2_d[l_ac].sfbcwf029 TO sfbcwf029 
            DISPLAY g_sfakwf2_d[l_ac].sfbcwf030 TO sfbcwf030 
            LET g_sfakwf2_d[l_ac].sfbcwf019_desc = s_desc_get_stock_desc(g_site,g_sfakwf2_d[l_ac].sfbcwf019)
            LET g_sfakwf2_d[l_ac].sfbcwf020_desc = s_desc_get_locator_desc(g_site,g_sfakwf2_d[l_ac].sfbcwf019,g_sfakwf2_d[l_ac].sfbcwf020)
            #180130-00007#1 add --(S)--
            CALL bsft001_wf_get_incgwf_inan_qty(g_sfakwf2_d[l_ac].sfbcwf006,g_sfakwf2_d[l_ac].sfbcwf021,g_sfakwf2_d[l_ac].sfbcwf014,g_sfakwf2_d[l_ac].sfbcwf019,g_sfakwf2_d[l_ac].sfbcwf020,g_sfakwf2_d[l_ac].sfbcwf029,g_sfakwf2_d[l_ac].sfbcwf030) 
               RETURNING g_sfakwf2_d[l_ac].number1,g_sfakwf2_d[l_ac].number2
            #???????????
            CALL bsft001_wf_get_incgwf_inan_qty(g_sfakwf2_d[l_ac].sfbcwf006,g_sfakwf2_d[l_ac].sfbcwf021,g_sfakwf2_d[l_ac].sfbcwf014,g_sfakwf2_d[l_ac].sfbcwf019,g_sfakwf2_d[l_ac].sfbcwf020,g_sfakwf2_d[l_ac].sfbcwf029,g_sfakwf2_d[l_ac].sfbcwf030) 
               RETURNING g_sfakwf2_d[l_ac].number5,g_sfakwf2_d[l_ac].number6
            #180130-00007#1 add --(E)--     
            END IF  #170912-00040#1
            NEXT FIELD sfbcwf029
            #END add-point
 
 
         #Ctrlp:input.c.page2.sfbcwf039
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf039
            #add-point:ON ACTION controlp INFIELD sfbcwf039 name="input.c.page2.sfbcwf039"
            #240423-00009#2 --s
            #????????
            #???ent+??site+???????????????imafwf211
            LET l_imafwf211 = ''
            LET l_wfaawfl002 = ''
            SELECT imafwf211 INTO l_imafwf211
              FROM imaf_t
             WHERE imafent = g_enterprise AND imafsite = g_site AND imaf001 = g_sfakwf2_d[l_ac].sfbcwf006
            #????????bwfi001_wf??????11.?????????????wfabwf_t?wfacwf_t??????
            SELECT wfaawfl002 INTO l_wfaawfl002    #??-->?????
              FROM wfaawfl_t
             WHERE wfaawflent = g_enterprise AND wfaawfl001 = '11' AND wfaawfl003 = g_dlang AND wfaawfl004 = l_imafwf211
            
            #??i?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'c'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_sfakwf2_d[l_ac].sfbcwf039          #??default?
            LET g_qryparam.default2 = ''                          #wfacwf005 #???
            #??arg
            LET g_qryparam.arg1 = "11" 
            
            IF NOT cl_null(l_wfaawfl002) THEN
               LET g_qryparam.where = " wfabwf002 = ",l_wfaawfl002
            ELSE
               LET g_qryparam.where = " wfabwf002 IS NULL "
            END IF
            LET g_qryparam.default3 = l_imafwf211 #????????
            CALL q_wfaawf001_2_wf()                                #????
            LET g_sfakwf2_d[l_ac].sfbcwf039 = g_qryparam.return2
            IF NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf039) THEN
#               CALL s_wfadwf_wf(g_enterprise,g_site,g_sfeb_d[l_ac].sfebwf106,g_sfea_m.sfeadocno,g_sfeb_d[l_ac].sfeb004) RETURNING r_success,l_sfeb016
               SELECT wfadwf001 INTO g_sfakwf2_d[l_ac].sfbcwf030
                 FROM wfadwf_t 
                WHERE wfadwfent = g_enterprise AND wfadwfsite = g_site 
                  AND wfadwf005 = g_sfakwf2_d[l_ac].sfbcwf039     
            ELSE
               LET g_sfakwf2_d[l_ac].sfbcwf030 = ''           
            END IF   
            DISPLAY g_sfakwf2_d[l_ac].sfbcwf030 TO sfbcwf030    
            DISPLAY g_sfakwf2_d[l_ac].sfbcwf039 TO sfbcwf039    
            NEXT FIELD sfbcwf039                                 #?????
            #240423-00009#2 --e
            #END add-point
 
 
         #Ctrlp:input.c.page2.sfbcwf030
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf030
            #add-point:ON ACTION controlp INFIELD sfbcwf030 name="input.c.page2.sfbcwf030"
            #?? a07 ??????(Version:3)   
            #??i?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = "i"
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_sfakwf2_d[l_ac].sfbcwf019
            LET g_qryparam.default2 = g_sfakwf2_d[l_ac].sfbcwf020
            LET g_qryparam.default3 = g_sfakwf2_d[l_ac].sfbcwf029
            LET g_qryparam.default4 = g_sfakwf2_d[l_ac].sfbcwf030
            #mod 141118 q_inag004_13???????
            #LET g_qryparam.where = " inag001 ='",g_sfakwf2_d[l_ac].sfbcwf006,"'"
            LET g_qryparam.arg1 = g_sfakwf2_d[l_ac].sfbcwf006
            IF cl_null(g_sfakwf2_d[l_ac].sfbcwf021) THEN
               LET g_qryparam.arg2 = ' '
            ELSE
               LET g_qryparam.arg2 = g_sfakwf2_d[l_ac].sfbcwf021
            END IF
            #????????
            LET g_qryparam.where = "1=1 "
            #add 150107
            LET l_sfbcwf019=''
            LET l_sfbcwf020=''
            LET l_sfbcwf029=''
            LET l_sfbcwf030=''
            SELECT sfbcwf019,sfbcwf020,sfbcwf029,sfbcwf030
              INTO l_sfbcwf019,l_sfbcwf020,l_sfbcwf029,l_sfbcwf030
              FROM sfbcwf_t
             WHERE sfbcwfent  = g_enterprise
               AND sfbcwfdocno= g_sfajwf_m.sfajwfdocno
               AND sfbcwfseq  = g_sfakwf_d[g_detail_idx].sfakwfseq
               AND sfbcwfseq1 = g_sfakwf2_d[l_ac].sfbcwfseq1
               AND sfbcwfseq2 = g_sfakwf2_d[l_ac].sfbcwfseq2
            #add 150107 end
            IF g_sfbcwf019_switch = 'N' THEN
               IF cl_null(g_sfakwf2_d[l_ac].sfbcwf019) THEN
                  #mod 150107
                  #LET g_qryparam.where = g_qryparam.where ," AND inag004 = ' ' "
                  IF NOT cl_null(l_sfbcwf019) THEN
                     LET g_qryparam.where = g_qryparam.where ," AND inag004 = '",l_sfbcwf019,"' "
                  ELSE
                     LET g_qryparam.where = g_qryparam.where ," AND inag004 = ' ' "
                  END IF
                  #mod 150107 end
               ELSE
                  LET g_qryparam.where = g_qryparam.where ," AND inag004 = '",g_sfakwf2_d[l_ac].sfbcwf019,"' "
               END IF
            #170818-00020#1 add --(S)--
            ELSE
               IF NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf019) THEN
                  LET g_qryparam.where = g_qryparam.where ," AND inag004 = '",g_sfakwf2_d[l_ac].sfbcwf019,"' "
               END IF
            #170818-00020#1 add --(E)--       
            END IF
            IF g_sfbcwf020_switch = 'N' THEN
               IF cl_null(g_sfakwf2_d[l_ac].sfbcwf020) THEN
                  #mod 150107
                  #LET g_qryparam.where = g_qryparam.where ," AND inag005 = ' ' "
                  IF NOT cl_null(l_sfbcwf020) THEN
                     LET g_qryparam.where = g_qryparam.where ," AND inag005 = '",l_sfbcwf020,"' "
                  ELSE
                     LET g_qryparam.where = g_qryparam.where ," AND inag005 = ' ' "
                  END IF
                  #mod 150107 end
               ELSE
                  LET g_qryparam.where = g_qryparam.where ," AND inag005 = '",g_sfakwf2_d[l_ac].sfbcwf020,"' "
               END IF
            #170818-00020#1 add --(S)--
            ELSE
               IF NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf020) THEN
                  LET g_qryparam.where = g_qryparam.where ," AND inag005 = '",g_sfakwf2_d[l_ac].sfbcwf020,"' "
               END IF
            #170818-00020#1 add --(E)--       
            END IF
            IF g_sfbcwf029_switch = 'N' THEN
               IF cl_null(g_sfakwf2_d[l_ac].sfbcwf029) THEN
                  #mod 150107
                  #LET g_qryparam.where = g_qryparam.where ," AND inag006 = ' ' "
                  IF NOT cl_null(l_sfbcwf029) THEN
                     LET g_qryparam.where = g_qryparam.where ," AND inag006 = '",l_sfbcwf029,"' "
                  ELSE
                     LET g_qryparam.where = g_qryparam.where ," AND inag006 = ' ' "
                  END IF
                  #mod 150107 end
               ELSE
                  LET g_qryparam.where = g_qryparam.where ," AND inag006 = '",g_sfakwf2_d[l_ac].sfbcwf029,"' "
               END IF
            #170818-00020#1 add --(S)--
            ELSE
               IF NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf029) THEN
                  LET g_qryparam.where = g_qryparam.where ," AND inag006 = '",g_sfakwf2_d[l_ac].sfbcwf029,"' "
               END IF
            #170818-00020#1 add --(E)--       
            END IF
            #170704-00048#1-s
            #191219-00008#1-(S) add
            #??VMI???
            LET g_qryparam.where = g_qryparam.where,
                                   "  AND NOT EXISTS( SELECT 1 FROM inac_t WHERE inacent = inaaent AND inac001 = inaa001 ",
                                   "  AND inac003 ='",l_para_data_2,"' AND (inac002 IS NULL OR inac002 = ' '))"
            #191219-00008#1-(E) add
            #CALL q_inag004_16()  #240423-00009#2 mark
            CALL q_inag004_16_wf()   #240423-00009#2  add
            #170704-00048#1-e
            LET g_sfakwf2_d[l_ac].sfbcwf019 = g_qryparam.return1
            LET g_sfakwf2_d[l_ac].sfbcwf020 = g_qryparam.return2
            LET g_sfakwf2_d[l_ac].sfbcwf029 = g_qryparam.return3
            LET g_sfakwf2_d[l_ac].sfbcwf030 = g_qryparam.return4
            DISPLAY g_sfakwf2_d[l_ac].sfbcwf019 TO sfbcwf019
            DISPLAY g_sfakwf2_d[l_ac].sfbcwf020 TO sfbcwf020
            DISPLAY g_sfakwf2_d[l_ac].sfbcwf029 TO sfbcwf029 
            DISPLAY g_sfakwf2_d[l_ac].sfbcwf030 TO sfbcwf030 
            LET g_sfakwf2_d[l_ac].sfbcwf019_desc = s_desc_get_stock_desc(g_site,g_sfakwf2_d[l_ac].sfbcwf019)
            LET g_sfakwf2_d[l_ac].sfbcwf020_desc = s_desc_get_locator_desc(g_site,g_sfakwf2_d[l_ac].sfbcwf019,g_sfakwf2_d[l_ac].sfbcwf020)
            #180130-00007#1 add --(S)--
            CALL bsft001_wf_get_incgwf_inan_qty(g_sfakwf2_d[l_ac].sfbcwf006,g_sfakwf2_d[l_ac].sfbcwf021,g_sfakwf2_d[l_ac].sfbcwf014,g_sfakwf2_d[l_ac].sfbcwf019,g_sfakwf2_d[l_ac].sfbcwf020,g_sfakwf2_d[l_ac].sfbcwf029,g_sfakwf2_d[l_ac].sfbcwf030) 
               RETURNING g_sfakwf2_d[l_ac].number1,g_sfakwf2_d[l_ac].number2  
            #???????????
            CALL bsft001_wf_get_incgwf_inan_qty(g_sfakwf2_d[l_ac].sfbcwf006,g_sfakwf2_d[l_ac].sfbcwf021,g_sfakwf2_d[l_ac].sfbcwf014,g_sfakwf2_d[l_ac].sfbcwf019,g_sfakwf2_d[l_ac].sfbcwf020,g_sfakwf2_d[l_ac].sfbcwf029,g_sfakwf2_d[l_ac].sfbcwf030) 
               RETURNING g_sfakwf2_d[l_ac].number5,g_sfakwf2_d[l_ac].number6
            #180130-00007#1 add --(E)--     
            NEXT FIELD sfbcwf030

            #END add-point
 
 
         #Ctrlp:input.c.page2.sfbcwf040
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf040
            #add-point:ON ACTION controlp INFIELD sfbcwf040 name="input.c.page2.sfbcwf040"

            #END add-point
 
 
         #Ctrlp:input.c.page2.sfbcwf041
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf041
            #add-point:ON ACTION controlp INFIELD sfbcwf041 name="input.c.page2.sfbcwf041"

            #END add-point
 
 
         #Ctrlp:input.c.page2.sfbcwf042
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf042
            #add-point:ON ACTION controlp INFIELD sfbcwf042 name="input.c.page2.sfbcwf042"

            #END add-point
 
 
         #Ctrlp:input.c.page2.sfbcwf028
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf028
            #add-point:ON ACTION controlp INFIELD sfbcwf028 name="input.c.page2.sfbcwf028"

            #END add-point
 
 
         #Ctrlp:input.c.page2.sfbcwf001
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf001
            #add-point:ON ACTION controlp INFIELD sfbcwf001 name="input.c.page2.sfbcwf001"

            #END add-point
 
 
         #Ctrlp:input.c.page2.sfbcwf026
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf026
            #add-point:ON ACTION controlp INFIELD sfbcwf026 name="input.c.page2.sfbcwf026"

            #END add-point
 
 
         #Ctrlp:input.c.page2.sfbcwf027
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf027
            #add-point:ON ACTION controlp INFIELD sfbcwf027 name="input.c.page2.sfbcwf027"

            #END add-point
 
 
         #Ctrlp:input.c.page2.ooff013
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD ooff013
            #add-point:ON ACTION controlp INFIELD ooff013 name="input.c.page2.ooff013"
            IF NOT cl_null(g_sfajwf_m.sfajwfdocno) AND l_ac > 0 THEN
               CALL aooi360_02('7',g_prog,g_sfajwf_m.sfajwfdocno,g_sfakwf2_d[l_ac].sfbcwfseq1,g_sfakwf2_d[l_ac].sfbcwfseq2,'','','','','','','1')
               CALL s_aooi360_sel('7',g_prog,g_sfajwf_m.sfajwfdocno,g_sfakwf2_d[l_ac].sfbcwfseq1,g_sfakwf2_d[l_ac].sfbcwfseq2,'','','','','','','1') RETURNING l_success,g_sfakwf2_d[l_ac].ooff013
               LET g_ooff001_d = '6'   #6.??????
               LET g_ooff002_d = g_prog
               LET g_ooff003_d = g_sfajwf_m.sfajwfdocno   #??
               LET g_ooff004_d = 0     #??
               LET g_ooff005_d = ' '
               LET g_ooff006_d = ' '
               LET g_ooff007_d = ' '
               LET g_ooff008_d = ' '
               LET g_ooff009_d = ' '
               LET g_ooff010_d = ' '
               LET g_ooff011_d = ' '
               CALL aooi360_01_b_fill(g_ooff001_d,g_ooff002_d,g_ooff003_d,g_ooff004_d,g_ooff005_d,g_ooff006_d,g_ooff007_d,g_ooff008_d,g_ooff009_d,g_ooff010_d,g_ooff011_d)   #???? 
            END IF
            #END add-point
 
 
         #Ctrlp:input.c.page2.sfbcwf043
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf043
            #add-point:ON ACTION controlp INFIELD sfbcwf043 name="input.c.page2.sfbcwf043"

            #END add-point
 
 
         #Ctrlp:input.c.page2.sfbcwf049
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfbcwf049
            #add-point:ON ACTION controlp INFIELD sfbcwf049 name="input.c.page2.sfbcwf049"

            #END add-point
 
 
 
 
         AFTER ROW
            #add-point:??page2_after_row name="input.body2.after_row"
             
            #end add-point
            LET l_ac = ARR_CURR()
            IF INT_FLAG THEN
               LET INT_FLAG = 0
               IF l_cmd = 'u' THEN
                  LET g_sfakwf2_d[l_ac].* = g_sfakwf2_d_t.*
               END IF
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code = 9001 
               LET g_errparam.popup = FALSE 
               CLOSE bsft001_wf_bcl3
               CLOSE bsft001_wf_bcl
               CALL s_transaction_end('N','0')
               CALL cl_err()
               EXIT DIALOG 
            END IF
            
            #??table??unlock
            
            CALL bsft001_wf_unlock_b("sfbcwf_t","'2'")
            CALL s_transaction_end('Y','0')
            #add-point:??page2_after_row2 name="input.body2.after_row2"
            CALL bsft001_wf_b_fill2('2')
            CALL bsft001_wf_b_fill2('3')  #240725-00004#1
            #end add-point
 
         AFTER INPUT
            #add-point:input?after input  name="input.body2.after_input"
            LET l_count = 0
            SELECT COUNT(1) INTO l_count FROM sfbcwf_t
             WHERE sfbcwfent = g_enterprise AND sfbcwfsite = g_site AND sfbcwfdocno = g_sfajwf_m.sfajwfdocno AND sfbcwfseq = g_sfakwf_d[g_detail_idx].sfakwfseq
            IF l_count > 0 THEN
               #??????sfakwf006=?????sfbcwf023*bmba012????/bmba011????
               #240611-00019#2 mark--s
#               IF cl_null(g_sfakwf_d[g_detail_idx].sfakwf002) THEN
#                  LET l_sfakwf002 = ' '
#               ELSE
#                  LET l_sfakwf002 = g_sfakwf_d[g_detail_idx].sfakwf002 
#               END IF      
##               SELECT COUNT(1) INTO l_cnt FROM sfbcwf_t 
##                 LEFT JOIN bmba_t ON bmbaent = sfbcwfent AND bmbasite = sfbcwfsite AND bmba001 = sfbcwf001 AND bmba003 = sfbcwf006
##                WHERE sfbcwfent = g_enterprise AND sfbcwfsite = g_site AND sfbcwfdocno = g_sfajwf_m.sfajwfdocno AND sfbcwfseq = g_sfakwf_d[g_detail_idx].sfakwfseq
##                  AND sfbcwf043 = 'Y'  
#               SELECT COUNT(1) INTO l_cnt FROM bmba_t 
#                WHERE bmbaent = g_enterprise AND bmbasite = g_site AND bmba001 = g_sfakwf_d[g_detail_idx].sfakwf001 AND bmba003 = g_sfakwf2_d[l_ac].sfbcwf006
#                  AND bmba002 = l_sfakwf002  AND bmba004 = g_sfakwf2_d[l_ac].sfbcwf002 AND bmbawf039 = 'Y'
#                  AND bmba007 = g_sfakwf2_d[l_ac].sfbcwf003 AND bmba008 = g_sfakwf2_d[l_ac].sfbcwf004
#               IF l_cnt > 0 THEN  #?????????BOM???????????,???????????
#                  SELECT bmba012,bmba011 INTO l_bmba012,l_bmba011 FROM bmba_t
#                   WHERE bmbaent = g_enterprise AND bmbasite = g_site AND bmba001 = g_sfakwf_d[g_detail_idx].sfakwf001  AND bmba002 = l_sfakwf002
#                     AND bmba003 = g_sfakwf2_d[l_ac].sfbcwf006 AND bmba004 = g_sfakwf2_d[l_ac].sfbcwf002
#                     AND bmba007 = g_sfakwf2_d[l_ac].sfbcwf003 AND bmba008 = g_sfakwf2_d[l_ac].sfbcwf004
#                  SELECT SUM(sfbcwf023) INTO l_sfbcwf023_sum FROM sfbcwf_t 
#                   WHERE sfbcwfent = g_enterprise AND sfbcwfsite = g_site AND sfbcwfdocno = g_sfajwf_m.sfajwfdocno AND sfbcwfseq = g_sfakwf_d[g_detail_idx].sfakwfseq
#                     AND sfbcwf043 = 'Y' 
#                  LET l_sfakwf006 = l_sfbcwf023_sum * l_bmba012 / l_bmba011                  
#               ELSE
#                  SELECT SUM(sfbcwf023) INTO l_sfbcwf023_sum FROM sfbcwf_t 
#                   WHERE sfbcwfent = g_enterprise AND sfbcwfsite = g_site AND sfbcwfdocno = g_sfajwf_m.sfajwfdocno AND sfbcwfseq = g_sfakwf_d[g_detail_idx].sfakwfseq          
#                  LET l_sfakwf006 = l_sfbcwf023_sum
#               END IF 
#               
#               #???????????????????????????
##               CALL s_aooi250_convert_qty(g_sfakwf2_d[l_ac].sfbcwf006,g_sfakwf2_d[l_ac].sfbcwf014,g_sfakwf_d[g_detail_idx].sfakwf007,g_sfakwf2_d[l_ac].sfbcwf023) 
##                     RETURNING l_success,g_sfakwf2_d[l_ac].sfbcwf047  #????
#               CALL s_aooi250_convert_qty(g_sfakwf2_d[l_ac].sfbcwf006,g_sfakwf2_d[l_ac].sfbcwf014,g_sfakwf_d[g_detail_idx].sfakwf007,l_sfakwf006) 
#                    RETURNING l_success,l_sfakwf006  
#               #??aimm215??????????????
#               CALL s_asft300_02_get_sfaa012(g_sfakwf_d[g_detail_idx].sfakwf001,l_sfakwf006,g_sfakwf_d[g_detail_idx].sfakwf007,'N','N') 
#                        RETURNING l_sfakwf006,l_success     
#               #????U1?????DATECODE??,U1????????????U1????
#               SELECT sfbcwf029,sfbcwf040 INTO l_sfakwf009,l_sfakwf010 FROM sfbcwf_t 
#                WHERE sfbcwfent = g_enterprise AND sfbcwfsite = g_site AND sfbcwfdocno = g_sfajwf_m.sfajwfdocno 
#                  AND sfbcwfseq = g_sfakwf_d[g_detail_idx].sfakwfseq AND sfbcwf043 = 'Y' 
#                  AND ROWNUM = 1  
#               
#               #?????? 
#               SELECT imaa006,imaf053 INTO l_imaa006,l_imaf053 FROM imaf_t 
#                 LEFT OUTER JOIN imaa_t ON imaaent = g_enterprise AND imaa001 = imaf001
#                WHERE imafent = g_enterprise AND imafsite = g_site
#                  AND imaf001 = g_sfakwf2_d[l_ac].sfbcwf006
#               SELECT NVL(SUM(icbawf011),0),NVL(SUM(icbawf022),0) INTO l_amount_die,l_amount FROM icbawf_t
#                LEFT JOIN sfbcwf_t ON sfbcwfent = icbawfent AND sfbcwfsite =icbawfsite AND sfbcwfdocno = icbawfdocno 
#                                AND sfbcwfseq = icbawf032 AND sfbcwfseq1 = icbawfseq AND sfbcwfseq2 = icbawfseq1
#                WHERE icbawfent = g_enterprise AND icbawfsite = g_site
#                  AND icbawfdocno = g_sfajwf_m.sfajwfdocno 
#                  AND icbawf032 = g_sfakwf_d[g_detail_idx].sfakwfseq  #????
#                  AND sfbcwf043 = 'Y'                
#               IF s_aint302_wf_oocawf008(g_sfakwf2_d[l_ac].sfbcwf006) THEN
#                  IF g_sfakwf_d[g_detail_idx].sfakwf035 = l_imaf053 THEN   
#                     LET l_sfakwf034 = l_amount_die
#                  ELSE
#                     LET l_sfakwf034 = l_amount                
#                  END IF                               
#               ELSE
#                  IF g_sfakwf_d[g_detail_idx].sfakwf035 = l_imaf053 THEN   
#                     LET l_sfakwf034 =  l_amount  
#                  ELSE
#                     LET l_sfakwf034 =  l_amount_die                
#                  END IF  
#               END IF                
#               UPDATE sfakwf_t SET sfakwf006 = l_sfakwf006, #????
#                                   sfakwf034 = l_sfakwf034,	#?????? 
#                                   sfakwf009 = l_sfakwf009,	#????
#                                   sfakwf010 = l_sfakwf010	#DATECODE          
#                WHERE sfakwfent = g_enterprise AND sfakwfsite = g_site AND sfakwfdocno = g_sfajwf_m.sfajwfdocno   
#                  AND sfakwfseq = g_sfakwf_d[g_detail_idx].sfakwfseq
#               CASE
#                  WHEN SQLCA.sqlerrd[3] = 0  #???????
#                  #   INITIALIZE g_errparam TO NULL 
#                  #   LET g_errparam.extend = "sfakwf_t" 
#                  #   LET g_errparam.code = "std-00009" 
#                  #   LET g_errparam.popup = TRUE 
#                  #   CALL cl_err()
#                  #   CALL s_transaction_end('N','0')
#                  #   CONTINUE WHILE
#                  WHEN SQLCA.SQLCODE #????
#                     INITIALIZE g_errparam TO NULL 
#                     LET g_errparam.extend = "sfakwf_t:",SQLERRMESSAGE 
#                     LET g_errparam.code = SQLCA.SQLCODE 
#                     LET g_errparam.popup = TRUE 
#                     CALL s_transaction_end('N','0')
#                     CALL cl_err()
#               END CASE 
#               #??QPA????
#               CALL bsft001_wf_sfbcwf023_qpa_02(g_sfakwf2_d[l_ac].sfbcwf023,l_sfakwf006) RETURNING g_sfakwf2_d[l_ac].sfbcwf010,g_sfakwf2_d[l_ac].sfbcwf011
#               UPDATE sfbcwf_t SET sfbcwf010 = g_sfakwf2_d[l_ac].sfbcwf010, 
#                                   sfbcwf011 = g_sfakwf2_d[l_ac].sfbcwf011  
#                WHERE sfbcwfent = g_enterprise AND sfbcwfsite = g_site AND sfbcwfdocno = g_sfajwf_m.sfajwfdocno AND sfbcwfseq = g_sfakwf_d[g_detail_idx].sfakwfseq 
#                  AND sfbcwfseq1 = g_sfakwf2_d[l_ac].sfbcwfseq1 AND sfbcwfseq2 = g_sfakwf2_d[l_ac].sfbcwfseq2
#               CASE
#                  WHEN SQLCA.sqlerrd[3] = 0  #???????
#                  WHEN SQLCA.SQLCODE #????
#                     INITIALIZE g_errparam TO NULL 
#                     LET g_errparam.extend = "upd sfbcwf_t:",SQLERRMESSAGE 
#                     LET g_errparam.code = SQLCA.SQLCODE 
#                     LET g_errparam.popup = TRUE 
#                     CALL s_transaction_end('N','0')
#                     CALL cl_err()
#               END CASE 
               #240611-00019#2 mark--e
               #240611-00019#2 add--s
               #??????sfbcwf049=?????sfbcwf023*bmba012????/bmba011????,???sum(??????)=sfakwf006
                #241105-16320#1 ??????? mark s
#               IF cl_null(g_sfakwf_d[g_detail_idx].sfakwf002) THEN
#                  LET l_sfakwf002 = ' '
#               ELSE
#                  LET l_sfakwf002 = g_sfakwf_d[g_detail_idx].sfakwf002 
#               END IF      
#               SELECT COUNT(1) INTO l_cnt FROM bmba_t 
#                WHERE bmbaent = g_enterprise AND bmbasite = g_site AND bmba001 = g_sfakwf_d[g_detail_idx].sfakwf001 AND bmba003 = g_sfakwf2_d[l_ac].sfbcwf006
#                  AND bmba002 = l_sfakwf002  AND bmba004 = g_sfakwf2_d[l_ac].sfbcwf002 AND bmbawf039 = 'Y'
#                  AND bmba007 = g_sfakwf2_d[l_ac].sfbcwf003 AND bmba008 = g_sfakwf2_d[l_ac].sfbcwf004
#               IF l_cnt > 0 THEN  #?????????BOM???????????,???????????
#                  SELECT bmba012,bmba011 INTO l_bmba012,l_bmba011 FROM bmba_t
#                   WHERE bmbaent = g_enterprise AND bmbasite = g_site AND bmba001 = g_sfakwf_d[g_detail_idx].sfakwf001  AND bmba002 = l_sfakwf002
#                     AND bmba003 = g_sfakwf2_d[l_ac].sfbcwf006 AND bmba004 = g_sfakwf2_d[l_ac].sfbcwf002
#                     AND bmba007 = g_sfakwf2_d[l_ac].sfbcwf003 AND bmba008 = g_sfakwf2_d[l_ac].sfbcwf004
#                  LET g_sfakwf2_d[l_ac].sfbcwf049 = g_sfakwf2_d[l_ac].sfbcwf023 * l_bmba012 / l_bmba011                  
#               ELSE
#                  LET g_sfakwf2_d[l_ac].sfbcwf049 = g_sfakwf2_d[l_ac].sfbcwf023
#               END IF                
#               #??QPA????
#               CALL bsft001_wf_sfbcwf023_qpa_02(g_sfakwf2_d[l_ac].sfbcwf023,g_sfakwf2_d[l_ac].sfbcwf049) RETURNING g_sfakwf2_d[l_ac].sfbcwf010,g_sfakwf2_d[l_ac].sfbcwf011
#               #241016-00014#1 add--s
#               CALL s_aooi250_convert_qty(g_sfakwf2_d[l_ac].sfbcwf006,g_sfakwf2_d[l_ac].sfbcwf014,g_sfakwf_d[g_detail_idx].sfakwf007,g_sfakwf2_d[l_ac].sfbcwf049) 
#                    RETURNING l_success,g_sfakwf2_d[l_ac].sfbcwf049
#               #241016-00014#1 add--e
#               UPDATE sfbcwf_t SET sfbcwf010 = g_sfakwf2_d[l_ac].sfbcwf010, 
#                                   sfbcwf011 = g_sfakwf2_d[l_ac].sfbcwf011,
#                                   sfbcwf049 = g_sfakwf2_d[l_ac].sfbcwf049                                
#                WHERE sfbcwfent = g_enterprise AND sfbcwfsite = g_site AND sfbcwfdocno = g_sfajwf_m.sfajwfdocno AND sfbcwfseq = g_sfakwf_d[g_detail_idx].sfakwfseq 
#                  AND sfbcwfseq1 = g_sfakwf2_d[l_ac].sfbcwfseq1 AND sfbcwfseq2 = g_sfakwf2_d[l_ac].sfbcwfseq2
#               CASE
#                  WHEN SQLCA.sqlerrd[3] = 0  #???????
#                  WHEN SQLCA.SQLCODE #????
#                     INITIALIZE g_errparam TO NULL 
#                     LET g_errparam.extend = "upd sfbcwf_t:",SQLERRMESSAGE 
#                     LET g_errparam.code = SQLCA.SQLCODE 
#                     LET g_errparam.popup = TRUE 
#                     CALL s_transaction_end('N','0')
#                     CALL cl_err()
#               END CASE 
               #241105-16320#1 ??????? mark e
               #241105-16320#1 ??????? s
               FOR l_i = 1 TO  g_sfakwf2_d.getlength()
                  IF g_sfakwf2_d[l_i].sfbcwf043 = 'N' OR g_sfakwf2_d[l_i].sfbcwf043 IS NULL THEN
                     CONTINUE FOR
                  END IF
                  IF cl_null(g_sfakwf_d[g_detail_idx_list[1]].sfakwf002) THEN
                     LET l_sfakwf002 = ' '
                  ELSE
                     LET l_sfakwf002 = g_sfakwf_d[g_detail_idx_list[1]].sfakwf002 
                  END IF      
                  SELECT COUNT(1) INTO l_cnt FROM bmba_t 
                   WHERE bmbaent = g_enterprise AND bmbasite = g_site AND bmba001 = g_sfakwf_d[g_detail_idx_list[1]].sfakwf001 AND bmba003 = g_sfakwf2_d[l_i].sfbcwf006
                     AND bmba002 = l_sfakwf002  AND bmba004 = g_sfakwf2_d[l_i].sfbcwf002 AND bmbawf039 = 'Y'
                     AND bmba007 = g_sfakwf2_d[l_i].sfbcwf003 AND bmba008 = g_sfakwf2_d[l_i].sfbcwf004
                     
                  let l_cnt1=0 
                  select count(1) into l_cnt1 from bmba_t,imaf_t a,imaf_t b
                  where bmbaent = g_enterprise AND bmbasite = g_site AND bmba001 = g_sfakwf_d[g_detail_idx_list[1]].sfakwf001 AND bmba003 = g_sfakwf2_d[l_i].sfbcwf006
                     AND bmba002 = l_sfakwf002  AND bmba004 = g_sfakwf2_d[l_i].sfbcwf002
                     AND bmba007 = g_sfakwf2_d[l_i].sfbcwf003 AND bmba008 = g_sfakwf2_d[l_i].sfbcwf004
                     and bmba001 = a.imaf001 and a.imafent = g_enterprise AND a.imafsite = g_site and a.imafwf201 in ('3','4')
                     and bmba003 = b.imaf001 and b.imafent = g_enterprise AND b.imafsite = g_site and b.imafwf201 in ('0')
                  IF (l_cnt > 0 or l_cnt1>0) and g_sfakwf_d[g_detail_idx_list[1]].sfakwf035 !='PCS' THEN  #?????????BOM???????????,???????????
                     SELECT bmba012,bmba011 INTO l_bmba012,l_bmba011 FROM bmba_t
                      WHERE bmbaent = g_enterprise AND bmbasite = g_site AND bmba001 = g_sfakwf_d[g_detail_idx_list[1]].sfakwf001  AND bmba002 = l_sfakwf002
                        AND bmba003 = g_sfakwf2_d[l_i].sfbcwf006 AND bmba004 = g_sfakwf2_d[l_i].sfbcwf002
                        AND bmba007 = g_sfakwf2_d[l_i].sfbcwf003 AND bmba008 = g_sfakwf2_d[l_i].sfbcwf004
                     LET g_sfakwf2_d[l_i].sfbcwf049 = g_sfakwf2_d[l_i].sfbcwf023 * l_bmba012 / l_bmba011                  
                  ELSE
                     LET g_sfakwf2_d[l_i].sfbcwf049 = g_sfakwf2_d[l_i].sfbcwf023
                  END IF                
                  #??QPA????
                  CALL bsft001_wf_sfbcwf023_qpa_02(g_sfakwf2_d[l_i].sfbcwf023,g_sfakwf2_d[l_i].sfbcwf049) RETURNING g_sfakwf2_d[l_i].sfbcwf010,g_sfakwf2_d[l_i].sfbcwf011
                  #241015-17538 add--s
                  CALL s_aooi250_convert_qty(g_sfakwf2_d[l_i].sfbcwf006,g_sfakwf2_d[l_i].sfbcwf014,g_sfakwf_d[g_detail_idx_list[1]].sfakwf007,g_sfakwf2_d[l_i].sfbcwf049) 
                       RETURNING l_success,g_sfakwf2_d[l_i].sfbcwf049
                  #241015-17538 add--e
                  UPDATE sfbcwf_t SET sfbcwf010 = g_sfakwf2_d[l_i].sfbcwf010, 
                                      sfbcwf011 = g_sfakwf2_d[l_i].sfbcwf011,
                                      sfbcwf049 = g_sfakwf2_d[l_i].sfbcwf049                                
                   WHERE sfbcwfent = g_enterprise AND sfbcwfsite = g_site AND sfbcwfdocno = g_sfajwf_m.sfajwfdocno AND sfbcwfseq = g_sfakwf_d[g_detail_idx_list[1]].sfakwfseq 
                     AND sfbcwfseq1 = g_sfakwf2_d[l_i].sfbcwfseq1 AND sfbcwfseq2 = g_sfakwf2_d[l_i].sfbcwfseq2
                  CASE
                     WHEN SQLCA.sqlerrd[3] = 0  #???????
                     WHEN SQLCA.SQLCODE #????
                        INITIALIZE g_errparam TO NULL 
                        LET g_errparam.extend = "upd sfbcwf_t:",SQLERRMESSAGE 
                        LET g_errparam.code = SQLCA.SQLCODE 
                        LET g_errparam.popup = TRUE 
                        CALL s_transaction_end('N','0')
                        CALL cl_err()
                  END CASE
               END FOR
               #241105-16320#1 ??????? e
                
               IF g_sfajwf_m.sfajwf003 <> '2' THEN  #241016-00014#1 add
                  SELECT SUM(sfbcwf049) INTO l_sfakwf006 FROM sfbcwf_t 
                   WHERE sfbcwfent = g_enterprise AND sfbcwfsite = g_site AND sfbcwfdocno = g_sfajwf_m.sfajwfdocno AND sfbcwfseq = g_sfakwf_d[g_detail_idx].sfakwfseq
                     AND sfbcwf043 = 'Y'  
               #241016-00014#1 add--s
               ELSE
                  SELECT SUM(sfbcwf049) INTO l_sfakwf006 FROM sfbcwf_t 
                   WHERE sfbcwfent = g_enterprise AND sfbcwfsite = g_site AND sfbcwfdocno = g_sfajwf_m.sfajwfdocno AND sfbcwfseq = g_sfakwf_d[g_detail_idx].sfakwfseq
               END IF
               #241016-00014#1 add--e   
               #??aimm215??????????????
               CALL s_asft300_02_get_sfaa012(g_sfakwf_d[g_detail_idx].sfakwf001,l_sfakwf006,g_sfakwf_d[g_detail_idx].sfakwf007,'N','N') 
                        RETURNING l_sfakwf006,l_success     
               #????U1?????DATECODE??,U1????????????U1????
               SELECT sfbcwf029,sfbcwf040 INTO l_sfakwf009,l_sfakwf010 FROM sfbcwf_t 
                WHERE sfbcwfent = g_enterprise AND sfbcwfsite = g_site AND sfbcwfdocno = g_sfajwf_m.sfajwfdocno 
                  AND sfbcwfseq = g_sfakwf_d[g_detail_idx].sfakwfseq AND sfbcwf043 = 'Y' 
                  AND ROWNUM = 1  
               
               #?????? 
               SELECT imaa006,imaf053 INTO l_imaa006,l_imaf053 FROM imaf_t 
                 LEFT OUTER JOIN imaa_t ON imaaent = g_enterprise AND imaa001 = imaf001
                WHERE imafent = g_enterprise AND imafsite = g_site
                  AND imaf001 = g_sfakwf2_d[l_ac].sfbcwf006
               SELECT NVL(SUM(icbawf011),0),NVL(SUM(icbawf022),0) INTO l_amount_die,l_amount FROM icbawf_t
                LEFT JOIN sfbcwf_t ON sfbcwfent = icbawfent AND sfbcwfsite =icbawfsite AND sfbcwfdocno = icbawfdocno 
                                AND sfbcwfseq = icbawf032 AND sfbcwfseq1 = icbawfseq AND sfbcwfseq2 = icbawfseq1
                WHERE icbawfent = g_enterprise AND icbawfsite = g_site
                  AND icbawfdocno = g_sfajwf_m.sfajwfdocno 
                  AND icbawf032 = g_sfakwf_d[g_detail_idx].sfakwfseq  #????
                  AND sfbcwf043 = 'Y'                
               IF s_aint302_wf_oocawf008(g_sfakwf2_d[l_ac].sfbcwf006) THEN
                  IF g_sfakwf_d[g_detail_idx].sfakwf035 = l_imaf053 THEN   
                     LET l_sfakwf034 = l_amount_die
                  ELSE
                     LET l_sfakwf034 = l_amount                
                  END IF                               
               ELSE
                  IF g_sfakwf_d[g_detail_idx].sfakwf035 = l_imaf053 THEN   
                     LET l_sfakwf034 =  l_amount  
                  ELSE
                     LET l_sfakwf034 =  l_amount_die                
                  END IF  
               END IF                
               UPDATE sfakwf_t SET sfakwf006 = l_sfakwf006, #????
                                   sfakwf034 = l_sfakwf034,	#?????? 
                                   sfakwf009 = l_sfakwf009,	#????
                                   sfakwf010 = l_sfakwf010	#DATECODE          
                WHERE sfakwfent = g_enterprise AND sfakwfsite = g_site AND sfakwfdocno = g_sfajwf_m.sfajwfdocno   
                  AND sfakwfseq = g_sfakwf_d[g_detail_idx].sfakwfseq
               CASE
                  WHEN SQLCA.sqlerrd[3] = 0  #???????
                  #   INITIALIZE g_errparam TO NULL 
                  #   LET g_errparam.extend = "sfakwf_t" 
                  #   LET g_errparam.code = "std-00009" 
                  #   LET g_errparam.popup = TRUE 
                  #   CALL cl_err()
                  #   CALL s_transaction_end('N','0')
                  #   CONTINUE WHILE
                  WHEN SQLCA.SQLCODE #????
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = "sfakwf_t:",SQLERRMESSAGE 
                     LET g_errparam.code = SQLCA.SQLCODE 
                     LET g_errparam.popup = TRUE 
                     CALL s_transaction_end('N','0')
                     CALL cl_err()
               END CASE
               #240709-00009#1 add--s               
               CALL bsft001_wf_b_fill()
               DELETE FROM sfanwf_t
                WHERE sfanwfent = g_enterprise
                  AND sfanwfdocno = g_sfajwf_m.sfajwfdocno
                  AND sfanwfseq1 =  g_sfakwf_d[g_detail_idx].sfakwfseq  #241016-00014#1 add
               CALL bsft001_wf_ins_sfanwf()
               #240709-00009#1 add--e
               #240611-00019#2 add--e
               
               
               #?????????????   
#               IF g_sfakwf2_d[l_ac].sfbcwf013 <> g_sfakwf2_d[l_ac].sfbcwf016 THEN
#                  INITIALIZE g_errparam TO NULL
#                  LET g_errparam.replace[1] = g_sfakwf2_d[l_ac].sfbcwfseq1
#                  LET g_errparam.replace[2] = g_sfakwf2_d[l_ac].sfbcwfseq2               
#                  LET g_errparam.extend = "" 
#                  LET g_errparam.code = "wf-00053"  #??%1???%2???????????????
#                  LET g_errparam.popup = TRUE 
#                  CALL cl_err()
#               END IF 
               CALL bsft001_wf_b_fill() #??????????????DATECODE
            END IF
            #end add-point  
 
         ON ACTION controlo    
            IF l_insert THEN
               #170920-00028 ---modify start---
               #????????????????
               IF l_ac_t <= 0 OR l_ac_t IS NULL THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.extend = ""
                  LET g_errparam.code   = "adz-01032"
                  LET g_errparam.popup  = TRUE
                  CALL cl_err()
               ELSE
                  LET li_reproduce = l_ac_t
                  LET li_reproduce_target = l_ac
                  LET g_sfakwf2_d[li_reproduce_target].* = g_sfakwf2_d[li_reproduce].*
 
                  LET g_sfakwf2_d[li_reproduce_target].sfbcwfseq1 = NULL
                  LET g_sfakwf2_d[li_reproduce_target].sfbcwfseq2 = NULL
               END IF
               #170920-00028 --- modify end ---
            ELSE
               CALL FGL_SET_ARR_CURR(g_sfakwf2_d.getLength()+1)
               LET lb_reproduce = TRUE
               LET li_reproduce = l_ac
               LET li_reproduce_target = g_sfakwf2_d.getLength()+1
            END IF
            #(ver:84) ---start---
            #add-point:input?????  name="input.body2.controlo"

            #end add-point
            #(ver:84) --- end ---
        
      END INPUT
      INPUT ARRAY g_sfakwf3_d FROM s_detail3.*
         ATTRIBUTE(COUNT = g_rec_b,WITHOUT DEFAULTS, #MAXCOUNT = g_max_rec,
                 INSERT ROW = l_allow_insert, #???insert????????, ???????!
                 DELETE ROW = l_allow_delete,
                 APPEND ROW = l_allow_insert)
                 
         #??ACTION(detail_input,page_3)
         
        
         BEFORE INPUT
            #???????idx??g_detail_idx
            LET g_detail_idx_tmp = g_detail_idx
            LET g_detail_idx = g_detail_idx_list[1]
            #??????????
            IF g_detail_idx = 0 OR g_sfakwf_d.getLength() = 0 THEN
               NEXT FIELD sfakwfseq
            END IF
            #???????????
            IF cl_null(g_sfakwf_d[g_detail_idx].sfakwfseq) THEN
               NEXT FIELD sfakwfseq
            END IF
            #add-point:????? name="input.body3.before_input2"

            #end add-point
            IF g_insert = 'Y' AND NOT cl_null(g_insert) THEN 
              CALL FGL_SET_ARR_CURR(g_sfakwf3_d.getLength()+1) 
              LET g_insert = 'N' 
           END IF 
 
            #????????2???????
            IF g_loc = 'd' AND g_rec_b != 0 THEN
               CALL FGL_SET_ARR_CURR(g_idx_group.getValue("'2',"))
            END IF
            LET g_loc = 'd'
            LET g_rec_b = g_sfakwf3_d.getLength()
            #add-point:????? name="input.body3.before_input"

            #end add-point
            
         BEFORE INSERT
            
            IF s_transaction_chk("N",0) THEN
               CALL s_transaction_begin()
            END IF
            LET l_insert = TRUE
            LET l_n = ARR_COUNT()
            CALL bsft001_wf_idx_chk()   #(ver:83)
            LET l_cmd = 'a'
            INITIALIZE g_sfakwf3_d[l_ac].* TO NULL 
            INITIALIZE g_sfakwf3_d_t.* TO NULL 
            INITIALIZE g_sfakwf3_d_o.* TO NULL 
            #??????(??3)
            
            #??????(??3)
                  LET g_sfakwf3_d[l_ac].wfapwf004 = "0"
      LET g_sfakwf3_d[l_ac].wfapwf006 = "0"
      LET g_sfakwf3_d[l_ac].wfapwf008 = "0"
      LET g_sfakwf3_d[l_ac].wfapwf010 = "0"
      LET g_sfakwf3_d[l_ac].wfapwf012 = "0"
      LET g_sfakwf3_d[l_ac].wfapwf014 = "0"
      LET g_sfakwf3_d[l_ac].wfapwf016 = "0"
      LET g_sfakwf3_d[l_ac].wfapwf017 = "0"
 
            #add-point:modify?before?? name="input.body3.insert.before_bak"
#            IF g_sfakwf3_d[l_ac].wfapwfseq1 IS NULL OR g_sfakwf3_d[l_ac].wfapwfseq1 = 0 THEN
#               SELECT max(sfakwfseq)+1
#                 INTO g_sfakwf3_d[l_ac].wfapwfseq1
#                 FROM sfakwf_t
#                WHERE sfakwfdocno = g_sfajwf_m.sfajwfdocno AND sfakwfent = g_enterprise AND sfakwfsite = g_site   
#               IF g_sfakwf3_d[l_ac].wfapwfseq1 IS NULL THEN
#                  LET g_sfakwf3_d[l_ac].wfapwfseq1 = 1
#               END IF  
#               DISPLAY BY NAME g_sfakwf3_d[l_ac].wfapwfseq1        
#            END IF 
            #end add-point
            LET g_sfakwf3_d_t.* = g_sfakwf3_d[l_ac].*     #?????
            LET g_sfakwf3_d_o.* = g_sfakwf3_d[l_ac].*     #?????
            CALL cl_show_fld_cont()
            CALL bsft001_wf_set_entry_b(l_cmd)
            #add-point:modify?after_set_entry_b name="input.body3.insert.after_set_entry_b"

            #end add-point
            CALL bsft001_wf_set_no_entry_b(l_cmd)
            IF lb_reproduce THEN
               LET lb_reproduce = FALSE
               LET g_sfakwf3_d[li_reproduce_target].* = g_sfakwf3_d[li_reproduce].*
 
               LET g_sfakwf3_d[li_reproduce_target].wfapwfseq1 = NULL
            END IF
            
 
            #add-point:modify?before insert name="input.body3.before_insert"

            #end add-point  
            
         BEFORE ROW
            #add-point:modify?before row2 name="input.body3.before_row2"
            SELECT COUNT(1) INTO l_n FROM wfapwf_t 
             WHERE wfapwfent = g_enterprise AND wfapwfsite = g_site AND wfapwfdocno = g_sfajwf_m.sfajwfdocno
               AND (wfapwf024 IS NOT NULL OR wfapwf025 IS NOT NULL OR  wfapwf026 IS NOT NULL)            
            IF l_n > 0 THEN
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code = 'wf-00094'  #?????????????/??????/?????????????
               LET g_errparam.extend = '' 
               LET g_errparam.popup = TRUE
               CALL cl_err() 
               RETURN
            END IF
            IF g_sfajwf_m.sfajwfstus <> 'Y' THEN
               RETURN
            END IF 
            #end add-point  
            LET l_insert = FALSE
            LET l_cmd = ''
            LET l_ac_t = l_ac 
            LET l_ac = ARR_CURR()
            LET g_detail_idx2 = l_ac
            LET g_detail_idx_list[3] = l_ac
            LET g_current_page = 3
            
            LET l_lock_sw = 'N'            #DEFAULT
            LET l_n = ARR_COUNT()
            DISPLAY l_ac TO FORMONLY.idx
         
            CALL s_transaction_begin()
            OPEN bsft001_wf_cl USING g_enterprise, g_site,g_sfajwf_m.sfajwfdocno
            #(ver:78) ---start---
            IF SQLCA.SQLCODE THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "OPEN bsft001_wf_cl:",SQLERRMESSAGE 
               LET g_errparam.code = SQLCA.SQLCODE
               LET g_errparam.popup = TRUE 
               CLOSE bsft001_wf_cl
               CALL s_transaction_end('N','0')
               CALL cl_err()
               RETURN
            END IF
            #(ver:78) --- end ---
            
            #200804-00006 ---start---
            FETCH bsft001_wf_cl
            IF SQLCA.SQLCODE AND SQLCA.SQLCODE <> 100 THEN
               INITIALIZE g_errparam TO NULL
               LET g_errparam.extend = "FETCH bsft001_wf_cl:",SQLERRMESSAGE
               LET g_errparam.code = SQLCA.SQLCODE
               LET g_errparam.popup = TRUE
               CLOSE bsft001_wf_cl
               #PostgreSQL???????, ????????????
               CALL s_transaction_end('N','0')
               CALL s_transaction_begin()
               CALL cl_err()
               RETURN
            END IF
            #200804-00006 --- end ---
            OPEN bsft001_wf_bcl USING g_enterprise, g_site,g_sfajwf_m.sfajwfdocno,g_sfakwf_d[g_detail_idx].sfakwfseq
            IF SQLCA.SQLCODE THEN   #(ver:78)
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "OPEN bsft001_wf_bcl:",SQLERRMESSAGE 
               LET g_errparam.code = SQLCA.SQLCODE   #(ver:78)
               LET g_errparam.popup = TRUE 
               CLOSE bsft001_wf_cl
               CLOSE bsft001_wf_bcl
               CALL s_transaction_end('N','0')
               CALL cl_err()
               RETURN
            END IF
            #200804-00006 ---start---
            FETCH bsft001_wf_bcl
            IF SQLCA.SQLCODE AND SQLCA.SQLCODE <> 100 THEN
               INITIALIZE g_errparam TO NULL
               LET g_errparam.extend = "FETCH bsft001_wf_bcl:",SQLERRMESSAGE
               LET g_errparam.code = SQLCA.SQLCODE
               LET g_errparam.popup = TRUE
               CLOSE bsft001_wf_cl
               CLOSE bsft001_wf_bcl
               #PostgreSQL???????, ????????????
               CALL s_transaction_end('N','0')
               CALL s_transaction_begin()
               CALL cl_err()
               RETURN
            END IF
            #200804-00006 --- end ---
            
            LET g_rec_b = g_sfakwf3_d.getLength()
            
            IF g_rec_b >= l_ac 
               AND g_sfakwf3_d[l_ac].wfapwfseq1 IS NOT NULL
            THEN 
               LET l_cmd='u'
               LET g_sfakwf3_d_t.* = g_sfakwf3_d[l_ac].*  #BACKUP
               LET g_sfakwf3_d_o.* = g_sfakwf3_d[l_ac].*  #BACKUP
               CALL bsft001_wf_set_entry_b(l_cmd)
               #add-point:modify?after_set_entry_b name="input.body3.after_set_entry_b"

               #end add-point  
               CALL bsft001_wf_set_no_entry_b(l_cmd)
               IF NOT bsft001_wf_lock_b("wfapwf_t","'3'") THEN
                  LET l_lock_sw='Y'
               ELSE
                  FETCH bsft001_wf_bcl4 INTO g_sfakwf3_d[l_ac].wfapwfseq1,g_sfakwf3_d[l_ac].wfapwf001,g_sfakwf3_d[l_ac].wfapwf002,g_sfakwf3_d[l_ac].wfapwf003,g_sfakwf3_d[l_ac].wfapwf004,g_sfakwf3_d[l_ac].wfapwf005,g_sfakwf3_d[l_ac].wfapwf006,g_sfakwf3_d[l_ac].wfapwf007,g_sfakwf3_d[l_ac].wfapwf008,g_sfakwf3_d[l_ac].wfapwf009, 
                      g_sfakwf3_d[l_ac].wfapwf010,g_sfakwf3_d[l_ac].wfapwf011,g_sfakwf3_d[l_ac].wfapwf012,g_sfakwf3_d[l_ac].wfapwf013,g_sfakwf3_d[l_ac].wfapwf014,g_sfakwf3_d[l_ac].wfapwf015,g_sfakwf3_d[l_ac].wfapwf016,g_sfakwf3_d[l_ac].wfapwf017,g_sfakwf3_d[l_ac].wfapwf018,g_sfakwf3_d[l_ac].wfapwf022, 
                      g_sfakwf3_d[l_ac].wfapwf019,g_sfakwf3_d[l_ac].wfapwf021,g_sfakwf3_d[l_ac].wfapwf020,g_sfakwf3_d[l_ac].wfapwf023,g_sfakwf3_d[l_ac].wfapwf024,g_sfakwf3_d[l_ac].wfapwf025,g_sfakwf3_d[l_ac].wfapwf026
                  IF SQLCA.SQLCODE THEN
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = SQLERRMESSAGE 
                     LET g_errparam.code = SQLCA.SQLCODE 
                     LET g_errparam.popup = TRUE 
                     CALL cl_err()
                     LET l_lock_sw = "Y"
                  END IF
                  
                  #??????
                  LET g_sfakwf3_d_mask_o[l_ac].* =  g_sfakwf3_d[l_ac].*
                  CALL bsft001_wf_wfapwf_t_mask()
                  LET g_sfakwf3_d_mask_n[l_ac].* =  g_sfakwf3_d[l_ac].*
                  
                  LET g_bfill = "N"
                  CALL bsft001_wf_show()
                  LET g_bfill = "Y"
                  
                  CALL cl_show_fld_cont()
               END IF
            ELSE
               LET l_cmd='a'
            END IF
            #add-point:modify?before row name="input.body3.before_row"
            
            #end add-point  
            #??table????(???????)
            
 
            #??table??lock
            
 
            CALL bsft001_wf_idx_chk()   #(ver:83)
            
         BEFORE DELETE                            #??????
            IF l_cmd = 'a' THEN
               LET l_cmd='d'
               #add-point:??AFTER DELETE (=d) name="input.body3.after_delete_d"

               #end add-point
            ELSE
               #add-point:????? name="input.body3.b_delete_ask"

               #end add-point 
               IF NOT cl_ask_del_detail() THEN
                  CANCEL DELETE
               END IF
               IF l_lock_sw = "Y" THEN
                  INITIALIZE g_errparam TO NULL 
                  LET g_errparam.extend = "" 
                  LET g_errparam.code = -263 
                  LET g_errparam.popup = TRUE 
                  CALL cl_err()
                  CANCEL DELETE
               END IF
               
               #add-point:??3??? name="input.body3.b_delete"

               #end add-point    
 
               #??????key?
                              INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_sfajwf_m.sfajwfdocno
               LET gs_keys[2] = g_sfakwf_d[g_detail_idx].sfakwfseq
               LET gs_keys[3] = g_sfakwf3_d_t.wfapwfseq1
 
 
               #??????
               IF NOT bsft001_wf_delete_b('wfapwf_t',gs_keys,"'3'") THEN
                  CALL s_transaction_end('N','0')
                  CLOSE bsft001_wf_bcl
                  CANCEL DELETE
               END IF
               
               #?????
               
 
               
   #161130-00056 add
  
               #add-point:??3??? name="input.body3.m_delete"

               #end add-point   
               
               CALL s_transaction_end('Y','0')
               CLOSE bsft001_wf_bcl
                  
               LET g_rec_b = g_rec_b-1
               #add-point:??3??? name="input.body3.a_delete"

               #end add-point
 
               LET l_count = g_sfakwf_d.getLength()
               
               #add-point:?????(<>d) name="input.body3.after_delete"

               #end add-point
            END IF 
 
         AFTER DELETE
            #???????
            IF l_ac = (g_sfakwf3_d.getLength() + 1) THEN
               CALL FGL_SET_ARR_CURR(l_ac-1)
            END IF
         
         AFTER INSERT    
            LET l_insert = FALSE
            IF INT_FLAG THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code = 9001 
               LET g_errparam.popup = FALSE 
               CALL cl_err()
               LET INT_FLAG = 0
               CANCEL INSERT
            END IF
               
            #add-point:??3??? name="input.body3.b_a_insert"

            #end add-point
    
            LET l_count = 1  
            SELECT COUNT(1) INTO l_count FROM wfapwf_t 
             WHERE wfapwfent = g_enterprise AND wfapwfsite = g_site AND wfapwfdocno = g_sfajwf_m.sfajwfdocno AND wfapwfseq = g_sfakwf_d[g_detail_idx].sfakwfseq AND wfapwfseq1 = g_sfakwf3_d[g_detail_idx2].wfapwfseq1
                
            #?????, ??????
            IF l_count = 0 THEN 
               #add-point:??3??? name="input.body3.b_insert"

               #end add-point
            
                              INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_sfajwf_m.sfajwfdocno
               LET gs_keys[2] = g_sfakwf_d[g_detail_idx].sfakwfseq
               LET gs_keys[3] = g_sfakwf3_d[g_detail_idx2].wfapwfseq1
               CALL bsft001_wf_insert_b('wfapwf_t',gs_keys,"'3'")
                           
               #add-point:?????3 name="input.body3.a_insert"

               #end add-point
            ELSE    
               INITIALIZE g_sfakwf_d[l_ac].* TO NULL
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = 'INSERT' 
               LET g_errparam.code = "std-00006" 
               LET g_errparam.popup = TRUE 
               CALL s_transaction_end('N','0')
               CALL cl_err()
               CANCEL INSERT
            END IF
 
            IF SQLCA.SQLCODE THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "wfapwf_t:",SQLERRMESSAGE 
               LET g_errparam.code = SQLCA.SQLCODE 
               LET g_errparam.popup = TRUE 
               CALL s_transaction_end('N','0')                    
               CALL cl_err()
               CANCEL INSERT
            ELSE
               #?????
               #CALL bsft001_wf_b_fill()
               #??????-?/?
               
                  #161130-00056 add
               #add-point:????? name="input.body3.after_insert"

               #end add-point
               CALL s_transaction_end('Y','0')
               #ERROR 'INSERT O.K'
               LET g_rec_b = g_rec_b + 1
            END IF
            
            #??g_detail_idx
            LET g_detail_idx = g_detail_idx_tmp
            
         ON ROW CHANGE 
            IF INT_FLAG THEN
               LET INT_FLAG = 0
               LET g_sfakwf3_d[l_ac].* = g_sfakwf3_d_t.*
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code = 9001 
               LET g_errparam.popup = FALSE 
               CLOSE bsft001_wf_bcl4
               CALL s_transaction_end('N','0')
               CALL cl_err()
               EXIT DIALOG 
            END IF
            
            IF l_lock_sw = 'Y' THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code = -263 
               LET g_errparam.popup = TRUE 
               CALL cl_err()
               LET g_sfakwf3_d[l_ac].* = g_sfakwf3_d_t.*
               EXIT DIALOG   #210416-00007
            ELSE
               #add-point:??page3??? name="input.body3.b_update"

               #end add-point
               
               #?????/??????(??3)
               
               
               #???????
               CALL bsft001_wf_wfapwf_t_mask_restore('restore_mask_o')
               
               UPDATE wfapwf_t SET (wfapwfdocno,wfapwfseq,wfapwfseq1,wfapwf001,wfapwf002,wfapwf003,wfapwf004,wfapwf005,wfapwf006,wfapwf007,wfapwf008,wfapwf009,wfapwf010,wfapwf011,wfapwf012,wfapwf013,wfapwf014,wfapwf015,wfapwf016,wfapwf017,wfapwf018,wfapwf022,wfapwf019,wfapwf021,wfapwf020,wfapwf023,wfapwf024, 
                   wfapwf025,wfapwf026) = (g_sfajwf_m.sfajwfdocno,g_sfakwf_d[g_detail_idx].sfakwfseq,g_sfakwf3_d[l_ac].wfapwfseq1,g_sfakwf3_d[l_ac].wfapwf001,g_sfakwf3_d[l_ac].wfapwf002,g_sfakwf3_d[l_ac].wfapwf003,g_sfakwf3_d[l_ac].wfapwf004,g_sfakwf3_d[l_ac].wfapwf005,g_sfakwf3_d[l_ac].wfapwf006,g_sfakwf3_d[l_ac].wfapwf007, 
                   g_sfakwf3_d[l_ac].wfapwf008,g_sfakwf3_d[l_ac].wfapwf009,g_sfakwf3_d[l_ac].wfapwf010,g_sfakwf3_d[l_ac].wfapwf011,g_sfakwf3_d[l_ac].wfapwf012,g_sfakwf3_d[l_ac].wfapwf013,g_sfakwf3_d[l_ac].wfapwf014,g_sfakwf3_d[l_ac].wfapwf015,g_sfakwf3_d[l_ac].wfapwf016,g_sfakwf3_d[l_ac].wfapwf017,g_sfakwf3_d[l_ac].wfapwf018, 
                   g_sfakwf3_d[l_ac].wfapwf022,g_sfakwf3_d[l_ac].wfapwf019,g_sfakwf3_d[l_ac].wfapwf021,g_sfakwf3_d[l_ac].wfapwf020,g_sfakwf3_d[l_ac].wfapwf023,g_sfakwf3_d[l_ac].wfapwf024,g_sfakwf3_d[l_ac].wfapwf025,g_sfakwf3_d[l_ac].wfapwf026) #??????
                WHERE wfapwfent = g_enterprise AND wfapwfsite = g_site AND wfapwfdocno = g_sfajwfdocno_t AND wfapwfseq = g_sfakwf_d[g_detail_idx].sfakwfseq AND wfapwfseq1 = g_sfakwf3_d_t.wfapwfseq1
                  
               #add-point:??page3??? name="input.body3.m_update"

               #end add-point
                  
               CASE
                  WHEN SQLCA.sqlerrd[3] = 0  #???????
                     LET g_sfakwf3_d[l_ac].* = g_sfakwf3_d_t.*
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = "wfapwf_t" 
                     LET g_errparam.code = "std-00009" 
                     LET g_errparam.popup = TRUE 
                     CALL s_transaction_end('N','0')
                     CALL cl_err()
                     EXIT DIALOG   #210416-00007
                     
                  WHEN SQLCA.SQLCODE #????
                     LET g_sfakwf3_d[l_ac].* = g_sfakwf3_d_t.*
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = "wfapwf_t:",SQLERRMESSAGE 
                     LET g_errparam.code = SQLCA.SQLCODE 
                     LET g_errparam.popup = TRUE 
                     CALL s_transaction_end('N','0')
                     CALL cl_err()
                     EXIT DIALOG   #210416-00007
                     
                  OTHERWISE
                     #??????-?/?
                     
                        #161130-00056 add
                                    INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_sfajwf_m.sfajwfdocno
               LET gs_keys_bak[1] = g_sfajwfdocno_t
               LET gs_keys[2] = g_sfakwf_d[g_detail_idx].sfakwfseq
               LET gs_keys_bak[2] = g_sfakwf_d[g_detail_idx].sfakwfseq
               LET gs_keys[3] = g_sfakwf3_d[g_detail_idx2].wfapwfseq1
               LET gs_keys_bak[3] = g_sfakwf3_d_t.wfapwfseq1
               CALL bsft001_wf_update_b('wfapwf_t',gs_keys,gs_keys_bak,"'3'")
               END CASE
               
               #210416-00007 ????add-point ---start---
               #add-point:??page3????????? name="input.body3.a_update_b_mask"

               #end add-point
               #210416-00007 ????add-point --- end ---
               #?????????
               CALL bsft001_wf_wfapwf_t_mask_restore('restore_mask_n')
               
               #??????(????)
               LET g_log1 = util.JSON.stringify(g_sfajwf_m),util.JSON.stringify(g_sfakwf3_d_t)
               LET g_log2 = util.JSON.stringify(g_sfajwf_m),util.JSON.stringify(g_sfakwf3_d[l_ac])
               IF NOT cl_log_modified_record_d(g_log1,g_log2) THEN 
                  CALL s_transaction_end('N','0')
                  EXIT DIALOG   #210416-00007
               END IF
               
               #add-point:??page3??? name="input.body3.a_update"

               #end add-point
            END IF
         
                  #?? a01 ??????(Version:2)
         BEFORE FIELD wfapwfseq1
            #add-point:BEFORE FIELD wfapwfseq1 name="input.b.page3.wfapwfseq1"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD wfapwfseq1
            
            #add-point:AFTER FIELD wfapwfseq1 name="input.a.page3.wfapwfseq1"
            #?? a05 ??????(Version:3)
            #???????
            IF  g_sfajwf_m.sfajwfdocno IS NOT NULL AND g_sfakwf_d[g_detail_idx].sfakwfseq IS NOT NULL AND g_sfakwf3_d[g_detail_idx2].wfapwfseq1 IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_sfajwf_m.sfajwfdocno != g_sfajwfdocno_t OR g_sfakwf_d[g_detail_idx].sfakwfseq != g_sfakwf_d[g_detail_idx].sfakwfseq OR g_sfakwf3_d[g_detail_idx2].wfapwfseq1 != g_sfakwf3_d_t.wfapwfseq1)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(1) FROM wfapwf_t WHERE "||"wfapwfent = " ||g_enterprise|| " AND wfapwfsite = '" ||g_site|| "' AND "||"wfapwfdocno = '"||g_sfajwf_m.sfajwfdocno ||"' AND "|| "wfapwfseq = '"||g_sfakwf_d[g_detail_idx].sfakwfseq ||"' AND "|| "wfapwfseq1 = '"||g_sfakwf3_d[g_detail_idx2].wfapwfseq1 ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF



            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE wfapwfseq1
            #add-point:ON CHANGE wfapwfseq1 name="input.g.page3.wfapwfseq1"

            #END add-point 
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD wfapwf001
            
            #add-point:AFTER FIELD wfapwf001 name="input.a.page3.wfapwf001"
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_sfakwf3_d[l_ac].wfapwf001
            CALL ap_ref_array2(g_ref_fields,"SELECT imaal003 FROM imaal_t WHERE imaalent="||g_enterprise||" AND imaal001=? AND imaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_sfakwf3_d[l_ac].wfapwf001_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_sfakwf3_d[l_ac].wfapwf001_desc

            LET g_sfakwf3_d[l_ac].wfapwf001_desc = ''
            LET g_sfakwf3_d[l_ac].wfapwf001_desc_1 = ''
            IF NOT cl_null(g_sfakwf3_d[l_ac].wfapwf001) THEN
               IF g_sfakwf3_d[l_ac].wfapwf001 != g_sfakwf_d_o.sfakwf001 OR cl_null(g_sfakwf_d_o.sfakwf001) THEN
                  IF NOT bsft001_wf_wfapwf001_chk() THEN
                     LET g_sfakwf3_d[l_ac].wfapwf001 = g_sfakwf_d_o.sfakwf001
                     CALL s_desc_get_item_desc(g_sfakwf3_d[l_ac].wfapwf001) RETURNING g_sfakwf3_d[l_ac].wfapwf001_desc,g_sfakwf3_d[l_ac].wfapwf001_desc_1
                     DISPLAY BY NAME g_sfakwf3_d[l_ac].wfapwf001,g_sfakwf3_d[l_ac].wfapwf001_desc,g_sfakwf3_d[l_ac].wfapwf001_desc_1
                     NEXT FIELD CURRENT
                  END IF 
                  CALL bsft001_wf_sfakwf001_ref(l_cmd)                  
               END IF  
               IF g_sfajwf_m.sfajwf013 <> '3' THEN 
                  LET g_sfakwf_d[l_ac].sfakwf006 = 0                  
               END IF               
            END IF

            LET g_sfakwf3_d_o.wfapwf001 = g_sfakwf3_d[l_ac].wfapwf001
            CALL bsft001_wf_set_entry(p_cmd)
            CALL bsft001_wf_set_no_entry(p_cmd)
            DISPLAY BY NAME g_sfakwf3_d[l_ac].wfapwf001_desc,g_sfakwf3_d[l_ac].wfapwf001_desc_1  
            #END add-point
            
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD wfapwf001
            #add-point:BEFORE FIELD wfapwf001 name="input.b.page3.wfapwf001"

            #END add-point
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE wfapwf001
            #add-point:ON CHANGE wfapwf001 name="input.g.page3.wfapwf001"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD wfapwf002
            #add-point:BEFORE FIELD wfapwf002 name="input.b.page3.wfapwf002"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD wfapwf002
            
            #add-point:AFTER FIELD wfapwf002 name="input.a.page3.wfapwf002"
            IF cl_null(g_sfakwf3_d[l_ac].wfapwf002) THEN
               LET g_sfakwf3_d[l_ac].wfapwf002 = ' '
            ELSE
               IF g_sfakwf3_d_o.wfapwf002 IS NULL OR g_sfakwf3_d[l_ac].wfapwf002 != g_sfakwf3_d_o.wfapwf002 THEN
                  IF NOT cl_null(g_sfakwf3_d[l_ac].wfapwf001) THEN                
                    #160727-00025#1-s
                     CALL s_aooi200_get_slip(g_sfajwf_m.sfajwfdocno) RETURNING l_success,l_ooba002
                    #IF g_sfajwf_m.sfajwf003 MATCHES '[145]' THEN
                     IF g_sfajwf_m.sfajwf003 MATCHES '[14]' OR
                       (g_sfajwf_m.sfajwf003 = '5' AND cl_get_doc_para(g_enterprise,g_site,l_ooba002,'D-MFG-0024') <> '2') THEN
                    #160727-00025#1-e
                        LET l_bmaa001 = ''
                        LET l_bmaastus = ''
                        LET l_sql = " SELECT bmaa001,bmaastus FROM bmaa_t ",
                                    "  WHERE bmaaent = ",g_enterprise," AND bmaasite = '",g_site,"' ",
                                    "    AND bmaa001 = '", g_sfakwf3_d[l_ac].wfapwf001,"' AND bmaa002 = '",g_sfakwf3_d[l_ac].wfapwf002,"' "
                        PREPARE sel_bmaa_pre1 FROM l_sql
                        EXECUTE sel_bmaa_pre1 INTO l_bmaa001,l_bmaastus
                        IF cl_null(l_bmaa001) THEN
                           INITIALIZE g_errparam TO NULL
                           LET g_errparam.code = 'asf-00045'
                           LET g_errparam.extend = g_sfakwf3_d[l_ac].wfapwf002
                           LET g_errparam.popup = TRUE
                           CALL cl_err()
                           LET g_sfakwf3_d[l_ac].wfapwf002 = g_sfakwf3_d_o.wfapwf002
                           DISPLAY BY NAME g_sfakwf3_d[l_ac].wfapwf002
                           NEXT FIELD wfapwf002
                        END IF
                        IF cl_null(l_bmaastus) THEN
                           INITIALIZE g_errparam TO NULL
                           LET g_errparam.code = 'asf-00045'
                           LET g_errparam.extend = g_sfakwf3_d[l_ac].wfapwf002
                           LET g_errparam.popup = TRUE
                           CALL cl_err()
                           LET g_sfakwf3_d[l_ac].wfapwf002 = g_sfakwf3_d_o.wfapwf002
                           DISPLAY BY NAME g_sfakwf3_d[l_ac].wfapwf002
                           NEXT FIELD wfapwf002
                        END IF
                     END IF
                     #161216-00029#10 add(s)
                     LET l_n = 0 
                     SELECT COUNT(*) INTO l_n
                      FROM bmaa_t
                     WHERE bmaa001 = g_sfakwf3_d[l_ac].wfapwf001
                       AND bmaa002 = g_sfakwf3_d[l_ac].wfapwf002
                       AND bmaaent = g_enterprise
                       AND bmaasite = g_site
                       AND bmaastus = 'VO'
                     IF l_n > 0 THEN
                        INITIALIZE g_errparam TO NULL
                        LET g_errparam.code = 'abm-00274'
                        LET g_errparam.popup = TRUE
                        CALL cl_err()
                        LET g_sfakwf3_d[l_ac].wfapwf002 = g_sfakwf3_d_o.wfapwf002
                        NEXT FIELD CURRENT
                     END IF
                     #161216-00029#10 add(e)
                  END IF 
               END IF
            END IF
            LET g_sfakwf3_d_o.wfapwf002 = g_sfakwf3_d[l_ac].wfapwf002
            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE wfapwf002
            #add-point:ON CHANGE wfapwf002 name="input.g.page3.wfapwf002"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD wfapwf003
            #add-point:BEFORE FIELD wfapwf003 name="input.b.page3.wfapwf003"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD wfapwf003
            
            #add-point:AFTER FIELD wfapwf003 name="input.a.page3.wfapwf003"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE wfapwf003
            #add-point:ON CHANGE wfapwf003 name="input.g.page3.wfapwf003"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD wfapwf004
            #add-point:BEFORE FIELD wfapwf004 name="input.b.page3.wfapwf004"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD wfapwf004
            
            #add-point:AFTER FIELD wfapwf004 name="input.a.page3.wfapwf004"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE wfapwf004
            #add-point:ON CHANGE wfapwf004 name="input.g.page3.wfapwf004"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD wfapwf005
            #add-point:BEFORE FIELD wfapwf005 name="input.b.page3.wfapwf005"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD wfapwf005
            
            #add-point:AFTER FIELD wfapwf005 name="input.a.page3.wfapwf005"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE wfapwf005
            #add-point:ON CHANGE wfapwf005 name="input.g.page3.wfapwf005"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD wfapwf006
            #add-point:BEFORE FIELD wfapwf006 name="input.b.page3.wfapwf006"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD wfapwf006
            
            #add-point:AFTER FIELD wfapwf006 name="input.a.page3.wfapwf006"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE wfapwf006
            #add-point:ON CHANGE wfapwf006 name="input.g.page3.wfapwf006"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD wfapwf007
            #add-point:BEFORE FIELD wfapwf007 name="input.b.page3.wfapwf007"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD wfapwf007
            
            #add-point:AFTER FIELD wfapwf007 name="input.a.page3.wfapwf007"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE wfapwf007
            #add-point:ON CHANGE wfapwf007 name="input.g.page3.wfapwf007"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD wfapwf008
            #add-point:BEFORE FIELD wfapwf008 name="input.b.page3.wfapwf008"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD wfapwf008
            
            #add-point:AFTER FIELD wfapwf008 name="input.a.page3.wfapwf008"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE wfapwf008
            #add-point:ON CHANGE wfapwf008 name="input.g.page3.wfapwf008"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD wfapwf009
            #add-point:BEFORE FIELD wfapwf009 name="input.b.page3.wfapwf009"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD wfapwf009
            
            #add-point:AFTER FIELD wfapwf009 name="input.a.page3.wfapwf009"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE wfapwf009
            #add-point:ON CHANGE wfapwf009 name="input.g.page3.wfapwf009"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD wfapwf010
            #add-point:BEFORE FIELD wfapwf010 name="input.b.page3.wfapwf010"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD wfapwf010
            
            #add-point:AFTER FIELD wfapwf010 name="input.a.page3.wfapwf010"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE wfapwf010
            #add-point:ON CHANGE wfapwf010 name="input.g.page3.wfapwf010"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD wfapwf011
            #add-point:BEFORE FIELD wfapwf011 name="input.b.page3.wfapwf011"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD wfapwf011
            
            #add-point:AFTER FIELD wfapwf011 name="input.a.page3.wfapwf011"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE wfapwf011
            #add-point:ON CHANGE wfapwf011 name="input.g.page3.wfapwf011"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD wfapwf012
            #add-point:BEFORE FIELD wfapwf012 name="input.b.page3.wfapwf012"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD wfapwf012
            
            #add-point:AFTER FIELD wfapwf012 name="input.a.page3.wfapwf012"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE wfapwf012
            #add-point:ON CHANGE wfapwf012 name="input.g.page3.wfapwf012"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD wfapwf013
            #add-point:BEFORE FIELD wfapwf013 name="input.b.page3.wfapwf013"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD wfapwf013
            
            #add-point:AFTER FIELD wfapwf013 name="input.a.page3.wfapwf013"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE wfapwf013
            #add-point:ON CHANGE wfapwf013 name="input.g.page3.wfapwf013"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD wfapwf014
            #add-point:BEFORE FIELD wfapwf014 name="input.b.page3.wfapwf014"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD wfapwf014
            
            #add-point:AFTER FIELD wfapwf014 name="input.a.page3.wfapwf014"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE wfapwf014
            #add-point:ON CHANGE wfapwf014 name="input.g.page3.wfapwf014"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD wfapwf015
            #add-point:BEFORE FIELD wfapwf015 name="input.b.page3.wfapwf015"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD wfapwf015
            
            #add-point:AFTER FIELD wfapwf015 name="input.a.page3.wfapwf015"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE wfapwf015
            #add-point:ON CHANGE wfapwf015 name="input.g.page3.wfapwf015"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD wfapwf016
            #add-point:BEFORE FIELD wfapwf016 name="input.b.page3.wfapwf016"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD wfapwf016
            
            #add-point:AFTER FIELD wfapwf016 name="input.a.page3.wfapwf016"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE wfapwf016
            #add-point:ON CHANGE wfapwf016 name="input.g.page3.wfapwf016"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD wfapwf017
            #add-point:BEFORE FIELD wfapwf017 name="input.b.page3.wfapwf017"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD wfapwf017
            
            #add-point:AFTER FIELD wfapwf017 name="input.a.page3.wfapwf017"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE wfapwf017
            #add-point:ON CHANGE wfapwf017 name="input.g.page3.wfapwf017"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD wfapwf018
            #add-point:BEFORE FIELD wfapwf018 name="input.b.page3.wfapwf018"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD wfapwf018
            
            #add-point:AFTER FIELD wfapwf018 name="input.a.page3.wfapwf018"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE wfapwf018
            #add-point:ON CHANGE wfapwf018 name="input.g.page3.wfapwf018"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD wfapwf022
            #add-point:BEFORE FIELD wfapwf022 name="input.b.page3.wfapwf022"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD wfapwf022
            
            #add-point:AFTER FIELD wfapwf022 name="input.a.page3.wfapwf022"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE wfapwf022
            #add-point:ON CHANGE wfapwf022 name="input.g.page3.wfapwf022"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD wfapwf019
            #add-point:BEFORE FIELD wfapwf019 name="input.b.page3.wfapwf019"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD wfapwf019
            
            #add-point:AFTER FIELD wfapwf019 name="input.a.page3.wfapwf019"
            IF NOT cl_null(g_sfakwf3_d[l_ac].wfapwf019) THEN 
               #??g_chkparam.*?????????????????????????????
               INITIALIZE g_chkparam.* TO NULL
 
               #??g_chkparam.*???
               LET g_chkparam.arg1 = g_sfakwf3_d[l_ac].wfapwf019
               #LET g_chkparam.arg2 = g_sfajwf_m.sfajwf006 #??
               LET g_chkparam.arg3 = g_sfakwf3_d[l_ac].wfapwf001 #??
               LET g_chkparam.arg4 = g_sfajwf_m.sfajwf016  #??/??
               #240423-00009#2 --s
               #IC?????????=??,????????=2.???3.????
               IF g_sfajwf_m.sfajwf005 = '1' THEN
                  LET g_chkparam.arg5 = "'2','3'"
               ELSE
               #????=??????????????=1.????3.????
                  LET l_qwhere = ''
                  LET g_chkparam.arg5 = "'1','3'"
                  LET l_qwhere = l_qwhere," wfagwf009='",g_sfajwf_m.sfajwf006,"'"
                  LET g_chkparam.where = l_qwhere
               END IF
               #240423-00009#2 --e
               #??????????library
               IF cl_chk_exist("v_sfakwf011_01_wf") THEN
                  #?????????
               ELSE
                  #?????????
                  NEXT FIELD CURRENT
               END IF
 


            END IF 
            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE wfapwf019
            #add-point:ON CHANGE wfapwf019 name="input.g.page3.wfapwf019"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf012_1
            #add-point:BEFORE FIELD sfakwf012_1 name="input.b.page3.sfakwf012_1"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf012_1
            
            #add-point:AFTER FIELD sfakwf012_1 name="input.a.page3.sfakwf012_1"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfakwf012_1
            #add-point:ON CHANGE sfakwf012_1 name="input.g.page3.sfakwf012_1"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf013_1
            #add-point:BEFORE FIELD sfakwf013_1 name="input.b.page3.sfakwf013_1"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf013_1
            
            #add-point:AFTER FIELD sfakwf013_1 name="input.a.page3.sfakwf013_1"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfakwf013_1
            #add-point:ON CHANGE sfakwf013_1 name="input.g.page3.sfakwf013_1"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf014_1
            #add-point:BEFORE FIELD sfakwf014_1 name="input.b.page3.sfakwf014_1"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf014_1
            
            #add-point:AFTER FIELD sfakwf014_1 name="input.a.page3.sfakwf014_1"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfakwf014_1
            #add-point:ON CHANGE sfakwf014_1 name="input.g.page3.sfakwf014_1"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf015_1
            #add-point:BEFORE FIELD sfakwf015_1 name="input.b.page3.sfakwf015_1"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf015_1
            
            #add-point:AFTER FIELD sfakwf015_1 name="input.a.page3.sfakwf015_1"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfakwf015_1
            #add-point:ON CHANGE sfakwf015_1 name="input.g.page3.sfakwf015_1"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD wfapwf021
            #add-point:BEFORE FIELD wfapwf021 name="input.b.page3.wfapwf021"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD wfapwf021
            
            #add-point:AFTER FIELD wfapwf021 name="input.a.page3.wfapwf021"
            IF NOT cl_null(g_sfakwf3_d[l_ac].wfapwf021) THEN 
               #??g_chkparam.*?????????????????????????????
               INITIALIZE g_chkparam.* TO NULL
 
               #??g_chkparam.*??? 
               LET g_chkparam.arg1 = g_sfakwf3_d[l_ac].wfapwf021 
               #LET g_chkparam.arg2 = g_sfajwf_m.sfajwf006 #??
               LET g_chkparam.arg3 = g_sfakwf3_d[l_ac].wfapwf001 #??
               #240423-00009#2 --s
               #IC?????????=??,????????=2.???3.????
               IF g_sfajwf_m.sfajwf005 = '1' THEN
                  LET g_chkparam.arg4 = "'2','3'"
               ELSE
               #????=??????????????=1.????3.????
                  LET l_qwhere = ''
                  LET g_chkparam.arg4 = "'1','3'"
                  LET l_qwhere = l_qwhere," wfahwf004='",g_sfajwf_m.sfajwf006,"'"
                  LET g_chkparam.where = l_qwhere
               END IF
               #240423-00009#2 --e
               #??????????library
               IF cl_chk_exist("v_sfakwf016_01_wf") THEN
                  #?????????
               ELSE
                  #?????????
                  NEXT FIELD CURRENT
               END IF
 


            END IF 
            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE wfapwf021
            #add-point:ON CHANGE wfapwf021 name="input.g.page3.wfapwf021"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf017_1
            #add-point:BEFORE FIELD sfakwf017_1 name="input.b.page3.sfakwf017_1"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf017_1
            
            #add-point:AFTER FIELD sfakwf017_1 name="input.a.page3.sfakwf017_1"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfakwf017_1
            #add-point:ON CHANGE sfakwf017_1 name="input.g.page3.sfakwf017_1"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf018_1
            #add-point:BEFORE FIELD sfakwf018_1 name="input.b.page3.sfakwf018_1"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf018_1
            
            #add-point:AFTER FIELD sfakwf018_1 name="input.a.page3.sfakwf018_1"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfakwf018_1
            #add-point:ON CHANGE sfakwf018_1 name="input.g.page3.sfakwf018_1"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf019_1
            #add-point:BEFORE FIELD sfakwf019_1 name="input.b.page3.sfakwf019_1"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf019_1
            
            #add-point:AFTER FIELD sfakwf019_1 name="input.a.page3.sfakwf019_1"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfakwf019_1
            #add-point:ON CHANGE sfakwf019_1 name="input.g.page3.sfakwf019_1"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf020_1
            #add-point:BEFORE FIELD sfakwf020_1 name="input.b.page3.sfakwf020_1"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf020_1
            
            #add-point:AFTER FIELD sfakwf020_1 name="input.a.page3.sfakwf020_1"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfakwf020_1
            #add-point:ON CHANGE sfakwf020_1 name="input.g.page3.sfakwf020_1"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf021_1
            #add-point:BEFORE FIELD sfakwf021_1 name="input.b.page3.sfakwf021_1"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf021_1
            
            #add-point:AFTER FIELD sfakwf021_1 name="input.a.page3.sfakwf021_1"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfakwf021_1
            #add-point:ON CHANGE sfakwf021_1 name="input.g.page3.sfakwf021_1"

            #END add-point 
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD wfapwf020
            
            #add-point:AFTER FIELD wfapwf020 name="input.a.page3.wfapwf020"
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_sfakwf3_d[l_ac].wfapwf020
            CALL ap_ref_array2(g_ref_fields,"SELECT wfajwfl003 FROM wfajwfl_t WHERE wfajwflent="||g_enterprise||" AND wfajwfl001=? AND wfajwfl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_sfakwf3_d[l_ac].wfapwf020_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_sfakwf3_d[l_ac].wfapwf020_desc
            
            IF NOT cl_null(g_sfakwf3_d[l_ac].wfapwf020) THEN 
               #??g_chkparam.*?????????????????????????????
               INITIALIZE g_chkparam.* TO NULL
 
               #??g_chkparam.*???
               LET g_chkparam.arg1 = g_sfakwf3_d[l_ac].wfapwf020
               LET g_chkparam.arg2 = g_sfajwf_m.sfajwf006 #??
               LET g_chkparam.arg3 = g_sfakwf3_d[l_ac].wfapwf001 #??
               LET g_chkparam.arg4 = g_sfajwf_m.sfajwf016  #??/??
                  
               #??????????library
               IF cl_chk_exist("v_wfajwf001_wf") THEN
                  #?????????
               ELSE
                  #?????????
                  NEXT FIELD CURRENT
               END IF
            END IF 

            #END add-point
            
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD wfapwf020
            #add-point:BEFORE FIELD wfapwf020 name="input.b.page3.wfapwf020"

            #END add-point
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE wfapwf020
            #add-point:ON CHANGE wfapwf020 name="input.g.page3.wfapwf020"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf023_1
            #add-point:BEFORE FIELD sfakwf023_1 name="input.b.page3.sfakwf023_1"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf023_1
            
            #add-point:AFTER FIELD sfakwf023_1 name="input.a.page3.sfakwf023_1"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfakwf023_1
            #add-point:ON CHANGE sfakwf023_1 name="input.g.page3.sfakwf023_1"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD wfapwf023
            #add-point:BEFORE FIELD wfapwf023 name="input.b.page3.wfapwf023"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD wfapwf023
            
            #add-point:AFTER FIELD wfapwf023 name="input.a.page3.wfapwf023"
            IF NOT cl_null(g_sfakwf3_d[l_ac].wfapwf023) THEN 
               #??g_chkparam.*?????????????????????????????
               INITIALIZE g_chkparam.* TO NULL
 
               #??g_chkparam.*???
               LET g_chkparam.arg1 = g_sfakwf3_d[l_ac].wfapwf023 
               LET g_chkparam.arg2 = g_sfakwf3_d[l_ac].wfapwf001 #??
                  
               #??????????library
               IF cl_chk_exist("v_wfalwf001_wf") THEN
                  #?????????
               ELSE
                  #?????????
                  NEXT FIELD CURRENT
               END IF
            END IF 

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE wfapwf023
            #add-point:ON CHANGE wfapwf023 name="input.g.page3.wfapwf023"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf025_1
            #add-point:BEFORE FIELD sfakwf025_1 name="input.b.page3.sfakwf025_1"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf025_1
            
            #add-point:AFTER FIELD sfakwf025_1 name="input.a.page3.sfakwf025_1"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfakwf025_1
            #add-point:ON CHANGE sfakwf025_1 name="input.g.page3.sfakwf025_1"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf026_1
            #add-point:BEFORE FIELD sfakwf026_1 name="input.b.page3.sfakwf026_1"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf026_1
            
            #add-point:AFTER FIELD sfakwf026_1 name="input.a.page3.sfakwf026_1"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfakwf026_1
            #add-point:ON CHANGE sfakwf026_1 name="input.g.page3.sfakwf026_1"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf027_1
            #add-point:BEFORE FIELD sfakwf027_1 name="input.b.page3.sfakwf027_1"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf027_1
            
            #add-point:AFTER FIELD sfakwf027_1 name="input.a.page3.sfakwf027_1"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfakwf027_1
            #add-point:ON CHANGE sfakwf027_1 name="input.g.page3.sfakwf027_1"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfakwf028_1
            #add-point:BEFORE FIELD sfakwf028_1 name="input.b.page3.sfakwf028_1"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfakwf028_1
            
            #add-point:AFTER FIELD sfakwf028_1 name="input.a.page3.sfakwf028_1"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfakwf028_1
            #add-point:ON CHANGE sfakwf028_1 name="input.g.page3.sfakwf028_1"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD wfapwf024
            #add-point:BEFORE FIELD wfapwf024 name="input.b.page3.wfapwf024"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD wfapwf024
            
            #add-point:AFTER FIELD wfapwf024 name="input.a.page3.wfapwf024"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE wfapwf024
            #add-point:ON CHANGE wfapwf024 name="input.g.page3.wfapwf024"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD wfapwf025
            #add-point:BEFORE FIELD wfapwf025 name="input.b.page3.wfapwf025"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD wfapwf025
            
            #add-point:AFTER FIELD wfapwf025 name="input.a.page3.wfapwf025"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE wfapwf025
            #add-point:ON CHANGE wfapwf025 name="input.g.page3.wfapwf025"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD wfapwf026
            #add-point:BEFORE FIELD wfapwf026 name="input.b.page3.wfapwf026"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD wfapwf026
            
            #add-point:AFTER FIELD wfapwf026 name="input.a.page3.wfapwf026"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE wfapwf026
            #add-point:ON CHANGE wfapwf026 name="input.g.page3.wfapwf026"

            #END add-point 
 
 
 
                  #Ctrlp:input.c.page3.wfapwfseq1
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD wfapwfseq1
            #add-point:ON ACTION controlp INFIELD wfapwfseq1 name="input.c.page3.wfapwfseq1"

            #END add-point
 
 
         #Ctrlp:input.c.page3.wfapwf001
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD wfapwf001
            #add-point:ON ACTION controlp INFIELD wfapwf001 name="input.c.page3.wfapwf001"
            #?? a07 ??????(Version:3)   
            #??i?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
 
            LET g_qryparam.default1 = g_sfakwf3_d[l_ac].wfapwf001             #??default?

            #??arg
            LET g_qryparam.arg1 = "" #s

            IF g_sfajwf_m.sfajwf003 = '2' THEN
               LET g_qryparam.where = " imaa004 IN ('A','X','M') " 
            ELSE                       
               LET g_qryparam.where = " imaa004 IN ('A','X') "  #170620-00109#1 add
            END IF    
            CASE g_sfajwf_m.sfajwf003
               WHEN '1' #????
                  LET g_qryparam.where = g_qryparam.where,
                                         " AND EXISTS (SELECT oocq001 FROM oocq_t ",
                                         "              WHERE oocqent = imafent ",
                                         "                AND oocq001 = '210'",
                                         "                AND oocq002 = imaf016 ",
                                         "                AND oocq006 = 'Y') " #???????
               WHEN '4' #????
                  LET g_qryparam.where = g_qryparam.where,
                                         " AND EXISTS (SELECT oocq001 FROM oocq_t ",
                                         "              WHERE oocqent = imafent ",
                                         "                AND oocq001 = '210'",
                                         "                AND oocq002 = imaf016 ",
                                         "                AND oocq005 = 'Y') " #???????
            END CASE
            #?????????
            LET g_qryparam.where = g_qryparam.where, 
                                   " AND EXISTS (SELECT oocq001 FROM oocq_t ",
                                   "              WHERE oocqent = imafent ",
                                   "                AND oocq001 = '210'",
                                   "                AND oocq002 = imaf016 ",
                                   "                AND oocq009 = 'N' AND oocqstus = 'Y') "
            #??????????????????????
            SELECT wfakwf002 INTO l_wfakwf002 FROM wfakwf_t WHERE wfakwf001 = g_sfajwf_m.sfajwf012
            LET g_qryparam.where = g_qryparam.where, 
                                   " AND imafwf206 = '",l_wfakwf002,"' "
            CALL q_imaf001_6()                                #????
 
            LET g_sfakwf3_d[l_ac].wfapwf001 = g_qryparam.return1              

            DISPLAY g_sfakwf3_d[l_ac].wfapwf001 TO wfapwf001              #

            NEXT FIELD wfapwf001                          #?????



            #END add-point
 
 
         #Ctrlp:input.c.page3.wfapwf002
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD wfapwf002
            #add-point:ON ACTION controlp INFIELD wfapwf002 name="input.c.page3.wfapwf002"

            #END add-point
 
 
         #Ctrlp:input.c.page3.wfapwf003
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD wfapwf003
            #add-point:ON ACTION controlp INFIELD wfapwf003 name="input.c.page3.wfapwf003"
            #?? a07 ??????(Version:3)   
            #??i?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
 
            LET g_qryparam.default1 = g_sfakwf3_d[l_ac].wfapwf002             #??default?

            #??arg
            LET g_qryparam.arg1 = g_sfakwf3_d[l_ac].wfapwf001  #??

 
            CALL q_bmaa002_2()                                #????
 
            LET g_sfakwf3_d[l_ac].wfapwf003 = g_qryparam.return1              

            DISPLAY g_sfakwf3_d[l_ac].wfapwf003 TO wfapwf003              #

            NEXT FIELD wfapwf003                          #?????



            #END add-point
 
 
         #Ctrlp:input.c.page3.wfapwf004
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD wfapwf004
            #add-point:ON ACTION controlp INFIELD wfapwf004 name="input.c.page3.wfapwf004"

            #END add-point
 
 
         #Ctrlp:input.c.page3.wfapwf005
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD wfapwf005
            #add-point:ON ACTION controlp INFIELD wfapwf005 name="input.c.page3.wfapwf005"
            #?? a07 ??????(Version:3)   
            #??i?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
 
            LET g_qryparam.default1 = g_sfakwf3_d[l_ac].wfapwf005             #??default?

            #??arg
            LET g_qryparam.arg1 = "" #s

 
            CALL q_ooca001()                                #????
 
            LET g_sfakwf3_d[l_ac].wfapwf005 = g_qryparam.return1              

            DISPLAY g_sfakwf3_d[l_ac].wfapwf005 TO wfapwf005              #

            NEXT FIELD wfapwf005                          #?????



            #END add-point
 
 
         #Ctrlp:input.c.page3.wfapwf006
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD wfapwf006
            #add-point:ON ACTION controlp INFIELD wfapwf006 name="input.c.page3.wfapwf006"

            #END add-point
 
 
         #Ctrlp:input.c.page3.wfapwf007
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD wfapwf007
            #add-point:ON ACTION controlp INFIELD wfapwf007 name="input.c.page3.wfapwf007"
            #?? a07 ??????(Version:3)   
            #??i?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
 
            LET g_qryparam.default1 = g_sfakwf3_d[l_ac].wfapwf007             #??default?

            #??arg
            LET g_qryparam.arg1 = "" #s

 
            CALL q_ooca001()                                #????
 
            LET g_sfakwf3_d[l_ac].wfapwf007 = g_qryparam.return1              

            DISPLAY g_sfakwf3_d[l_ac].wfapwf007 TO wfapwf007              #

            NEXT FIELD wfapwf007                          #?????



            #END add-point
 
 
         #Ctrlp:input.c.page3.wfapwf008
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD wfapwf008
            #add-point:ON ACTION controlp INFIELD wfapwf008 name="input.c.page3.wfapwf008"

            #END add-point
 
 
         #Ctrlp:input.c.page3.wfapwf009
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD wfapwf009
            #add-point:ON ACTION controlp INFIELD wfapwf009 name="input.c.page3.wfapwf009"
            #?? a07 ??????(Version:3)   
            #??i?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
 
            LET g_qryparam.default1 = g_sfakwf3_d[l_ac].wfapwf009             #??default?

            #??arg
            LET g_qryparam.arg1 = g_sfakwf3_d[l_ac].wfapwf001 #????

 
            CALL q_imao002()                                #????
 
            LET g_sfakwf3_d[l_ac].wfapwf009 = g_qryparam.return1              

            DISPLAY g_sfakwf3_d[l_ac].wfapwf009 TO wfapwf009              #

            NEXT FIELD wfapwf009                          #?????



            #END add-point
 
 
         #Ctrlp:input.c.page3.wfapwf010
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD wfapwf010
            #add-point:ON ACTION controlp INFIELD wfapwf010 name="input.c.page3.wfapwf010"

            #END add-point
 
 
         #Ctrlp:input.c.page3.wfapwf011
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD wfapwf011
            #add-point:ON ACTION controlp INFIELD wfapwf011 name="input.c.page3.wfapwf011"
            #?? a07 ??????(Version:3)   
            #??i?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
 
            LET g_qryparam.default1 = g_sfakwf3_d[l_ac].wfapwf011             #??default?

            #??arg
            LET g_qryparam.arg1 = g_sfakwf3_d[l_ac].wfapwf001 #????

 
            CALL q_imao002()                                #????
 
            LET g_sfakwf3_d[l_ac].wfapwf011 = g_qryparam.return1              

            DISPLAY g_sfakwf3_d[l_ac].wfapwf011 TO wfapwf011              #

            NEXT FIELD wfapwf011                          #?????



            #END add-point
 
 
         #Ctrlp:input.c.page3.wfapwf012
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD wfapwf012
            #add-point:ON ACTION controlp INFIELD wfapwf012 name="input.c.page3.wfapwf012"

            #END add-point
 
 
         #Ctrlp:input.c.page3.wfapwf013
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD wfapwf013
            #add-point:ON ACTION controlp INFIELD wfapwf013 name="input.c.page3.wfapwf013"
            #?? a07 ??????(Version:3)   
            #??i?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
 
            LET g_qryparam.default1 = g_sfakwf3_d[l_ac].wfapwf013             #??default?

            #??arg
            LET g_qryparam.arg1 = g_sfakwf3_d[l_ac].wfapwf001 #????

 
            CALL q_imao002()                                #????
 
            LET g_sfakwf3_d[l_ac].wfapwf013 = g_qryparam.return1              

            DISPLAY g_sfakwf3_d[l_ac].wfapwf013 TO wfapwf013              #

            NEXT FIELD wfapwf013                          #?????



            #END add-point
 
 
         #Ctrlp:input.c.page3.wfapwf014
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD wfapwf014
            #add-point:ON ACTION controlp INFIELD wfapwf014 name="input.c.page3.wfapwf014"

            #END add-point
 
 
         #Ctrlp:input.c.page3.wfapwf015
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD wfapwf015
            #add-point:ON ACTION controlp INFIELD wfapwf015 name="input.c.page3.wfapwf015"
            #?? a07 ??????(Version:3)   
            #??i?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
 
            LET g_qryparam.default1 = g_sfakwf3_d[l_ac].wfapwf015             #??default?

            #??arg
            LET g_qryparam.arg1 = "" #s

 
            CALL q_oodb002_2()                                #????
 
            LET g_sfakwf3_d[l_ac].wfapwf015 = g_qryparam.return1              

            DISPLAY g_sfakwf3_d[l_ac].wfapwf015 TO wfapwf015              #

            NEXT FIELD wfapwf015                          #?????



            #END add-point
 
 
         #Ctrlp:input.c.page3.wfapwf016
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD wfapwf016
            #add-point:ON ACTION controlp INFIELD wfapwf016 name="input.c.page3.wfapwf016"

            #END add-point
 
 
         #Ctrlp:input.c.page3.wfapwf017
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD wfapwf017
            #add-point:ON ACTION controlp INFIELD wfapwf017 name="input.c.page3.wfapwf017"

            #END add-point
 
 
         #Ctrlp:input.c.page3.wfapwf018
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD wfapwf018
            #add-point:ON ACTION controlp INFIELD wfapwf018 name="input.c.page3.wfapwf018"

            #END add-point
 
 
         #Ctrlp:input.c.page3.wfapwf022
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD wfapwf022
            #add-point:ON ACTION controlp INFIELD wfapwf022 name="input.c.page3.wfapwf022"

            #END add-point
 
 
         #Ctrlp:input.c.page3.wfapwf019
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD wfapwf019
            #add-point:ON ACTION controlp INFIELD wfapwf019 name="input.c.page3.wfapwf019"
            #?? a07 ??????(Version:3)   
            #??i?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
 
            LET g_qryparam.default1 = g_sfakwf3_d[l_ac].wfapwf019             #??default?
            LET g_qryparam.default2 = "" #g_sfakwf3_d[l_ac].wfagwf003 #????
            LET g_qryparam.default3 = "" #g_sfakwf3_d[l_ac].wfagwf004 #??????
            LET g_qryparam.default4 = "" #g_sfakwf3_d[l_ac].wfagwf006 #????
            LET g_qryparam.default5 = "" #g_sfakwf3_d[l_ac].wfagwf007 #????
            #??arg
            #LET g_qryparam.arg1 = g_sfajwf_m.sfajwf006 #??
            LET g_qryparam.arg2 = g_sfakwf3_d[l_ac].wfapwf001 #??
            LET g_qryparam.arg3 = g_sfajwf_m.sfajwf016  #??/??
            #240423-00009#2 --s
            #IC?????????=??,????????=2.???3.????
            IF g_sfajwf_m.sfajwf005 = '1' THEN
               LET g_qryparam.arg4 = "'2','3'"
            ELSE
            #????=??????????????=1.????3.????
               LET l_qwhere = ''
               LET g_qryparam.arg4 = "'1','3'"
               LET l_qwhere = l_qwhere," wfagwf009='",g_sfajwf_m.sfajwf006,"'"
               LET g_qryparam.where = l_qwhere
            END IF
            #240423-00009#2 --e
            CALL q_wfagwf001_wf()                                #????
 
            LET g_sfakwf3_d[l_ac].wfapwf019 = g_qryparam.return1              
            LET g_sfakwf3_d[l_ac].sfakwf012 = g_qryparam.return2 
            LET g_sfakwf3_d[l_ac].sfakwf013 = g_qryparam.return3 
            LET g_sfakwf3_d[l_ac].sfakwf014 = g_qryparam.return4 
            LET g_sfakwf3_d[l_ac].sfakwf015 = g_qryparam.return5 
            
            DISPLAY g_sfakwf3_d[l_ac].wfapwf019 TO wfapwf019              #
            DISPLAY g_sfakwf3_d[l_ac].sfakwf012 TO sfakwf012 #????
            DISPLAY g_sfakwf3_d[l_ac].sfakwf013 TO sfakwf013 #??????
            DISPLAY g_sfakwf3_d[l_ac].sfakwf014 TO sfakwf014 #????
            DISPLAY g_sfakwf3_d[l_ac].sfakwf015 TO sfakwf015 #????
            NEXT FIELD wfapwf019                          #?????

            #END add-point
 
 
         #Ctrlp:input.c.page3.sfakwf012_1
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf012_1
            #add-point:ON ACTION controlp INFIELD sfakwf012_1 name="input.c.page3.sfakwf012_1"

            #END add-point
 
 
         #Ctrlp:input.c.page3.sfakwf013_1
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf013_1
            #add-point:ON ACTION controlp INFIELD sfakwf013_1 name="input.c.page3.sfakwf013_1"

            #END add-point
 
 
         #Ctrlp:input.c.page3.sfakwf014_1
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf014_1
            #add-point:ON ACTION controlp INFIELD sfakwf014_1 name="input.c.page3.sfakwf014_1"

            #END add-point
 
 
         #Ctrlp:input.c.page3.sfakwf015_1
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf015_1
            #add-point:ON ACTION controlp INFIELD sfakwf015_1 name="input.c.page3.sfakwf015_1"

            #END add-point
 
 
         #Ctrlp:input.c.page3.wfapwf021
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD wfapwf021
            #add-point:ON ACTION controlp INFIELD wfapwf021 name="input.c.page3.wfapwf021"
            #?? a07 ??????(Version:3)   
            #??i?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
 
            LET g_qryparam.default1 = g_sfakwf3_d[l_ac].wfapwf021             #??default?
            LET g_qryparam.default2 = "" #g_sfakwf3_d[l_ac].wfahwf005 #????
            LET g_qryparam.default3 = "" #g_sfakwf3_d[l_ac].wfahwf006 #????
            LET g_qryparam.default4 = "" #g_sfakwf3_d[l_ac].wfahwf010 #????
            LET g_qryparam.default5 = "" #g_sfakwf3_d[l_ac].wfahwf008 #???
            LET g_qryparam.default6 = "" #g_sfakwf3_d[l_ac].wfahwf009 #?????
            #??arg
            #LET g_qryparam.arg1 = g_sfajwf_m.sfajwf006 #??    #240423-00009#2 mark
            LET g_qryparam.arg2 = g_sfakwf3_d[l_ac].wfapwf001 #???? 
            #240423-00009#2 --s
            #IC?????????=??,????????=2.???3.????
            IF g_sfajwf_m.sfajwf005 = '1' THEN
               LET g_qryparam.arg3 = "'2','3'"
            ELSE
            #????=??????????????=1.????3.????
               LET l_qwhere = ''
               LET g_qryparam.arg3 = "'1','3'"
               LET l_qwhere = l_qwhere," wfahwf004='",g_sfajwf_m.sfajwf006,"'"
               LET g_qryparam.where = l_qwhere
            END IF
            #240423-00009#2 --e
            CALL q_sfakwf016_01_wf()                                #????
 
            LET g_sfakwf3_d[l_ac].wfapwf021 = g_qryparam.return1              
            LET g_sfakwf3_d[l_ac].sfakwf017 = g_qryparam.return2 
            LET g_sfakwf3_d[l_ac].sfakwf018 = g_qryparam.return3 
            LET g_sfakwf3_d[l_ac].sfakwf019 = g_qryparam.return4 
            LET g_sfakwf3_d[l_ac].sfakwf020 = g_qryparam.return5 
            LET g_sfakwf3_d[l_ac].sfakwf021 = g_qryparam.return6 
            
            DISPLAY g_sfakwf3_d[l_ac].wfapwf021 TO wfapwf021              #
            DISPLAY g_sfakwf3_d[l_ac].sfakwf017 TO sfakwf017 #????
            DISPLAY g_sfakwf3_d[l_ac].sfakwf018 TO sfakwf018 #????
            DISPLAY g_sfakwf3_d[l_ac].sfakwf019 TO sfakwf019 #????
            DISPLAY g_sfakwf3_d[l_ac].sfakwf020 TO sfakwf020 #???
            DISPLAY g_sfakwf3_d[l_ac].sfakwf021 TO sfakwf021 #?????
            NEXT FIELD wfapwf021                          #?????

            #END add-point
 
 
         #Ctrlp:input.c.page3.sfakwf017_1
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf017_1
            #add-point:ON ACTION controlp INFIELD sfakwf017_1 name="input.c.page3.sfakwf017_1"

            #END add-point
 
 
         #Ctrlp:input.c.page3.sfakwf018_1
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf018_1
            #add-point:ON ACTION controlp INFIELD sfakwf018_1 name="input.c.page3.sfakwf018_1"

            #END add-point
 
 
         #Ctrlp:input.c.page3.sfakwf019_1
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf019_1
            #add-point:ON ACTION controlp INFIELD sfakwf019_1 name="input.c.page3.sfakwf019_1"

            #END add-point
 
 
         #Ctrlp:input.c.page3.sfakwf020_1
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf020_1
            #add-point:ON ACTION controlp INFIELD sfakwf020_1 name="input.c.page3.sfakwf020_1"

            #END add-point
 
 
         #Ctrlp:input.c.page3.sfakwf021_1
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf021_1
            #add-point:ON ACTION controlp INFIELD sfakwf021_1 name="input.c.page3.sfakwf021_1"

            #END add-point
 
 
         #Ctrlp:input.c.page3.wfapwf020
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD wfapwf020
            #add-point:ON ACTION controlp INFIELD wfapwf020 name="input.c.page3.wfapwf020"
            #?? a07 ??????(Version:3)   
            #??i?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
 
            LET g_qryparam.default1 = g_sfakwf3_d[l_ac].wfapwf020             #??default?
            LET g_qryparam.default2 = "" #g_sfakwf3_d[l_ac].wfajwf004 #????
            LET g_qryparam.default3 = "" #g_sfakwf3_d[l_ac].wfajwfl003 #??????
            #??arg
            LET g_qryparam.arg1 = g_sfajwf_m.sfajwf006 #??
            LET g_qryparam.arg2 = g_sfakwf3_d[l_ac].wfapwf001 #????
            LET g_qryparam.arg3 = g_sfajwf_m.sfajwf016  #??/??
 
            CALL q_wfajwf001_wf()                                #????
 
            LET g_sfakwf3_d[l_ac].wfapwf020 = g_qryparam.return1              
            LET g_sfakwf3_d[l_ac].sfakwf023 = g_qryparam.return2 
            LET g_sfakwf3_d[l_ac].wfapwf020_desc = g_qryparam.return3 
            DISPLAY g_sfakwf3_d[l_ac].wfapwf020 TO wfapwf020              #
            DISPLAY g_sfakwf3_d[l_ac].sfakwf023 TO sfakwf023 #????
            DISPLAY g_sfakwf3_d[l_ac].wfapwf020_desc TO wfapwf020_desc #??????
            NEXT FIELD wfapwf020                          #?????
            #END add-point
 
 
         #Ctrlp:input.c.page3.sfakwf023_1
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf023_1
            #add-point:ON ACTION controlp INFIELD sfakwf023_1 name="input.c.page3.sfakwf023_1"

            #END add-point
 
 
         #Ctrlp:input.c.page3.wfapwf023
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD wfapwf023
            #add-point:ON ACTION controlp INFIELD wfapwf023 name="input.c.page3.wfapwf023"
            #?? a07 ??????(Version:3)   
            #??i?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
 
            LET g_qryparam.default1 = g_sfakwf3_d[l_ac].wfapwf023             #??default?
            LET g_qryparam.default2 = "" #g_sfakwf3_d[l_ac].wfalwf005 #??????
            LET g_qryparam.default3 = "" #g_sfakwf3_d[l_ac].wfalwf006 #??????
            LET g_qryparam.default4 = "" #g_sfakwf3_d[l_ac].wfalwf007 #????
            LET g_qryparam.default5 = "" #g_sfakwf3_d[l_ac].wfalwf008 #??????
            #??arg
            LET g_qryparam.arg1 = g_sfakwf3_d[l_ac].wfapwf001 #????

 
            CALL q_wfalwf001_wf()                                #????
 
            LET g_sfakwf3_d[l_ac].wfapwf023 = g_qryparam.return1              
            LET g_sfakwf3_d[l_ac].sfakwf025 = g_qryparam.return2 
            LET g_sfakwf3_d[l_ac].sfakwf026 = g_qryparam.return3 
            LET g_sfakwf3_d[l_ac].sfakwf027 = g_qryparam.return4 
            LET g_sfakwf3_d[l_ac].sfakwf028 = g_qryparam.return5 
            DISPLAY g_sfakwf3_d[l_ac].wfapwf023 TO wfapwf023              #
            DISPLAY g_sfakwf3_d[l_ac].sfakwf025 TO sfakwf025 #??????
            DISPLAY g_sfakwf3_d[l_ac].sfakwf026 TO sfakwf026 #??????
            DISPLAY g_sfakwf3_d[l_ac].sfakwf027 TO sfakwf027 #????
            DISPLAY g_sfakwf3_d[l_ac].sfakwf028 TO sfakwf028 #??????
            NEXT FIELD wfapwf023                          #?????

            #END add-point
 
 
         #Ctrlp:input.c.page3.sfakwf025_1
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf025_1
            #add-point:ON ACTION controlp INFIELD sfakwf025_1 name="input.c.page3.sfakwf025_1"

            #END add-point
 
 
         #Ctrlp:input.c.page3.sfakwf026_1
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf026_1
            #add-point:ON ACTION controlp INFIELD sfakwf026_1 name="input.c.page3.sfakwf026_1"

            #END add-point
 
 
         #Ctrlp:input.c.page3.sfakwf027_1
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf027_1
            #add-point:ON ACTION controlp INFIELD sfakwf027_1 name="input.c.page3.sfakwf027_1"

            #END add-point
 
 
         #Ctrlp:input.c.page3.sfakwf028_1
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfakwf028_1
            #add-point:ON ACTION controlp INFIELD sfakwf028_1 name="input.c.page3.sfakwf028_1"

            #END add-point
 
 
         #Ctrlp:input.c.page3.wfapwf024
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD wfapwf024
            #add-point:ON ACTION controlp INFIELD wfapwf024 name="input.c.page3.wfapwf024"

            #END add-point
 
 
         #Ctrlp:input.c.page3.wfapwf025
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD wfapwf025
            #add-point:ON ACTION controlp INFIELD wfapwf025 name="input.c.page3.wfapwf025"

            #END add-point
 
 
         #Ctrlp:input.c.page3.wfapwf026
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD wfapwf026
            #add-point:ON ACTION controlp INFIELD wfapwf026 name="input.c.page3.wfapwf026"

            #END add-point
 
 
 
 
         AFTER ROW
            #add-point:??page3_after_row name="input.body3.after_row"

            #end add-point
            LET l_ac = ARR_CURR()
            IF INT_FLAG THEN
               LET INT_FLAG = 0
               IF l_cmd = 'u' THEN
                  LET g_sfakwf3_d[l_ac].* = g_sfakwf3_d_t.*
               END IF
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code = 9001 
               LET g_errparam.popup = FALSE 
               CLOSE bsft001_wf_bcl4
               CLOSE bsft001_wf_bcl
               CALL s_transaction_end('N','0')
               CALL cl_err()
               EXIT DIALOG 
            END IF
            
            #??table??unlock
            
            CALL bsft001_wf_unlock_b("wfapwf_t","'3'")
            CALL s_transaction_end('Y','0')
            #add-point:??page3_after_row2 name="input.body3.after_row2"

            #end add-point
 
         AFTER INPUT
            #add-point:input?after input  name="input.body3.after_input"

            #end add-point  
 
         ON ACTION controlo    
            IF l_insert THEN
               #170920-00028 ---modify start---
               #????????????????
               IF l_ac_t <= 0 OR l_ac_t IS NULL THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.extend = ""
                  LET g_errparam.code   = "adz-01032"
                  LET g_errparam.popup  = TRUE
                  CALL cl_err()
               ELSE
                  LET li_reproduce = l_ac_t
                  LET li_reproduce_target = l_ac
                  LET g_sfakwf3_d[li_reproduce_target].* = g_sfakwf3_d[li_reproduce].*
 
                  LET g_sfakwf3_d[li_reproduce_target].wfapwfseq1 = NULL
               END IF
               #170920-00028 --- modify end ---
            ELSE
               CALL FGL_SET_ARR_CURR(g_sfakwf3_d.getLength()+1)
               LET lb_reproduce = TRUE
               LET li_reproduce = l_ac
               LET li_reproduce_target = g_sfakwf3_d.getLength()+1
            END IF
            #(ver:84) ---start---
            #add-point:input?????  name="input.body3.controlo"

            #end add-point
            #(ver:84) --- end ---
        
      END INPUT
      INPUT ARRAY g_sfakwf5_d FROM s_detail5.*
         ATTRIBUTE(COUNT = g_rec_b,WITHOUT DEFAULTS, #MAXCOUNT = g_max_rec,
                 INSERT ROW = l_allow_insert, #???insert????????, ???????!
                 DELETE ROW = l_allow_delete,
                 APPEND ROW = l_allow_insert)
                 
         #??ACTION(detail_input,page_5)
         
        
         BEFORE INPUT
            #???????idx??g_detail_idx
            LET g_detail_idx_tmp = g_detail_idx
            LET g_detail_idx = g_detail_idx_list[1]
            #??????????
            IF g_detail_idx = 0 OR g_sfakwf_d.getLength() = 0 THEN
               NEXT FIELD sfakwfseq
            END IF
            #???????????
            IF cl_null(g_sfakwf_d[g_detail_idx].sfakwfseq) THEN
               NEXT FIELD sfakwfseq
            END IF
            #add-point:????? name="input.body5.before_input2"

            #end add-point
            IF g_insert = 'Y' AND NOT cl_null(g_insert) THEN 
              CALL FGL_SET_ARR_CURR(g_sfakwf5_d.getLength()+1) 
              LET g_insert = 'N' 
           END IF 
 
            #????????2???????
            IF g_loc = 'd' AND g_rec_b != 0 THEN
               CALL FGL_SET_ARR_CURR(g_idx_group.getValue("'5',"))
            END IF
            LET g_loc = 'd'
            LET g_rec_b = g_sfakwf5_d.getLength()
            #add-point:????? name="input.body5.before_input"

            #end add-point
            
         BEFORE INSERT
            
            IF s_transaction_chk("N",0) THEN
               CALL s_transaction_begin()
            END IF
            LET l_insert = TRUE
            LET l_n = ARR_COUNT()
            CALL bsft001_wf_idx_chk()   #(ver:83)
            LET l_cmd = 'a'
            INITIALIZE g_sfakwf5_d[l_ac].* TO NULL 
            INITIALIZE g_sfakwf5_d_t.* TO NULL 
            INITIALIZE g_sfakwf5_d_o.* TO NULL 
            #??????(??5)
            
            #??????(??5)
                  LET g_sfakwf5_d[l_ac].l_sfanwfseq1 = "0"
 
            #add-point:modify?before?? name="input.body5.insert.before_bak"
            #240709-00009#1 add--s
            LET g_sfakwf5_d[l_ac].l_sfanwfseq1 = g_sfakwf_d[g_detail_idx].sfakwfseq
            LET g_sfakwf5_d[l_ac].sfanwf005 = 0
            LET l_imaa005 = ''
            SELECT imaa005 INTO l_imaa005 FROM imaa_t
             WHERE imaaent = g_enterprise AND imaa001 = g_sfakwf_d[l_ac].sfakwf001
            IF NOT cl_null(l_imaa005) THEN
               LET g_sfakwf5_d[l_ac].sfanwf002 = '2'
               LET g_sfakwf5_d[l_ac].sfanwf001 = g_sfakwf_d[l_ac].sfakwf001
               CALL s_desc_get_item_desc(g_sfakwf5_d[l_ac].sfanwf001) RETURNING g_sfakwf5_d[l_ac].sfanwf001_desc,g_sfakwf5_d[l_ac].sfanwf001_desc_1
            END IF
            CALL bsft001_wf_set_entry_sfanwf() 
            #240709-00009#1 add--e
            #end add-point
            LET g_sfakwf5_d_t.* = g_sfakwf5_d[l_ac].*     #?????
            LET g_sfakwf5_d_o.* = g_sfakwf5_d[l_ac].*     #?????
            CALL cl_show_fld_cont()
            CALL bsft001_wf_set_entry_b(l_cmd)
            #add-point:modify?after_set_entry_b name="input.body5.insert.after_set_entry_b"

            #end add-point
            CALL bsft001_wf_set_no_entry_b(l_cmd)
            IF lb_reproduce THEN
               LET lb_reproduce = FALSE
               LET g_sfakwf5_d[li_reproduce_target].* = g_sfakwf5_d[li_reproduce].*
 
               LET g_sfakwf5_d[li_reproduce_target].sfanwfseq = NULL
            END IF
            
 
            #add-point:modify?before insert name="input.body5.before_insert"

            #end add-point  
            
         BEFORE ROW
            #add-point:modify?before row2 name="input.body5.before_row2"

            #end add-point  
            LET l_insert = FALSE
            LET l_cmd = ''
            LET l_ac_t = l_ac 
            LET l_ac = ARR_CURR()
            LET g_detail_idx2 = l_ac
            LET g_detail_idx_list[5] = l_ac
            LET g_current_page = 5
            
            LET l_lock_sw = 'N'            #DEFAULT
            LET l_n = ARR_COUNT()
            DISPLAY l_ac TO FORMONLY.idx
         
            CALL s_transaction_begin()
            OPEN bsft001_wf_cl USING g_enterprise, g_site,g_sfajwf_m.sfajwfdocno
            #(ver:78) ---start---
            IF SQLCA.SQLCODE THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "OPEN bsft001_wf_cl:",SQLERRMESSAGE 
               LET g_errparam.code = SQLCA.SQLCODE
               LET g_errparam.popup = TRUE 
               CLOSE bsft001_wf_cl
               CALL s_transaction_end('N','0')
               CALL cl_err()
               RETURN
            END IF
            #(ver:78) --- end ---
            
            #200804-00006 ---start---
            FETCH bsft001_wf_cl
            IF SQLCA.SQLCODE AND SQLCA.SQLCODE <> 100 THEN
               INITIALIZE g_errparam TO NULL
               LET g_errparam.extend = "FETCH bsft001_wf_cl:",SQLERRMESSAGE
               LET g_errparam.code = SQLCA.SQLCODE
               LET g_errparam.popup = TRUE
               CLOSE bsft001_wf_cl
               #PostgreSQL???????, ????????????
               CALL s_transaction_end('N','0')
               CALL s_transaction_begin()
               CALL cl_err()
               RETURN
            END IF
            #200804-00006 --- end ---
            OPEN bsft001_wf_bcl USING g_enterprise, g_site,g_sfajwf_m.sfajwfdocno,g_sfakwf_d[g_detail_idx].sfakwfseq
            IF SQLCA.SQLCODE THEN   #(ver:78)
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "OPEN bsft001_wf_bcl:",SQLERRMESSAGE 
               LET g_errparam.code = SQLCA.SQLCODE   #(ver:78)
               LET g_errparam.popup = TRUE 
               CLOSE bsft001_wf_cl
               CLOSE bsft001_wf_bcl
               CALL s_transaction_end('N','0')
               CALL cl_err()
               RETURN
            END IF
            #200804-00006 ---start---
            FETCH bsft001_wf_bcl
            IF SQLCA.SQLCODE AND SQLCA.SQLCODE <> 100 THEN
               INITIALIZE g_errparam TO NULL
               LET g_errparam.extend = "FETCH bsft001_wf_bcl:",SQLERRMESSAGE
               LET g_errparam.code = SQLCA.SQLCODE
               LET g_errparam.popup = TRUE
               CLOSE bsft001_wf_cl
               CLOSE bsft001_wf_bcl
               #PostgreSQL???????, ????????????
               CALL s_transaction_end('N','0')
               CALL s_transaction_begin()
               CALL cl_err()
               RETURN
            END IF
            #200804-00006 --- end ---
            
            LET g_rec_b = g_sfakwf5_d.getLength()
            
            IF g_rec_b >= l_ac 
               AND g_sfakwf5_d[l_ac].sfanwfseq IS NOT NULL
            THEN 
               LET l_cmd='u'
               LET g_sfakwf5_d_t.* = g_sfakwf5_d[l_ac].*  #BACKUP
               LET g_sfakwf5_d_o.* = g_sfakwf5_d[l_ac].*  #BACKUP
               CALL bsft001_wf_set_entry_b(l_cmd)
               #add-point:modify?after_set_entry_b name="input.body5.after_set_entry_b"
               #240709-00009#1 add--s
               SELECT imaa011 INTO l_imaa011
                 FROM imaa_t
                WHERE imaaent = g_enterprise
                  AND imaa001 = g_sfakwf_d[l_ac].sfakwf001
               IF l_imaa011 <> '1' THEN
                  IF g_sfakwf5_d[l_ac].sfanwf002 = '1' THEN
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = 'asf-00114'
                     LET g_errparam.extend = g_sfakwf5_d[l_ac].sfanwf002
                     LET g_errparam.popup = TRUE  
                     CALL cl_err()
                  END IF
               END IF 
               #240709-00009#1 add--e
               #end add-point  
               CALL bsft001_wf_set_no_entry_b(l_cmd)
               IF NOT bsft001_wf_lock_b("sfanwf_t","'5'") THEN
                  LET l_lock_sw='Y'
               ELSE
                  FETCH bsft001_wf_bcl5 INTO g_sfakwf5_d[l_ac].sfanwfseq,g_sfakwf5_d[l_ac].sfanwf002,g_sfakwf5_d[l_ac].sfanwf001,g_sfakwf5_d[l_ac].sfanwf006,g_sfakwf5_d[l_ac].sfanwf003,g_sfakwf5_d[l_ac].sfanwf004,g_sfakwf5_d[l_ac].sfanwf005
                  IF SQLCA.SQLCODE THEN
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = SQLERRMESSAGE 
                     LET g_errparam.code = SQLCA.SQLCODE 
                     LET g_errparam.popup = TRUE 
                     CALL cl_err()
                     LET l_lock_sw = "Y"
                  END IF
                  
                  #??????
                  LET g_sfakwf5_d_mask_o[l_ac].* =  g_sfakwf5_d[l_ac].*
                  CALL bsft001_wf_sfanwf_t_mask()
                  LET g_sfakwf5_d_mask_n[l_ac].* =  g_sfakwf5_d[l_ac].*
                  
                  LET g_bfill = "N"
                  CALL bsft001_wf_show()
                  LET g_bfill = "Y"
                  
                  CALL cl_show_fld_cont()
               END IF
            ELSE
               LET l_cmd='a'
            END IF
            #add-point:modify?before row name="input.body5.before_row"
            CALL bsft001_wf_set_entry_sfanwf()  
            #end add-point  
            #??table????(???????)
            
 
            #??table??lock
            
 
            CALL bsft001_wf_idx_chk()   #(ver:83)
            
         BEFORE DELETE                            #??????
            IF l_cmd = 'a' THEN
               LET l_cmd='d'
               #add-point:??AFTER DELETE (=d) name="input.body5.after_delete_d"
               IF NOT cl_null(g_sfakwf5_d[l_ac].sfanwf001) AND g_sfakwf5_d[l_ac].sfanwf002 = '1' THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = 'asf-00114'
                  LET g_errparam.popup = TRUE
                  CALL cl_err()
                  CANCEL DELETE
               END IF
               #end add-point
            ELSE
               #add-point:????? name="input.body5.b_delete_ask"
               IF NOT cl_null(g_sfakwf5_d[l_ac].sfanwf001) AND g_sfakwf5_d[l_ac].sfanwf002 = '1' THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = 'asf-00114'
                  LET g_errparam.popup = TRUE
                  CALL cl_err()
                  CANCEL DELETE
               END IF
               #end add-point 
               IF NOT cl_ask_del_detail() THEN
                  CANCEL DELETE
               END IF
               IF l_lock_sw = "Y" THEN
                  INITIALIZE g_errparam TO NULL 
                  LET g_errparam.extend = "" 
                  LET g_errparam.code = -263 
                  LET g_errparam.popup = TRUE 
                  CALL cl_err()
                  CANCEL DELETE
               END IF
               
               #add-point:??5??? name="input.body5.b_delete"

               #end add-point    
 
               #??????key?
                              INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_sfajwf_m.sfajwfdocno
               LET gs_keys[2] = g_sfakwf_d[g_detail_idx].sfakwfseq
               LET gs_keys[3] = g_sfakwf5_d_t.sfanwfseq
 
 
               #??????
               IF NOT bsft001_wf_delete_b('sfanwf_t',gs_keys,"'5'") THEN
                  CALL s_transaction_end('N','0')
                  CLOSE bsft001_wf_bcl
                  CANCEL DELETE
               END IF
               
               #?????
               
 
               
   #161130-00056 add
  
               #add-point:??5??? name="input.body5.m_delete"

               #end add-point   
               
               CALL s_transaction_end('Y','0')
               CLOSE bsft001_wf_bcl
                  
               LET g_rec_b = g_rec_b-1
               #add-point:??5??? name="input.body5.a_delete"

               #end add-point
 
               LET l_count = g_sfakwf_d.getLength()
               
               #add-point:?????(<>d) name="input.body5.after_delete"

               #end add-point
            END IF 
 
         AFTER DELETE
            #???????
            IF l_ac = (g_sfakwf5_d.getLength() + 1) THEN
               CALL FGL_SET_ARR_CURR(l_ac-1)
            END IF
         
         AFTER INSERT    
            LET l_insert = FALSE
            IF INT_FLAG THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code = 9001 
               LET g_errparam.popup = FALSE 
               CALL cl_err()
               LET INT_FLAG = 0
               CANCEL INSERT
            END IF
               
            #add-point:??5??? name="input.body5.b_a_insert"
            IF cl_null(g_sfakwf5_d[l_ac].sfanwf006) THEN
               LET g_sfakwf5_d[l_ac].sfanwf006 = ' '
            END IF
            #end add-point
    
            LET l_count = 1  
            SELECT COUNT(1) INTO l_count FROM sfanwf_t 
             WHERE sfanwfent = g_enterprise AND sfanwfsite = g_site AND sfanwfdocno = g_sfajwf_m.sfajwfdocno AND sfanwfseq1 = g_sfakwf_d[g_detail_idx].sfakwfseq AND sfanwfseq = g_sfakwf5_d[g_detail_idx2].sfanwfseq
                
            #?????, ??????
            IF l_count = 0 THEN 
               #add-point:??5??? name="input.body5.b_insert"

               #end add-point
            
                              INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_sfajwf_m.sfajwfdocno
               LET gs_keys[2] = g_sfakwf_d[g_detail_idx].sfakwfseq
               LET gs_keys[3] = g_sfakwf5_d[g_detail_idx2].sfanwfseq
               CALL bsft001_wf_insert_b('sfanwf_t',gs_keys,"'5'")
                           
               #add-point:?????5 name="input.body5.a_insert"
               #240709-00009#1 add--s
               SELECT COUNT(1) INTO l_count FROM sfanwf_t 
                WHERE sfanwfent = g_enterprise AND sfanwfsite = g_site AND sfanwfdocno = g_sfajwf_m.sfajwfdocno
                  AND sfanwfseq = g_sfakwf5_d[g_detail_idx].sfanwfseq AND sfanwfseq1 = g_sfakwf_d[g_detail_idx].sfakwfseq
               IF l_count > 0 THEN
                  #????????DB
                  IF l_inam.getLength() > 1 THEN  #????????????????DB, ????????
                     #161109-00085#66 --s add
                     SELECT sfanwfent,sfanwfsite,sfanwfdocno,sfanwf001,sfanwf002,
                            sfanwf003,sfanwf004,sfanwf005,sfanwfseq,sfanwf006,sfanwfseq1,
                            sfanwfud001,sfanwfud002,sfanwfud003,sfanwfud004,sfanwfud005,
                            sfanwfud006,sfanwfud007,sfanwfud008,sfanwfud009,sfanwfud010,
                            sfanwfud011,sfanwfud012,sfanwfud013,sfanwfud014,sfanwfud015,
                            sfanwfud016,sfanwfud017,sfanwfud018,sfanwfud019,sfanwfud020,
                            sfanwfud021,sfanwfud022,sfanwfud023,sfanwfud024,sfanwfud025,
                            sfanwfud026,sfanwfud027,sfanwfud028,sfanwfud029,sfanwfud030,
                            sfanwf007
                       INTO l_sfanwf.sfanwfent,l_sfanwf.sfanwfsite,l_sfanwf.sfanwfdocno,l_sfanwf.sfanwf001,l_sfanwf.sfanwf002,
                            l_sfanwf.sfanwf003,l_sfanwf.sfanwf004,l_sfanwf.sfanwf005,l_sfanwf.sfanwfseq,l_sfanwf.sfanwf006,l_sfanwf.sfanwfseq1,
                            l_sfanwf.sfanwfud001,l_sfanwf.sfanwfud002,l_sfanwf.sfanwfud003,l_sfanwf.sfanwfud004,l_sfanwf.sfanwfud005,
                            l_sfanwf.sfanwfud006,l_sfanwf.sfanwfud007,l_sfanwf.sfanwfud008,l_sfanwf.sfanwfud009,l_sfanwf.sfanwfud010,
                            l_sfanwf.sfanwfud011,l_sfanwf.sfanwfud012,l_sfanwf.sfanwfud013,l_sfanwf.sfanwfud014,l_sfanwf.sfanwfud015,
                            l_sfanwf.sfanwfud016,l_sfanwf.sfanwfud017,l_sfanwf.sfanwfud018,l_sfanwf.sfanwfud019,l_sfanwf.sfanwfud020,
                            l_sfanwf.sfanwfud021,l_sfanwf.sfanwfud022,l_sfanwf.sfanwfud023,l_sfanwf.sfanwfud024,l_sfanwf.sfanwfud025,
                            l_sfanwf.sfanwfud026,l_sfanwf.sfanwfud027,l_sfanwf.sfanwfud028,l_sfanwf.sfanwfud029,l_sfanwf.sfanwfud030,
                            l_sfanwf.sfanwf007
                     #161109-00085#66 --e add
                       FROM sfanwf_t
                      WHERE sfanwfent = g_enterprise AND sfanwfsite = g_site
                        AND sfanwfdocno = g_sfajwf_m.sfajwfdocno AND sfanwfseq = g_sfakwf5_d[l_ac].sfanwfseq AND sfanwfseq1 = g_sfakwf_d[l_ac].sfakwfseq
                     #161109-00085#27-e  
                     FOR l_k = 2 TO l_inam.getLength()
                        SELECT MAX(sfanwfseq)+1 INTO l_sfanwf.sfanwfseq FROM sfanwf_t 
                         WHERE sfanwfent = g_enterprise AND sfanwfsite = g_site
                           AND sfanwfdocno = g_sfajwf_m.sfajwfdocno AND sfanwfseq1 = g_sfakwf_d[l_ac].sfakwfseq
                        LET l_sfanwf.sfanwf006 = l_inam[l_k].inam002
                        LET l_sfanwf.sfanwf003 = l_inam[l_k].inam004
                        SELECT COUNT(1) INTO l_count FROM sfanwf_t
                         WHERE sfanwfent = g_enterprise
                           AND sfanwfsite = g_site
                           AND sfanwfdocno = g_sfajwf_m.sfajwfdocno
                           AND sfanwf001 = g_sfakwf5_d[l_ac].sfanwf001 AND sfanwfseq1 = g_sfakwf_d[l_ac].sfakwfseq
                           AND sfanwf006 = l_sfanwf.sfanwf006
                        IF l_count > 0 THEN
                           CONTINUE FOR
                        END IF
                        INSERT INTO sfanwf_t(sfanwfent,sfanwfsite,sfanwfdocno,sfanwf001,sfanwf002,
                                           sfanwf003,sfanwf004,sfanwf005,sfanwfseq,sfanwf006,sfanwfseq1,
                                           sfanwfud001,sfanwfud002,sfanwfud003,sfanwfud004,sfanwfud005,
                                           sfanwfud006,sfanwfud007,sfanwfud008,sfanwfud009,sfanwfud010,
                                           sfanwfud011,sfanwfud012,sfanwfud013,sfanwfud014,sfanwfud015,
                                           sfanwfud016,sfanwfud017,sfanwfud018,sfanwfud019,sfanwfud020,
                                           sfanwfud021,sfanwfud022,sfanwfud023,sfanwfud024,sfanwfud025,
                                           sfanwfud026,sfanwfud027,sfanwfud028,sfanwfud029,sfanwfud030,
                                           sfanwf007)
                        VALUES(l_sfanwf.sfanwfent,l_sfanwf.sfanwfsite,l_sfanwf.sfanwfdocno,l_sfanwf.sfanwf001,l_sfanwf.sfanwf002,
                               l_sfanwf.sfanwf003,l_sfanwf.sfanwf004,l_sfanwf.sfanwf005,l_sfanwf.sfanwfseq,l_sfanwf.sfanwf006,l_sfanwf.sfanwfseq1,
                               l_sfanwf.sfanwfud001,l_sfanwf.sfanwfud002,l_sfanwf.sfanwfud003,l_sfanwf.sfanwfud004,l_sfanwf.sfanwfud005,
                               l_sfanwf.sfanwfud006,l_sfanwf.sfanwfud007,l_sfanwf.sfanwfud008,l_sfanwf.sfanwfud009,l_sfanwf.sfanwfud010,
                               l_sfanwf.sfanwfud011,l_sfanwf.sfanwfud012,l_sfanwf.sfanwfud013,l_sfanwf.sfanwfud014,l_sfanwf.sfanwfud015,
                               l_sfanwf.sfanwfud016,l_sfanwf.sfanwfud017,l_sfanwf.sfanwfud018,l_sfanwf.sfanwfud019,l_sfanwf.sfanwfud020,
                               l_sfanwf.sfanwfud021,l_sfanwf.sfanwfud022,l_sfanwf.sfanwfud023,l_sfanwf.sfanwfud024,l_sfanwf.sfanwfud025,
                               l_sfanwf.sfanwfud026,l_sfanwf.sfanwfud027,l_sfanwf.sfanwfud028,l_sfanwf.sfanwfud029,l_sfanwf.sfanwfud030,
                               l_sfanwf.sfanwf007)
                        #161109-00085#66 --e add
                        #161109-00085#27-e
                     END FOR 
                     CALL bsft001_wf_b_fill_sfanwf()
                  END IF
                  CALL l_inam.clear()
                 #CALL s_transaction_end('Y','0')   #160701-00010#1 mark
                 #ERROR 'INSERT O.K'  #170906-00054#1 mark
                  LET g_rec_b=g_rec_b+1 
               END IF
               #160701-00010#1 -s add
               IF g_sfajwf_m.sfajwf003 = '3' THEN
                  #????????????
                  DELETE FROM sfbcwf_t WHERE sfbcwfent=g_enterprise AND sfbcwfsite=g_site AND sfbcwfdocno=g_sfajwf_m.sfajwfdocno
                  CALL cl_err_collect_init()   #181112-00058#1 add
                  CALL s_bsft001_wf_02(g_sfajwf_m.sfajwfdocno,g_sfakwf_d[g_detail_idx].sfakwfseq,g_sfajwf_m.sfajwf003,g_sfakwf_d[g_detail_idx].sfakwf001,
                                          #??                #????     #????               #????               
            
                             g_sfakwf_d[g_detail_idx].sfakwf043,'N','','','','') 
                                     #BOM????    #?????Y/N)      #??????             #??DATECODE                  #??????             #??????

                  RETURNING l_success,l_num
                  #241104-00004#1 add--s
                  IF l_success AND g_sfajwf_m.sfajwf013 =  '2' THEN
                     CALL bsft001_wf_up_fc() RETURNING l_success 
                  END IF                     
                  #241104-00004#1 add--e
                  IF NOT l_success THEN
                     CALL s_transaction_end('N','0')
                  ELSE
                     CALL s_transaction_end('Y','0')
                  END IF
                  CALL cl_err_collect_show()   #181112-00058#1 add
                  CALL bsft001_wf_b_fill()
                  LET g_rec_b = g_sfakwf2_d.getLength()               
               END IF
               #160701-00010#1 -e add 
               #fanngxy add--e
               #end add-point
            ELSE    
               INITIALIZE g_sfakwf_d[l_ac].* TO NULL
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = 'INSERT' 
               LET g_errparam.code = "std-00006" 
               LET g_errparam.popup = TRUE 
               CALL s_transaction_end('N','0')
               CALL cl_err()
               CANCEL INSERT
            END IF
 
            IF SQLCA.SQLCODE THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "sfanwf_t:",SQLERRMESSAGE 
               LET g_errparam.code = SQLCA.SQLCODE 
               LET g_errparam.popup = TRUE 
               CALL s_transaction_end('N','0')                    
               CALL cl_err()
               CANCEL INSERT
            ELSE
               #?????
               #CALL bsft001_wf_b_fill()
               #??????-?/?
               
                  #161130-00056 add
               #add-point:????? name="input.body5.after_insert"

               #end add-point
               CALL s_transaction_end('Y','0')
               #ERROR 'INSERT O.K'
               LET g_rec_b = g_rec_b + 1
            END IF
            
            #??g_detail_idx
            LET g_detail_idx = g_detail_idx_tmp
            
         ON ROW CHANGE 
            IF INT_FLAG THEN
               LET INT_FLAG = 0
               LET g_sfakwf5_d[l_ac].* = g_sfakwf5_d_t.*
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code = 9001 
               LET g_errparam.popup = FALSE 
               CLOSE bsft001_wf_bcl5
               CALL s_transaction_end('N','0')
               CALL cl_err()
               EXIT DIALOG 
            END IF
            
            IF l_lock_sw = 'Y' THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code = -263 
               LET g_errparam.popup = TRUE 
               CALL cl_err()
               LET g_sfakwf5_d[l_ac].* = g_sfakwf5_d_t.*
               EXIT DIALOG   #210416-00007
            ELSE
               #add-point:??page5??? name="input.body5.b_update"
               IF cl_null(g_sfakwf5_d[l_ac].sfanwf006) THEN
                  LET g_sfakwf5_d[l_ac].sfanwf006 = ' '
               END IF
               #end add-point
               
               #?????/??????(??5)
               
               
               #???????
               CALL bsft001_wf_sfanwf_t_mask_restore('restore_mask_o')
               
               UPDATE sfanwf_t SET (sfanwfdocno,sfanwfseq1,sfanwfseq,sfanwf002,sfanwf001,sfanwf006,sfanwf003,sfanwf004,sfanwf005) = (g_sfajwf_m.sfajwfdocno,g_sfakwf_d[g_detail_idx].sfakwfseq,g_sfakwf5_d[l_ac].sfanwfseq,g_sfakwf5_d[l_ac].sfanwf002,g_sfakwf5_d[l_ac].sfanwf001,g_sfakwf5_d[l_ac].sfanwf006, 
                   g_sfakwf5_d[l_ac].sfanwf003,g_sfakwf5_d[l_ac].sfanwf004,g_sfakwf5_d[l_ac].sfanwf005) #??????
                WHERE sfanwfent = g_enterprise AND sfanwfsite = g_site AND sfanwfdocno = g_sfajwfdocno_t AND sfanwfseq1 = g_sfakwf_d[g_detail_idx].sfakwfseq AND sfanwfseq = g_sfakwf5_d_t.sfanwfseq
                  
               #add-point:??page5??? name="input.body5.m_update"

               #end add-point
                  
               CASE
                  WHEN SQLCA.sqlerrd[3] = 0  #???????
                     LET g_sfakwf5_d[l_ac].* = g_sfakwf5_d_t.*
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = "sfanwf_t" 
                     LET g_errparam.code = "std-00009" 
                     LET g_errparam.popup = TRUE 
                     CALL s_transaction_end('N','0')
                     CALL cl_err()
                     EXIT DIALOG   #210416-00007
                     
                  WHEN SQLCA.SQLCODE #????
                     LET g_sfakwf5_d[l_ac].* = g_sfakwf5_d_t.*
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = "sfanwf_t:",SQLERRMESSAGE 
                     LET g_errparam.code = SQLCA.SQLCODE 
                     LET g_errparam.popup = TRUE 
                     CALL s_transaction_end('N','0')
                     CALL cl_err()
                     EXIT DIALOG   #210416-00007
                     
                  OTHERWISE
                     #??????-?/?
                     
                        #161130-00056 add
                                    INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_sfajwf_m.sfajwfdocno
               LET gs_keys_bak[1] = g_sfajwfdocno_t
               LET gs_keys[2] = g_sfakwf_d[g_detail_idx].sfakwfseq
               LET gs_keys_bak[2] = g_sfakwf_d[g_detail_idx].sfakwfseq
               LET gs_keys[3] = g_sfakwf5_d[g_detail_idx2].sfanwfseq
               LET gs_keys_bak[3] = g_sfakwf5_d_t.sfanwfseq
               CALL bsft001_wf_update_b('sfanwf_t',gs_keys,gs_keys_bak,"'5'")
               END CASE
               
               #210416-00007 ????add-point ---start---
               #add-point:??page5????????? name="input.body5.a_update_b_mask"

               #end add-point
               #210416-00007 ????add-point --- end ---
               #?????????
               CALL bsft001_wf_sfanwf_t_mask_restore('restore_mask_n')
               
               #??????(????)
               LET g_log1 = util.JSON.stringify(g_sfajwf_m),util.JSON.stringify(g_sfakwf5_d_t)
               LET g_log2 = util.JSON.stringify(g_sfajwf_m),util.JSON.stringify(g_sfakwf5_d[l_ac])
               IF NOT cl_log_modified_record_d(g_log1,g_log2) THEN 
                  CALL s_transaction_end('N','0')
                  EXIT DIALOG   #210416-00007
               END IF
               
               #add-point:??page5??? name="input.body5.a_update"

               #end add-point
            END IF
         
                  #?? a01 ??????(Version:2)
         BEFORE FIELD l_sfanwfseq1
            #add-point:BEFORE FIELD l_sfanwfseq1 name="input.b.page5.l_sfanwfseq1"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD l_sfanwfseq1
            
            #add-point:AFTER FIELD l_sfanwfseq1 name="input.a.page5.l_sfanwfseq1"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE l_sfanwfseq1
            #add-point:ON CHANGE l_sfanwfseq1 name="input.g.page5.l_sfanwfseq1"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfanwfseq
            #add-point:BEFORE FIELD sfanwfseq name="input.b.page5.sfanwfseq"
            IF cl_null(g_sfakwf5_d[l_ac].sfanwfseq) OR g_sfakwf5_d[l_ac].sfanwfseq = 0  THEN 
               SELECT MAX(sfanwfseq)+1 INTO g_sfakwf5_d[l_ac].sfanwfseq FROM sfanwf_t
                WHERE sfanwfent = g_enterprise
                  AND sfanwfsite = g_site
                  AND sfanwfdocno = g_sfajwf_m.sfajwfdocno AND sfanwfseq1 = g_sfakwf_d[l_ac].sfakwfseq
               IF cl_null(g_sfakwf5_d[l_ac].sfanwfseq) THEN
                  LET g_sfakwf5_d[l_ac].sfanwfseq = 1
               END IF                
            END IF
            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfanwfseq
            
            #add-point:AFTER FIELD sfanwfseq name="input.a.page5.sfanwfseq"
            #?? a05 ??????(Version:3)
            IF NOT cl_ap_chk_Range(g_sfakwf5_d[l_ac].sfanwfseq,"0","0","","","azz-00079",1) THEN
               LET g_sfakwf5_d[l_ac].sfanwfseq = g_sfakwf5_d_t.sfanwfseq
               NEXT FIELD sfanwfseq
            END IF
            
            #???????
            IF  g_sfajwf_m.sfajwfdocno IS NOT NULL AND g_sfakwf5_d[g_detail_idx].sfanwfseq IS NOT NULL THEN 
               IF l_cmd = 'a' OR ( l_cmd = 'u' AND (g_sfajwf_m.sfajwfdocno != g_sfajwfdocno_t OR g_sfakwf5_d[g_detail_idx].sfanwfseq != g_sfakwf5_d_t.sfanwfseq)) THEN 
                  IF NOT ap_chk_notDup("","SELECT COUNT(1) FROM sfanwf_t WHERE "||"sfanwfent = " ||g_enterprise|| " AND sfanwfsite = '" ||g_site|| "' AND "||"sfanwfdocno = '"||g_sfajwf_m.sfajwfdocno ||"' AND "|| "sfanwfseq = '"||g_sfakwf5_d[g_detail_idx].sfanwfseq ||"' AND "|| "sfanwfseq1 = '"||g_sfakwf_d[g_detail_idx].sfakwfseq ||"'",'std-00004',0) THEN 
                     NEXT FIELD CURRENT
                  END IF
               END IF
            END IF

            

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfanwfseq
            #add-point:ON CHANGE sfanwfseq name="input.g.page5.sfanwfseq"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfanwf002
            #add-point:BEFORE FIELD sfanwf002 name="input.b.page5.sfanwf002"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfanwf002
            
            #add-point:AFTER FIELD sfanwf002 name="input.a.page5.sfanwf002"
            IF NOT cl_null(g_sfakwf5_d[l_ac].sfanwf002) AND (g_sfakwf5_d[l_ac].sfanwf002 != g_sfakwf5_d_t.sfanwf002 OR cl_null(g_sfakwf5_d_t.sfanwf002)) THEN
               IF g_sfajwf_m.sfajwf003 = '3' THEN
                  IF g_sfakwf5_d[l_ac].sfanwf002 != '4' THEN
                     INITIALIZE g_errparam TO NULL
                     LET g_errparam.code = 'asf-00049'
                     LET g_errparam.extend = g_sfakwf5_d[l_ac].sfanwf002
                     LET g_errparam.popup = TRUE
                     CALL cl_err()
             
                     LET g_sfakwf5_d[l_ac].sfanwf002 = g_sfakwf5_d_t.sfanwf002
                     NEXT FIELD sfanwf002
                  END IF 
               END IF
               IF l_cmd = 'a' AND g_sfakwf5_d[l_ac].sfanwf002 = '1' THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = 'asf-00114'
                  LET g_errparam.extend = g_sfakwf5_d[l_ac].sfanwf002
                  LET g_errparam.popup = TRUE
                  CALL cl_err()
             
                  LET g_sfakwf5_d[l_ac].sfanwf002 = g_sfakwf5_d_t.sfanwf002
                  NEXT FIELD sfanwf002
               END IF 
               
               #190328-00034#1---add---s
               IF g_sfajwf_m.sfajwf003 MATCHES '[12]' AND g_sfakwf5_d[l_ac].sfanwf002 = '4' THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = 'asf-01006'
                  LET g_errparam.extend = g_sfakwf5_d[l_ac].sfanwf002
                  LET g_errparam.popup = TRUE
                  CALL cl_err()
                   
                  LET g_sfakwf5_d[l_ac].sfanwf002 = g_sfakwf5_d_t.sfanwf002
                  NEXT FIELD sfanwf002 
               END IF
               #190328-00034#1---add---e
               
               CALL bsft001_wf_set_entry_sfanwf()
            END IF
            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfanwf002
            #add-point:ON CHANGE sfanwf002 name="input.g.page5.sfanwf002"

            #END add-point 
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfanwf001
            
            #add-point:AFTER FIELD sfanwf001 name="input.a.page5.sfanwf001"
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_sfakwf5_d[l_ac].sfanwf001
            CALL ap_ref_array2(g_ref_fields,"SELECT imaal003 FROM imaal_t WHERE imaalent="||g_enterprise||" AND imaal001=? AND imaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_sfakwf5_d[l_ac].sfanwf001_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_sfakwf5_d[l_ac].sfanwf001_desc
            IF NOT cl_null(g_sfakwf5_d[l_ac].sfanwf001) THEN
               IF cl_null(g_sfakwf5_d_o.sfanwf001) OR g_sfakwf5_d_o.sfanwf001 !=g_sfakwf5_d[l_ac].sfanwf001 THEN
                  #201111-00004#1---add---str---
                  IF cl_null(g_sfakwf5_d[l_ac].sfanwf002) THEN
                      CALL bsft001_wf_get_sfanwf002()
                  END IF
                  #201111-00004#1---add---end---
                  CALL bsft001_wf_sfanwf001_chk() RETURNING l_success,l_imaa005_1
                  IF NOT l_success THEN
                     LET g_sfakwf5_d[l_ac].sfanwf001 = g_sfakwf5_d_o.sfanwf001
                     CALL s_desc_get_item_desc(g_sfakwf5_d[l_ac].sfanwf001) RETURNING g_sfakwf5_d[l_ac].sfanwf001_desc,g_sfakwf5_d[l_ac].sfanwf001_desc_1
                     NEXT FIELD sfanwf001
                  END IF
                  IF s_feature_auto_chk(g_sfakwf5_d[l_ac].sfanwf001) THEN    #160314-00009#16  add           
                     IF NOT cl_null(l_imaa005_1) THEN
                        IF l_cmd = 'a' THEN
                           CALL l_inam.clear()          
                           CALL s_feature_multi(g_sfakwf5_d[l_ac].sfanwf001,'','',g_site,g_sfajwf_m.sfajwfdocno) RETURNING l_success,l_inam
                           LET g_sfakwf5_d[l_ac].sfanwf006 = l_inam[1].inam002
                           LET g_sfakwf5_d[l_ac].sfanwf003 = l_inam[1].inam004
                        END IF
                     END IF
                  END IF   #160314-00009#16  add
                  #??????
                  IF NOT cl_null(g_sfakwf5_d[l_ac].sfanwf006) THEN                 
                     IF NOT s_feature_check(g_sfakwf5_d[l_ac].sfanwf001,g_sfakwf5_d[l_ac].sfanwf006) THEN
                        LET g_sfakwf5_d[l_ac].sfanwf006 = g_sfakwf5_d_t.sfanwf006
                        NEXT FIELD sfanwf006
                     END IF
                     #????????
                     CALL s_feature_description(g_sfakwf5_d[l_ac].sfanwf001,g_sfakwf5_d[l_ac].sfanwf006)
                        RETURNING l_success,g_sfakwf5_d[l_ac].sfanwf006_desc
                     IF NOT l_success THEN
                        LET g_sfakwf5_d[l_ac].sfanwf006_desc = ''
                     END IF
                  ELSE 
                     LET g_sfakwf5_d[l_ac].sfanwf006_desc = ''
                  END IF
                  DISPLAY BY NAME g_sfakwf5_d[l_ac].sfanwf006_desc
               #END IF  #170225-00003#1
                  #????
                  #IF cl_null(g_sfakwf5_d[l_ac].sfanwf004) THEN        #170313-00046#1 mark
                     SELECT imae016 INTO g_sfakwf5_d[l_ac].sfanwf004 FROM imae_t 
                      WHERE imaeent = g_enterprise AND imaesite = g_site AND imae001 = g_sfakwf5_d[l_ac].sfanwf001
                     IF cl_null(g_sfakwf5_d[l_ac].sfanwf004) THEN
                        SELECT imaa006 INTO g_sfakwf5_d[l_ac].sfanwf004 FROM imaa_t 
                         WHERE imaaent = g_enterprise AND imaa001 = g_sfakwf5_d[l_ac].sfanwf001
                     END IF
                  #END IF                                          #170313-00046#1 mark  
            #170225-00003#1-s
               END IF
            END IF
            CALL bsft001_wf_show_sfanwf_desc(l_ac)  #180503-00034#1
            LET g_sfakwf5_d_o.sfanwf001 = g_sfakwf5_d[l_ac].sfanwf001
            #170225-00003#1-e
            CALL bsft001_wf_set_entry_sfanwf()

            #END add-point
            
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfanwf001
            #add-point:BEFORE FIELD sfanwf001 name="input.b.page5.sfanwf001"

            #END add-point
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfanwf001
            #add-point:ON CHANGE sfanwf001 name="input.g.page5.sfanwf001"

            #END add-point 
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfanwf006
            
            #add-point:AFTER FIELD sfanwf006 name="input.a.page5.sfanwf006"
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_sfakwf5_d[l_ac].sfanwf006
            CALL ap_ref_array2(g_ref_fields,"SELECT imecl005 FROM imecl_t WHERE imeclent="||g_enterprise||" AND imecl003=? AND imecl004='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_sfakwf5_d[l_ac].sfanwf006_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_sfakwf5_d[l_ac].sfanwf006_desc
            IF NOT cl_null(g_sfakwf5_d[l_ac].sfanwf001) AND NOT cl_null(g_sfakwf5_d[l_ac].sfanwf006) THEN
             
               #??????
               IF NOT s_feature_check(g_sfakwf5_d[l_ac].sfanwf001,g_sfakwf5_d[l_ac].sfanwf006) THEN
                  LET g_sfakwf5_d[l_ac].sfanwf006 = g_sfakwf5_d_t.sfanwf006
                  NEXT FIELD sfanwf006
               END IF
               #--151224-00025#4 add start--
               IF NOT s_feature_direct_input(g_sfakwf5_d[l_ac].sfanwf001,g_sfakwf5_d[l_ac].sfanwf006,g_sfakwf5_d_t.sfanwf006,g_sfajwf_m.sfajwfdocno,g_site) THEN
                  NEXT FIELD CURRENT
               END IF
               #--151224-00025#4 add end--
               #????????
               CALL s_feature_description(g_sfakwf5_d[l_ac].sfanwf001,g_sfakwf5_d[l_ac].sfanwf006)
                  RETURNING l_success,g_sfakwf5_d[l_ac].sfanwf006_desc
               IF NOT l_success THEN
                  LET g_sfakwf5_d[l_ac].sfanwf006_desc = ''
               END IF
            ELSE 
               LET g_sfakwf5_d[l_ac].sfanwf006_desc = ''
            END IF

            DISPLAY BY NAME g_sfakwf5_d[l_ac].sfanwf006_desc

            #END add-point
            
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfanwf006
            #add-point:BEFORE FIELD sfanwf006 name="input.b.page5.sfanwf006"

            #END add-point
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfanwf006
            #add-point:ON CHANGE sfanwf006 name="input.g.page5.sfanwf006"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfanwf003
            #add-point:BEFORE FIELD sfanwf003 name="input.b.page5.sfanwf003"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfanwf003
            
            #add-point:AFTER FIELD sfanwf003 name="input.a.page5.sfanwf003"
            #220511-00019#1 add--s
            SELECT imaa011 INTO l_imaa011
              FROM imaa_t
             WHERE imaaent = g_enterprise
               AND imaa001 = g_sfakwf_d[g_detail_idx].sfakwf001
            IF l_imaa011 = '1' THEN
               LET l_sfanwf003_cnt = 0
               FOR l_i = 1 TO g_sfakwf5_d.getLength()
                  IF g_sfakwf5_d[l_i].sfanwf002 = '1' OR g_sfakwf5_d[l_i].sfanwf002 = '2' THEN
                     LET l_sfanwf003_cnt = l_sfanwf003_cnt + g_sfakwf5_d[l_i].sfanwf003
                  END IF
               END FOR
               IF l_sfanwf003_cnt > g_sfakwf_d[g_detail_idx].sfakwf006 THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = 'asf-01100'
                  LET g_errparam.extend = g_sfakwf5_d[l_ac].sfanwf001
                  LET g_errparam.popup = TRUE
                  CALL cl_err()
                  LET g_sfakwf5_d[l_ac].sfanwf003 = g_sfakwf5_d_t.sfanwf003
                  NEXT FIELD sfanwf003
               END IF
            ELSE
            #220511-00019#1 add--e
               #170331-00012#1 add --(S)--
               IF g_sfakwf5_d[l_ac].sfanwf002 = '1' AND (g_sfakwf5_d[l_ac].sfanwf003 <> g_sfakwf5_d_t.sfanwf003) THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = 'asf-00114'
                  LET g_errparam.extend = g_sfakwf5_d[l_ac].sfanwf001
                  LET g_errparam.popup = TRUE
                  CALL cl_err()
                  LET g_sfakwf5_d[l_ac].sfanwf003 = g_sfakwf5_d_t.sfanwf003
                  NEXT FIELD sfanwf003
               END IF
               #170331-00012#1 add --(E)--
            END IF   #220511-00019#1 add
            IF g_sfakwf5_d[l_ac].sfanwf003 < 0 THEN
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code = 'agl-00041'
               LET g_errparam.extend = g_sfakwf5_d[l_ac].sfanwf003
               LET g_errparam.popup = FALSE
               CALL cl_err()

               LET g_sfakwf5_d[l_ac].sfanwf003 = g_sfakwf5_d_t.sfanwf003
               NEXT FIELD sfanwf003
            END IF 
            #????
            IF NOT cl_null(g_sfakwf5_d[l_ac].sfanwf004) THEN
               CALL s_aooi250_take_decimals(g_sfakwf5_d[l_ac].sfanwf004,g_sfakwf5_d[l_ac].sfanwf003)
                    RETURNING l_success,g_sfakwf5_d[l_ac].sfanwf003
            END IF
            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfanwf003
            #add-point:ON CHANGE sfanwf003 name="input.g.page5.sfanwf003"

            #END add-point 
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfanwf004
            
            #add-point:AFTER FIELD sfanwf004 name="input.a.page5.sfanwf004"
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_sfakwf5_d[l_ac].sfanwf004
            CALL ap_ref_array2(g_ref_fields,"SELECT oocal003 FROM oocal_t WHERE oocalent="||g_enterprise||" AND oocal001=? AND oocal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_sfakwf5_d[l_ac].sfanwf004_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_sfakwf5_d[l_ac].sfanwf004_desc


            #END add-point
            
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfanwf004
            #add-point:BEFORE FIELD sfanwf004 name="input.b.page5.sfanwf004"

            #END add-point
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfanwf004
            #add-point:ON CHANGE sfanwf004 name="input.g.page5.sfanwf004"

            #END add-point 
 
 
         #?? a01 ??????(Version:2)
         BEFORE FIELD sfanwf005
            #add-point:BEFORE FIELD sfanwf005 name="input.b.page5.sfanwf005"

            #END add-point
 
 
         #?? a02 ??????(Version:3)
         AFTER FIELD sfanwf005
            
            #add-point:AFTER FIELD sfanwf005 name="input.a.page5.sfanwf005"

            #END add-point
            
 
 
         #?? a04 ??????(Version:3)
         ON CHANGE sfanwf005
            #add-point:ON CHANGE sfanwf005 name="input.g.page5.sfanwf005"

            #END add-point 
 
 
 
                  #Ctrlp:input.c.page5.l_sfanwfseq1
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD l_sfanwfseq1
            #add-point:ON ACTION controlp INFIELD l_sfanwfseq1 name="input.c.page5.l_sfanwfseq1"

            #END add-point
 
 
         #Ctrlp:input.c.page5.sfanwfseq
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfanwfseq
            #add-point:ON ACTION controlp INFIELD sfanwfseq name="input.c.page5.sfanwfseq"

            #END add-point
 
 
         #Ctrlp:input.c.page5.sfanwf002
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfanwf002
            #add-point:ON ACTION controlp INFIELD sfanwf002 name="input.c.page5.sfanwf002"

            #END add-point
 
 
         #Ctrlp:input.c.page5.sfanwf001
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfanwf001
            #add-point:ON ACTION controlp INFIELD sfanwf001 name="input.c.page5.sfanwf001"
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
            LET g_qryparam.default1 = g_sfakwf5_d[l_ac].sfanwf001  #??default?
            LET g_qryparam.where = " imaa004 <> 'X' AND imaa004 <> 'F' "   #170618-00283#1 add
            #170618-00477#4-s-add
            #?????????
            LET g_qryparam.where = g_qryparam.where, 
                                   " AND EXISTS (SELECT oocq001 FROM oocq_t ",
                                   "              WHERE oocqent = imafent ",
                                   "                AND oocq001 = '210'",
                                   "                AND oocq002 = imaf016 ",
                                   "                AND oocq009 = 'N' AND oocqstus = 'Y') "
            #170618-00477#4-e-add
            #CALL q_imaa001()                                 #????  #170225-00003#1
            CALL q_imaf001_6()                                #170225-00003#1
            LET g_sfakwf5_d[l_ac].sfanwf001 = g_qryparam.return1   #????????????
            CALL s_desc_get_item_desc(g_sfakwf5_d[l_ac].sfanwf001) RETURNING g_sfakwf5_d[l_ac].sfanwf001_desc,g_sfakwf5_d[l_ac].sfanwf001_desc_1  #170225-00003#1
            NEXT FIELD sfanwf001    
            #END add-point
 
 
         #Ctrlp:input.c.page5.sfanwf006
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfanwf006
            #add-point:ON ACTION controlp INFIELD sfanwf006 name="input.c.page5.sfanwf006"
            #???????
            SELECT imaa005 INTO l_imaa005_1 FROM imaa_t WHERE imaaent = g_enterprise AND imaa001 = g_sfakwf5_d[l_ac].sfanwf001 #210514-00037#1 mark  #220511-00015#1 remark
            IF NOT cl_null(l_imaa005_1) THEN                   #210514-00037#1 mark  #220511-00015#1 remark
            #IF s_feature_auto_chk(g_sfakwf5_d[l_ac].sfanwf001) THEN #210514-00037#1 add  #220511-00015#1 mark
               IF l_cmd = 'a' THEN 
                  CALL l_inam.clear()          
                  CALL s_feature_multi(g_sfakwf5_d[l_ac].sfanwf001,'','',g_site,g_sfajwf_m.sfajwfdocno) RETURNING l_success,l_inam
                  LET g_sfakwf5_d[l_ac].sfanwf006 = l_inam[1].inam002
                  LET g_sfakwf5_d[l_ac].sfanwf003 = l_inam[1].inam004                   
               END IF
               IF l_cmd = 'u' THEN
                  CALL s_feature_single(g_sfakwf5_d[l_ac].sfanwf001,g_sfakwf5_d[l_ac].sfanwf006,g_site,g_sfajwf_m.sfajwfdocno)
                     RETURNING l_success,g_sfakwf5_d[l_ac].sfanwf006
               END IF
            END IF
            #END add-point
 
 
         #Ctrlp:input.c.page5.sfanwf003
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfanwf003
            #add-point:ON ACTION controlp INFIELD sfanwf003 name="input.c.page5.sfanwf003"

            #END add-point
 
 
         #Ctrlp:input.c.page5.sfanwf004
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfanwf004
            #add-point:ON ACTION controlp INFIELD sfanwf004 name="input.c.page5.sfanwf004"

            #END add-point
 
 
         #Ctrlp:input.c.page5.sfanwf005
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD sfanwf005
            #add-point:ON ACTION controlp INFIELD sfanwf005 name="input.c.page5.sfanwf005"

            #END add-point
 
 
 
 
         AFTER ROW
            #add-point:??page5_after_row name="input.body5.after_row"

            #end add-point
            LET l_ac = ARR_CURR()
            IF INT_FLAG THEN
               LET INT_FLAG = 0
               IF l_cmd = 'u' THEN
                  LET g_sfakwf5_d[l_ac].* = g_sfakwf5_d_t.*
               END IF
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code = 9001 
               LET g_errparam.popup = FALSE 
               CLOSE bsft001_wf_bcl5
               CLOSE bsft001_wf_bcl
               CALL s_transaction_end('N','0')
               CALL cl_err()
               EXIT DIALOG 
            END IF
            
            #??table??unlock
            
            CALL bsft001_wf_unlock_b("sfanwf_t","'5'")
            CALL s_transaction_end('Y','0')
            #add-point:??page5_after_row2 name="input.body5.after_row2"

            #end add-point
 
         AFTER INPUT
            #add-point:input?after input  name="input.body5.after_input"
            LET l_m = 0
            SELECT COUNT(1) INTO l_m FROM sfanwf_t
             WHERE sfanwfent = g_enterprise AND sfanwfdocno = g_sfajwf_m.sfajwfdocno AND sfanwf002 = '3' AND sfanwfseq1 = g_sfakwf_d[l_ac].sfakwfseq
            IF g_sfajwf_m.sfajwf003 != '3' AND l_m = 0 THEN
            #160202 by 04441 add (e)
            #IF g_sfaa_m.sfaa003 != '3' THEN  #160202 by 04441 mark
               DECLARE asft300_input_chk_sfanwf_cs CURSOR FOR 
               #161109-00085#27-s
               #SELECT * FROM sfanwf_t
               #SELECT sfanwfent,sfanwfsite,sfanwfdocno,sfanwf001,sfanwf002,sfanwf003,sfanwf004,sfanwf005,sfanwfseq,sfanwf006,sfanwf007 #161109-00085#66 mark
               SELECT sfanwfent,sfanwfsite,sfanwfdocno,sfanwf001,sfanwf002,
                      sfanwf003,sfanwf004,sfanwf005,sfanwfseq,sfanwf006,sfanwfseq1,
                      sfanwfud001,sfanwfud002,sfanwfud003,sfanwfud004,sfanwfud005,
                      sfanwfud006,sfanwfud007,sfanwfud008,sfanwfud009,sfanwfud010,
                      sfanwfud011,sfanwfud012,sfanwfud013,sfanwfud014,sfanwfud015,
                      sfanwfud016,sfanwfud017,sfanwfud018,sfanwfud019,sfanwfud020,
                      sfanwfud021,sfanwfud022,sfanwfud023,sfanwfud024,sfanwfud025,
                      sfanwfud026,sfanwfud027,sfanwfud028,sfanwfud029,sfanwfud030,
                      sfanwf007              
                 FROM sfanwf_t
                 WHERE sfanwfent = g_enterprise
                   AND sfanwfdocno = g_sfajwf_m.sfajwfdocno AND sfanwfseq1 = g_sfakwf_d[l_ac].sfakwfseq
                   AND (sfanwf002 = '1' OR sfanwf002 = '2')
               LET l_sfanwf003_sum = 0
               #FOREACH asft300_input_chk_sfanwf_cs INTO l_sfanwf.*
               FOREACH asft300_input_chk_sfanwf_cs 
               #161109-00085#66 --s mark
               #   INTO l_sfanwf.sfanwfent,l_sfanwf.sfanwfsite,l_sfanwf.sfanwfdocno,l_sfanwf.sfanwf001,l_sfanwf.sfanwf002,
               #        l_sfanwf.sfanwf003,l_sfanwf.sfanwf004,l_sfanwf.sfanwf005,l_sfanwf.sfanwfseq,l_sfanwf.sfanwf006,
               #        l_sfanwf.sfanwf007
               #161109-00085#66 --e mark
               #161109-00085#66 --s add
                  INTO l_sfanwf.sfanwfent,l_sfanwf.sfanwfsite,l_sfanwf.sfanwfdocno,l_sfanwf.sfanwf001,l_sfanwf.sfanwf002,
                       l_sfanwf.sfanwf003,l_sfanwf.sfanwf004,l_sfanwf.sfanwf005,l_sfanwf.sfanwfseq,l_sfanwf.sfanwf006,l_sfanwf.sfanwfseq1,
                       l_sfanwf.sfanwfud001,l_sfanwf.sfanwfud002,l_sfanwf.sfanwfud003,l_sfanwf.sfanwfud004,l_sfanwf.sfanwfud005,
                       l_sfanwf.sfanwfud006,l_sfanwf.sfanwfud007,l_sfanwf.sfanwfud008,l_sfanwf.sfanwfud009,l_sfanwf.sfanwfud010,
                       l_sfanwf.sfanwfud011,l_sfanwf.sfanwfud012,l_sfanwf.sfanwfud013,l_sfanwf.sfanwfud014,l_sfanwf.sfanwfud015,
                       l_sfanwf.sfanwfud016,l_sfanwf.sfanwfud017,l_sfanwf.sfanwfud018,l_sfanwf.sfanwfud019,l_sfanwf.sfanwfud020,
                       l_sfanwf.sfanwfud021,l_sfanwf.sfanwfud022,l_sfanwf.sfanwfud023,l_sfanwf.sfanwfud024,l_sfanwf.sfanwfud025,
                       l_sfanwf.sfanwfud026,l_sfanwf.sfanwfud027,l_sfanwf.sfanwfud028,l_sfanwf.sfanwfud029,l_sfanwf.sfanwfud030,
                       l_sfanwf.sfanwf007
               #161109-00085#66 --e add
               #161109-00085#27-e
                  CALL s_aooi250_convert_qty(l_sfanwf.sfanwf001,l_sfanwf.sfanwf004,g_sfakwf_d[g_detail_idx].sfakwf007,l_sfanwf.sfanwf003) 
                       RETURNING l_success,l_sfanwf003
                  IF NOT l_success THEN
                     LET l_sfanwf003 = l_sfanwf.sfanwf003
                  END IF
                  LET l_sfanwf003_sum = l_sfanwf003_sum + l_sfanwf003
               END FOREACH
               IF l_sfanwf003_sum != g_sfakwf_d[g_detail_idx].sfakwf006 THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = 'asf-00476'
                  LET g_errparam.extend = ''
                  LET g_errparam.popup = TRUE
                  CALL cl_err()
                  NEXT FIELD sfanwf003
               END IF
            END IF
            #end add-point  
 
         ON ACTION controlo    
            IF l_insert THEN
               #170920-00028 ---modify start---
               #????????????????
               IF l_ac_t <= 0 OR l_ac_t IS NULL THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.extend = ""
                  LET g_errparam.code   = "adz-01032"
                  LET g_errparam.popup  = TRUE
                  CALL cl_err()
               ELSE
                  LET li_reproduce = l_ac_t
                  LET li_reproduce_target = l_ac
                  LET g_sfakwf5_d[li_reproduce_target].* = g_sfakwf5_d[li_reproduce].*
 
                  LET g_sfakwf5_d[li_reproduce_target].sfanwfseq = NULL
               END IF
               #170920-00028 --- modify end ---
            ELSE
               CALL FGL_SET_ARR_CURR(g_sfakwf5_d.getLength()+1)
               LET lb_reproduce = TRUE
               LET li_reproduce = l_ac
               LET li_reproduce_target = g_sfakwf5_d.getLength()+1
            END IF
            #(ver:84) ---start---
            #add-point:input?????  name="input.body5.controlo"

            #end add-point
            #(ver:84) --- end ---
        
      END INPUT
 
 
 

{</section>}

{<section id="bsft001_wf.input.other" type="s" >}
      
      #add-point:???input name="input.more_input"

      #end add-point
    
      BEFORE DIALOG 
         #CALL cl_err_collect_init()    
         #add-point:input?before dialog name="input.before_dialog"

         #end add-point    
         #????????????
         CALL DIALOG.setCurrentRow("s_detail1",g_idx_group.getValue("'1',"))      
         CALL DIALOG.setCurrentRow("s_detail2",g_idx_group.getValue("'4',"))
         CALL DIALOG.setCurrentRow("s_detail3",g_idx_group.getValue("'2',"))
         CALL DIALOG.setCurrentRow("s_detail4",g_idx_group.getValue("'3',"))
         CALL DIALOG.setCurrentRow("s_detail5",g_idx_group.getValue("'5',"))
 
         #???????????
         IF p_cmd = 'a' THEN
            #add-point:input?next_field name="input.next_field"

            #end add-point  
            NEXT FIELD sfajwfdocno #170906-00011#1
         ELSE
            CASE g_aw
               WHEN "s_detail1"
                  NEXT FIELD sfakwfseq #170906-00011#1
               WHEN "s_detail4"
                  NEXT FIELD sfamwfseq #170906-00011#1
 
               #add-point:input?modify_detail  name="input.modify_detail.other"

               #end add-point  
            END CASE
         END IF
      
      AFTER DIALOG
         #add-point:input?after_dialog name="input.after_dialog"

         #end add-point    
         
      ON ACTION controlf
         CALL cl_set_focus_form(ui.Interface.getRootNode()) RETURNING g_fld_name,g_frm_name
         CALL cl_fldhelp(g_frm_name,g_fld_name,g_lang)
 
      ON ACTION controlr
         CALL cl_show_req_fields()
 
      ON ACTION controls
         IF g_header_hidden THEN
            CALL gfrm_curr.setElementHidden("vb_master",0)
            CALL gfrm_curr.setElementImage("controls","small/arr-u.png")
            LET g_header_hidden = 0     #visible
         ELSE
            CALL gfrm_curr.setElementHidden("vb_master",1)
            CALL gfrm_curr.setElementImage("controls","small/arr-d.png")
            LET g_header_hidden = 1     #hidden     
         END IF
 
      ON ACTION accept
         #add-point:input?accept  name="input.accept"
#         IF g_loc = 'd' AND g_sfakwf2_d.getLength() > 0 THEN   #241016-00014#1 mark   
         IF g_loc = 'd' AND g_sfakwf2_d.getLength() > 0 AND g_sfajwf_m.sfajwf003 <> 2 THEN     #241016-00014#1 add        
            #C250109 makrk by wangjue --s
#            SELECT COUNT(1) INTO l_cnt FROM sfbcwf_t
#             WHERE sfbcwfent = g_enterprise
#               AND sfbcwfsite = g_site
#               AND sfbcwfdocno = g_sfajwf_m.sfajwfdocno
#               AND sfbcwfseq = g_sfakwf_d[g_detail_idx].sfakwfseq AND sfbcwf043 = 'Y'
#            IF l_cnt = '0' THEN  
#               INITIALIZE g_errparam TO NULL 
#               LET g_errparam.extend = '' 
#               LET g_errparam.code = "wf-00052"   #?????????????????? ???abmm210_wf??????????????
#               LET g_errparam.popup = TRUE 
#               CALL cl_err()
#               NEXT FIELD sfbcwf006
#            END IF
            #C250109 mark by wangjue--e
            #C250109 add by wangjue--s
            LET l_flag_043 = 'Y'
            FOR l_i = 1 TO g_sfakwf2_d.getLength()
                IF g_sfakwf2_d[l_i].sfbcwf043 = 'N' OR cl_null(g_sfakwf2_d[l_i].sfbcwf043) THEN
                   LET l_flag_043 = 'N'
                ELSE
                   LET l_flag_043 = 'Y'
                END IF
                IF l_flag_043 = 'Y' THEN
                   EXIT FOR
                END IF
            END FOR  
            IF l_flag_043 <> 'Y' THEN
                INITIALIZE g_errparam TO NULL 
                  LET g_errparam.extend = '' 
                  LET g_errparam.code = "wf-00052"   #?????????????????? ???abmm210_wf??????????????
                  LET g_errparam.popup = TRUE 
                  CALL cl_err()
                  NEXT FIELD sfbcwf006
            END IF
            #C250109 add by wangjue--e
         END IF 
         #????????BIN?????Y?????????????																																												
	      #?????sfbcwf014=IC???????aooi250??oocawf008='Y'????????????????icbawf_t????????																																											
	      #?????sfbcwf014< >IC???????aooi250??oocawf008='Y'??????????????																																											
	      #??????100EA,?????PCS, 1PCS=5EA																																											
	      #????=30PCS???????20PCS?																																											
	      #?????????????????????????? 
           
         #end add-point    
         ACCEPT DIALOG
        
      ON ACTION cancel      #?dialog button (??)
         #add-point:input?cancel name="input.cancel"
         
         #end add-point  
         LET INT_FLAG = TRUE 
         LET g_detail_idx  = 1
         LET g_detail_idx2 = 1
         #??page??
         LET g_detail_idx_list[1] = 1 
         LET g_detail_idx_list[2] = 1
         LET g_detail_idx_list[3] = 1
         LET g_detail_idx_list[4] = 1
         LET g_detail_idx_list[5] = 1
 
         CALL g_curr_diag.setCurrentRow("s_detail1",1)    
         CALL g_curr_diag.setCurrentRow("s_detail2",1)
         CALL g_curr_diag.setCurrentRow("s_detail3",1)
         CALL g_curr_diag.setCurrentRow("s_detail4",1)
         CALL g_curr_diag.setCurrentRow("s_detail5",1)
 
         EXIT DIALOG
 
      ON ACTION close       #?dialog ??? (X)
         #add-point:input?close name="input.close"
    
         #end add-point  
         LET INT_FLAG = TRUE 
         EXIT DIALOG
 
      ON ACTION exit        #toolbar ??
         #add-point:input?exit name="input.exit"
  
         #end add-point
         LET INT_FLAG = TRUE 
         LET g_detail_idx  = 1
         LET g_detail_idx2 = 1
         #??page??
         LET g_detail_idx_list[1] = 1 
         LET g_detail_idx_list[2] = 1
         LET g_detail_idx_list[3] = 1
         LET g_detail_idx_list[4] = 1
         LET g_detail_idx_list[5] = 1
 
         CALL g_curr_diag.setCurrentRow("s_detail1",1)    
         CALL g_curr_diag.setCurrentRow("s_detail2",1)
         CALL g_curr_diag.setCurrentRow("s_detail3",1)
         CALL g_curr_diag.setCurrentRow("s_detail4",1)
         CALL g_curr_diag.setCurrentRow("s_detail5",1)
 
         EXIT DIALOG
 
      #??????ACTION
      &include "common_action.4gl" 
         CONTINUE DIALOG 
   END DIALOG
    
   #add-point:input?after input  name="input.after_input"

   #end add-point    
 
END FUNCTION

{</section>}

{<section id="bsft001_wf.show" type="s" >}
#+ ???????????????
PRIVATE FUNCTION bsft001_wf_show() RETURNS ()   #200213-00032
   #add-point:show?define(???) name="show.define_customerization"

   #end add-point  
   DEFINE l_ac_t    LIKE type_t.num10
   #add-point:show?define (?????????????????, ?????patch????????) name="show.define"
   DEFINE l_sfajwf018_str  STRING
   #end add-point  
   
   #add-point:Function???? name="show.before"

   #end add-point
   
   
   
   IF g_bfill = "Y" THEN
      CALL bsft001_wf_b_fill() #????
      CALL bsft001_wf_b_fill2('0') #????
   END IF
     
   #??????reference?
   #?? a12 ??????(Version:4)
 
 
 
   
   #??followup??
   #?? a48 ??????(Version:3)
   CALL bsft001_wf_set_pk_array()
   #add-point:ON ACTION agendum name="show.follow_pic"

   #END add-point
   CALL cl_user_overview_set_follow_pic()
  
 
 
 
   
   LET l_ac_t = l_ac
   
   #??ref?(??)
   #add-point:show?reference name="show.head.reference"
   LET g_sfajwf_m.oobal004 = s_aooi200_get_slip_desc(g_sfajwf_m.sfajwfdocno)
   #240201-00005#1 add--s 
   LET l_sfajwf018_str = g_sfajwf_m.sfajwf019 CLIPPED,"-",g_sfajwf_m.sfajwf020 CLIPPED,"-",g_sfajwf_m.sfajwf021 CLIPPED
   CALL cl_replace_str(l_sfajwf018_str, " ", "") RETURNING g_sfajwf_m.l_sfajwf018
   #240201-00005#1 add--e
   LET g_sfajwf_m.sfajwf023_desc = s_desc_get_icaa001_desc(g_sfajwf_m.sfajwf023)
   #end add-point
   
   #??????
   LET g_sfajwf_m_mask_o.* =  g_sfajwf_m.*
   CALL bsft001_wf_sfajwf_t_mask()
   LET g_sfajwf_m_mask_n.* =  g_sfajwf_m.*
   
   #?????????
   DISPLAY BY NAME g_sfajwf_m.sfajwfdocno,g_sfajwf_m.oobal004,g_sfajwf_m.sfajwfdocdt,g_sfajwf_m.sfajwf006,g_sfajwf_m.sfajwf006_desc,g_sfajwf_m.sfajwf007,g_sfajwf_m.sfajwf007_desc,g_sfajwf_m.sfajwf017,g_sfajwf_m.sfajwf019,g_sfajwf_m.sfajwf020,g_sfajwf_m.sfajwf021,g_sfajwf_m.sfajwf018,g_sfajwf_m.l_sfajwf018, 
       g_sfajwf_m.sfajwf022,g_sfajwf_m.sfajwf023,g_sfajwf_m.sfajwf023_desc,g_sfajwf_m.sfajwf012,g_sfajwf_m.sfajwf012_desc,g_sfajwf_m.sfajwf013,g_sfajwf_m.sfajwf014,g_sfajwf_m.sfajwf001,g_sfajwf_m.sfajwf001_desc,g_sfajwf_m.sfajwf002,g_sfajwf_m.sfajwf002_desc,g_sfajwf_m.sfajwf025,g_sfajwf_m.sfajwf025_desc, 
       g_sfajwf_m.sfajwf015,g_sfajwf_m.sfajwfua002,g_sfajwf_m.sfajwf016,g_sfajwf_m.sfajwfua003,g_sfajwf_m.sfajwf024,g_sfajwf_m.sfajwf003,g_sfajwf_m.sfajwf005,g_sfajwf_m.sfajwf004,g_sfajwf_m.sfajwf008,g_sfajwf_m.sfajwf008_desc,g_sfajwf_m.sfajwf009,g_sfajwf_m.sfajwf009_desc,g_sfajwf_m.sfajwf010,g_sfajwf_m.sfajwf010_desc, 
       g_sfajwf_m.sfajwf011,g_sfajwf_m.sfajwf011_desc,g_sfajwf_m.sfajwfua011,g_sfajwf_m.sfajwfua012,g_sfajwf_m.sfajwfua013,g_sfajwf_m.sfajwfua014,g_sfajwf_m.sfajwfua015,g_sfajwf_m.sfajwfstus,g_sfajwf_m.sfajwfownid,g_sfajwf_m.sfajwfownid_desc,g_sfajwf_m.sfajwfowndp,g_sfajwf_m.sfajwfowndp_desc,g_sfajwf_m.sfajwfcrtid, 
       g_sfajwf_m.sfajwfcrtid_desc,g_sfajwf_m.sfajwfcrtdp,g_sfajwf_m.sfajwfcrtdp_desc,g_sfajwf_m.sfajwfcrtdt,g_sfajwf_m.sfajwfmodid,g_sfajwf_m.sfajwfmodid_desc,g_sfajwf_m.sfajwfmoddt,g_sfajwf_m.sfajwfcnfid,g_sfajwf_m.sfajwfcnfid_desc,g_sfajwf_m.sfajwfcnfdt
   
   #????(stus)??
         #?? a21 ??????(Version:3)
	  #???????????
      CASE g_sfajwf_m.sfajwfstus 
         WHEN "A"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/approved.png")
         WHEN "D"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/withdraw.png")
         WHEN "R"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/rejection.png")
         WHEN "W"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/signing.png")
         WHEN "N"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/unconfirmed.png")
         WHEN "Y"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/confirmed.png")
         WHEN "F"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/released.png")
         WHEN "U"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/unreleased.png")
         WHEN "X"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/invalid.png")
         
      END CASE
 
 
 
   
   #??ref?(??)
   FOR l_ac = 1 TO g_sfakwf_d.getLength()
      #add-point:show???reference name="show.body.reference"

      #end add-point
   END FOR
   
   FOR l_ac = 1 TO g_sfakwf2_d.getLength()
      #add-point:show???reference name="show.body2.reference"

      #end add-point
   END FOR
   FOR l_ac = 1 TO g_sfakwf3_d.getLength()
      #add-point:show???reference name="show.body3.reference"

      #end add-point
   END FOR
   FOR l_ac = 1 TO g_sfakwf4_d.getLength()
      #add-point:show???reference name="show.body4.reference"

      #end add-point
   END FOR
   FOR l_ac = 1 TO g_sfakwf5_d.getLength()
      #add-point:show???reference name="show.body5.reference"

      #end add-point
   END FOR
 
   
    
   
   #add-point:show?other name="show.other"

   #end add-point  
   
   LET l_ac = l_ac_t
   
   #?????????????
   CALL cl_show_fld_cont()     
 
   CALL bsft001_wf_detail_show()
 
   #add-point:show??? name="show.after"

   #end add-point
   
END FUNCTION

{</section>}

{<section id="bsft001_wf.detail_show" type="s" >}
#+ ?????reference
PRIVATE FUNCTION bsft001_wf_detail_show() RETURNS ()   #200213-00032
   #add-point:detail_show?define(???) name="detail_show.define_customerization"

   #end add-point  
   #add-point:detail_show?define (?????????????????, ?????patch????????) name="detail_show.define"

   #end add-point  
   
   #add-point:Function???? name="detail_show.before"

   #end add-point
   
   #add-point:detail_show??? name="detail_show.after"

   #end add-point
   
END FUNCTION

{</section>}

{<section id="bsft001_wf.reproduce" type="s" >}
#+ ????
PRIVATE FUNCTION bsft001_wf_reproduce() RETURNS ()   #200213-00032
   #add-point:reproduce?define(???) name="reproduce.define_customerization"

   #end add-point   
   DEFINE l_newno     LIKE sfajwf_t.sfajwfdocno 
   DEFINE l_oldno     LIKE sfajwf_t.sfajwfdocno 
 
   DEFINE l_master    RECORD LIKE sfajwf_t.* #??????????
   DEFINE l_detail    RECORD LIKE sfakwf_t.* #??????????
   DEFINE l_detail2    RECORD LIKE sfamwf_t.* #??????????
 
 
   DEFINE l_detail3    RECORD LIKE sfbcwf_t.* #??????????
 
   DEFINE l_detail4    RECORD LIKE wfapwf_t.* #??????????
 
   DEFINE l_detail5    RECORD LIKE sfanwf_t.* #??????????
 
 
   DEFINE l_cnt       LIKE type_t.num10
   #add-point:reproduce?define (?????????????????, ?????patch????????) name="reproduce.define"

   #end add-point   
   
   #add-point:Function????  name="reproduce.pre_function"

   #end add-point
   
   #????
   IF g_main_hidden THEN
      CALL gfrm_curr.setElementHidden("mainlayout",0)
      CALL gfrm_curr.setElementHidden("worksheet",1)
      LET g_main_hidden = 0
   END IF
   
   LET g_master_insert = FALSE
   
   IF g_sfajwf_m.sfajwfdocno IS NULL
 
   THEN
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = "" 
      LET g_errparam.code = "std-00003" 
      LET g_errparam.popup = FALSE 
      CALL cl_err()
      RETURN
   END IF
    
   LET g_sfajwfdocno_t = g_sfajwf_m.sfajwfdocno
 
    
   LET g_sfajwf_m.sfajwfdocno = ""
 
 
   CALL cl_set_head_visible("","YES")
 
   #?????????
   #?? a14 ??????(Version:5)    
      #????????  
      LET g_sfajwf_m.sfajwfownid = g_user
      LET g_sfajwf_m.sfajwfowndp = g_dept
      LET g_sfajwf_m.sfajwfcrtid = g_user
      LET g_sfajwf_m.sfajwfcrtdp = g_dept 
      LET g_sfajwf_m.sfajwfcrtdt = cl_get_current()
      LET g_sfajwf_m.sfajwfmodid = g_user
      LET g_sfajwf_m.sfajwfmoddt = cl_get_current()
      LET g_sfajwf_m.sfajwfstus = 'N'
 
 
 
   
   CALL s_transaction_begin()
   
   #add-point:????? name="reproduce.head.b_input"
   LET g_sfajwf_m.sfajwfdocdt = g_today
   LET g_sfajwf_m.sfajwf024 = 'N' 
   #240423-00009#2 --s
   #??????
#   CALL g_icbawf_d.clear()  
#   CALL g_icbawf_d2.clear()
#   CALL bsft001_wf_ui_detailshow()
   #240423-00009#2 --e
   #end add-point
   
   #????(stus)??
         #?? a21 ??????(Version:3)
	  #???????????
      CASE g_sfajwf_m.sfajwfstus 
         WHEN "A"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/approved.png")
         WHEN "D"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/withdraw.png")
         WHEN "R"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/rejection.png")
         WHEN "W"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/signing.png")
         WHEN "N"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/unconfirmed.png")
         WHEN "Y"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/confirmed.png")
         WHEN "F"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/released.png")
         WHEN "U"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/unreleased.png")
         WHEN "X"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/invalid.png")
         
      END CASE
 
 
 
   
   #??key???desc
   
   
   CALL bsft001_wf_input("r")
   
   IF INT_FLAG AND NOT g_master_insert THEN
      LET INT_FLAG = 0
      DISPLAY g_detail_cnt  TO FORMONLY.h_count    #???
      DISPLAY g_current_idx TO FORMONLY.h_index    #????
      LET INT_FLAG = 0
      INITIALIZE g_sfajwf_m.* TO NULL
      INITIALIZE g_sfakwf_d TO NULL
      INITIALIZE g_sfakwf2_d TO NULL
      INITIALIZE g_sfakwf3_d TO NULL
      INITIALIZE g_sfakwf4_d TO NULL
      INITIALIZE g_sfakwf5_d TO NULL
 
      #add-point:????? name="reproduce.cancel"

      #end add-point
      CALL bsft001_wf_show()
      CALL bsft001_wf_idx_chk()   #(ver:83)
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = '' 
      LET g_errparam.code = 9001 
      LET g_errparam.popup = FALSE 
      CALL s_transaction_end('N','0')
      CALL cl_err()
      RETURN
   END IF
   
   #????????action??
   CALL cl_set_act_visible("statechange,modify,modify_detail,delete,reproduce", TRUE)
   CALL bsft001_wf_set_act_visible()   
   CALL bsft001_wf_set_act_no_visible()
   
   #?????????????
   LET g_sfajwfdocno_t = g_sfajwf_m.sfajwfdocno
 
   
   #?????????
   LET g_add_browse = " sfajwfent = " ||g_enterprise|| " AND sfajwfsite = '" ||g_site|| "' AND",
                      " sfajwfdocno = '", g_sfajwf_m.sfajwfdocno, "' "
 
   #?????
   LET g_current_idx = g_browser.getLength() + 1
   CALL bsft001_wf_browser_fill("")
   
   DISPLAY g_browser_cnt TO FORMONLY.h_count    #???
   DISPLAY g_current_idx TO FORMONLY.h_index    #????
   CALL cl_navigator_setting(g_current_idx, g_browser_cnt)
   
   #add-point:??????? name="reproduce.after_reproduce"

   #end add-point
   
   CALL bsft001_wf_idx_chk()
   
   LET g_data_owner = g_sfajwf_m.sfajwfownid      
   LET g_data_dept  = g_sfajwf_m.sfajwfowndp
   LET g_data_crtid = g_sfajwf_m.sfajwfcrtid   #180201-00054
   LET g_data_crtdp = g_sfajwf_m.sfajwfcrtdp   #180201-00054
   
   #?????,??????
   CALL bsft001_wf_msgcentre_notify('reproduce')
   
END FUNCTION

{</section>}

{<section id="bsft001_wf.detail_reproduce" type="s" >}
#+ ??????
PRIVATE FUNCTION bsft001_wf_detail_reproduce() RETURNS ()   #200213-00032
   #add-point:delete?define(???) name="detail_reproduce.define_customerization"

   #end add-point    
   DEFINE ls_sql      STRING
   DEFINE ld_date     DATETIME YEAR TO SECOND
   DEFINE l_detail    RECORD LIKE sfakwf_t.* #??????????
   DEFINE l_detail2    RECORD LIKE sfamwf_t.* #??????????
 
 
   DEFINE l_detail3    RECORD LIKE sfbcwf_t.* #??????????
 
   DEFINE l_detail4    RECORD LIKE wfapwf_t.* #??????????
 
   DEFINE l_detail5    RECORD LIKE sfanwf_t.* #??????????
 
 
   #add-point:delete?define (?????????????????, ?????patch????????) name="detail_reproduce.define"

   #end add-point    
   
   #add-point:Function????  name="detail_reproduce.pre_function"

   #end add-point
   
   CALL s_transaction_begin()
   
   LET ld_date = cl_get_current()
   
   DROP TABLE bsft001_wf_detail
   
   #add-point:?????1 name="detail_reproduce.body.table1.b_insert"

   #end add-point
   
   #CREATE TEMP TABLE
   SELECT * FROM sfakwf_t
    WHERE sfakwfent = g_enterprise AND sfakwfsite = g_site AND sfakwfdocno = g_sfajwfdocno_t
 
    INTO TEMP bsft001_wf_detail
 
   #?key??????   
   UPDATE bsft001_wf_detail 
      #??key??
      SET sfakwfdocno = g_sfajwf_m.sfajwfdocno
 
      #??????
      
 
   #add-point:????? name="detail_reproduce.body.table1.b_update"
   UPDATE bsft001_wf_detail 
      SET sfakwf044 = '',
          sfakwf029 = '',
          sfakwf030 = '',
          sfakwf031 = ''
   #end add-point                                       
  
   #??????table   
   INSERT INTO sfakwf_t SELECT * FROM bsft001_wf_detail
   
   IF SQLCA.SQLCODE THEN
      #180110-00034 ---start---
      #add-point:????? name="detail_reproduce.body.table1.rollback"

      #end add-point
      CALL s_transaction_end('N','0')
      #180110-00034 --- end ---
 
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = "reproduce:",SQLERRMESSAGE 
      LET g_errparam.code = SQLCA.SQLCODE 
      LET g_errparam.popup = TRUE 
      CALL cl_err()
      RETURN
   END IF
   
   #add-point:?????1 name="detail_reproduce.body.table1.m_insert"

   #end add-point
   
   #??TEMP TABLE
   DROP TABLE bsft001_wf_detail
   
   #add-point:?????1 name="detail_reproduce.body.table1.a_insert"

   #end add-point
 
   #add-point:????? name="detail_reproduce.body.table2.b_insert"

   #end add-point
   
   #CREATE TEMP TABLE
   SELECT * FROM sfamwf_t 
    WHERE sfamwfent = g_enterprise AND sfamwfdocno = g_sfajwfdocno_t
 
    INTO TEMP bsft001_wf_detail
 
   #?key??????   
   UPDATE bsft001_wf_detail SET sfamwfdocno = g_sfajwf_m.sfajwfdocno
 
  
   #add-point:????? name="detail_reproduce.body.table2.b_update"

   #end add-point    
 
   #??????table   
   INSERT INTO sfamwf_t SELECT * FROM bsft001_wf_detail
 
   #180110-00034 ---start---
   IF SQLCA.SQLCODE THEN
      #add-point:????? name="detail_reproduce.body.table2.rollback"

      #end add-point
      CALL s_transaction_end('N','0')
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = "Reproduce:",SQLERRMESSAGE 
      LET g_errparam.code = SQLCA.SQLCODE 
      LET g_errparam.popup = TRUE 
      CALL cl_err()
      RETURN
   END IF
   #180110-00034 --- end ---
   
   #add-point:????? name="detail_reproduce.body.table2.m_insert"

   #end add-point
   
   #??TEMP TABLE
   DROP TABLE bsft001_wf_detail
   
   #add-point:????? name="detail_reproduce.body.table2.a_insert"

   #end add-point
 
 
   
   #add-point:????? name="detail_reproduce.body.table3.b_insert"

   #end add-point
   
   #CREATE TEMP TABLE
   SELECT * FROM sfbcwf_t 
    WHERE sfbcwfent = g_enterprise AND sfbcwfsite = g_site AND sfbcwfdocno = g_sfajwfdocno_t
 
    INTO TEMP bsft001_wf_detail
 
   #?key??????   
   UPDATE bsft001_wf_detail SET sfbcwfdocno = g_sfajwf_m.sfajwfdocno
 
  
   #add-point:????? name="detail_reproduce.body.table3.b_update"
   UPDATE bsft001_wf_detail SET sfanwfdocno = g_sfajwf_m.sfajwfdocno , sfac005 = 0
   #end add-point    
  
   #??????table   
   INSERT INTO sfbcwf_t SELECT * FROM bsft001_wf_detail
 
   #180110-00034 ---start---
   IF SQLCA.SQLCODE THEN
      #add-point:????? name="detail_reproduce.body.table3.rollback"

      #end add-point
      CALL s_transaction_end('N','0')
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = "Reproduce:",SQLERRMESSAGE 
      LET g_errparam.code = SQLCA.SQLCODE 
      LET g_errparam.popup = TRUE 
      CALL cl_err()
      RETURN
   END IF
   #180110-00034 --- end ---
   
   #add-point:????? name="detail_reproduce.body.table3.m_insert"

   #end add-point
   
   #??TEMP TABLE
   DROP TABLE bsft001_wf_detail
   
#  LET g_data_owner = g_sfajwf_m.sfajwfownid   #180110-00034 mark
#  LET g_data_dept  = g_sfajwf_m.sfajwfowndp   #180110-00034 mark
   
   #add-point:????? name="detail_reproduce.body.table3.a_insert"

   #end add-point
 
   #add-point:????? name="detail_reproduce.body.table4.b_insert"

   #end add-point
   
   #CREATE TEMP TABLE
   SELECT * FROM wfapwf_t 
    WHERE wfapwfent = g_enterprise AND wfapwfsite = g_site AND wfapwfdocno = g_sfajwfdocno_t
 
    INTO TEMP bsft001_wf_detail
 
   #?key??????   
   UPDATE bsft001_wf_detail SET wfapwfdocno = g_sfajwf_m.sfajwfdocno
 
  
   #add-point:????? name="detail_reproduce.body.table4.b_update"

   #end add-point    
  
   #??????table   
   INSERT INTO wfapwf_t SELECT * FROM bsft001_wf_detail
 
   #180110-00034 ---start---
   IF SQLCA.SQLCODE THEN
      #add-point:????? name="detail_reproduce.body.table4.rollback"

      #end add-point
      CALL s_transaction_end('N','0')
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = "Reproduce:",SQLERRMESSAGE 
      LET g_errparam.code = SQLCA.SQLCODE 
      LET g_errparam.popup = TRUE 
      CALL cl_err()
      RETURN
   END IF
   #180110-00034 --- end ---
   
   #add-point:????? name="detail_reproduce.body.table4.m_insert"

   #end add-point
   
   #??TEMP TABLE
   DROP TABLE bsft001_wf_detail
   
#  LET g_data_owner = g_sfajwf_m.sfajwfownid   #180110-00034 mark
#  LET g_data_dept  = g_sfajwf_m.sfajwfowndp   #180110-00034 mark
   
   #add-point:????? name="detail_reproduce.body.table4.a_insert"

   #end add-point
 
   #add-point:????? name="detail_reproduce.body.table5.b_insert"

   #end add-point
   
   #CREATE TEMP TABLE
   SELECT * FROM sfanwf_t 
    WHERE sfanwfent = g_enterprise AND sfanwfsite = g_site AND sfanwfdocno = g_sfajwfdocno_t
 
    INTO TEMP bsft001_wf_detail
 
   #?key??????   
   UPDATE bsft001_wf_detail SET sfanwfdocno = g_sfajwf_m.sfajwfdocno
 
  
   #add-point:????? name="detail_reproduce.body.table5.b_update"

   #end add-point    
  
   #??????table   
   INSERT INTO sfanwf_t SELECT * FROM bsft001_wf_detail
 
   #180110-00034 ---start---
   IF SQLCA.SQLCODE THEN
      #add-point:????? name="detail_reproduce.body.table5.rollback"

      #end add-point
      CALL s_transaction_end('N','0')
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = "Reproduce:",SQLERRMESSAGE 
      LET g_errparam.code = SQLCA.SQLCODE 
      LET g_errparam.popup = TRUE 
      CALL cl_err()
      RETURN
   END IF
   #180110-00034 --- end ---
   
   #add-point:????? name="detail_reproduce.body.table5.m_insert"

   #end add-point
   
   #??TEMP TABLE
   DROP TABLE bsft001_wf_detail
   
#  LET g_data_owner = g_sfajwf_m.sfajwfownid   #180110-00034 mark
#  LET g_data_dept  = g_sfajwf_m.sfajwfowndp   #180110-00034 mark
   
   #add-point:????? name="detail_reproduce.body.table5.a_insert"

   #end add-point
 
 
   
   #???????
   
   
   CALL s_transaction_end('Y','0')
   
   #????, ??????(?????)
   LET g_sfajwfdocno_t = g_sfajwf_m.sfajwfdocno
 
   
END FUNCTION

{</section>}

{<section id="bsft001_wf.delete" type="s" >}
#+ ????
PRIVATE FUNCTION bsft001_wf_delete() RETURNS ()   #200213-00032
   #add-point:delete?define(???) name="delete.define_customerization"

   #end add-point     
   DEFINE  l_var_keys      DYNAMIC ARRAY OF STRING
   DEFINE  l_field_keys    DYNAMIC ARRAY OF STRING
   DEFINE  l_vars          DYNAMIC ARRAY OF STRING
   DEFINE  l_fields        DYNAMIC ARRAY OF STRING
   DEFINE  l_var_keys_bak  DYNAMIC ARRAY OF STRING
   #add-point:delete?define (?????????????????, ?????patch????????) name="delete.define"

   #end add-point     
   
   #add-point:Function????  name="delete.pre_function"

   #end add-point
   
   IF g_sfajwf_m.sfajwfdocno IS NULL
 
   THEN
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = "" 
      LET g_errparam.code = "std-00003" 
      LET g_errparam.popup = FALSE 
      CALL cl_err()
      RETURN
   END IF
   
   
   
   CALL s_transaction_begin()
 
   OPEN bsft001_wf_cl USING g_enterprise, g_site,g_sfajwf_m.sfajwfdocno
   IF SQLCA.SQLCODE THEN   #(ver:78)
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = "OPEN bsft001_wf_cl:",SQLERRMESSAGE 
      LET g_errparam.code = SQLCA.SQLCODE   #(ver:78)
      LET g_errparam.popup = TRUE 
      CLOSE bsft001_wf_cl
      CALL s_transaction_end('N','0')
      CALL cl_err()
      RETURN
   END IF
 
   #???????
   EXECUTE bsft001_wf_master_referesh USING g_site,g_sfajwf_m.sfajwfdocno INTO g_sfajwf_m.sfajwfdocno,g_sfajwf_m.sfajwfdocdt,g_sfajwf_m.sfajwf006,g_sfajwf_m.sfajwf007,g_sfajwf_m.sfajwf017,g_sfajwf_m.sfajwf019,g_sfajwf_m.sfajwf020,g_sfajwf_m.sfajwf021,g_sfajwf_m.sfajwf018,g_sfajwf_m.sfajwf022,g_sfajwf_m.sfajwf023, 
       g_sfajwf_m.sfajwf012,g_sfajwf_m.sfajwf013,g_sfajwf_m.sfajwf014,g_sfajwf_m.sfajwf001,g_sfajwf_m.sfajwf002,g_sfajwf_m.sfajwf025,g_sfajwf_m.sfajwf015,g_sfajwf_m.sfajwfua002,g_sfajwf_m.sfajwf016,g_sfajwf_m.sfajwfua003,g_sfajwf_m.sfajwf024,g_sfajwf_m.sfajwf003,g_sfajwf_m.sfajwf005,g_sfajwf_m.sfajwf004, 
       g_sfajwf_m.sfajwf008,g_sfajwf_m.sfajwf009,g_sfajwf_m.sfajwf010,g_sfajwf_m.sfajwf011,g_sfajwf_m.sfajwfua011,g_sfajwf_m.sfajwfua012,g_sfajwf_m.sfajwfua013,g_sfajwf_m.sfajwfua014,g_sfajwf_m.sfajwfua015,g_sfajwf_m.sfajwfstus,g_sfajwf_m.sfajwfownid,g_sfajwf_m.sfajwfowndp,g_sfajwf_m.sfajwfcrtid,g_sfajwf_m.sfajwfcrtdp, 
       g_sfajwf_m.sfajwfcrtdt,g_sfajwf_m.sfajwfmodid,g_sfajwf_m.sfajwfmoddt,g_sfajwf_m.sfajwfcnfid,g_sfajwf_m.sfajwfcnfdt,g_sfajwf_m.sfajwf006_desc,g_sfajwf_m.sfajwf007_desc,g_sfajwf_m.sfajwf023_desc,g_sfajwf_m.sfajwf012_desc,g_sfajwf_m.sfajwf001_desc,g_sfajwf_m.sfajwf002_desc,g_sfajwf_m.sfajwf025_desc, 
       g_sfajwf_m.sfajwf008_desc,g_sfajwf_m.sfajwf009_desc,g_sfajwf_m.sfajwf010_desc,g_sfajwf_m.sfajwf011_desc,g_sfajwf_m.sfajwfownid_desc,g_sfajwf_m.sfajwfowndp_desc,g_sfajwf_m.sfajwfcrtid_desc,g_sfajwf_m.sfajwfcrtdp_desc,g_sfajwf_m.sfajwfmodid_desc,g_sfajwf_m.sfajwfcnfid_desc
   
   
   #?????????
   IF NOT bsft001_wf_action_chk() THEN
      CALL s_transaction_end('N','0')
      RETURN
   END IF
   
   #??????
   LET g_sfajwf_m_mask_o.* =  g_sfajwf_m.*
   CALL bsft001_wf_sfajwf_t_mask()
   LET g_sfajwf_m_mask_n.* =  g_sfajwf_m.*
   
   CALL bsft001_wf_show()
   
   #add-point:delete?before ask name="delete.before_ask"

   #end add-point 
 
   IF cl_ask_del_master() THEN              #????
   
      #add-point:????? name="delete.head.b_delete"

      #end add-point   
      
      #?? a47 ??????(Version:4)
      #??????
      CALL bsft001_wf_set_pk_array()
      #add-point:??????? name="delete.befroe.related_document_remove"

      #end add-point   
      CALL cl_doc_remove()  
 
 
 
  
  
      #????
      LET g_sfajwfdocno_t = g_sfajwf_m.sfajwfdocno
 
 
      DELETE FROM sfajwf_t
       WHERE sfajwfent = g_enterprise AND sfajwfsite = g_site AND sfajwfdocno = g_sfajwf_m.sfajwfdocno
 
       
      #add-point:????? name="delete.head.m_delete"

      #end add-point
       
      IF SQLCA.SQLCODE THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = g_sfajwf_m.sfajwfdocno,":",SQLERRMESSAGE  
         LET g_errparam.code = SQLCA.SQLCODE 
         LET g_errparam.popup = FALSE 
         CALL s_transaction_end('N','0')
         CALL cl_err()
         RETURN
      END IF
      
      #add-point:????? name="delete.head.a_delete"

      #end add-point
  
      #add-point:????? name="delete.body.b_delete"

      #end add-point
      
      DELETE FROM sfakwf_t
       WHERE sfakwfent = g_enterprise AND sfakwfsite = g_site AND sfakwfdocno = g_sfajwf_m.sfajwfdocno
 
 
      #add-point:????? name="delete.body.m_delete"

      #end add-point
         
      IF SQLCA.SQLCODE THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "sfakwf_t:",SQLERRMESSAGE 
         LET g_errparam.code = SQLCA.SQLCODE 
         LET g_errparam.popup = FALSE 
         CALL s_transaction_end('N','0')
         CALL cl_err()
         RETURN
      END IF    
 
      #add-point:????? name="delete.body.a_delete"
     
      #end add-point
      
            
                                                               
      #add-point:????? name="delete.body.b_delete2"

      #end add-point
      DELETE FROM sfamwf_t
       WHERE sfamwfent = g_enterprise AND
             sfamwfdocno = g_sfajwf_m.sfajwfdocno
      #add-point:????? name="delete.body.m_delete2"

      #end add-point
      IF SQLCA.SQLCODE THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "sfbcwf_t:",SQLERRMESSAGE 
         LET g_errparam.code = SQLCA.SQLCODE 
         LET g_errparam.popup = FALSE 
         CALL s_transaction_end('N','0')
         CALL cl_err()
         RETURN
      END IF      
 
      #add-point:????? name="delete.body.a_delete2"
      #????/BIN??
      DELETE FROM icbawf_t
       WHERE icbawfent = g_enterprise AND icbawfsite = g_site
         AND icbawfdocno = g_sfajwf_m.sfajwfdocno
      IF SQLCA.SQLCODE THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "sfbcwf_t:",SQLERRMESSAGE 
         LET g_errparam.code = SQLCA.SQLCODE 
         LET g_errparam.popup = FALSE 
         CALL s_transaction_end('N','0')
         CALL cl_err()
         RETURN
      END IF
      #end add-point
 
 
 
      #add-point:????? name="delete.body.b_delete3"

      #end add-point
      DELETE FROM sfbcwf_t
       WHERE sfbcwfent = g_enterprise AND sfbcwfsite = g_site AND
             sfbcwfdocno = g_sfajwf_m.sfajwfdocno
      #add-point:????? name="delete.body.m_delete3"

      #end add-point
      IF SQLCA.SQLCODE THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "sfbcwf_t:",SQLERRMESSAGE 
         LET g_errparam.code = SQLCA.SQLCODE 
         LET g_errparam.popup = FALSE 
         CALL s_transaction_end('N','0')
         CALL cl_err()
         RETURN
      END IF      
 
      #add-point:????? name="delete.body.a_delete3"

      #end add-point
 
      #add-point:????? name="delete.body.b_delete4"

      #end add-point
      DELETE FROM wfapwf_t
       WHERE wfapwfent = g_enterprise AND wfapwfsite = g_site AND
             wfapwfdocno = g_sfajwf_m.sfajwfdocno
      #add-point:????? name="delete.body.m_delete4"

      #end add-point
      IF SQLCA.SQLCODE THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "wfapwf_t:",SQLERRMESSAGE 
         LET g_errparam.code = SQLCA.SQLCODE 
         LET g_errparam.popup = FALSE 
         CALL s_transaction_end('N','0')
         CALL cl_err()
         RETURN
      END IF      
 
      #add-point:????? name="delete.body.a_delete4"

      #end add-point
 
      #add-point:????? name="delete.body.b_delete5"

      #end add-point
      DELETE FROM sfanwf_t
       WHERE sfanwfent = g_enterprise AND sfanwfsite = g_site AND
             sfanwfdocno = g_sfajwf_m.sfajwfdocno
      #add-point:????? name="delete.body.m_delete5"

      #end add-point
      IF SQLCA.SQLCODE THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "sfanwf_t:",SQLERRMESSAGE 
         LET g_errparam.code = SQLCA.SQLCODE 
         LET g_errparam.popup = FALSE 
         CALL s_transaction_end('N','0')
         CALL cl_err()
         RETURN
      END IF      
 
      #add-point:????? name="delete.body.a_delete5"

      #end add-point
 
 
      
      #??????(??)
      LET g_log1 = util.JSON.stringify(g_sfajwf_m)   #(ver:78)
      IF NOT cl_log_modified_record(g_log1,'') THEN    #(ver:78)
         CLOSE bsft001_wf_cl
         CALL s_transaction_end('N','0')
         RETURN
      END IF
             
      CLEAR FORM
      CALL g_sfakwf_d.clear() 
      CALL g_sfakwf2_d.clear()       
      CALL g_sfakwf3_d.clear()       
      CALL g_sfakwf4_d.clear()       
      CALL g_sfakwf5_d.clear()       
 
     
      CALL bsft001_wf_ui_browser_refresh()  
      #CALL bsft001_wf_ui_headershow()  
      #CALL bsft001_wf_ui_detailshow()
 
      #add-point:????? name="delete.lang.before_delete"

      #end add-point
      
      #???????
      
         #161130-00056 add
      
      #???????
      
         #161130-00056 add
      
         #161130-00056 add
      
         #161130-00056 add
      
         #161130-00056 add
      
         #161130-00056 add
 
   
      #add-point:????? name="delete.lang.delete"

      #end add-point
      
      #??????
      INITIALIZE g_sfajwf_m.* TO NULL   #180420-00043
 
      IF g_browser_cnt > 0 THEN 
         #CALL bsft001_wf_browser_fill("")
         CALL bsft001_wf_fetch('P')
         DISPLAY g_browser_cnt TO FORMONLY.h_count   #??????
         DISPLAY g_browser_cnt TO FORMONLY.b_count   #??????
      ELSE
         CLEAR FORM
      END IF
      
      CALL s_transaction_end('Y','0')
   ELSE
      CALL s_transaction_end('N','0')
   END IF
 
   CLOSE bsft001_wf_cl
 
   #?????,??????
   CALL bsft001_wf_msgcentre_notify('delete')
    
END FUNCTION

{</section>}

{<section id="bsft001_wf.b_fill" type="s" >}
#+ ??????
PRIVATE FUNCTION bsft001_wf_b_fill() RETURNS ()   #200213-00032
   #add-point:b_fill?define(???) name="b_fill.define_customerization"

   #end add-point     
   DEFINE p_wc2      STRING
   DEFINE li_idx     LIKE type_t.num10
   #add-point:b_fill?define (?????????????????, ?????patch????????) name="b_fill.define"
   #240704-00015 add -s
   DEFINE l_errno_abg      LIKE gzze_t.gzze001
   DEFINE l_bgaf016        LIKE bgaf_t.bgaf016
   DEFINE l_pmdn058        LIKE pmdn_t.pmdn058
   DEFINE l_pmdn058_desc   LIKE type_t.chr500
   DEFINE l_pmdn058_desc_sql STRING   
   DEFINE l_success LIKE type_t.num5
   #240704-00015 add -e
   #end add-point     
   
   #add-point:Function????  name="b_fill.pre_function"

   #end add-point
   
   #???????
   CALL g_sfakwf_d.clear()
   CALL g_sfakwf4_d.clear()
 
 
   #add-point:b_fill?sql_before name="b_fill.sql_before"

   #end add-point
   
   #??????
   IF bsft001_wf_fill_chk(1) THEN
      #?????????SQL
      #??????(g_wc2)?????????????????,????????? ver:81
      IF (g_action_choice = "query" OR cl_null(g_action_choice) OR g_action_choice = "queryplan" OR 
          g_action_choice = "insert" OR g_action_choice = "modify" OR g_action_choice = "reproduce" ) #ver:81 #ver:82
      #add-point:b_fill?long_sql_if name="b_fill.long_sql_if"

      #end add-point
      THEN
         LET g_sql = "SELECT  DISTINCT sfakwfseq,sfakwf001,sfakwf002,sfakwf003,sfakwf004,sfakwf005,sfakwf006,sfakwf007,sfakwf008,sfakwf009,sfakwf010,sfakwf011,sfakwf012,sfakwf013,sfakwf014,sfakwf015,sfakwf016,sfakwf017,sfakwf018,sfakwf019,sfakwf020,sfakwf021,sfakwf022,sfakwf023,sfakwf024,sfakwf025,sfakwf026, 
             sfakwf027,sfakwf028,sfakwf029,sfakwf030,sfakwf031,sfakwf044,sfakwf032,sfakwf033,sfakwf034,sfakwf035,sfakwf036,sfakwf037,sfakwf038,sfakwf039,sfakwf040,sfakwf041,sfakwf042,sfakwf043,sfakwf045,sfakwf046,sfakwf047,sfakwf048,sfakwf049,sfakwfud001 ,t1.imaal003 ,t2.inaml004 ,t3.wfajwfl003 ,t4.pjbal003 , 
             t5.pjbbl004 ,t6.pjbml004 ,t7.ooefl003 FROM sfakwf_t",   
                     " INNER JOIN sfajwf_t ON sfajwfent = " ||g_enterprise|| " AND sfajwfsite = '" ||g_site|| "' AND sfajwfdocno = sfakwfdocno ",
 
                     #"",
                     " LEFT JOIN sfbcwf_t ON sfakwfent = sfbcwfent AND sfakwfsite = sfbcwfsite AND sfakwfdocno = sfbcwfdocno AND sfakwfseq = sfbcwfseq ",
               " LEFT JOIN wfapwf_t ON sfakwfent = wfapwfent AND sfakwfsite = wfapwfsite AND sfakwfdocno = wfapwfdocno AND sfakwfseq = wfapwfseq ",
               " LEFT JOIN sfanwf_t ON sfakwfent = sfanwfent AND sfakwfsite = sfanwfsite AND sfakwfdocno = sfanwfdocno AND sfakwfseq = sfanwfseq1 ",
                     "",
                     #???????join??
                     " ",
 
                     " ",
 
                     " ",
 
 
                                    " LEFT JOIN imaal_t t1 ON t1.imaalent="||g_enterprise||" AND t1.imaal001=sfakwf001 AND t1.imaal002='"||g_dlang||"' ",
               " LEFT JOIN inaml_t t2 ON t2.inamlent="||g_enterprise||" AND t2.inaml001=sfakwf001 AND t2.inaml002=sfakwf003 AND t2.inaml003='"||g_dlang||"' ",
               " LEFT JOIN wfajwfl_t t3 ON t3.wfajwflent="||g_enterprise||" AND t3.wfajwfl001=sfakwf023 AND t3.wfajwfl002='"||g_dlang||"' ",
               " LEFT JOIN pjbal_t t4 ON t4.pjbalent="||g_enterprise||" AND t4.pjbal001=sfakwf045 AND t4.pjbal002='"||g_dlang||"' ",
               " LEFT JOIN pjbbl_t t5 ON t5.pjbblent="||g_enterprise||" AND t5.pjbbl001=sfakwf045 AND t5.pjbbl002=sfakwf046 AND t5.pjbbl003='"||g_dlang||"' ",
               " LEFT JOIN pjbml_t t6 ON t6.pjbmlent="||g_enterprise||" AND t6.pjbml001=sfakwf045 AND t6.pjbml002=sfakwf047 AND t6.pjbml003='"||g_dlang||"' ",
               " LEFT JOIN ooefl_t t7 ON t7.ooeflent="||g_enterprise||" AND t7.ooefl001=sfakwf049 AND t7.ooefl002='"||g_dlang||"' ",
 
                     " WHERE sfakwfent=? AND sfakwfsite=? AND sfakwfdocno=?"
         LET g_sql = cl_sql_add_mask(g_sql)              #??????
         #add-point:b_fill?sql_before name="b_fill.body.fill_sql"

         #end add-point
         IF NOT cl_null(g_wc2_table1) THEN
            LET g_sql = g_sql CLIPPED, " AND ", g_wc2_table1 CLIPPED
         END IF
         
         #????WC
            IF NOT cl_null(g_wc2_table3) THEN 
      LET g_sql = g_sql CLIPPED," AND ", g_wc2_table3 CLIPPED
   END IF 
   IF NOT cl_null(g_wc2_table4) THEN 
      LET g_sql = g_sql CLIPPED," AND ", g_wc2_table4 CLIPPED
   END IF 
   IF NOT cl_null(g_wc2_table5) THEN 
      LET g_sql = g_sql CLIPPED," AND ", g_wc2_table5 CLIPPED
   END IF 
 
         
         LET g_sql = g_sql, " ORDER BY sfakwf_t.sfakwfseq"
         
         #add-point:?????? name="b_fill.sql"

         #end add-point
         
         LET g_sql = cl_sql_add_mask(g_sql)              #??????
         PREPARE bsft001_wf_pb FROM g_sql
         DECLARE b_fill_cs CURSOR FOR bsft001_wf_pb
      END IF
      
      LET g_cnt = l_ac
      LET l_ac = 1
      
   #  OPEN b_fill_cs USING g_enterprise, g_site,g_sfajwf_m.sfajwfdocno   #(ver:78)
                                               
      FOREACH b_fill_cs USING g_enterprise, g_site,g_sfajwf_m.sfajwfdocno INTO g_sfakwf_d[l_ac].sfakwfseq,g_sfakwf_d[l_ac].sfakwf001,g_sfakwf_d[l_ac].sfakwf002,g_sfakwf_d[l_ac].sfakwf003,g_sfakwf_d[l_ac].sfakwf004,g_sfakwf_d[l_ac].sfakwf005,g_sfakwf_d[l_ac].sfakwf006,g_sfakwf_d[l_ac].sfakwf007,g_sfakwf_d[l_ac].sfakwf008, 
          g_sfakwf_d[l_ac].sfakwf009,g_sfakwf_d[l_ac].sfakwf010,g_sfakwf_d[l_ac].sfakwf011,g_sfakwf_d[l_ac].sfakwf012,g_sfakwf_d[l_ac].sfakwf013,g_sfakwf_d[l_ac].sfakwf014,g_sfakwf_d[l_ac].sfakwf015,g_sfakwf_d[l_ac].sfakwf016,g_sfakwf_d[l_ac].sfakwf017,g_sfakwf_d[l_ac].sfakwf018,g_sfakwf_d[l_ac].sfakwf019, 
          g_sfakwf_d[l_ac].sfakwf020,g_sfakwf_d[l_ac].sfakwf021,g_sfakwf_d[l_ac].sfakwf022,g_sfakwf_d[l_ac].sfakwf023,g_sfakwf_d[l_ac].sfakwf024,g_sfakwf_d[l_ac].sfakwf025,g_sfakwf_d[l_ac].sfakwf026,g_sfakwf_d[l_ac].sfakwf027,g_sfakwf_d[l_ac].sfakwf028,g_sfakwf_d[l_ac].sfakwf029,g_sfakwf_d[l_ac].sfakwf030, 
          g_sfakwf_d[l_ac].sfakwf031,g_sfakwf_d[l_ac].sfakwf044,g_sfakwf_d[l_ac].sfakwf032,g_sfakwf_d[l_ac].sfakwf033,g_sfakwf_d[l_ac].sfakwf034,g_sfakwf_d[l_ac].sfakwf035,g_sfakwf_d[l_ac].sfakwf036,g_sfakwf_d[l_ac].sfakwf037,g_sfakwf_d[l_ac].sfakwf038,g_sfakwf_d[l_ac].sfakwf039,g_sfakwf_d[l_ac].sfakwf040, 
          g_sfakwf_d[l_ac].sfakwf041,g_sfakwf_d[l_ac].sfakwf042,g_sfakwf_d[l_ac].sfakwf043,g_sfakwf_d[l_ac].sfakwf045,g_sfakwf_d[l_ac].sfakwf046,g_sfakwf_d[l_ac].sfakwf047,g_sfakwf_d[l_ac].sfakwf048,g_sfakwf_d[l_ac].sfakwf049,g_sfakwf_d[l_ac].sfakwfud001,g_sfakwf_d[l_ac].sfakwf001_desc,g_sfakwf_d[l_ac].sfakwf003_desc, 
          g_sfakwf_d[l_ac].sfakwf023_desc,g_sfakwf_d[l_ac].sfakwf045_desc,g_sfakwf_d[l_ac].sfakwf046_desc,g_sfakwf_d[l_ac].sfakwf047_desc,g_sfakwf_d[l_ac].sfakwf049_desc   #(ver:78)
         IF SQLCA.SQLCODE THEN
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = "FOREACH:",SQLERRMESSAGE 
            LET g_errparam.code = SQLCA.SQLCODE 
            LET g_errparam.popup = TRUE 
            CALL cl_err()
            EXIT FOREACH
         END IF
        
         #add-point:b_fill????? name="b_fill.fill"
         #240423-00009#2 --s
         #??????
         IF NOT cl_null(g_sfakwf_d[l_ac].sfakwf012) THEN
            SELECT wfagwfl003 INTO g_sfakwf_d[l_ac].sfakwf012_desc FROM wfagwfl_t
              WHERE wfagwflent = g_enterprise AND wfagwfl001 = g_sfakwf_d[l_ac].sfakwf012 AND wfagwfl002 = g_dlang
         END IF
         #??????
         IF NOT cl_null(g_sfakwf_d[l_ac].sfakwf017) THEN
            SELECT wfaiwfl003 INTO g_sfakwf_d[l_ac].sfakwf017_desc FROM wfaiwfl_t
              WHERE wfaiwflent = g_enterprise AND wfaiwfl001 = g_sfakwf_d[l_ac].sfakwf017 AND wfaiwfl002 = g_dlang
         END IF 
         #240423-00009#2 --e
         #240704-00015#1 add ---s
         CALL bsft001_wf_detail_abg('3')
              RETURNING l_success,l_errno_abg,l_bgaf016,
                        l_pmdn058,l_pmdn058_desc,l_pmdn058_desc_sql
         LET g_sfakwf_d[l_ac].sfakwf048_desc = l_pmdn058_desc         
         #240704-00015#1 add ---e
         
         #250220-00015# add ---s
         INITIALIZE g_ref_fields TO NULL
         LET g_ref_fields[1] = g_sfakwf_d[l_ac].sfakwf001
         CALL ap_ref_array2(g_ref_fields,"SELECT imaal003,imaal004 FROM imaal_t WHERE imaalent='"||g_enterprise||"' AND imaal001=? AND imaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
         LET g_sfakwf_d[l_ac].sfakwf001_desc = '', g_rtn_fields[1] , ''
         LET g_sfakwf_d[l_ac].sfakwf001_desc_1 = '', g_rtn_fields[2] , '' 
         #250220-00015# add ---e
         
         #241104-00004#1 add--s
         CALL s_desc_get_item_desc(g_sfakwf_d[l_ac].sfakwf001) RETURNING g_sfakwf_d[l_ac].sfakwf001_desc,g_sfakwf_d[l_ac].sfakwf001_desc_1
         #241104-00004#1 add--e
         #end add-point
      
         IF l_ac > g_max_rec THEN
            #????????????????????????????
            IF cl_null(g_action_choice) OR g_action_choice <> "ui_change" THEN   #190108-00038
               IF g_error_show = 1 THEN
                  INITIALIZE g_errparam TO NULL 
                  LET g_errparam.extend = l_ac
                  LET g_errparam.code = 9035 
                  LET g_errparam.popup = TRUE 
                  CALL cl_err()
               END IF
            END IF   #190108-00038
            EXIT FOREACH
         END IF
         
         LET l_ac = l_ac + 1
      END FOREACH
      LET g_error_show = 0
   
   END IF
    
   #??????
   IF bsft001_wf_fill_chk(2) THEN
      #??????(g_wc2)?????????????????,????????? ver:81
      IF (g_action_choice = "query" OR cl_null(g_action_choice) OR g_action_choice = "queryplan" OR
          g_action_choice = "insert" OR g_action_choice = "modify" OR g_action_choice = "reproduce" ) #ver:81 #ver:82
         #add-point:b_fill?long_sql_if name="b_fill.body2.long_sql_if"

         #end add-point
      THEN
         LET g_sql = "SELECT  DISTINCT sfamwfseq,sfamwf001,sfamwf002,sfamwf003,sfamwf004,sfamwf005,sfamwf006,sfamwf007,sfamwf008  FROM sfamwf_t",   
                     " INNER JOIN  sfajwf_t ON sfajwfent = " ||g_enterprise|| " AND sfajwfsite = '" ||g_site|| "' AND sfajwfdocno = sfamwfdocno ",
 
                     "",
                     
                     
                     " WHERE sfamwfent=? AND sfamwfsite=? AND sfamwfdocno=?"   
         LET g_sql = cl_sql_add_mask(g_sql)              #??????
         #add-point:b_fill?fill_sql name="b_fill.body2.fill_sql"
         LET g_sql = "SELECT  DISTINCT sfamwfseq,sfamwf001,sfamwf002,sfamwf003,sfamwf004,sfamwf005,sfamwf006,sfamwf007,sfamwf008  FROM sfamwf_t",   
                     " INNER JOIN  sfajwf_t ON sfajwfent = " ||g_enterprise|| " AND sfajwfsite = '" ||g_site|| "' AND sfajwfdocno = sfamwfdocno ",
 
                     "",
                     
                     
                     " WHERE sfamwfent=? AND sfamwfsite=? AND sfamwfdocno=?"
         LET g_sql = cl_sql_add_mask(g_sql) 
         #end add-point
         IF NOT cl_null(g_wc2_table2) THEN
            LET g_sql = g_sql CLIPPED," AND ",g_wc2_table2 CLIPPED
         END IF
         
         #????WC
         
         
         LET g_sql = g_sql, " ORDER BY sfamwf_t.sfamwfseq"
         
         #add-point:?????? name="b_fill.sql2"

         #end add-point
         
         LET g_sql = cl_sql_add_mask(g_sql)              #??????
         PREPARE bsft001_wf_pb2 FROM g_sql
         DECLARE b_fill_cs2 CURSOR FOR bsft001_wf_pb2
      END IF
    
      LET l_ac = 1
      
   #  OPEN b_fill_cs2 USING g_enterprise, g_site,g_sfajwf_m.sfajwfdocno   #(ver:78)
                                               
      FOREACH b_fill_cs2 USING g_enterprise, g_site,g_sfajwf_m.sfajwfdocno INTO g_sfakwf4_d[l_ac].sfamwfseq,g_sfakwf4_d[l_ac].sfamwf001,g_sfakwf4_d[l_ac].sfamwf002,g_sfakwf4_d[l_ac].sfamwf003,g_sfakwf4_d[l_ac].sfamwf004,g_sfakwf4_d[l_ac].sfamwf005,g_sfakwf4_d[l_ac].sfamwf006,g_sfakwf4_d[l_ac].sfamwf007, 
          g_sfakwf4_d[l_ac].sfamwf008   #(ver:78)
         IF SQLCA.SQLCODE THEN
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = "FOREACH:",SQLERRMESSAGE 
            LET g_errparam.code = SQLCA.SQLCODE 
            LET g_errparam.popup = TRUE 
            CALL cl_err()
            EXIT FOREACH
         END IF
        
         #add-point:b_fill????? name="b_fill2.fill"

         #end add-point
      
         LET l_ac = l_ac + 1
         IF l_ac > g_max_rec THEN
            #????????????????????????????
            IF cl_null(g_action_choice) OR g_action_choice <> "ui_change" THEN   #190108-00038
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = l_ac
               LET g_errparam.code = 9035 
               LET g_errparam.popup = TRUE 
               CALL cl_err()
            END IF   #190108-00038
            EXIT FOREACH
         END IF
         
      END FOREACH
   END IF
 
 
   
   #add-point:browser_fill???table?? name="browser_fill.other_fill"
   CALL s_icd_wf_ins_b_fill2(g_site,g_sfajwf_m.sfajwfdocno,'-1') #17538 add
   #end add-point
   
   CALL g_sfakwf_d.deleteElement(g_sfakwf_d.getLength())
   CALL g_sfakwf4_d.deleteElement(g_sfakwf4_d.getLength())
 
   
 
   LET l_ac = g_cnt
   LET g_cnt = 0  
   
   FREE bsft001_wf_pb
   FREE bsft001_wf_pb2
 
 
   
   LET li_idx = l_ac
   
   #??????
   FOR l_ac = 1 TO g_sfakwf_d.getLength()
      LET g_sfakwf_d_mask_o[l_ac].* =  g_sfakwf_d[l_ac].*
      CALL bsft001_wf_sfakwf_t_mask()
      LET g_sfakwf_d_mask_n[l_ac].* =  g_sfakwf_d[l_ac].*
   END FOR
   
   LET g_sfakwf2_d_mask_o.* =  g_sfakwf2_d.*
   FOR l_ac = 1 TO g_sfakwf2_d.getLength()
      LET g_sfakwf2_d_mask_o[l_ac].* =  g_sfakwf2_d[l_ac].*
      CALL bsft001_wf_sfbcwf_t_mask()
      LET g_sfakwf2_d_mask_n[l_ac].* =  g_sfakwf2_d[l_ac].*
   END FOR
   LET g_sfakwf3_d_mask_o.* =  g_sfakwf3_d.*
   FOR l_ac = 1 TO g_sfakwf3_d.getLength()
      LET g_sfakwf3_d_mask_o[l_ac].* =  g_sfakwf3_d[l_ac].*
      CALL bsft001_wf_wfapwf_t_mask()
      LET g_sfakwf3_d_mask_n[l_ac].* =  g_sfakwf3_d[l_ac].*
   END FOR
   LET g_sfakwf4_d_mask_o.* =  g_sfakwf4_d.*
   FOR l_ac = 1 TO g_sfakwf4_d.getLength()
      LET g_sfakwf4_d_mask_o[l_ac].* =  g_sfakwf4_d[l_ac].*
      CALL bsft001_wf_sfamwf_t_mask()
      LET g_sfakwf4_d_mask_n[l_ac].* =  g_sfakwf4_d[l_ac].*
   END FOR
   LET g_sfakwf5_d_mask_o.* =  g_sfakwf5_d.*
   FOR l_ac = 1 TO g_sfakwf5_d.getLength()
      LET g_sfakwf5_d_mask_o[l_ac].* =  g_sfakwf5_d[l_ac].*
      CALL bsft001_wf_sfanwf_t_mask()
      LET g_sfakwf5_d_mask_n[l_ac].* =  g_sfakwf5_d[l_ac].*
   END FOR
 
   
   LET l_ac = li_idx
   
   CALL cl_ap_performance_next_end()
 
END FUNCTION

{</section>}

{<section id="bsft001_wf.delete_b" type="s" >}
#+ ???????table??
PRIVATE FUNCTION bsft001_wf_delete_b(ps_table,ps_keys_bak,ps_page) RETURNS (INT)   #200213-00032
   #add-point:delete_b?define(???) name="delete_b.define_customerization"

   #end add-point     
   DEFINE ps_table    STRING
   DEFINE ps_page     STRING
   DEFINE ps_keys_bak DYNAMIC ARRAY OF VARCHAR(500)
   DEFINE ls_group    STRING
   DEFINE li_idx      LIKE type_t.num10
   #add-point:delete_b?define (?????????????????, ?????patch????????) name="delete_b.define"

   #end add-point     
   
   #add-point:Function????  name="delete_b.pre_function"

   #end add-point
   
#  LET g_update = TRUE  #200610-00021 mark
   
   #??????????table
   LET ls_group = "'1',"
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      #add-point:delete_b???? name="delete_b.b_delete"

      #end add-point    
      DELETE FROM sfakwf_t
       WHERE sfakwfent = g_enterprise AND sfakwfsite = g_site AND
         sfakwfdocno = ps_keys_bak[1] AND sfakwfseq = ps_keys_bak[2]
      #add-point:delete_b???? name="delete_b.m_delete"
      #????/BIN??
      DELETE FROM icbawf_t
       WHERE icbawfent = g_enterprise AND icbawfsite = g_site
         AND icbawfdocno = ps_keys_bak[1]
         AND icbawf032 = ps_keys_bak[2]  #????
      #240423-00009#2 --s
      #??????
      DELETE FROM sfbcwf_t
       WHERE sfbcwfent = g_enterprise AND sfbcwfsite = g_site AND
             sfbcwfdocno = ps_keys_bak[1] AND sfbcwfseq = ps_keys_bak[2] 
      #240423-00009#2 --e
      
      LET li_idx = g_detail_idx
      IF ps_page <> "'2'" THEN 
         CALL g_sfakwf2_d.deleteElement(li_idx) 
      END IF
      #end add-point    
      IF SQLCA.SQLCODE THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = ":",SQLERRMESSAGE 
         LET g_errparam.code = SQLCA.SQLCODE 
         LET g_errparam.popup = FALSE 
         CALL cl_err()
         RETURN FALSE
      END IF
      LET li_idx = g_detail_idx
      IF ps_page <> "'1'" THEN 
         CALL g_sfakwf_d.deleteElement(li_idx) 
      END IF 
 
   END IF
   
   LET ls_group = "'4',"
   #??????????table
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      #add-point:delete_b???? name="delete_b.b_delete2"

      #end add-point    
      DELETE FROM sfamwf_t
       WHERE sfamwfent = g_enterprise AND
             sfamwfdocno = ps_keys_bak[1] AND sfamwfseq = ps_keys_bak[2]
      #add-point:delete_b???? name="delete_b.m_delete2"
      #????/BIN??
      DELETE FROM icbawf_t
       WHERE icbawfent = g_enterprise AND icbawfsite = g_site
         AND icbawfdocno = ps_keys_bak[1]
         AND icbawfseq  = ps_keys_bak[3] #??
         AND icbawfseq1 = ps_keys_bak[4] #??
         AND icbawf032 = ps_keys_bak[2]  #????    
      #end add-point    
      IF SQLCA.SQLCODE THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "sfamwf_t:",SQLERRMESSAGE 
         LET g_errparam.code = SQLCA.SQLCODE 
         LET g_errparam.popup = FALSE 
         CALL cl_err()
         RETURN FALSE
      END IF
      
      LET li_idx = g_detail_idx
      IF ps_page <> "'4'" THEN 
         CALL g_sfakwf4_d.deleteElement(li_idx) 
      END IF 
 
      #add-point:delete_b???? name="delete_b.a_delete2"
      
      #end add-point    
   END IF
 
 
   
   LET ls_group = "'2',"
   #??????????table2
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      #add-point:delete_b???? name="delete_b.b_delete3"

      #end add-point    
      DELETE FROM sfbcwf_t
       WHERE sfbcwfent = g_enterprise AND sfbcwfsite = g_site AND
             sfbcwfdocno = ps_keys_bak[1] AND sfbcwfseq = ps_keys_bak[2] AND sfbcwfseq1 = ps_keys_bak[3] AND sfbcwfseq2 = ps_keys_bak[4]
      #add-point:delete_b???? name="delete_b.m_delete3"
      #241104-00004#1 add--s
      #????/BIN??
      DELETE FROM icbawf_t
       WHERE icbawfent = g_enterprise AND icbawfsite = g_site
         AND icbawfdocno = ps_keys_bak[1]
         AND icbawfseq  = ps_keys_bak[3] #??
         AND icbawfseq1 = ps_keys_bak[4] #??
         AND icbawf032 = ps_keys_bak[2]  #????   
      #241104-00004#1 add--e
      #end add-point    
      IF SQLCA.SQLCODE THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "sfbcwf_t:",SQLERRMESSAGE 
         LET g_errparam.code = SQLCA.SQLCODE 
         LET g_errparam.popup = FALSE 
         CALL cl_err()
         RETURN FALSE
      END IF
    
      LET li_idx = g_detail_idx2
      IF ps_page <> "'2'" THEN 
         CALL g_sfakwf2_d.deleteElement(li_idx) 
      END IF 
 
      #add-point:delete_b???? name="delete_b.a_delete3"

      #end add-point    
   END IF
 
   LET ls_group = "'3',"
   #??????????table2
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      #add-point:delete_b???? name="delete_b.b_delete4"

      #end add-point    
      DELETE FROM wfapwf_t
       WHERE wfapwfent = g_enterprise AND wfapwfsite = g_site AND
             wfapwfdocno = ps_keys_bak[1] AND wfapwfseq = ps_keys_bak[2] AND wfapwfseq1 = ps_keys_bak[3]
      #add-point:delete_b???? name="delete_b.m_delete4"

      #end add-point    
      IF SQLCA.SQLCODE THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "wfapwf_t:",SQLERRMESSAGE 
         LET g_errparam.code = SQLCA.SQLCODE 
         LET g_errparam.popup = FALSE 
         CALL cl_err()
         RETURN FALSE
      END IF
    
      LET li_idx = g_detail_idx2
      IF ps_page <> "'3'" THEN 
         CALL g_sfakwf3_d.deleteElement(li_idx) 
      END IF 
 
      #add-point:delete_b???? name="delete_b.a_delete4"

      #end add-point    
   END IF
 
   LET ls_group = "'5',"
   #??????????table2
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      #add-point:delete_b???? name="delete_b.b_delete5"

      #end add-point    
      DELETE FROM sfanwf_t
       WHERE sfanwfent = g_enterprise AND sfanwfsite = g_site AND
             sfanwfdocno = ps_keys_bak[1] AND sfanwfseq1 = ps_keys_bak[2] AND sfanwfseq = ps_keys_bak[3]
      #add-point:delete_b???? name="delete_b.m_delete5"

      #end add-point    
      IF SQLCA.SQLCODE THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "sfanwf_t:",SQLERRMESSAGE 
         LET g_errparam.code = SQLCA.SQLCODE 
         LET g_errparam.popup = FALSE 
         CALL cl_err()
         RETURN FALSE
      END IF
    
      LET li_idx = g_detail_idx2
      IF ps_page <> "'5'" THEN 
         CALL g_sfakwf5_d.deleteElement(li_idx) 
      END IF 
 
      #add-point:delete_b???? name="delete_b.a_delete5"

      #end add-point    
   END IF
 
 
   
   #add-point:delete_b?other name="delete_b.other"
   
   #end add-point  
   
   LET g_update = TRUE  #200610-00021
 
   RETURN TRUE
   
END FUNCTION

{</section>}

{<section id="bsft001_wf.insert_b" type="s" >}
#+ ???????table??
PRIVATE FUNCTION bsft001_wf_insert_b(ps_table,ps_keys,ps_page) RETURNS ()   #200213-00032
   #add-point:insert_b?define(???) name="insert_b.define_customerization"

   #end add-point     
   DEFINE ps_table    STRING
   DEFINE ps_page     STRING
   DEFINE ps_keys     DYNAMIC ARRAY OF VARCHAR(500)
   DEFINE ls_group    STRING
   DEFINE ls_page     STRING
   DEFINE li_idx      LIKE type_t.num10
   #add-point:insert_b?define (?????????????????, ?????patch????????) name="insert_b.define"

   #end add-point     
   
   #add-point:Function????  name="insert_b.pre_function"

   #end add-point
   
#  LET g_update = TRUE   #200610-00021 mark
   
   #??????????table
   LET ls_group = "'1',"
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      #add-point:insert_b?????? name="insert_b.before_insert"
      IF cl_null(g_sfakwf_d[g_detail_idx].sfakwf002) THEN
         LET g_sfakwf_d[g_detail_idx].sfakwf002  = ' '
      END IF   
      #end add-point 
      INSERT INTO sfakwf_t
                  (sfakwfent, sfakwfsite,
                   sfakwfdocno,
                   sfakwfseq
                   ,sfakwf001,sfakwf002,sfakwf003,sfakwf004,sfakwf005,sfakwf006,sfakwf007,sfakwf008,sfakwf009,sfakwf010,sfakwf011,sfakwf012,sfakwf013,sfakwf014,sfakwf015,sfakwf016,sfakwf017,sfakwf018,sfakwf019,sfakwf020,sfakwf021,sfakwf022,sfakwf023,sfakwf024,sfakwf025,sfakwf026,sfakwf027,sfakwf028,sfakwf029,sfakwf030,sfakwf031,sfakwf044,sfakwf032,sfakwf033,sfakwf034,sfakwf035,sfakwf036,sfakwf037,sfakwf038,sfakwf039,sfakwf040,sfakwf041,sfakwf042,sfakwf043,sfakwf045,sfakwf046,sfakwf047,sfakwf048,sfakwf049,sfakwfud001) 
            VALUES(g_enterprise, g_site,
                   ps_keys[1],ps_keys[2]
                   ,g_sfakwf_d[g_detail_idx].sfakwf001,g_sfakwf_d[g_detail_idx].sfakwf002,g_sfakwf_d[g_detail_idx].sfakwf003,g_sfakwf_d[g_detail_idx].sfakwf004,g_sfakwf_d[g_detail_idx].sfakwf005,g_sfakwf_d[g_detail_idx].sfakwf006,g_sfakwf_d[g_detail_idx].sfakwf007,g_sfakwf_d[g_detail_idx].sfakwf008, 
                       g_sfakwf_d[g_detail_idx].sfakwf009,g_sfakwf_d[g_detail_idx].sfakwf010,g_sfakwf_d[g_detail_idx].sfakwf011,g_sfakwf_d[g_detail_idx].sfakwf012,g_sfakwf_d[g_detail_idx].sfakwf013,g_sfakwf_d[g_detail_idx].sfakwf014,g_sfakwf_d[g_detail_idx].sfakwf015,g_sfakwf_d[g_detail_idx].sfakwf016, 
                       g_sfakwf_d[g_detail_idx].sfakwf017,g_sfakwf_d[g_detail_idx].sfakwf018,g_sfakwf_d[g_detail_idx].sfakwf019,g_sfakwf_d[g_detail_idx].sfakwf020,g_sfakwf_d[g_detail_idx].sfakwf021,g_sfakwf_d[g_detail_idx].sfakwf022,g_sfakwf_d[g_detail_idx].sfakwf023,g_sfakwf_d[g_detail_idx].sfakwf024, 
                       g_sfakwf_d[g_detail_idx].sfakwf025,g_sfakwf_d[g_detail_idx].sfakwf026,g_sfakwf_d[g_detail_idx].sfakwf027,g_sfakwf_d[g_detail_idx].sfakwf028,g_sfakwf_d[g_detail_idx].sfakwf029,g_sfakwf_d[g_detail_idx].sfakwf030,g_sfakwf_d[g_detail_idx].sfakwf031,g_sfakwf_d[g_detail_idx].sfakwf044, 
                       g_sfakwf_d[g_detail_idx].sfakwf032,g_sfakwf_d[g_detail_idx].sfakwf033,g_sfakwf_d[g_detail_idx].sfakwf034,g_sfakwf_d[g_detail_idx].sfakwf035,g_sfakwf_d[g_detail_idx].sfakwf036,g_sfakwf_d[g_detail_idx].sfakwf037,g_sfakwf_d[g_detail_idx].sfakwf038,g_sfakwf_d[g_detail_idx].sfakwf039, 
                       g_sfakwf_d[g_detail_idx].sfakwf040,g_sfakwf_d[g_detail_idx].sfakwf041,g_sfakwf_d[g_detail_idx].sfakwf042,g_sfakwf_d[g_detail_idx].sfakwf043,g_sfakwf_d[g_detail_idx].sfakwf045,g_sfakwf_d[g_detail_idx].sfakwf046,g_sfakwf_d[g_detail_idx].sfakwf047,g_sfakwf_d[g_detail_idx].sfakwf048, 
                       g_sfakwf_d[g_detail_idx].sfakwf049,g_sfakwf_d[g_detail_idx].sfakwfud001)
      #add-point:insert_b?????? name="insert_b.m_insert"

      #end add-point 
      IF SQLCA.SQLCODE THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "sfakwf_t:",SQLERRMESSAGE 
         LET g_errparam.code = SQLCA.SQLCODE 
         LET g_errparam.popup = FALSE 
         CALL cl_err()
      END IF
      
      LET li_idx = g_detail_idx
      IF ps_page <> "'1'" THEN 
         CALL g_sfakwf_d.insertElement(li_idx) 
      END IF 
 
      #add-point:insert_b?????? name="insert_b.after_insert"
      #240201-00005#1 add--s 
      IF NOT bsft001_wf_gen_sfamwf() THEN 
      END IF  
      #240201-00005#1 add--e
      #end add-point 
   END IF
   
   LET ls_group = "'4',"
   #??????????table
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      #add-point:insert_b?????? name="insert_b.before_insert2"

      #end add-point 
      INSERT INTO sfamwf_t
                  (sfamwfent,
                   sfamwfdocno,
                   sfamwfseq
                   ,sfamwf001,sfamwf002,sfamwf003,sfamwf004,sfamwf005,sfamwf006,sfamwf007,sfamwf008) 
            VALUES(g_enterprise,
                   ps_keys[1],ps_keys[2]
                   ,g_sfakwf4_d[g_detail_idx].sfamwf001,g_sfakwf4_d[g_detail_idx].sfamwf002,g_sfakwf4_d[g_detail_idx].sfamwf003,g_sfakwf4_d[g_detail_idx].sfamwf004,g_sfakwf4_d[g_detail_idx].sfamwf005,g_sfakwf4_d[g_detail_idx].sfamwf006,g_sfakwf4_d[g_detail_idx].sfamwf007,g_sfakwf4_d[g_detail_idx].sfamwf008) 

      #add-point:insert_b?????? name="insert_b.m_insert2"

      #end add-point
      IF SQLCA.SQLCODE THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "sfamwf_t:",SQLERRMESSAGE 
         LET g_errparam.code = SQLCA.SQLCODE 
         LET g_errparam.popup = FALSE 
         CALL cl_err()
      END IF
      
      LET li_idx = g_detail_idx
      IF ps_page <> "'4'" THEN 
         CALL g_sfakwf4_d.insertElement(li_idx) 
      END IF 
 
      #add-point:insert_b?????? name="insert_b.after_insert2"

      #end add-point
   END IF
 
 
   
   LET ls_group = "'2',"
   #??????????table
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      #add-point:insert_b?????? name="insert_b.before_insert3"

      #end add-point 
      INSERT INTO sfbcwf_t
                  (sfbcwfent, sfbcwfsite,
                   sfbcwfdocno,sfbcwfseq,
                   sfbcwfseq1,sfbcwfseq2
                   ,sfbcwf002,sfbcwf003,sfbcwf004,sfbcwf005,sfbcwf022,sfbcwf006,sfbcwf033,sfbcwf021,sfbcwf007,sfbcwf008,sfbcwf009,sfbcwf010,sfbcwf011,sfbcwf012,sfbcwf023,sfbcwf024,sfbcwf013,sfbcwf047,sfbcwf048,sfbcwf014,sfbcwf015,sfbcwf016,sfbcwf025,sfbcwf017,sfbcwf018,sfbcwf019,sfbcwf020,sfbcwf029,sfbcwf039,sfbcwf030,sfbcwf040,sfbcwf041,sfbcwf042,sfbcwf028,sfbcwf001,sfbcwf026,sfbcwf027,sfbcwf034,sfbcwf035,sfbcwf043,sfbcwf049) 
            VALUES(g_enterprise, g_site,
                   ps_keys[1],ps_keys[2],ps_keys[3],ps_keys[4]
                   ,g_sfakwf2_d[g_detail_idx2].sfbcwf002,g_sfakwf2_d[g_detail_idx2].sfbcwf003,g_sfakwf2_d[g_detail_idx2].sfbcwf004,g_sfakwf2_d[g_detail_idx2].sfbcwf005,g_sfakwf2_d[g_detail_idx2].sfbcwf022,g_sfakwf2_d[g_detail_idx2].sfbcwf006,g_sfakwf2_d[g_detail_idx2].sfbcwf033,g_sfakwf2_d[g_detail_idx2].sfbcwf021, 
                       g_sfakwf2_d[g_detail_idx2].sfbcwf007,g_sfakwf2_d[g_detail_idx2].sfbcwf008,g_sfakwf2_d[g_detail_idx2].sfbcwf009,g_sfakwf2_d[g_detail_idx2].sfbcwf010,g_sfakwf2_d[g_detail_idx2].sfbcwf011,g_sfakwf2_d[g_detail_idx2].sfbcwf012,g_sfakwf2_d[g_detail_idx2].sfbcwf023,g_sfakwf2_d[g_detail_idx2].sfbcwf024, 
                       g_sfakwf2_d[g_detail_idx2].sfbcwf013,g_sfakwf2_d[g_detail_idx2].sfbcwf047,g_sfakwf2_d[g_detail_idx2].sfbcwf048,g_sfakwf2_d[g_detail_idx2].sfbcwf014,g_sfakwf2_d[g_detail_idx2].sfbcwf015,g_sfakwf2_d[g_detail_idx2].sfbcwf016,g_sfakwf2_d[g_detail_idx2].sfbcwf025,g_sfakwf2_d[g_detail_idx2].sfbcwf017, 
                       g_sfakwf2_d[g_detail_idx2].sfbcwf018,g_sfakwf2_d[g_detail_idx2].sfbcwf019,g_sfakwf2_d[g_detail_idx2].sfbcwf020,g_sfakwf2_d[g_detail_idx2].sfbcwf029,g_sfakwf2_d[g_detail_idx2].sfbcwf039,g_sfakwf2_d[g_detail_idx2].sfbcwf030,g_sfakwf2_d[g_detail_idx2].sfbcwf040,g_sfakwf2_d[g_detail_idx2].sfbcwf041, 
                       g_sfakwf2_d[g_detail_idx2].sfbcwf042,g_sfakwf2_d[g_detail_idx2].sfbcwf028,g_sfakwf2_d[g_detail_idx2].sfbcwf001,g_sfakwf2_d[g_detail_idx2].sfbcwf026,g_sfakwf2_d[g_detail_idx2].sfbcwf027,g_sfakwf2_d[g_detail_idx2].sfbcwf034,g_sfakwf2_d[g_detail_idx2].sfbcwf035,g_sfakwf2_d[g_detail_idx2].sfbcwf043, 
                       g_sfakwf2_d[g_detail_idx2].sfbcwf049)
      #add-point:insert_b?????? name="insert_b.m_insert3"

      #end add-point
      IF SQLCA.SQLCODE THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "sfbcwf_t:",SQLERRMESSAGE 
         LET g_errparam.code = SQLCA.SQLCODE 
         LET g_errparam.popup = FALSE 
         CALL cl_err()
      END IF
      
      LET li_idx = g_detail_idx2
      IF ps_page <> "'2'" THEN 
         CALL g_sfakwf2_d.insertElement(li_idx) 
      END IF 
 
      #add-point:insert_b?????? name="insert_b.after_insert3"

      #end add-point
   END IF
 
   LET ls_group = "'3',"
   #??????????table
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      #add-point:insert_b?????? name="insert_b.before_insert4"

      #end add-point 
      INSERT INTO wfapwf_t
                  (wfapwfent, wfapwfsite,
                   wfapwfdocno,wfapwfseq,
                   wfapwfseq1
                   ,wfapwf001,wfapwf002,wfapwf003,wfapwf004,wfapwf005,wfapwf006,wfapwf007,wfapwf008,wfapwf009,wfapwf010,wfapwf011,wfapwf012,wfapwf013,wfapwf014,wfapwf015,wfapwf016,wfapwf017,wfapwf018,wfapwf022,wfapwf019,wfapwf021,wfapwf020,wfapwf023,wfapwf024,wfapwf025,wfapwf026) 
            VALUES(g_enterprise, g_site,
                   ps_keys[1],ps_keys[2],ps_keys[3]
                   ,g_sfakwf3_d[g_detail_idx2].wfapwf001,g_sfakwf3_d[g_detail_idx2].wfapwf002,g_sfakwf3_d[g_detail_idx2].wfapwf003,g_sfakwf3_d[g_detail_idx2].wfapwf004,g_sfakwf3_d[g_detail_idx2].wfapwf005,g_sfakwf3_d[g_detail_idx2].wfapwf006,g_sfakwf3_d[g_detail_idx2].wfapwf007,g_sfakwf3_d[g_detail_idx2].wfapwf008, 
                       g_sfakwf3_d[g_detail_idx2].wfapwf009,g_sfakwf3_d[g_detail_idx2].wfapwf010,g_sfakwf3_d[g_detail_idx2].wfapwf011,g_sfakwf3_d[g_detail_idx2].wfapwf012,g_sfakwf3_d[g_detail_idx2].wfapwf013,g_sfakwf3_d[g_detail_idx2].wfapwf014,g_sfakwf3_d[g_detail_idx2].wfapwf015,g_sfakwf3_d[g_detail_idx2].wfapwf016, 
                       g_sfakwf3_d[g_detail_idx2].wfapwf017,g_sfakwf3_d[g_detail_idx2].wfapwf018,g_sfakwf3_d[g_detail_idx2].wfapwf022,g_sfakwf3_d[g_detail_idx2].wfapwf019,g_sfakwf3_d[g_detail_idx2].wfapwf021,g_sfakwf3_d[g_detail_idx2].wfapwf020,g_sfakwf3_d[g_detail_idx2].wfapwf023,g_sfakwf3_d[g_detail_idx2].wfapwf024, 
                       g_sfakwf3_d[g_detail_idx2].wfapwf025,g_sfakwf3_d[g_detail_idx2].wfapwf026)
      #add-point:insert_b?????? name="insert_b.m_insert4"

      #end add-point
      IF SQLCA.SQLCODE THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "wfapwf_t:",SQLERRMESSAGE 
         LET g_errparam.code = SQLCA.SQLCODE 
         LET g_errparam.popup = FALSE 
         CALL cl_err()
      END IF
      
      LET li_idx = g_detail_idx2
      IF ps_page <> "'3'" THEN 
         CALL g_sfakwf3_d.insertElement(li_idx) 
      END IF 
 
      #add-point:insert_b?????? name="insert_b.after_insert4"

      #end add-point
   END IF
 
   LET ls_group = "'5',"
   #??????????table
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      #add-point:insert_b?????? name="insert_b.before_insert5"

      #end add-point 
      INSERT INTO sfanwf_t
                  (sfanwfent, sfanwfsite,
                   sfanwfdocno,sfanwfseq1,
                   sfanwfseq
                   ,sfanwf002,sfanwf001,sfanwf006,sfanwf003,sfanwf004,sfanwf005) 
            VALUES(g_enterprise, g_site,
                   ps_keys[1],ps_keys[2],ps_keys[3]
                   ,g_sfakwf5_d[g_detail_idx2].sfanwf002,g_sfakwf5_d[g_detail_idx2].sfanwf001,g_sfakwf5_d[g_detail_idx2].sfanwf006,g_sfakwf5_d[g_detail_idx2].sfanwf003,g_sfakwf5_d[g_detail_idx2].sfanwf004,g_sfakwf5_d[g_detail_idx2].sfanwf005)
      #add-point:insert_b?????? name="insert_b.m_insert5"

      #end add-point
      IF SQLCA.SQLCODE THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "sfanwf_t:",SQLERRMESSAGE 
         LET g_errparam.code = SQLCA.SQLCODE 
         LET g_errparam.popup = FALSE 
         CALL cl_err()
      END IF
      
      LET li_idx = g_detail_idx2
      IF ps_page <> "'5'" THEN 
         CALL g_sfakwf5_d.insertElement(li_idx) 
      END IF 
 
      #add-point:insert_b?????? name="insert_b.after_insert5"

      #end add-point
   END IF
 
 
   
   #add-point:insert_b?other name="insert_b.other"

   #end add-point     
   
   LET g_update = TRUE   #200610-00021
 
END FUNCTION

{</section>}

{<section id="bsft001_wf.update_b" type="s" >}
#+ ???????table??
PRIVATE FUNCTION bsft001_wf_update_b(ps_table,ps_keys,ps_keys_bak,ps_page) RETURNS ()   #200213-00032
   #add-point:update_b?define(???) name="update_b.define_customerization"

   #end add-point   
   DEFINE ps_table         STRING
   DEFINE ps_page          STRING
   DEFINE ps_keys          DYNAMIC ARRAY OF VARCHAR(500)
   DEFINE ps_keys_bak      DYNAMIC ARRAY OF VARCHAR(500)
   DEFINE ls_group         STRING
   DEFINE li_idx           LIKE type_t.num10 
   DEFINE lb_chk           BOOLEAN
   DEFINE l_new_key        DYNAMIC ARRAY OF STRING
   DEFINE l_old_key        DYNAMIC ARRAY OF STRING
   DEFINE l_field_key      DYNAMIC ARRAY OF STRING
   #add-point:update_b?define (?????????????????, ?????patch????????) name="update_b.define"

   #end add-point   
   
   #add-point:Function????  name="update_b.pre_function"

   #end add-point
   
#  LET g_update = TRUE   #200610-00021 mark
   
   #??key?????
   LET lb_chk = TRUE
   FOR li_idx = 1 TO ps_keys.getLength()
      IF ps_keys[li_idx] <> ps_keys_bak[li_idx] THEN
         LET lb_chk = FALSE
         EXIT FOR
      END IF
   END FOR
   
   #??????
   IF lb_chk THEN
      RETURN
   END IF
   
   #??????????table
   LET ls_group = "'1',"
   IF ls_group.getIndexOf(ps_page,1) > 0 AND ps_table <> "sfakwf_t" THEN
      #add-point:update_b???? name="update_b.before_update"

      #end add-point 
      
      #???????
      CALL bsft001_wf_sfakwf_t_mask_restore('restore_mask_o')
               
      UPDATE sfakwf_t 
         SET (sfakwfdocno,
              sfakwfseq
              ,sfakwf001,sfakwf002,sfakwf003,sfakwf004,sfakwf005,sfakwf006,sfakwf007,sfakwf008,sfakwf009,sfakwf010,sfakwf011,sfakwf012,sfakwf013,sfakwf014,sfakwf015,sfakwf016,sfakwf017,sfakwf018,sfakwf019,sfakwf020,sfakwf021,sfakwf022,sfakwf023,sfakwf024,sfakwf025,sfakwf026,sfakwf027,sfakwf028,sfakwf029,sfakwf030,sfakwf031,sfakwf044,sfakwf032,sfakwf033,sfakwf034,sfakwf035,sfakwf036,sfakwf037,sfakwf038,sfakwf039,sfakwf040,sfakwf041,sfakwf042,sfakwf043,sfakwf045,sfakwf046,sfakwf047,sfakwf048,sfakwf049,sfakwfud001) 
              = 
             (ps_keys[1],ps_keys[2]
              ,g_sfakwf_d[g_detail_idx].sfakwf001,g_sfakwf_d[g_detail_idx].sfakwf002,g_sfakwf_d[g_detail_idx].sfakwf003,g_sfakwf_d[g_detail_idx].sfakwf004,g_sfakwf_d[g_detail_idx].sfakwf005,g_sfakwf_d[g_detail_idx].sfakwf006,g_sfakwf_d[g_detail_idx].sfakwf007,g_sfakwf_d[g_detail_idx].sfakwf008,g_sfakwf_d[g_detail_idx].sfakwf009, 
                  g_sfakwf_d[g_detail_idx].sfakwf010,g_sfakwf_d[g_detail_idx].sfakwf011,g_sfakwf_d[g_detail_idx].sfakwf012,g_sfakwf_d[g_detail_idx].sfakwf013,g_sfakwf_d[g_detail_idx].sfakwf014,g_sfakwf_d[g_detail_idx].sfakwf015,g_sfakwf_d[g_detail_idx].sfakwf016,g_sfakwf_d[g_detail_idx].sfakwf017,g_sfakwf_d[g_detail_idx].sfakwf018, 
                  g_sfakwf_d[g_detail_idx].sfakwf019,g_sfakwf_d[g_detail_idx].sfakwf020,g_sfakwf_d[g_detail_idx].sfakwf021,g_sfakwf_d[g_detail_idx].sfakwf022,g_sfakwf_d[g_detail_idx].sfakwf023,g_sfakwf_d[g_detail_idx].sfakwf024,g_sfakwf_d[g_detail_idx].sfakwf025,g_sfakwf_d[g_detail_idx].sfakwf026,g_sfakwf_d[g_detail_idx].sfakwf027, 
                  g_sfakwf_d[g_detail_idx].sfakwf028,g_sfakwf_d[g_detail_idx].sfakwf029,g_sfakwf_d[g_detail_idx].sfakwf030,g_sfakwf_d[g_detail_idx].sfakwf031,g_sfakwf_d[g_detail_idx].sfakwf044,g_sfakwf_d[g_detail_idx].sfakwf032,g_sfakwf_d[g_detail_idx].sfakwf033,g_sfakwf_d[g_detail_idx].sfakwf034,g_sfakwf_d[g_detail_idx].sfakwf035, 
                  g_sfakwf_d[g_detail_idx].sfakwf036,g_sfakwf_d[g_detail_idx].sfakwf037,g_sfakwf_d[g_detail_idx].sfakwf038,g_sfakwf_d[g_detail_idx].sfakwf039,g_sfakwf_d[g_detail_idx].sfakwf040,g_sfakwf_d[g_detail_idx].sfakwf041,g_sfakwf_d[g_detail_idx].sfakwf042,g_sfakwf_d[g_detail_idx].sfakwf043,g_sfakwf_d[g_detail_idx].sfakwf045, 
                  g_sfakwf_d[g_detail_idx].sfakwf046,g_sfakwf_d[g_detail_idx].sfakwf047,g_sfakwf_d[g_detail_idx].sfakwf048,g_sfakwf_d[g_detail_idx].sfakwf049,g_sfakwf_d[g_detail_idx].sfakwfud001) 
         WHERE sfakwfent = g_enterprise AND sfakwfsite = g_site AND sfakwfdocno = ps_keys_bak[1] AND sfakwfseq = ps_keys_bak[2]
      #add-point:update_b???? name="update_b.m_update"

      #end add-point   
      CASE
         WHEN SQLCA.sqlerrd[3] = 0  #???????
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = "sfakwf_t" 
            LET g_errparam.code = "std-00009" 
            LET g_errparam.popup = TRUE 
            CALL s_transaction_end('N','0')
            CALL cl_err()
            
         WHEN SQLCA.SQLCODE #????
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = "sfakwf_t:",SQLERRMESSAGE 
            LET g_errparam.code = SQLCA.SQLCODE 
            LET g_errparam.popup = TRUE 
            CALL s_transaction_end('N','0')
            CALL cl_err()
            
         OTHERWISE
 
      END CASE
      
      #?????????
      CALL bsft001_wf_sfakwf_t_mask_restore('restore_mask_n')
               
      #add-point:update_b???? name="update_b.after_update"
      #240201-00005#1 add--s 
      IF NOT bsft001_wf_gen_sfamwf() THEN 
      END IF  
      #240201-00005#1 add--e
      #end add-point  
   END IF
   
   #????
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      
   END IF
   
   
   LET ls_group = "'4',"
   #??????????table
   IF ls_group.getIndexOf(ps_page,1) > 0 AND ps_table <> "sfamwf_t" THEN
      #add-point:update_b???? name="update_b.before_update2"

      #end add-point  
      
      #???????
      CALL bsft001_wf_sfamwf_t_mask_restore('restore_mask_o')
               
      UPDATE sfamwf_t 
         SET (sfamwfdocno,
              sfamwfseq
              ,sfamwf001,sfamwf002,sfamwf003,sfamwf004,sfamwf005,sfamwf006,sfamwf007,sfamwf008) 
              = 
             (ps_keys[1],ps_keys[2]
              ,g_sfakwf4_d[g_detail_idx].sfamwf001,g_sfakwf4_d[g_detail_idx].sfamwf002,g_sfakwf4_d[g_detail_idx].sfamwf003,g_sfakwf4_d[g_detail_idx].sfamwf004,g_sfakwf4_d[g_detail_idx].sfamwf005,g_sfakwf4_d[g_detail_idx].sfamwf006,g_sfakwf4_d[g_detail_idx].sfamwf007,g_sfakwf4_d[g_detail_idx].sfamwf008)  

         WHERE sfamwfent = g_enterprise AND sfamwfdocno = ps_keys_bak[1] AND sfamwfseq = ps_keys_bak[2]
      #add-point:update_b???? name="update_b.m_update2"

      #end add-point  
      CASE
         WHEN SQLCA.sqlerrd[3] = 0  #???????
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = "sfamwf_t" 
            LET g_errparam.code = "std-00009" 
            LET g_errparam.popup = TRUE 
            CALL s_transaction_end('N','0')
            CALL cl_err()
            
         WHEN SQLCA.SQLCODE #????
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = "sfamwf_t:",SQLERRMESSAGE 
            LET g_errparam.code = SQLCA.SQLCODE 
            LET g_errparam.popup = TRUE 
            CALL s_transaction_end('N','0')
            CALL cl_err()
            
         OTHERWISE
          
      END CASE
      
      #?????????
      CALL bsft001_wf_sfamwf_t_mask_restore('restore_mask_n')
 
      #add-point:update_b???? name="update_b.after_update2"

      #end add-point  
   END IF
 
   #????
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      
   END IF
 
 
   
   LET ls_group = "'2',"
   #??????????table
   IF ls_group.getIndexOf(ps_page,1) > 0 AND ps_table <> "sfbcwf_t" THEN
      #add-point:update_b???? name="update_b.before_update3"

      #end add-point
      
      #???????
      CALL bsft001_wf_sfbcwf_t_mask_restore('restore_mask_o')
               
      UPDATE sfbcwf_t 
         SET (sfbcwfdocno,sfbcwfseq,
              sfbcwfseq1,sfbcwfseq2
              ,sfbcwf002,sfbcwf003,sfbcwf004,sfbcwf005,sfbcwf022,sfbcwf006,sfbcwf033,sfbcwf021,sfbcwf007,sfbcwf008,sfbcwf009,sfbcwf010,sfbcwf011,sfbcwf012,sfbcwf023,sfbcwf024,sfbcwf013,sfbcwf047,sfbcwf048,sfbcwf014,sfbcwf015,sfbcwf016,sfbcwf025,sfbcwf017,sfbcwf018,sfbcwf019,sfbcwf020,sfbcwf029,sfbcwf039,sfbcwf030,sfbcwf040,sfbcwf041,sfbcwf042,sfbcwf028,sfbcwf001,sfbcwf026,sfbcwf027,sfbcwf034,sfbcwf035,sfbcwf043,sfbcwf049) 
              = 
             (ps_keys[1],ps_keys[2],ps_keys[3],ps_keys[4]
              ,g_sfakwf2_d[g_detail_idx2].sfbcwf002,g_sfakwf2_d[g_detail_idx2].sfbcwf003,g_sfakwf2_d[g_detail_idx2].sfbcwf004,g_sfakwf2_d[g_detail_idx2].sfbcwf005,g_sfakwf2_d[g_detail_idx2].sfbcwf022,g_sfakwf2_d[g_detail_idx2].sfbcwf006,g_sfakwf2_d[g_detail_idx2].sfbcwf033,g_sfakwf2_d[g_detail_idx2].sfbcwf021, 
                  g_sfakwf2_d[g_detail_idx2].sfbcwf007,g_sfakwf2_d[g_detail_idx2].sfbcwf008,g_sfakwf2_d[g_detail_idx2].sfbcwf009,g_sfakwf2_d[g_detail_idx2].sfbcwf010,g_sfakwf2_d[g_detail_idx2].sfbcwf011,g_sfakwf2_d[g_detail_idx2].sfbcwf012,g_sfakwf2_d[g_detail_idx2].sfbcwf023,g_sfakwf2_d[g_detail_idx2].sfbcwf024, 
                  g_sfakwf2_d[g_detail_idx2].sfbcwf013,g_sfakwf2_d[g_detail_idx2].sfbcwf047,g_sfakwf2_d[g_detail_idx2].sfbcwf048,g_sfakwf2_d[g_detail_idx2].sfbcwf014,g_sfakwf2_d[g_detail_idx2].sfbcwf015,g_sfakwf2_d[g_detail_idx2].sfbcwf016,g_sfakwf2_d[g_detail_idx2].sfbcwf025,g_sfakwf2_d[g_detail_idx2].sfbcwf017, 
                  g_sfakwf2_d[g_detail_idx2].sfbcwf018,g_sfakwf2_d[g_detail_idx2].sfbcwf019,g_sfakwf2_d[g_detail_idx2].sfbcwf020,g_sfakwf2_d[g_detail_idx2].sfbcwf029,g_sfakwf2_d[g_detail_idx2].sfbcwf039,g_sfakwf2_d[g_detail_idx2].sfbcwf030,g_sfakwf2_d[g_detail_idx2].sfbcwf040,g_sfakwf2_d[g_detail_idx2].sfbcwf041, 
                  g_sfakwf2_d[g_detail_idx2].sfbcwf042,g_sfakwf2_d[g_detail_idx2].sfbcwf028,g_sfakwf2_d[g_detail_idx2].sfbcwf001,g_sfakwf2_d[g_detail_idx2].sfbcwf026,g_sfakwf2_d[g_detail_idx2].sfbcwf027,g_sfakwf2_d[g_detail_idx2].sfbcwf034,g_sfakwf2_d[g_detail_idx2].sfbcwf035,g_sfakwf2_d[g_detail_idx2].sfbcwf043, 
                  g_sfakwf2_d[g_detail_idx2].sfbcwf049) 
         WHERE sfbcwfent = g_enterprise AND sfbcwfsite = g_site AND sfbcwfdocno = ps_keys_bak[1] AND sfbcwfseq = ps_keys_bak[2] AND sfbcwfseq1 = ps_keys_bak[3] AND sfbcwfseq2 = ps_keys_bak[4]
      #add-point:update_b???? name="update_b.m_update3"

      #end add-point  
      CASE
         WHEN SQLCA.sqlerrd[3] = 0  #???????
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = "sfbcwf_t" 
            LET g_errparam.code = "std-00009" 
            LET g_errparam.popup = TRUE 
            CALL s_transaction_end('N','0')
            CALL cl_err()
            
         WHEN SQLCA.SQLCODE #????
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = "sfbcwf_t:",SQLERRMESSAGE 
            LET g_errparam.code = SQLCA.SQLCODE 
            LET g_errparam.popup = TRUE 
            CALL s_transaction_end('N','0')
            CALL cl_err()
            
         OTHERWISE
 
      END CASE
      
      #?????????
      CALL bsft001_wf_sfbcwf_t_mask_restore('restore_mask_n')
               
      #add-point:update_b???? name="update_b.after_update3"

      #end add-point  
   END IF
 
   #????
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      
   END IF
 
   LET ls_group = "'3',"
   #??????????table
   IF ls_group.getIndexOf(ps_page,1) > 0 AND ps_table <> "wfapwf_t" THEN
      #add-point:update_b???? name="update_b.before_update4"

      #end add-point
      
      #???????
      CALL bsft001_wf_wfapwf_t_mask_restore('restore_mask_o')
               
      UPDATE wfapwf_t 
         SET (wfapwfdocno,wfapwfseq,
              wfapwfseq1
              ,wfapwf001,wfapwf002,wfapwf003,wfapwf004,wfapwf005,wfapwf006,wfapwf007,wfapwf008,wfapwf009,wfapwf010,wfapwf011,wfapwf012,wfapwf013,wfapwf014,wfapwf015,wfapwf016,wfapwf017,wfapwf018,wfapwf022,wfapwf019,wfapwf021,wfapwf020,wfapwf023,wfapwf024,wfapwf025,wfapwf026) 
              = 
             (ps_keys[1],ps_keys[2],ps_keys[3]
              ,g_sfakwf3_d[g_detail_idx2].wfapwf001,g_sfakwf3_d[g_detail_idx2].wfapwf002,g_sfakwf3_d[g_detail_idx2].wfapwf003,g_sfakwf3_d[g_detail_idx2].wfapwf004,g_sfakwf3_d[g_detail_idx2].wfapwf005,g_sfakwf3_d[g_detail_idx2].wfapwf006,g_sfakwf3_d[g_detail_idx2].wfapwf007,g_sfakwf3_d[g_detail_idx2].wfapwf008, 
                  g_sfakwf3_d[g_detail_idx2].wfapwf009,g_sfakwf3_d[g_detail_idx2].wfapwf010,g_sfakwf3_d[g_detail_idx2].wfapwf011,g_sfakwf3_d[g_detail_idx2].wfapwf012,g_sfakwf3_d[g_detail_idx2].wfapwf013,g_sfakwf3_d[g_detail_idx2].wfapwf014,g_sfakwf3_d[g_detail_idx2].wfapwf015,g_sfakwf3_d[g_detail_idx2].wfapwf016, 
                  g_sfakwf3_d[g_detail_idx2].wfapwf017,g_sfakwf3_d[g_detail_idx2].wfapwf018,g_sfakwf3_d[g_detail_idx2].wfapwf022,g_sfakwf3_d[g_detail_idx2].wfapwf019,g_sfakwf3_d[g_detail_idx2].wfapwf021,g_sfakwf3_d[g_detail_idx2].wfapwf020,g_sfakwf3_d[g_detail_idx2].wfapwf023,g_sfakwf3_d[g_detail_idx2].wfapwf024, 
                  g_sfakwf3_d[g_detail_idx2].wfapwf025,g_sfakwf3_d[g_detail_idx2].wfapwf026) 
         WHERE wfapwfent = g_enterprise AND wfapwfsite = g_site AND wfapwfdocno = ps_keys_bak[1] AND wfapwfseq = ps_keys_bak[2] AND wfapwfseq1 = ps_keys_bak[3]
      #add-point:update_b???? name="update_b.m_update4"

      #end add-point  
      CASE
         WHEN SQLCA.sqlerrd[3] = 0  #???????
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = "wfapwf_t" 
            LET g_errparam.code = "std-00009" 
            LET g_errparam.popup = TRUE 
            CALL s_transaction_end('N','0')
            CALL cl_err()
            
         WHEN SQLCA.SQLCODE #????
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = "wfapwf_t:",SQLERRMESSAGE 
            LET g_errparam.code = SQLCA.SQLCODE 
            LET g_errparam.popup = TRUE 
            CALL s_transaction_end('N','0')
            CALL cl_err()
            
         OTHERWISE
 
      END CASE
      
      #?????????
      CALL bsft001_wf_wfapwf_t_mask_restore('restore_mask_n')
               
      #add-point:update_b???? name="update_b.after_update4"

      #end add-point  
   END IF
 
   #????
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      
   END IF
 
   LET ls_group = "'5',"
   #??????????table
   IF ls_group.getIndexOf(ps_page,1) > 0 AND ps_table <> "sfanwf_t" THEN
      #add-point:update_b???? name="update_b.before_update5"

      #end add-point
      
      #???????
      CALL bsft001_wf_sfanwf_t_mask_restore('restore_mask_o')
               
      UPDATE sfanwf_t 
         SET (sfanwfdocno,sfanwfseq1,
              sfanwfseq
              ,sfanwf002,sfanwf001,sfanwf006,sfanwf003,sfanwf004,sfanwf005) 
              = 
             (ps_keys[1],ps_keys[2],ps_keys[3]
              ,g_sfakwf5_d[g_detail_idx2].sfanwf002,g_sfakwf5_d[g_detail_idx2].sfanwf001,g_sfakwf5_d[g_detail_idx2].sfanwf006,g_sfakwf5_d[g_detail_idx2].sfanwf003,g_sfakwf5_d[g_detail_idx2].sfanwf004,g_sfakwf5_d[g_detail_idx2].sfanwf005) 
         WHERE sfanwfent = g_enterprise AND sfanwfsite = g_site AND sfanwfdocno = ps_keys_bak[1] AND sfanwfseq1 = ps_keys_bak[2] AND sfanwfseq = ps_keys_bak[3]
      #add-point:update_b???? name="update_b.m_update5"

      #end add-point  
      CASE
         WHEN SQLCA.sqlerrd[3] = 0  #???????
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = "sfanwf_t" 
            LET g_errparam.code = "std-00009" 
            LET g_errparam.popup = TRUE 
            CALL s_transaction_end('N','0')
            CALL cl_err()
            
         WHEN SQLCA.SQLCODE #????
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = "sfanwf_t:",SQLERRMESSAGE 
            LET g_errparam.code = SQLCA.SQLCODE 
            LET g_errparam.popup = TRUE 
            CALL s_transaction_end('N','0')
            CALL cl_err()
            
         OTHERWISE
 
      END CASE
      
      #?????????
      CALL bsft001_wf_sfanwf_t_mask_restore('restore_mask_n')
               
      #add-point:update_b???? name="update_b.after_update5"

      #end add-point  
   END IF
 
   #????
   IF ls_group.getIndexOf(ps_page,1) > 0 THEN
      
   END IF
 
 
   
   #add-point:update_b?other name="update_b.other"

   #end add-point  
   
   LET g_update = TRUE   #200610-00021
 
END FUNCTION

{</section>}

{<section id="bsft001_wf.key_update_b" type="s" >}
#+ ????key?????, ????????key??
PRIVATE FUNCTION bsft001_wf_key_update_b(ps_keys_bak,ps_table) RETURNS ()   #200213-00032
   #add-point:update_b?define(???) name="key_update_b.define_customerization"

   #end add-point
   DEFINE ps_keys_bak       DYNAMIC ARRAY OF VARCHAR(500)
   DEFINE ps_table          STRING
   DEFINE l_field_key       DYNAMIC ARRAY OF STRING
   DEFINE l_var_keys_bak    DYNAMIC ARRAY OF STRING
   DEFINE l_new_key         DYNAMIC ARRAY OF STRING
   DEFINE l_old_key         DYNAMIC ARRAY OF STRING
   #add-point:update_b?define (?????????????????, ?????patch????????) name="key_update_b.define"

   #end add-point
   
   #add-point:Function????  name="key_update_b.pre_function"

   #end add-point
   
   #??????????update
   IF ps_table = 'sfakwf_t' THEN
      #add-point:update_b???? name="key_update_b.before_update3"

      #end add-point
      
      UPDATE sfbcwf_t 
         SET (sfbcwfdocno,sfbcwfseq) 
              = 
             (g_sfajwf_m.sfajwfdocno,g_sfakwf_d[g_detail_idx].sfakwfseq) 
         WHERE sfbcwfent = g_enterprise AND sfbcwfsite = g_site AND
               sfbcwfdocno = ps_keys_bak[1] AND sfbcwfseq = ps_keys_bak[2]
 
      #add-point:update_b???? name="key_update_b.m_update3"

      #end add-point
              
      CASE
         WHEN SQLCA.SQLCODE #????
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = "sfbcwf_t:",SQLERRMESSAGE 
            LET g_errparam.code = SQLCA.SQLCODE 
            LET g_errparam.popup = TRUE 
            CALL s_transaction_end('N','0')
            CALL cl_err()
            
         OTHERWISE
            #?????table??????
            
      END CASE
      
      #add-point:update_b???? name="key_update_b.after_update3"

      #end add-point
   END IF
 
   #??????????update
   IF ps_table = 'sfakwf_t' THEN
      #add-point:update_b???? name="key_update_b.before_update4"

      #end add-point
      
      UPDATE wfapwf_t 
         SET (wfapwfdocno,wfapwfseq) 
              = 
             (g_sfajwf_m.sfajwfdocno,g_sfakwf_d[g_detail_idx].sfakwfseq) 
         WHERE wfapwfent = g_enterprise AND wfapwfsite = g_site AND
               wfapwfdocno = ps_keys_bak[1] AND wfapwfseq = ps_keys_bak[2]
 
      #add-point:update_b???? name="key_update_b.m_update4"

      #end add-point
              
      CASE
         WHEN SQLCA.SQLCODE #????
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = "wfapwf_t:",SQLERRMESSAGE 
            LET g_errparam.code = SQLCA.SQLCODE 
            LET g_errparam.popup = TRUE 
            CALL s_transaction_end('N','0')
            CALL cl_err()
            
         OTHERWISE
            #?????table??????
            
      END CASE
      
      #add-point:update_b???? name="key_update_b.after_update4"

      #end add-point
   END IF
 
   #??????????update
   IF ps_table = 'sfakwf_t' THEN
      #add-point:update_b???? name="key_update_b.before_update5"

      #end add-point
      
      UPDATE sfanwf_t 
         SET (sfanwfdocno,sfanwfseq1) 
              = 
             (g_sfajwf_m.sfajwfdocno,g_sfakwf_d[g_detail_idx].sfakwfseq) 
         WHERE sfanwfent = g_enterprise AND sfanwfsite = g_site AND
               sfanwfdocno = ps_keys_bak[1] AND sfanwfseq1 = ps_keys_bak[2]
 
      #add-point:update_b???? name="key_update_b.m_update5"

      #end add-point
              
      CASE
         WHEN SQLCA.SQLCODE #????
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = "sfanwf_t:",SQLERRMESSAGE 
            LET g_errparam.code = SQLCA.SQLCODE 
            LET g_errparam.popup = TRUE 
            CALL s_transaction_end('N','0')
            CALL cl_err()
            
         OTHERWISE
            #?????table??????
            
      END CASE
      
      #add-point:update_b???? name="key_update_b.after_update5"

      #end add-point
   END IF
 
 
   
END FUNCTION

{</section>}

{<section id="bsft001_wf.key_delete_b" type="s" >}
#+ ???????, ????????key??
PRIVATE FUNCTION bsft001_wf_key_delete_b(ps_keys_bak,ps_table) RETURNS (INT)   #200213-00032
   #add-point:delete_b?define(???) name="key_delete_b.define_customerization"

   #end add-point
   DEFINE ps_keys_bak       DYNAMIC ARRAY OF VARCHAR(500)
   DEFINE ps_table          STRING
   DEFINE l_field_keys      DYNAMIC ARRAY OF STRING
   DEFINE l_var_keys_bak    DYNAMIC ARRAY OF STRING
   DEFINE l_new_key         DYNAMIC ARRAY OF STRING
   DEFINE l_old_key         DYNAMIC ARRAY OF STRING
   #add-point:delete_b?define (?????????????????, ?????patch????????) name="key_delete_b.define"

   #end add-point
   
   #add-point:Function????  name="key_delete_b.pre_function"

   #end add-point
   
   #??????????delete
   IF ps_table = 'sfakwf_t' THEN
      #add-point:delete_b???? name="key_delete_b.before_delete3"

      #end add-point
      
      DELETE FROM sfbcwf_t 
            WHERE sfbcwfent = g_enterprise AND sfbcwfsite = g_site AND
                  sfbcwfdocno = ps_keys_bak[1] AND sfbcwfseq = ps_keys_bak[2]
 
      #add-point:delete_b???? name="key_delete_b.m_delete3"

      #end add-point
              
      CASE
         WHEN SQLCA.SQLCODE #????
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = "sfbcwf_t:",SQLERRMESSAGE 
            LET g_errparam.code = SQLCA.SQLCODE 
            LET g_errparam.popup = TRUE 
            CALL s_transaction_end('N','0')
            CALL cl_err()
            RETURN FALSE
         OTHERWISE
      END CASE
 
       
 
      #add-point:delete_b???? name="key_delete_b.after_delete3"

      #end add-point
   END IF
 
   #??????????delete
   IF ps_table = 'sfakwf_t' THEN
      #add-point:delete_b???? name="key_delete_b.before_delete4"

      #end add-point
      
      DELETE FROM wfapwf_t 
            WHERE wfapwfent = g_enterprise AND wfapwfsite = g_site AND
                  wfapwfdocno = ps_keys_bak[1] AND wfapwfseq = ps_keys_bak[2]
 
      #add-point:delete_b???? name="key_delete_b.m_delete4"

      #end add-point
              
      CASE
         WHEN SQLCA.SQLCODE #????
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = "wfapwf_t:",SQLERRMESSAGE 
            LET g_errparam.code = SQLCA.SQLCODE 
            LET g_errparam.popup = TRUE 
            CALL s_transaction_end('N','0')
            CALL cl_err()
            RETURN FALSE
         OTHERWISE
      END CASE
 
       
 
      #add-point:delete_b???? name="key_delete_b.after_delete4"

      #end add-point
   END IF
 
   #??????????delete
   IF ps_table = 'sfakwf_t' THEN
      #add-point:delete_b???? name="key_delete_b.before_delete5"

      #end add-point
      
      DELETE FROM sfanwf_t 
            WHERE sfanwfent = g_enterprise AND sfanwfsite = g_site AND
                  sfanwfdocno = ps_keys_bak[1] AND sfanwfseq1 = ps_keys_bak[2]
 
      #add-point:delete_b???? name="key_delete_b.m_delete5"

      #end add-point
              
      CASE
         WHEN SQLCA.SQLCODE #????
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = "sfanwf_t:",SQLERRMESSAGE 
            LET g_errparam.code = SQLCA.SQLCODE 
            LET g_errparam.popup = TRUE 
            CALL s_transaction_end('N','0')
            CALL cl_err()
            RETURN FALSE
         OTHERWISE
      END CASE
 
       
 
      #add-point:delete_b???? name="key_delete_b.after_delete5"

      #end add-point
   END IF
 
 
   
   RETURN TRUE
   
END FUNCTION

{</section>}

{<section id="bsft001_wf.lock_b" type="s" >}
#+ ??lock????table??
PRIVATE FUNCTION bsft001_wf_lock_b(ps_table,ps_page) RETURNS (INT)   #200213-00032
   #add-point:lock_b?define(???) name="lock_b.define_customerization"

   #end add-point   
   DEFINE ps_page     STRING
   DEFINE ps_table    STRING
   DEFINE ls_group    STRING
   #add-point:lock_b?define (?????????????????, ?????patch????????) name="lock_b.define"

   #end add-point   
   
   #add-point:Function????  name="lock_b.pre_function"

   #end add-point
    
   #?????
   #CALL bsft001_wf_b_fill()
   
   #????table
   #LET ls_group = "'1',"
   #?????table
   LET ls_group = "sfakwf_t"
   
   IF ls_group.getIndexOf(ps_table,1) THEN
      OPEN bsft001_wf_bcl USING g_enterprise, g_site,
                                       g_sfajwf_m.sfajwfdocno,g_sfakwf_d[g_detail_idx].sfakwfseq     
      IF SQLCA.SQLCODE THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "bsft001_wf_bcl:",SQLERRMESSAGE 
         LET g_errparam.code = SQLCA.SQLCODE 
         LET g_errparam.popup = TRUE 
         CALL cl_err()
         RETURN FALSE
      END IF
   END IF
                                    
   #????table
   #LET ls_group = "'4',"
   #?????table
   LET ls_group = "sfamwf_t"
   IF ls_group.getIndexOf(ps_table,1) THEN
   
      OPEN bsft001_wf_bcl2 USING g_enterprise,
                                             g_sfajwf_m.sfajwfdocno,g_sfakwf4_d[g_detail_idx].sfamwfseq
      IF SQLCA.SQLCODE THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "bsft001_wf_bcl2:",SQLERRMESSAGE 
         LET g_errparam.code = SQLCA.SQLCODE 
         LET g_errparam.popup = TRUE 
         CALL cl_err()
         RETURN FALSE
      END IF
   END IF
 
 
   
   #????table
   #LET ls_group = "'2',"
   #?????table
   LET ls_group = "sfbcwf_t"
   IF ls_group.getIndexOf(ps_table,1) THEN
   
      OPEN bsft001_wf_bcl3 USING g_enterprise, g_site,
                                             g_sfajwf_m.sfajwfdocno,g_sfakwf_d[g_detail_idx].sfakwfseq,
                                             g_sfakwf2_d[g_detail_idx2].sfbcwfseq1,g_sfakwf2_d[g_detail_idx2].sfbcwfseq2
      IF SQLCA.SQLCODE THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "bsft001_wf_bcl3:",SQLERRMESSAGE 
         LET g_errparam.code = SQLCA.SQLCODE 
         LET g_errparam.popup = TRUE 
         CALL cl_err()
         RETURN FALSE
      END IF
   END IF
 
   #????table
   #LET ls_group = "'3',"
   #?????table
   LET ls_group = "wfapwf_t"
   IF ls_group.getIndexOf(ps_table,1) THEN
   
      OPEN bsft001_wf_bcl4 USING g_enterprise, g_site,
                                             g_sfajwf_m.sfajwfdocno,g_sfakwf_d[g_detail_idx].sfakwfseq,
                                             g_sfakwf3_d[g_detail_idx2].wfapwfseq1
      IF SQLCA.SQLCODE THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "bsft001_wf_bcl4:",SQLERRMESSAGE 
         LET g_errparam.code = SQLCA.SQLCODE 
         LET g_errparam.popup = TRUE 
         CALL cl_err()
         RETURN FALSE
      END IF
   END IF
 
   #????table
   #LET ls_group = "'5',"
   #?????table
   LET ls_group = "sfanwf_t"
   IF ls_group.getIndexOf(ps_table,1) THEN
   
      OPEN bsft001_wf_bcl5 USING g_enterprise, g_site,
                                             g_sfajwf_m.sfajwfdocno,g_sfakwf_d[g_detail_idx].sfakwfseq,
                                             g_sfakwf5_d[g_detail_idx2].sfanwfseq
      IF SQLCA.SQLCODE THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "bsft001_wf_bcl5:",SQLERRMESSAGE 
         LET g_errparam.code = SQLCA.SQLCODE 
         LET g_errparam.popup = TRUE 
         CALL cl_err()
         RETURN FALSE
      END IF
   END IF
 
 
   
   #add-point:lock_b?other name="lock_b.other"

   #end add-point  
   
   RETURN TRUE
 
END FUNCTION

{</section>}

{<section id="bsft001_wf.unlock_b" type="s" >}
#+ ??unlock????table??
PRIVATE FUNCTION bsft001_wf_unlock_b(ps_table,ps_page) RETURNS ()   #200213-00032
   #add-point:unlock_b?define(???) name="unlock_b.define_customerization"

   #end add-point  
   DEFINE ps_page     STRING
   DEFINE ps_table    STRING
   DEFINE ls_group    STRING
   #add-point:unlock_b?define (?????????????????, ?????patch????????) name="unlock_b.define"

   #end add-point  
   
   #add-point:Function????  name="unlock_b.pre_function"

   #end add-point
    
   LET ls_group = "'1',"
   
   IF ls_group.getIndexOf(ps_page,1) THEN
      CLOSE bsft001_wf_bcl
   END IF
   
   LET ls_group = "'4',"
   
   IF ls_group.getIndexOf(ps_page,1) THEN
      CLOSE bsft001_wf_bcl2
   END IF
 
 
   
   LET ls_group = "'2',"
   
   IF ls_group.getIndexOf(ps_page,1) THEN
      CLOSE bsft001_wf_bcl3
   END IF
 
   LET ls_group = "'3',"
   
   IF ls_group.getIndexOf(ps_page,1) THEN
      CLOSE bsft001_wf_bcl4
   END IF
 
   LET ls_group = "'5',"
   
   IF ls_group.getIndexOf(ps_page,1) THEN
      CLOSE bsft001_wf_bcl5
   END IF
 
 
 
   #add-point:unlock_b?other name="unlock_b.other"

   #end add-point  
 
END FUNCTION

{</section>}

{<section id="bsft001_wf.set_entry" type="s" >}
#+ ????????
PRIVATE FUNCTION bsft001_wf_set_entry(p_cmd) RETURNS ()   #200213-00032
   #add-point:set_entry?define(???) name="set_entry.define_customerization"

   #end add-point       
   DEFINE p_cmd   LIKE type_t.chr1  
   #add-point:set_entry?define (?????????????????, ?????patch????????) name="set_entry.define"
   DEFINE l_fields     STRING
   #end add-point       
   
   #add-point:Function????  name="set_entry.pre_function"

   #end add-point
   
   CALL cl_set_comp_entry("sfajwfdocno",TRUE)
   
   IF p_cmd = 'a' THEN
      CALL cl_set_comp_entry("sfajwfdocno",TRUE)
      CALL cl_set_comp_entry("sfajwfdocdt",TRUE)
      #??azzi850???????????
      IF NOT cl_null(g_no_entry) THEN
         CALL cl_set_comp_entry(g_no_entry,TRUE)
      END IF
      #add-point:set_entry????? name="set_entry.field_control"

      #end add-point  
   END IF
   
   #add-point:set_entry?????? name="set_entry.after_control"
   CALL cl_set_comp_entry("sfajwf003,sfajwf004",TRUE)
   #??????aooi200????????????????
   IF NOT cl_null(g_sfajwf_m.sfajwfdocno) THEN
      LET l_fields = ''
      CALL s_aooi200_get_doc_fields(g_site,'1',g_sfajwf_m.sfajwfdocno) RETURNING l_fields
      CALL cl_set_comp_entry(l_fields,TRUE)
   END IF
   CALL cl_set_comp_entry("sfajwf017,sfajwf018,l_sfajwf018",TRUE) #240201-00005#1 add
   CALL cl_set_comp_entry("sfajwf022,sfajwf023,sfajwf005",TRUE) #240325-00027#1 add
   CALL cl_set_comp_entry("sfajwf025",TRUE)  #250328-00010#1 add
   #end add-point 
 
END FUNCTION

{</section>}

{<section id="bsft001_wf.set_no_entry" type="s" >}
#+ ????????
PRIVATE FUNCTION bsft001_wf_set_no_entry(p_cmd) RETURNS ()   #200213-00032
   #add-point:set_no_entry?define(???) name="set_no_entry.define_customerization"

   #end add-point     
   DEFINE p_cmd   LIKE type_t.chr1   
   #add-point:set_no_entry?define (?????????????????, ?????patch????????) name="set_no_entry.define"
   DEFINE l_n   LIKE type_t.num5
   DEFINE l_fields     STRING   
   #end add-point     
   
   #add-point:Function????  name="set_no_entry.pre_function"

   #end add-point
   
   IF p_cmd = 'u' AND g_chkey = 'N' THEN
      CALL cl_set_comp_entry("sfajwfdocno",FALSE)
      #??azzi850???????????
      IF NOT cl_null(g_no_entry) THEN
         CALL cl_set_comp_entry(g_no_entry,FALSE)
      END IF
      #add-point:set_no_entry????? name="set_no_entry.field_control"

      #end add-point 
   END IF 
   
   IF p_cmd = 'u' THEN  #docno,ld?????????
      CALL cl_set_comp_entry("sfajwfdocno",FALSE)
   END IF 
 
#  IF p_cmd = 'u' THEN  #docdt????????(FALSE?????????) #(ver:78)
      IF NOT cl_chk_update_docdt() THEN
         CALL cl_set_comp_entry("sfajwfdocdt",FALSE)
      END IF
#  END IF 
   
   #add-point:set_no_entry?????? name="set_no_entry.after_control"
   #?????????????????????????????
   LET l_n = 0
   SELECT COUNT(1) INTO l_n
     FROM sfakwf_t 
    WHERE sfakwfent = g_enterprise AND sfakwfsite = g_site AND sfakwfdocno = g_sfajwf_m.sfajwfdocno
   IF l_n > 0 THEN   
      CALL cl_set_comp_entry("sfajwf003,sfajwf004",FALSE)
      CALL cl_set_comp_entry("sfajwf017,sfajwf018,l_sfajwf018",FALSE) #240201-00005#1 add
   END IF
   #??????aooi200????????????????
   IF NOT cl_null(g_sfajwf_m.sfajwfdocno) THEN
      LET l_fields = ''
      CALL s_aooi200_get_doc_fields(g_site,'1',g_sfajwf_m.sfajwfdocno) RETURNING l_fields
      CALL cl_set_comp_entry(l_fields,FALSE)
   END IF
   
   #240201-00005#1 add--s 
   IF g_sfajwf_m.sfajwf017 IS NULL THEN                                   
      CALL cl_set_comp_entry("sfajwf018,l_sfajwf018",FALSE)
   END IF
   #240201-00005#1 add--e
   #240325-00027#1 add--s
   IF g_sfajwf_m.sfajwf005 = '2' AND g_sfajwf_m.sfajwf013 <> '3' AND g_sfajwf_m.sfajwf003 MATCHES '[12]' THEN                                   
   ELSE   
      CALL cl_set_comp_entry("sfajwf022,sfajwf023",FALSE)
   END IF
   #240325-00027#1 add--e 
   #240530-00021#1 add---s
   IF cl_get_doc_para(g_enterprise,g_site,g_sfajwf_m.sfajwfdocno,'D-BWF-0004') = 'Y' THEN
      CALL cl_set_comp_entry("sfajwf005",FALSE)
   END IF 
   #240530-00021#1 add---e   
   #end add-point 
 
END FUNCTION

{</section>}

{<section id="bsft001_wf.set_entry_b" type="s" >}
#+ ????????
PRIVATE FUNCTION bsft001_wf_set_entry_b(p_cmd) RETURNS ()   #200213-00032
   #add-point:set_entry_b?define(???) name="set_entry_b.define_customerization"

   #end add-point     
   DEFINE p_cmd   LIKE type_t.chr1   
   #add-point:set_entry_b?define (?????????????????, ?????patch????????) name="set_entry_b.define"
   DEFINE l_imaf055    LIKE imaf_t.imaf055
   DEFINE l_imaf061    LIKE imaf_t.imaf061 
   #end add-point     
   
   #add-point:Function????  name="set_entry_b.pre_function"

   #end add-point
    
   IF p_cmd = 'a' THEN
      CALL cl_set_comp_entry("",TRUE)
      #add-point:set_entry????? name="set_entry_b.field_control"

      #end add-point  
   END IF
   
   #add-point:set_entry_b? name="set_entry_b.set_entry_b"
   LET g_sfbcwf019_switch = 'Y'   #??        ???? Y??? N????
   LET g_sfbcwf020_switch = 'Y'   #??        ???? Y??? N????
   LET g_sfbcwf029_switch = 'Y'   #??        ???? Y??? N????
   LET g_sfbcwf030_switch = 'Y'   #?????? ???? Y??? N????
   IF g_sfajwf_m.sfajwf013 = '2' THEN
      CALL cl_set_comp_entry("sfakwf008",TRUE)
#      CALL cl_set_comp_required("sfakwf008",TRUE) #241104-00004#1 mark
   END IF
   CALL cl_set_comp_entry("sfakwf006,sfakwf036,sfakwf001",TRUE)
#   CALL cl_set_comp_required("sfakwfseq,sfakwf001,sfakwf008",TRUE)  #241104-00004#1 mark
   CALL cl_set_comp_required("sfakwfseq,sfakwf001",TRUE)  #241104-00004#1 add
   CALL cl_set_comp_entry('sfbcwf009',TRUE)
   CALL cl_set_comp_entry("sfbcwf010,sfbcwf011",TRUE)
   CALL cl_set_comp_entry('sfbcwf023,sfbcwf024',TRUE)
   CALL cl_set_comp_entry("sfbcwf020",TRUE)    #160726-00001#11 add
   CALL cl_set_comp_entry("sfbcwf029,sfbcwf030",TRUE)
#   CALL cl_set_comp_entry("wfapwf019,wfapwf020,wfapwf021,wfapwf022,wfapwf023",TRUE)
   CALL cl_set_comp_entry("sfakwf049",TRUE) #250328-00010#1 add
   #end add-point  
END FUNCTION

{</section>}

{<section id="bsft001_wf.set_no_entry_b" type="s" >}
#+ ????????
PRIVATE FUNCTION bsft001_wf_set_no_entry_b(p_cmd) RETURNS ()   #200213-00032
   #add-point:set_no_entry_b?define(???) name="set_no_entry_b.define_customerization"

   #end add-point    
   DEFINE p_cmd   LIKE type_t.chr1   
   #add-point:set_no_entry_b?define (?????????????????, ?????patch????????) name="set_no_entry_b.define"
   DEFINE l_ooba002         LIKE ooba_t.ooba002
   DEFINE l_inaa007         LIKE inaa_t.inaa007
   DEFINE l_imaf055          LIKE imaf_t.imaf055
   DEFINE l_imaf061          LIKE imaf_t.imaf061
   DEFINE l_success         LIKE type_t.num5
   DEFINE l_imaf015  LIKE imaf_t.imaf015  #????
   DEFINE l_fields     STRING    #250328-00010#1 add
   #end add-point    
   
   #add-point:Function????  name="set_no_entry_b.pre_function"
   DEFINE l_n               LIKE type_t.num5    #250114-00001#1 add
   #end add-point
   
   IF p_cmd = 'u' AND g_chkey = 'N' THEN
      CALL cl_set_comp_entry("",FALSE)
      #add-point:set_no_entry_b????? name="set_no_entry_b.field_control"

      #end add-point 
   END IF 
   
   #add-point:set_no_entry_b? name="set_no_entry_b.set_no_entry_b"
   CALL s_aooi200_get_slip(g_sfajwf_m.sfajwfdocno) RETURNING l_success,l_ooba002
   #?????? ??????
   IF g_sfajwf_m.sfajwf003 = '1' THEN  #170922-00027#1
      CASE g_sfakwf2_d[l_ac].sfbcwf008
         WHEN '1'  #????
            #????????????
            IF cl_get_doc_para(g_enterprise,g_site,l_ooba002,'D-MFG-0034') = 'N' THEN
               CALL cl_set_comp_entry("sfbcwf023,sfbcwf024",FALSE) #161213-00010#1 add sfbcwf023
            ELSE
               CALL cl_set_comp_entry("sfbcwf023",FALSE)         #161213-00010#1 add ???????????????    
            END IF
         WHEN '2'  #????
            #??????????????????
            IF cl_get_doc_para(g_enterprise,g_site,l_ooba002,'D-MFG-0035') = 'N' THEN
               CALL cl_set_comp_entry("sfbcwf023,sfbcwf024",FALSE)
            END IF
         WHEN '3'  #????
            #???????
            IF cl_get_doc_para(g_enterprise,g_site,l_ooba002,'D-MFG-0036') = 'N' THEN
               CALL cl_set_comp_entry("sfbcwf023,sfbcwf024",FALSE)
            END IF
         WHEN '4'  #????
      END CASE
   END IF  #170922-00027#1
   
   #????????????????????????sfbcwf030
   IF NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf006) THEN
      SELECT imaf055,imaf015,imaf061        #160519-00022#18 add imaf061
        INTO l_imaf055,l_imaf015,l_imaf061  #??????,???? #160519-00022#18 add imaf061
        FROM imaf_t
       WHERE imafent  = g_enterprise
         AND imafsite = g_site
         AND imaf001  = g_sfakwf2_d[l_ac].sfbcwf006
      IF l_imaf055 = '2' THEN
         CALL cl_set_comp_required("sfbcwf030",FALSE)   #160519-00008#18
         CALL cl_set_comp_entry("sfbcwf030",FALSE)
         LET g_sfbcwf030_switch = 'N'   #???? Y??? N????
      END IF
      #???????????????????????????    
      CASE l_imaf061
         WHEN '1'  #?????
            CALL cl_set_comp_required("sfbcwf029",FALSE)    #200606-00013#3 add
         WHEN '2'  #?????
            CALL cl_set_comp_entry("sfbcwf029",FALSE)
      END CASE        
     #160519-00022#18-e-add
   END IF
   
   #250319-00001#1 mark--s
#   IF g_sfakwf2_d[l_ac].sfbcwfseq2 != 0 THEN #210701-00004#1 add
#       CALL cl_set_comp_entry("sfbcwf023,sfbcwf024",FALSE)
#   END IF
   #250319-00001#1 mark--e
   
   IF g_sfajwf_m.sfajwf013 = '2' THEN
   ELSE
      CALL cl_set_comp_entry("sfakwf008",FALSE)
      CALL cl_set_comp_required("sfakwf008",FALSE)
   END IF
   #?????3????????????
   #240423-00009#2 --mark--s 
   #????????
#   IF g_sfajwf_m.sfajwf013 <> '3' THEN
#      CALL cl_set_comp_entry("sfakwf006",FALSE)
#   END IF
   #240201-00005#1 add--s
   IF NOT cl_null(g_sfajwf_m.sfajwf017) AND NOT cl_null(g_sfajwf_m.sfajwf018) AND NOT cl_null(g_sfajwf_m.sfajwf019) AND NOT cl_null(g_sfajwf_m.sfajwf020) AND NOT cl_null(g_sfajwf_m.sfajwf021) THEN
      CALL cl_set_comp_entry("sfakwf001",FALSE)
   END IF   
   #240201-00005#1 add--e
   #250114-00001#1 add--s
   SELECT COUNT(1) INTO l_n FROM sfbcwf_t 
    WHERE sfbcwfent = g_enterprise
      AND sfbcwfsite = g_site AND sfbcwfdocno = g_sfajwf_m.sfajwfdocno AND sfbcwfseq = g_sfakwf_d[g_detail_idx].sfakwfseq    
   IF l_n > 0 THEN
      CALL cl_set_comp_entry("sfakwf001",FALSE)
   END IF   
   #250114-00001#1 add--e
   
   CALL cl_set_comp_entry('sfbcwf035',FALSE)
   
   #?[T:?????].[C:????]='5'(???????)???[C:????]?????
   SELECT inaa007 INTO l_inaa007 
     FROM inaa_t 
    WHERE inaaent = g_enterprise 
      AND inaasite = g_site 
      AND inaa001 = g_sfakwf2_d[l_ac].sfbcwf019
   IF l_inaa007 = '5' THEN
      CALL cl_set_comp_entry("sfbcwf020",FALSE)  #??????
   END IF 
   
   #?????Y???????0?????
   IF g_sfajwf_m.sfajwf015 = 'Y' THEN
      CALL cl_set_comp_entry("sfakwf036",FALSE)
   END IF
   CALL cl_set_comp_entry("sfbcwf022",FALSE)
   
   #???
   IF g_sfajwf_m.sfajwf004 = '2' THEN
      CALL cl_set_comp_entry('sfbcwf009',FALSE)
   END IF
   IF NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf001) OR g_sfakwf2_d[l_ac].sfbcwfseq2 != 0 THEN
      CALL cl_set_comp_entry("sfbcwf010,sfbcwf011",FALSE)
   END IF
   
   #??????,??
   CALL s_axmt540_get_imaf(g_sfakwf2_d[l_ac].sfbcwf006) RETURNING l_imaf055,l_imaf061
   #160519-00008#17--(S)
   IF l_imaf055 <> '1' THEN
      CALL cl_set_comp_required("sfbcwf030",FALSE) 
   END IF
   CASE l_imaf055
      WHEN '1'  #?????????
        #CALL cl_set_comp_required("sfbcwf030",TRUE)  #160519-00022#17 mark
         #160519-00008#17--(S)
         IF g_sfakwf2_d[l_ac].sfbcwf030 = ' ' THEN
            LET g_sfakwf2_d[l_ac].sfbcwf030 = ''
         END IF
         #160519-00008#17--(E)
      WHEN '2'  #?????????
         CALL cl_set_comp_entry("sfbcwf030",FALSE)
   END CASE
   CASE l_imaf061
      WHEN '1'  #?????
        #CALL cl_set_comp_required("sfbcwf029",TRUE)  #160519-00022#17 mark
      WHEN '2'  #?????
         CALL cl_set_comp_entry("sfbcwf029",FALSE)
   END CASE
   CALL cl_set_comp_entry("wfapwfseq1,wfapwf001,wfapwf002,wfapwf003,wfapwf004,wfapwf005,wfapwf006,wfapwf007,wfapwf008,
                           wfapwf009,wfapwf010,wfapwf011,wfapwf012,wfapwf013,wfapwf014,wfapwf015,wfapwf016,wfapwf017,wfapwf018",FALSE)
   #250328-00010#1 add--s
   IF NOT cl_null(g_sfajwf_m.sfajwfdocno) THEN
      LET l_fields = ''
      CALL s_aooi200_get_doc_fields(g_site,'1',g_sfajwf_m.sfajwfdocno) RETURNING l_fields
      IF l_fields.getIndexOf("sfajwf025",1) > 0  THEN
         CALL cl_set_comp_entry("sfakwf049",FALSE)
      END IF      
   END IF
   #250328-00010#1 add--e
   #end add-point     
END FUNCTION

{</section>}

{<section id="bsft001_wf.set_act_visible" type="s" >}
#+ ??????
PRIVATE FUNCTION bsft001_wf_set_act_visible() RETURNS ()   #200213-00032
   #add-point:set_act_visible?define(???) name="set_act_visible.define_customerization"

   #end add-point   
   #add-point:set_act_visible?define (?????????????????, ?????patch????????) name="set_act_visible.define"
   CALL cl_set_toolbaritem_visible("turnkey",TRUE)
   CALL cl_set_act_visible("turnkey",TRUE)
   CALL cl_set_comp_visible("page_4",TRUE)
   #end add-point   
   #add-point:set_act_visible? name="set_act_visible.set_act_visible"
  
   #end add-point   
END FUNCTION

{</section>}

{<section id="bsft001_wf.set_act_no_visible" type="s" >}
#+ ??????
PRIVATE FUNCTION bsft001_wf_set_act_no_visible() RETURNS ()   #200213-00032
   #add-point:set_act_no_visible?define(???) name="set_act_no_visible.define_customerization"

   #end add-point   
   #add-point:set_act_no_visible?define (?????????????????, ?????patch????????) name="set_act_no_visible.define"
   DEFINE l_success        LIKE type_t.num5
   #end add-point   
   #add-point:set_act_no_visible? name="set_act_no_visible.set_act_no_visible"
   #?? a63 ??????(Version:2)
   IF g_sfajwf_m.sfajwfstus NOT MATCHES "[NDR]" THEN   # N???/D??/R???????
      CALL cl_set_act_visible("modify,delete,modify_detail", FALSE)
   END IF
   
   IF g_sfajwf_m.sfajwfstus <> "Y" THEN   
      CALL cl_set_act_visible("turnkey", FALSE)
      CALL cl_set_toolbaritem_visible("turnkey",FALSE)
   END IF
   IF NOT cl_null(g_sfajwf_m.sfajwfdocno) THEN
       CALL s_aooi200_get_slip(g_sfajwf_m.sfajwfdocno) RETURNING l_success,g_ooba002
       IF cl_get_doc_para(g_enterprise,g_site,g_ooba002,'D-BWF-0004') = 'N' THEN
          CALL cl_set_comp_visible("page_4",FALSE)
       END IF
    ELSE
       CALL cl_set_comp_visible("page_4",FALSE)
    END IF 

   #end add-point   
END FUNCTION

{</section>}

{<section id="bsft001_wf.set_act_visible_b" type="s" >}
#+ ??????
PRIVATE FUNCTION bsft001_wf_set_act_visible_b() RETURNS ()   #200213-00032
   #add-point:set_act_visible_b?define(???) name="set_act_visible_b.define_customerization"

   #end add-point   
   #add-point:set_act_visible_b?define (?????????????????, ?????patch????????) name="set_act_visible_b.define"
   
   #end add-point   
   #add-point:set_act_visible_b? name="set_act_visible_b.set_act_visible_b"

   #end add-point   
END FUNCTION

{</section>}

{<section id="bsft001_wf.set_act_no_visible_b" type="s" >}
#+ ??????
PRIVATE FUNCTION bsft001_wf_set_act_no_visible_b() RETURNS ()   #200213-00032
   #add-point:set_act_no_visible_b?define(???) name="set_act_no_visible_b.define_customerization"

   #end add-point   
   #add-point:set_act_no_visible_b?define (?????????????????, ?????patch????????) name="set_act_no_visible_b.define"
   IF g_sfajwf_m.sfajwfstus NOT MATCHES "[NDR]" THEN   # N???/D??/R???????
      CALL cl_set_act_visible("modify,delete,modify_detail", FALSE)
   END IF

   #end add-point   
   #add-point:set_act_no_visible_b? name="set_act_no_visible_b.set_act_no_visible_b"
   
   #end add-point   
END FUNCTION

{</section>}

{<section id="bsft001_wf.default_search" type="s" >}
#+ ??????
PRIVATE FUNCTION bsft001_wf_default_search() RETURNS ()   #200213-00032
   #add-point:default_search?define(???) name="default_search.define_customerization"

   #end add-point  
   DEFINE li_idx     LIKE type_t.num10
   DEFINE li_cnt     LIKE type_t.num10
   DEFINE ls_wc      STRING
   DEFINE la_wc      DYNAMIC ARRAY OF RECORD
          tableid    STRING,
          wc         STRING
          END RECORD
   DEFINE ls_where   STRING
   #add-point:default_search?define(?????????????????, ?????patch????????) name="default_search.define"

   #end add-point  
   
   #add-point:Function???? name="default_search.before"

   #end add-point  
   
   LET g_pagestart = 1
   
   IF cl_null(g_order) THEN
      LET g_order = "ASC"
   END IF
   
   IF NOT cl_null(g_argv[01]) THEN
      LET ls_wc = ls_wc, " sfajwfdocno = '", g_argv[01], "' AND "
   END IF
   
 
   
   #add-point:default_search?after sql name="default_search.after_sql"

   #end add-point  
   
   #200330-00044 ---start---
   IF NOT cl_null(g_default_wc) THEN
      LET g_wc = g_default_wc
      LET g_default = TRUE
   ELSE
   #200330-00044 --- end ---
      IF NOT cl_null(ls_wc) THEN
         LET g_wc = ls_wc.subString(1,ls_wc.getLength()-5)
         LET g_default = TRUE
      ELSE
         #??????????1=2
         LET g_default = FALSE
         
         #??????
         CALL cl_qbe_get_default_qryplan() RETURNING ls_where
         IF NOT cl_null(ls_where) THEN
            CALL util.JSON.parse(ls_where, la_wc)
            INITIALIZE g_wc, g_wc2,g_wc2_table1,g_wc2_extend TO NULL
            LET g_wc2_extend = " 1=1" #190730-00003#4 add
            INITIALIZE g_wc2_table2 TO NULL
 
 
            FOR li_idx = 1 TO la_wc.getLength()
               CASE
                  WHEN la_wc[li_idx].tableid = "sfajwf_t" 
                     LET g_wc = la_wc[li_idx].wc
                  WHEN la_wc[li_idx].tableid = "sfakwf_t" 
                     LET g_wc2_table1 = la_wc[li_idx].wc
                  WHEN la_wc[li_idx].tableid = "sfamwf_t" 
                     LET g_wc2_table2 = la_wc[li_idx].wc
 
 
                  WHEN la_wc[li_idx].tableid = "EXTENDWC"
                     LET g_wc2_extend = la_wc[li_idx].wc
               END CASE
            END FOR
            IF NOT cl_null(g_wc) OR NOT cl_null(g_wc2_table1) 
               OR NOT cl_null(g_wc2_table2)
 
 
               OR NOT cl_null(g_wc2_extend)
               THEN
               #??g_wc2
               IF g_wc2_table1 <> " 1=1" AND NOT cl_null(g_wc2_table1) THEN
                  LET g_wc2 = g_wc2_table1
               END IF
               IF g_wc2_table2 <> " 1=1" AND NOT cl_null(g_wc2_table2)
                                                AND NOT g_wc2.getIndexOf(g_wc2_table2,1) THEN   #200828-00027?????,??g_wc2???? (???)
                  LET g_wc2 = g_wc2 ," AND ", g_wc2_table2   #200917-00047
               END IF
 
 
               IF g_wc2_extend <> " 1=1" AND NOT cl_null(g_wc2_extend)
                                         AND NOT g_wc2.getIndexOf(g_wc2_extend,1) THEN   #200828-00027?????,??g_wc2???? (???)
                  LET g_wc2 = g_wc2 ," AND ", g_wc2_extend   #200917-00047
               END IF
            
               IF g_wc2.subString(1,5) = " AND " THEN
                  LET g_wc2 = g_wc2.subString(6,g_wc2.getLength())
               END IF
            END IF
         END IF
       
         IF cl_null(g_wc) AND cl_null(g_wc2) THEN
            LET g_wc = " 1=2"
         END IF
      END IF
   END IF   #200330-00044
   
   #add-point:default_search???? name="default_search.after"

   #end add-point  
 
   #181128-00048 ---start---
   #????????,???????
   IF NOT cl_null(g_default_wc) THEN
      LET g_wc = g_default_wc
   END IF
   #181128-00048 --- end ---
 
   IF g_wc.getIndexOf(" 1=2", 1) THEN
      LET g_default = TRUE
   END IF
 
END FUNCTION

{</section>}

{<section id="bsft001_wf.state_change" type="s" >}
   #?? a09 ??????(Version:25)
#+ ????? 
PRIVATE FUNCTION bsft001_wf_statechange() RETURNS ()   #200213-00032
   #add-point:statechange?define(???) name="statechange.define_customerization"

   #end add-point  
   DEFINE lc_state LIKE type_t.chr5
   #add-point:statechange?define(?????????????????, ?????patch????????) name="statechange.define"
   DEFINE l_cnt LIKE type_t.num5
   DEFINE l_success    LIKE type_t.num5
   DEFINE l_sfbcwfseq  LIKE sfbcwf_t.sfbcwfseq 
   DEFINE l_sfbcwfseq1 LIKE sfbcwf_t.sfbcwfseq1
   DEFINE l_sfbcwfseq2 LIKE sfbcwf_t.sfbcwfseq2
   #end add-point  
   
   #add-point:Function???? name="statechange.before"

   #end add-point  
   
   ERROR ""     #???????ERROR??
 
   #180130-00006 ---start---
   #??????
   LET g_sfajwf_m_t.* = g_sfajwf_m.*
   LET g_sfajwf_m_o.* = g_sfajwf_m.*
   #180130-00006 --- end ---
 
   IF g_sfajwf_m.sfajwfdocno IS NULL
 
   THEN
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = "" 
      LET g_errparam.code   = "std-00003" 
      LET g_errparam.popup = FALSE 
      CALL cl_err()
      RETURN
   END IF
 
   CALL s_transaction_begin()
   
   OPEN bsft001_wf_cl USING g_enterprise, g_site,g_sfajwf_m.sfajwfdocno
   IF SQLCA.SQLCODE THEN
   #  CLOSE bsft001_wf_cl
   #  CALL s_transaction_end('N','0')   #(ver:19)
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = "OPEN bsft001_wf_cl:",SQLERRMESSAGE
      LET g_errparam.code   = SQLCA.SQLCODE
      LET g_errparam.popup = TRUE 
      CLOSE bsft001_wf_cl
      CALL s_transaction_end('N','0')   #(ver:19)
      CALL cl_err()
      RETURN
   END IF
   
   #???????
   EXECUTE bsft001_wf_master_referesh USING g_site,g_sfajwf_m.sfajwfdocno INTO g_sfajwf_m.sfajwfdocno,g_sfajwf_m.sfajwfdocdt,g_sfajwf_m.sfajwf006,g_sfajwf_m.sfajwf007,g_sfajwf_m.sfajwf017,g_sfajwf_m.sfajwf019,g_sfajwf_m.sfajwf020,g_sfajwf_m.sfajwf021,g_sfajwf_m.sfajwf018,g_sfajwf_m.sfajwf022,g_sfajwf_m.sfajwf023, 
       g_sfajwf_m.sfajwf012,g_sfajwf_m.sfajwf013,g_sfajwf_m.sfajwf014,g_sfajwf_m.sfajwf001,g_sfajwf_m.sfajwf002,g_sfajwf_m.sfajwf025,g_sfajwf_m.sfajwf015,g_sfajwf_m.sfajwfua002,g_sfajwf_m.sfajwf016,g_sfajwf_m.sfajwfua003,g_sfajwf_m.sfajwf024,g_sfajwf_m.sfajwf003,g_sfajwf_m.sfajwf005,g_sfajwf_m.sfajwf004, 
       g_sfajwf_m.sfajwf008,g_sfajwf_m.sfajwf009,g_sfajwf_m.sfajwf010,g_sfajwf_m.sfajwf011,g_sfajwf_m.sfajwfua011,g_sfajwf_m.sfajwfua012,g_sfajwf_m.sfajwfua013,g_sfajwf_m.sfajwfua014,g_sfajwf_m.sfajwfua015,g_sfajwf_m.sfajwfstus,g_sfajwf_m.sfajwfownid,g_sfajwf_m.sfajwfowndp,g_sfajwf_m.sfajwfcrtid,g_sfajwf_m.sfajwfcrtdp, 
       g_sfajwf_m.sfajwfcrtdt,g_sfajwf_m.sfajwfmodid,g_sfajwf_m.sfajwfmoddt,g_sfajwf_m.sfajwfcnfid,g_sfajwf_m.sfajwfcnfdt,g_sfajwf_m.sfajwf006_desc,g_sfajwf_m.sfajwf007_desc,g_sfajwf_m.sfajwf023_desc,g_sfajwf_m.sfajwf012_desc,g_sfajwf_m.sfajwf001_desc,g_sfajwf_m.sfajwf002_desc,g_sfajwf_m.sfajwf025_desc, 
       g_sfajwf_m.sfajwf008_desc,g_sfajwf_m.sfajwf009_desc,g_sfajwf_m.sfajwf010_desc,g_sfajwf_m.sfajwf011_desc,g_sfajwf_m.sfajwfownid_desc,g_sfajwf_m.sfajwfowndp_desc,g_sfajwf_m.sfajwfcrtid_desc,g_sfajwf_m.sfajwfcrtdp_desc,g_sfajwf_m.sfajwfmodid_desc,g_sfajwf_m.sfajwfcnfid_desc
   
 
   #?????????
   IF NOT bsft001_wf_action_chk() THEN
      CLOSE bsft001_wf_cl
      CALL s_transaction_end('N','0')
      RETURN
   END IF
 
   #?????????
   DISPLAY BY NAME g_sfajwf_m.sfajwfdocno,g_sfajwf_m.oobal004,g_sfajwf_m.sfajwfdocdt,g_sfajwf_m.sfajwf006,g_sfajwf_m.sfajwf006_desc,g_sfajwf_m.sfajwf007,g_sfajwf_m.sfajwf007_desc,g_sfajwf_m.sfajwf017,g_sfajwf_m.sfajwf019,g_sfajwf_m.sfajwf020,g_sfajwf_m.sfajwf021,g_sfajwf_m.sfajwf018,g_sfajwf_m.l_sfajwf018, 
       g_sfajwf_m.sfajwf022,g_sfajwf_m.sfajwf023,g_sfajwf_m.sfajwf023_desc,g_sfajwf_m.sfajwf012,g_sfajwf_m.sfajwf012_desc,g_sfajwf_m.sfajwf013,g_sfajwf_m.sfajwf014,g_sfajwf_m.sfajwf001,g_sfajwf_m.sfajwf001_desc,g_sfajwf_m.sfajwf002,g_sfajwf_m.sfajwf002_desc,g_sfajwf_m.sfajwf025,g_sfajwf_m.sfajwf025_desc, 
       g_sfajwf_m.sfajwf015,g_sfajwf_m.sfajwfua002,g_sfajwf_m.sfajwf016,g_sfajwf_m.sfajwfua003,g_sfajwf_m.sfajwf024,g_sfajwf_m.sfajwf003,g_sfajwf_m.sfajwf005,g_sfajwf_m.sfajwf004,g_sfajwf_m.sfajwf008,g_sfajwf_m.sfajwf008_desc,g_sfajwf_m.sfajwf009,g_sfajwf_m.sfajwf009_desc,g_sfajwf_m.sfajwf010,g_sfajwf_m.sfajwf010_desc, 
       g_sfajwf_m.sfajwf011,g_sfajwf_m.sfajwf011_desc,g_sfajwf_m.sfajwfua011,g_sfajwf_m.sfajwfua012,g_sfajwf_m.sfajwfua013,g_sfajwf_m.sfajwfua014,g_sfajwf_m.sfajwfua015,g_sfajwf_m.sfajwfstus,g_sfajwf_m.sfajwfownid,g_sfajwf_m.sfajwfownid_desc,g_sfajwf_m.sfajwfowndp,g_sfajwf_m.sfajwfowndp_desc,g_sfajwf_m.sfajwfcrtid, 
       g_sfajwf_m.sfajwfcrtid_desc,g_sfajwf_m.sfajwfcrtdp,g_sfajwf_m.sfajwfcrtdp_desc,g_sfajwf_m.sfajwfcrtdt,g_sfajwf_m.sfajwfmodid,g_sfajwf_m.sfajwfmodid_desc,g_sfajwf_m.sfajwfmoddt,g_sfajwf_m.sfajwfcnfid,g_sfajwf_m.sfajwfcnfid_desc,g_sfajwf_m.sfajwfcnfdt
 
   CASE g_sfajwf_m.sfajwfstus
      WHEN "A"
         CALL gfrm_curr.setElementImage("statechange", "stus/32/approved.png")
      WHEN "D"
         CALL gfrm_curr.setElementImage("statechange", "stus/32/withdraw.png")
      WHEN "R"
         CALL gfrm_curr.setElementImage("statechange", "stus/32/rejection.png")
      WHEN "W"
         CALL gfrm_curr.setElementImage("statechange", "stus/32/signing.png")
      WHEN "N"
         CALL gfrm_curr.setElementImage("statechange", "stus/32/unconfirmed.png")
      WHEN "Y"
         CALL gfrm_curr.setElementImage("statechange", "stus/32/confirmed.png")
      WHEN "F"
         CALL gfrm_curr.setElementImage("statechange", "stus/32/released.png")
      WHEN "U"
         CALL gfrm_curr.setElementImage("statechange", "stus/32/unreleased.png")
      WHEN "X"
         CALL gfrm_curr.setElementImage("statechange", "stus/32/invalid.png")
      
   END CASE
 
   #add-point:????? name="statechange.after_refresh"

   #end add-point
 
   MENU "" ATTRIBUTES (STYLE="popup")
      BEFORE MENU
         HIDE OPTION "approved"
         HIDE OPTION "rejection"
         CASE g_sfajwf_m.sfajwfstus
            
            WHEN "A"
               HIDE OPTION "approved"
            WHEN "D"
               HIDE OPTION "withdraw"
            WHEN "R"
               HIDE OPTION "rejection"
            WHEN "W"
               HIDE OPTION "signing"
            WHEN "N"
               HIDE OPTION "unconfirmed"
            WHEN "Y"
               HIDE OPTION "confirmed"
            WHEN "F"
               HIDE OPTION "released"
            WHEN "U"
               HIDE OPTION "unreleased"
            WHEN "X"
               HIDE OPTION "invalid"
         END CASE
     
         #181128-00048 ---start---
         #181211 SA????mark????
      #  #BPM??
      #  CALL cl_set_act_visible("reunconfirmed",FALSE)
      #  CASE g_sfajwf_m.sfajwfstus
      #      WHEN "A"
      #         CALL cl_set_act_visible("reunconfirmed",TRUE)
      #      WHEN "D"
      #         CALL cl_set_act_visible("reunconfirmed",TRUE)
      #      WHEN "R"
      #         CALL cl_set_act_visible("reunconfirmed",TRUE)
      #  END CASE
         #181128-00048 --- end ---
 
      #add-point:menu? name="statechange.before_menu"
      #230921-00006#7 add--s      
         CALL cl_set_act_visible("unconfirmed,unreleased,released,invalid,confirmed",TRUE)
      #??????
      CALL cl_set_act_visible("closed,costing_closed,closed_irregular",FALSE)
      #?????????????
      CALL cl_set_act_visible("signing,withdraw",FALSE)
      
      CASE g_sfajwf_m.sfajwfstus
         #?????????;?????????
         WHEN "A"
            CALL cl_set_act_visible("confirmed ",TRUE)
            CALL cl_set_act_visible("unconfirmed,invalid,unreleased,released",FALSE)
         WHEN "C"
            CALL cl_set_act_visible("unconfirmed,unreleased,released,invalid,confirmed",FALSE)
            CALL s_transaction_end('N','0')   #160907-00038#1 add
            RETURN                            #160907-00038#1 add
         WHEN "D"
            CALL cl_set_act_visible("unconfirmed,unreleased,released,confirmed",FALSE)
         WHEN "E"
         WHEN "F"
            CALL cl_set_act_visible("unconfirmed,released,invalid,confirmed",FALSE)
         WHEN "M"
         #191118-00022#1   add-S 13130
            CALL cl_set_act_visible("unconfirmed,unreleased,released,invalid,confirmed",FALSE)
            CALL s_transaction_end('N','0')
            RETURN
         #191118-00022#1   add-E 13130
         WHEN "N"
            CALL cl_set_act_visible("unconfirmed,released,unreleased",FALSE)
            #????BPM????????????????????
            IF cl_bpm_chk() THEN
               CALL cl_set_act_visible("signing",TRUE)
               CALL cl_set_act_visible("confirmed",FALSE)
            END IF
         #???????(???)?????????
         WHEN "R"
            CALL cl_set_act_visible("unconfirmed,unreleased,released,confirmed",FALSE)
         #?????????;?????????
         WHEN "W"
            CALL cl_set_act_visible("withdraw",TRUE)
            CALL cl_set_act_visible("unconfirmed,unreleased,released,invalid,confirmed",FALSE)
         WHEN "Y"
            CALL cl_set_act_visible("invalid,confirmed,unreleased",FALSE)
         WHEN "X"
            CALL cl_set_act_visible("unconfirmed,released,unreleased,invalid,confirmed",FALSE)
            CALL s_transaction_end('N','0')   #160907-00038#1 add
            RETURN                            #160907-00038#1 add
      END CASE
      #230921-00006#7 add--e
      #end add-point
      
      #?? a36 ??????(Version:6)
      #??
      ON ACTION signing
         IF cl_auth_chk_act("signing") THEN
            IF NOT bsft001_wf_send() THEN
               CALL s_transaction_end('N','0')
            ELSE
               CALL s_transaction_end('Y','0')
            END IF
            #??????, ??????????????
            #???????
            CLOSE bsft001_wf_cl
             RETURN
         END IF
    
      #??
      ON ACTION withdraw
         IF cl_auth_chk_act("withdraw") THEN
            IF NOT bsft001_wf_draw_out() THEN
               CALL s_transaction_end('N','0')
            ELSE
               CALL s_transaction_end('Y','0')
            END IF
            #??????, ??????????????
            #???????
            CLOSE bsft001_wf_cl
             RETURN
         END IF
 
      #181128-00048 ---start---
      #181211 SA????mark????
      #??????
   #  ON ACTION reunconfirmed
   #     IF cl_auth_chk_act("reunconfirmed") THEN
   #        LET lc_state = "N"
   #        IF g_sfajwf_m.sfajwfstus = "A" THEN   #????????log
   #           CALL cl_bpm_write_status_log("RN")   #??log
   #        END IF
   #        #add-point:action?? name="statechange.reunconfirmed"

   #        #end add-point
   #     END IF
   #     EXIT MENU
      #181128-00048 --- end ---
 
 
 
	  
      ON ACTION approved
         IF cl_auth_chk_act("approved") THEN
            LET lc_state = "A"
            #add-point:action?? name="statechange.approved"

            #end add-point
         END IF
         EXIT MENU
      #ON ACTION withdraw
      #   IF cl_auth_chk_act("withdraw") THEN
      #      LET lc_state = "D"
      #      #add-point:action?? name="statechange.withdraw"

      #      #end add-point
      #   END IF
      #   EXIT MENU
      ON ACTION rejection
         IF cl_auth_chk_act("rejection") THEN
            LET lc_state = "R"
            #add-point:action?? name="statechange.rejection"

            #end add-point
         END IF
         EXIT MENU
      #ON ACTION signing
      #   IF cl_auth_chk_act("signing") THEN
      #      LET lc_state = "W"
      #      #add-point:action?? name="statechange.signing"

      #      #end add-point
      #   END IF
      #   EXIT MENU
      ON ACTION unconfirmed
         IF cl_auth_chk_act("unconfirmed") THEN
            LET lc_state = "N"
            #add-point:action?? name="statechange.unconfirmed"
            IF g_sfajwf_m.sfajwfstus = 'Y' THEN
               CALL s_transaction_begin()   
               CALL cl_err_collect_init()  
               CALL s_bsft001_wf_unconfirmed_chk(g_sfajwf_m.sfajwfdocno)
                    RETURNING l_success
               CALL cl_err_collect_show()  
               CLOSE bsft001_wf_cl #190805-00038#1 add     
               IF NOT l_success THEN
                  CLOSE bsft001_wf_cl
                  CALL s_transaction_end('N',0)
                  CALL cl_err_collect_show()
                  RETURN
               ELSE
                  CALL s_transaction_end('Y',0)
                  CALL bsft001_wf_b_fill2('3')
                  CALL bsft001_wf_b_fill2('4')
               END IF
               CALL bsft001_wf_msgcentre_notify('statechange:'||lc_state)       #210928-00015#1 add
#               RETURN 
            ELSE
               #???????????????????????????'X.??'?'Y.???'
               IF g_sfajwf_m.sfajwfstus NOT MATCHES '[XY]' THEN
                  INITIALIZE g_errparam TO NULL
                  LET g_errparam.code = 'sub-00474'
                  LET g_errparam.extend = ''
                  LET g_errparam.popup = TRUE
                  CLOSE bsft001_wf_cl #190805-00038#1 add 
                  CALL s_transaction_end('N',0)   #160812-00017#4 20160815 add by beckxie
                  CALL cl_err_collect_show()
                  CALL cl_err()  #171006-00010#78 add
                  RETURN
               END IF
            END IF
         ELSE
            LET lc_state = ''
            #end add-point
         END IF
         EXIT MENU
      ON ACTION confirmed
         IF cl_auth_chk_act("confirmed") THEN
            LET lc_state = "Y"
            #add-point:action?? name="statechange.confirmed"
            IF g_sfajwf_m.sfajwfstus = 'N' THEN             
#               #1.???????????
#               IF g_sfakwf2_d.getLength() = 0 THEN
#                  INITIALIZE g_errparam TO NULL
#                  LET g_errparam.code = 'wf-00056'  #??????????????????
#                  LET g_errparam.extend = '' 
#                  LET g_errparam.popup = TRUE
#                  CLOSE bsft001_wf_cl 
#                  CALL cl_err() 
#                  RETURN
#               END IF
#               #2.???????????
#               CALL bsft001_wf_chk_sfbcwf013() RETURNING l_success  
#               IF NOT l_success THEN
#                  CLOSE bsft001_wf_cl 
#                  RETURN
#               END IF               
#               #3.????????????sfbcwf023*bmba012????/bmba011????
#               #4.??????????0
#               SELECT COUNT(1) INTO l_cnt FROM sfbcwf_t 
#                WHERE sfbcwfent = g_enterprise AND sfbcwfsite = g_site AND sfbcwfdocno = g_sfajwf_m.sfajwfdocno 
#                  AND sfbcwf013 = 0
#               IF l_cnt > 0 THEN
#                  SELECT sfbcwfseq,sfbcwfseq1,sfbcwfseq2 INTO l_sfbcwfseq,l_sfbcwfseq1,l_sfbcwfseq2 FROM sfbcwf_t 
#                   WHERE sfbcwfent = g_enterprise AND sfbcwfsite = g_site AND sfbcwfdocno = g_sfajwf_m.sfajwfdocno 
#                     AND sfbcwf013 = 0
#                  INITIALIZE g_errparam TO NULL
#                  LET g_errparam.code = 'wf-00057'  #????%1???%2???%3?????????0?????????
#                  LET g_errparam.extend = '' 
#                  LET g_errparam.popup = TRUE
#                  LET g_errparam.replace[1] = l_sfbcwfseq
#                  LET g_errparam.replace[2] = l_sfbcwfseq1
#                  LET g_errparam.replace[3] = l_sfbcwfseq2
#                  CLOSE bsft001_wf_cl 
#                  CALL cl_err() 
#                  RETURN
#               END IF
#               #5.?????????
               CALL s_transaction_begin()   
               CALL cl_err_collect_init()  
               CALL s_bsft001_wf_confirmed_chk(g_sfajwf_m.sfajwfdocno)
                    RETURNING l_success
               #230921-00006#7 add--s
               IF l_success THEN
                  CALL s_bsft001_wf_ins_wfapwf(g_sfajwf_m.sfajwfdocno) RETURNING l_success
               END IF 
               #230921-00006#7 add--e
               CALL cl_err_collect_show() 
               IF NOT l_success THEN
                  CLOSE bsft001_wf_cl
                  CALL s_transaction_end('N',0)
                  CALL cl_err_collect_show()
                  RETURN
               ELSE
                  CALL s_transaction_end('Y',0)   
                  CALL bsft001_wf_b_fill2('3')
                  CALL bsft001_wf_b_fill2('4')
               END IF 
               CLOSE bsft001_wf_cl
               CALL bsft001_wf_msgcentre_notify('statechange:'||lc_state)      
#               RETURN               
            END IF
         ELSE
            LET lc_state = ''
            #end add-point
         END IF
         EXIT MENU
      ON ACTION released
         IF cl_auth_chk_act("released") THEN
            LET lc_state = "F"
            #add-point:action?? name="statechange.released"
            CALL cl_err_collect_init()  #?????????
            CALL s_aooi200_get_slip(g_sfajwf_m.sfajwfdocno) RETURNING l_success,g_ooba002
            IF cl_get_doc_para(g_enterprise,g_site,g_ooba002,'D-BWF-0004') = 'N' THEN
               IF NOT s_bsft001_wf_process(g_site,g_sfajwf_m.sfajwfdocno) THEN
                  CLOSE bsft001_wf_cl
                  CALL s_transaction_end('N','0')
                  DROP TABLE asft300_tmp
                  DROP TABLE asfp310_01_t
                  DROP TABLE asfp310_01_t1
                  #240423-00009#2 add--s
                  #????Drop???s_aic_carry???Table
                  #s_aic_carry_gen_tri_so
                  CALL s_aic_carry_drop_temp_table_xmd()
                  
                  #s_aic_carry_gen_tri_wo
                  CALL s_aic_carry_drop_temp_asfp400()
                  
                  #s_aic_carry_gen_tri_po
                  CALL s_aic_carry_drop_temp_table_order()
                  
                  CALL s_aic_carry_drop_temp_table_mail() 
                  #240423-00009#2 add--e
                  CALL cl_err_collect_show() 
                  RETURN
               END IF
            ELSE
               IF NOT s_bsft001_wf_process_turnkey(g_sfajwf_m.sfajwfdocno) THEN
                  CLOSE bsft001_wf_cl
                  CALL s_transaction_end('N','0')
                  CALL cl_err_collect_show() 
                  RETURN
               END IF
            END IF
            CALL bsft001_wf_b_fill()
            CALL cl_err_collect_show()
            #end add-point
         END IF
         EXIT MENU
      ON ACTION unreleased
         IF cl_auth_chk_act("unreleased") THEN
            LET lc_state = "U"
            #add-point:action?? name="statechange.unreleased"
            LET lc_state = "Y"
            CALL cl_err_collect_init()  #?????????
            CALL s_aooi200_get_slip(g_sfajwf_m.sfajwfdocno) RETURNING l_success,g_ooba002
            IF cl_get_doc_para(g_enterprise,g_site,g_ooba002,'D-BWF-0004') = 'N' THEN
               IF NOT s_bsft001_wf_unprocessn(g_site,g_sfajwf_m.sfajwfdocno) THEN
                  CLOSE bsft001_wf_cl
                  CALL s_transaction_end('N','0')
                  CALL cl_err_collect_show()  
                  RETURN
               END IF
            ELSE
               IF NOT s_bsft001_wf_unprocessn_turnkey(g_sfajwf_m.sfajwfdocno) THEN
                  CLOSE bsft001_wf_cl
                  CALL s_transaction_end('N','0')
                  CALL cl_err_collect_show()  
                  RETURN
               END IF
            END IF
            CALL bsft001_wf_b_fill()
            CALL cl_err_collect_show()
            #end add-point
         END IF
         EXIT MENU
      ON ACTION invalid
         IF cl_auth_chk_act("invalid") THEN
            LET lc_state = "X"
            #add-point:action?? name="statechange.invalid"
            CALL cl_err_collect_init()  #?????????
            IF NOT s_asft300_invalid_chk(g_sfajwf_m.sfajwfdocno) THEN
               CLOSE bsft001_wf_cl
               CALL s_transaction_end('N','0')
               CALL cl_err_collect_show()  
               RETURN
            END IF
            IF NOT cl_ask_confirm('aim-00109') THEN
               CLOSE bsft001_wf_cl
               CALL s_transaction_end('N','0')
               CALL cl_err_collect_show() 
               RETURN
            END IF
            IF NOT s_bsft001_wf_invalid_chk(g_sfajwf_m.sfajwfdocno) THEN
               CLOSE bsft001_wf_cl
               CALL s_transaction_end('N','0')
               CALL cl_err_collect_show() 
               RETURN
            END IF
            CALL cl_err_collect_show()
            #end add-point
         END IF
         EXIT MENU
 
      #add-point:stus?? name="statechange.more_control"

      #end add-point
      
   END MENU
   LET INT_FLAG=FALSE  #(ver.18)
   
   #?????????????
   IF (lc_state <> "A" 
      AND lc_state <> "D"
      AND lc_state <> "R"
      AND lc_state <> "W"
      AND lc_state <> "N"
      AND lc_state <> "Y"
      AND lc_state <> "F"
      AND lc_state <> "U"
      AND lc_state <> "X"
      ) OR 
      g_sfajwf_m.sfajwfstus = lc_state OR cl_null(lc_state) THEN
      CLOSE bsft001_wf_cl
      CALL s_transaction_end('N','0')
      RETURN
   END IF
   
   #add-point:stus??? name="statechange.b_update"

   #end add-point
   
   LET g_sfajwf_m.sfajwfmodid = g_user
   LET g_sfajwf_m.sfajwfmoddt = cl_get_current()
   LET g_sfajwf_m.sfajwfstus = lc_state
   
   #???????/???/????
   UPDATE sfajwf_t 
      SET (sfajwfstus,sfajwfmodid,sfajwfmoddt) 
        = (g_sfajwf_m.sfajwfstus,g_sfajwf_m.sfajwfmodid,g_sfajwf_m.sfajwfmoddt)     
    WHERE sfajwfent = g_enterprise AND sfajwfsite = g_site AND sfajwfdocno = g_sfajwf_m.sfajwfdocno
 
    
   IF SQLCA.SQLCODE THEN
      #171011-00030 ---start---
      CLOSE bsft001_wf_cl
      CALL s_transaction_end('N','0')
      #171011-00030 --- end ---
      INITIALIZE g_errparam TO NULL 
      LET g_errparam.extend = "" 
      LET g_errparam.code = SQLCA.SQLCODE 
      LET g_errparam.popup = FALSE 
      CALL cl_err()
      #170801-00033 ---start---
   #  CLOSE bsft001_wf_cl   #171011-00030 mark
   #  CALL s_transaction_end('N','0')   #171011-00030 mark
      RETURN
      #170801-00033 --- end ---
   ELSE
      CASE lc_state
         WHEN "A"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/approved.png")
         WHEN "D"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/withdraw.png")
         WHEN "R"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/rejection.png")
         WHEN "W"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/signing.png")
         WHEN "N"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/unconfirmed.png")
         WHEN "Y"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/confirmed.png")
         WHEN "F"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/released.png")
         WHEN "U"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/unreleased.png")
         WHEN "X"
            CALL gfrm_curr.setElementImage("statechange", "stus/32/invalid.png")
         
      END CASE
 
      #180130-00006 ---start---
      #??????(?????)
      LET g_log1 = util.JSON.stringify(g_sfajwf_m_t)
      LET g_log2 = util.JSON.stringify(g_sfajwf_m)
      IF NOT cl_log_modified_record(g_log1,g_log2) THEN
         CALL s_transaction_end('N','0')
         RETURN
      END IF
      #180130-00006 --- end ---
    
      #????????
      EXECUTE bsft001_wf_master_referesh USING g_site,g_sfajwf_m.sfajwfdocno INTO g_sfajwf_m.sfajwfdocno,g_sfajwf_m.sfajwfdocdt,g_sfajwf_m.sfajwf006,g_sfajwf_m.sfajwf007,g_sfajwf_m.sfajwf017,g_sfajwf_m.sfajwf019,g_sfajwf_m.sfajwf020,g_sfajwf_m.sfajwf021,g_sfajwf_m.sfajwf018,g_sfajwf_m.sfajwf022,g_sfajwf_m.sfajwf023, 
          g_sfajwf_m.sfajwf012,g_sfajwf_m.sfajwf013,g_sfajwf_m.sfajwf014,g_sfajwf_m.sfajwf001,g_sfajwf_m.sfajwf002,g_sfajwf_m.sfajwf025,g_sfajwf_m.sfajwf015,g_sfajwf_m.sfajwfua002,g_sfajwf_m.sfajwf016,g_sfajwf_m.sfajwfua003,g_sfajwf_m.sfajwf024,g_sfajwf_m.sfajwf003,g_sfajwf_m.sfajwf005,g_sfajwf_m.sfajwf004, 
          g_sfajwf_m.sfajwf008,g_sfajwf_m.sfajwf009,g_sfajwf_m.sfajwf010,g_sfajwf_m.sfajwf011,g_sfajwf_m.sfajwfua011,g_sfajwf_m.sfajwfua012,g_sfajwf_m.sfajwfua013,g_sfajwf_m.sfajwfua014,g_sfajwf_m.sfajwfua015,g_sfajwf_m.sfajwfstus,g_sfajwf_m.sfajwfownid,g_sfajwf_m.sfajwfowndp,g_sfajwf_m.sfajwfcrtid, 
          g_sfajwf_m.sfajwfcrtdp,g_sfajwf_m.sfajwfcrtdt,g_sfajwf_m.sfajwfmodid,g_sfajwf_m.sfajwfmoddt,g_sfajwf_m.sfajwfcnfid,g_sfajwf_m.sfajwfcnfdt,g_sfajwf_m.sfajwf006_desc,g_sfajwf_m.sfajwf007_desc,g_sfajwf_m.sfajwf023_desc,g_sfajwf_m.sfajwf012_desc,g_sfajwf_m.sfajwf001_desc,g_sfajwf_m.sfajwf002_desc, 
          g_sfajwf_m.sfajwf025_desc,g_sfajwf_m.sfajwf008_desc,g_sfajwf_m.sfajwf009_desc,g_sfajwf_m.sfajwf010_desc,g_sfajwf_m.sfajwf011_desc,g_sfajwf_m.sfajwfownid_desc,g_sfajwf_m.sfajwfowndp_desc,g_sfajwf_m.sfajwfcrtid_desc,g_sfajwf_m.sfajwfcrtdp_desc,g_sfajwf_m.sfajwfmodid_desc,g_sfajwf_m.sfajwfcnfid_desc 

      
      #?????????
      DISPLAY BY NAME g_sfajwf_m.sfajwfdocno,g_sfajwf_m.oobal004,g_sfajwf_m.sfajwfdocdt,g_sfajwf_m.sfajwf006,g_sfajwf_m.sfajwf006_desc,g_sfajwf_m.sfajwf007,g_sfajwf_m.sfajwf007_desc,g_sfajwf_m.sfajwf017,g_sfajwf_m.sfajwf019,g_sfajwf_m.sfajwf020,g_sfajwf_m.sfajwf021,g_sfajwf_m.sfajwf018,g_sfajwf_m.l_sfajwf018, 
          g_sfajwf_m.sfajwf022,g_sfajwf_m.sfajwf023,g_sfajwf_m.sfajwf023_desc,g_sfajwf_m.sfajwf012,g_sfajwf_m.sfajwf012_desc,g_sfajwf_m.sfajwf013,g_sfajwf_m.sfajwf014,g_sfajwf_m.sfajwf001,g_sfajwf_m.sfajwf001_desc,g_sfajwf_m.sfajwf002,g_sfajwf_m.sfajwf002_desc,g_sfajwf_m.sfajwf025,g_sfajwf_m.sfajwf025_desc, 
          g_sfajwf_m.sfajwf015,g_sfajwf_m.sfajwfua002,g_sfajwf_m.sfajwf016,g_sfajwf_m.sfajwfua003,g_sfajwf_m.sfajwf024,g_sfajwf_m.sfajwf003,g_sfajwf_m.sfajwf005,g_sfajwf_m.sfajwf004,g_sfajwf_m.sfajwf008,g_sfajwf_m.sfajwf008_desc,g_sfajwf_m.sfajwf009,g_sfajwf_m.sfajwf009_desc,g_sfajwf_m.sfajwf010,g_sfajwf_m.sfajwf010_desc, 
          g_sfajwf_m.sfajwf011,g_sfajwf_m.sfajwf011_desc,g_sfajwf_m.sfajwfua011,g_sfajwf_m.sfajwfua012,g_sfajwf_m.sfajwfua013,g_sfajwf_m.sfajwfua014,g_sfajwf_m.sfajwfua015,g_sfajwf_m.sfajwfstus,g_sfajwf_m.sfajwfownid,g_sfajwf_m.sfajwfownid_desc,g_sfajwf_m.sfajwfowndp,g_sfajwf_m.sfajwfowndp_desc,g_sfajwf_m.sfajwfcrtid, 
          g_sfajwf_m.sfajwfcrtid_desc,g_sfajwf_m.sfajwfcrtdp,g_sfajwf_m.sfajwfcrtdp_desc,g_sfajwf_m.sfajwfcrtdt,g_sfajwf_m.sfajwfmodid,g_sfajwf_m.sfajwfmodid_desc,g_sfajwf_m.sfajwfmoddt,g_sfajwf_m.sfajwfcnfid,g_sfajwf_m.sfajwfcnfid_desc,g_sfajwf_m.sfajwfcnfdt
   END IF
 
   #add-point:stus??? name="statechange.a_update"

   #end add-point
 
   #add-point:statechange???? name="statechange.after"

   #end add-point  
 
   CLOSE bsft001_wf_cl
   CALL s_transaction_end('Y','0')
   
   #(ver:20) ---start---
   #add-point:transaction??? name="statechange.transaction_after"

   #end add-point  
   #(ver:20) --- end --- 
 
   #?????,??????
   CALL bsft001_wf_msgcentre_notify('statechange:'||lc_state)
   
END FUNCTION
 
 
 

{</section>}

{<section id="bsft001_wf.idx_chk" type="s" >}
#+ ???????????
PRIVATE FUNCTION bsft001_wf_idx_chk() RETURNS ()   #200213-00032
   #add-point:idx_chk?define(???) name="idx_chk.define_customerization"

   #end add-point  
   #add-point:idx_chk?define (?????????????????, ?????patch????????) name="idx_chk.define"

   #end add-point  
   
   #add-point:Function????  name="idx_chk.pre_function"

   #end add-point
   
   LET g_curr_diag = ui.DIALOG.getCurrent()   #(ver:83)
   
   IF g_current_page = 1 THEN
      LET g_detail_idx = g_curr_diag.getCurrentRow("s_detail1")
      IF g_detail_idx > g_sfakwf_d.getLength() THEN
         LET g_detail_idx = g_sfakwf_d.getLength()
      END IF
      IF g_detail_idx = 0 AND g_sfakwf_d.getLength() <> 0 THEN
         LET g_detail_idx = 1
      END IF
      DISPLAY g_detail_idx TO FORMONLY.idx
      DISPLAY g_sfakwf_d.getLength() TO FORMONLY.cnt
   END IF
   
   IF g_current_page = 2 THEN
      LET g_detail_idx2 = g_curr_diag.getCurrentRow("s_detail2")
      IF g_detail_idx2 > g_sfakwf2_d.getLength() THEN
         LET g_detail_idx2 = g_sfakwf2_d.getLength()
      END IF
      IF g_detail_idx2 = 0 AND g_sfakwf2_d.getLength() <> 0 THEN
         LET g_detail_idx2 = 1
      END IF
      DISPLAY g_detail_idx2 TO FORMONLY.idx
      DISPLAY g_sfakwf2_d.getLength() TO FORMONLY.cnt
   END IF
   IF g_current_page = 3 THEN
      LET g_detail_idx2 = g_curr_diag.getCurrentRow("s_detail3")
      IF g_detail_idx2 > g_sfakwf3_d.getLength() THEN
         LET g_detail_idx2 = g_sfakwf3_d.getLength()
      END IF
      IF g_detail_idx2 = 0 AND g_sfakwf3_d.getLength() <> 0 THEN
         LET g_detail_idx2 = 1
      END IF
      DISPLAY g_detail_idx2 TO FORMONLY.idx
      DISPLAY g_sfakwf3_d.getLength() TO FORMONLY.cnt
   END IF
   IF g_current_page = 4 THEN
      LET g_detail_idx = g_curr_diag.getCurrentRow("s_detail4")
      IF g_detail_idx > g_sfakwf4_d.getLength() THEN
         LET g_detail_idx = g_sfakwf4_d.getLength()
      END IF
      IF g_detail_idx = 0 AND g_sfakwf4_d.getLength() <> 0 THEN
         LET g_detail_idx = 1
      END IF
      DISPLAY g_detail_idx TO FORMONLY.idx
      DISPLAY g_sfakwf4_d.getLength() TO FORMONLY.cnt
   END IF
   IF g_current_page = 5 THEN
      LET g_detail_idx2 = g_curr_diag.getCurrentRow("s_detail5")
      IF g_detail_idx2 > g_sfakwf5_d.getLength() THEN
         LET g_detail_idx2 = g_sfakwf5_d.getLength()
      END IF
      IF g_detail_idx2 = 0 AND g_sfakwf5_d.getLength() <> 0 THEN
         LET g_detail_idx2 = 1
      END IF
      DISPLAY g_detail_idx2 TO FORMONLY.idx
      DISPLAY g_sfakwf5_d.getLength() TO FORMONLY.cnt
   END IF
 
   
   #add-point:idx_chk?other name="idx_chk.other"

   #end add-point  
   
END FUNCTION

{</section>}

{<section id="bsft001_wf.b_fill2" type="s" >}
#+ ??????2
PRIVATE FUNCTION bsft001_wf_b_fill2(pi_idx) RETURNS ()   #200213-00032
   #add-point:b_fill2?define(???) name="b_fill2.define_customerization"

   #end add-point
   DEFINE pi_idx                 LIKE type_t.num10
   DEFINE li_ac                  LIKE type_t.num10
   DEFINE li_detail_idx_tmp      LIKE type_t.num10
   DEFINE ls_chk                 LIKE type_t.chr1
   #add-point:b_fill2?define (?????????????????, ?????patch????????) name="b_fill2.define"
   #241120-00001#1 add--s
   DEFINE l_qty        LIKE inag_t.inag008 
   DEFINE l_imaa001    LIKE imaa_t.imaa001
   DEFINE l_from_unit  LIKE inag_t.inag007 
   DEFINE l_to_unit    LIKE inag_t.inag007
   DEFINE l_success    LIKE type_t.num5
   DEFINE l_sql        STRING
   TYPE l_item RECORD
      code LIKE type_t.chr80,
      bom_num  LIKE type_t.num20_6,
      send_num LIKE type_t.num20_6
   END RECORD
   DEFINE l_table  DYNAMIC ARRAY OF l_item
   DEFINE l_table_i int
   DEFINE foundflag BOOLEAN
   
   #241120-00001#1 add--e
   #end add-point
   
   #add-point:Function????  name="b_fill2.pre_function"
   
   #end add-point
   
   LET li_ac = l_ac 
   
   IF g_detail_idx <= 0 THEN
      RETURN
   END IF
   
   LET li_detail_idx_tmp = g_detail_idx
   
   IF bsft001_wf_fill_chk(3) THEN
      IF (pi_idx = 3 OR pi_idx = 0 ) AND g_sfakwf_d.getLength() > 0 THEN
               CALL g_sfakwf2_d.clear()
 
         
         #??????????idx
         LET g_detail_idx = g_detail_idx_list[1]
         
         LET g_sql = "SELECT  DISTINCT sfbcwfseq1,sfbcwfseq2,sfbcwf002,sfbcwf003,sfbcwf004,sfbcwf005,sfbcwf022,sfbcwf006,sfbcwf033,sfbcwf021,sfbcwf007,sfbcwf008,sfbcwf009,sfbcwf010,sfbcwf011,sfbcwf012,sfbcwf023,sfbcwf024,sfbcwf013,sfbcwf047,sfbcwf048,sfbcwf014,sfbcwf015,sfbcwf016,sfbcwf025,sfbcwf017, 
             sfbcwf018,sfbcwf019,sfbcwf020,sfbcwf029,sfbcwf039,sfbcwf030,sfbcwf040,sfbcwf041,sfbcwf042,sfbcwf028,sfbcwf001,sfbcwf026,sfbcwf027,sfbcwf034,sfbcwf035,sfbcwf043,sfbcwf049 ,t8.oocql004 ,t9.oocql004 ,t10.imaal003 ,t11.imaal003 ,t12.inaml004 ,t13.oocal003 ,t14.inaa002 ,t15.inab003 ,t16.imaal003 FROM sfbcwf_t", 
                 
                     "",
                                    " LEFT JOIN oocql_t t8 ON t8.oocqlent="||g_enterprise||" AND t8.oocql001='215' AND t8.oocql002=sfbcwf002 AND t8.oocql003='"||g_dlang||"' ",
               " LEFT JOIN oocql_t t9 ON t9.oocqlent="||g_enterprise||" AND t9.oocql001='221' AND t9.oocql002=sfbcwf003 AND t9.oocql003='"||g_dlang||"' ",
               " LEFT JOIN imaal_t t10 ON t10.imaalent="||g_enterprise||" AND t10.imaal001=sfbcwf005 AND t10.imaal002='"||g_dlang||"' ",
               " LEFT JOIN imaal_t t11 ON t11.imaalent="||g_enterprise||" AND t11.imaal001=sfbcwf006 AND t11.imaal002='"||g_dlang||"' ",
               " LEFT JOIN inaml_t t12 ON t12.inamlent="||g_enterprise||" AND t12.inaml001=sfbcwf006 AND t12.inaml002=sfbcwf021 AND t12.inaml003='"||g_dlang||"' ",
               " LEFT JOIN oocal_t t13 ON t13.oocalent="||g_enterprise||" AND t13.oocal001=sfbcwf014 AND t13.oocal002='"||g_dlang||"' ",
               " LEFT JOIN inaa_t t14 ON t14.inaaent="||g_enterprise||" AND t14.inaasite=sfbcwfsite AND t14.inaa001=sfbcwf019  ",
               " LEFT JOIN inab_t t15 ON t15.inabent="||g_enterprise||" AND t15.inabsite=sfbcwfsite AND t15.inab001=sfbcwf019 AND t15.inab002=sfbcwf020  ",
               " LEFT JOIN imaal_t t16 ON t16.imaalent="||g_enterprise||" AND t16.imaal001=sfbcwf001 AND t16.imaal002='"||g_dlang||"' ",
 
                     " WHERE sfbcwfent=? AND sfbcwfsite=? AND sfbcwfdocno=? AND sfbcwfseq=?"
         
         IF NOT cl_null(g_wc2_table3) THEN
            LET g_sql = g_sql CLIPPED," AND ",g_wc2_table3 CLIPPED
         END IF
         
         LET g_sql = g_sql, " ORDER BY  sfbcwf_t.sfbcwfseq1,sfbcwf_t.sfbcwfseq2" 
                            
         #add-point:????? name="b_fill2.before_fill3"
         #241120-00001#1 add--s
         DELETE FROM convert_tmp
         LET l_sql = "INSERT INTO convert_tmp ",
                     "SELECT DISTINCT sfbcwf006,inag007,sfbcwf014,1 ",
                     "  FROM sfbcwf_t,inag_t ",
                     " WHERE sfbcwfent=inagent  AND sfbcwfsite=inagsite AND sfbcwfent=",g_enterprise," AND sfbcwfsite='",g_site,"'",
                     "   AND sfbcwfdocno = '",g_sfajwf_m.sfajwfdocno,"' ",
                     "   AND inag001 = sfbcwf006 AND inag002 = COALESCE(sfbcwf021,' ') ",
                     "   AND (inag004 = sfbcwf019 OR (NOT(inag004 = sfbcwf019) AND sfbcwf019 = ' ')) AND (inag005 = sfbcwf020 OR (NOT(inag005 = sfbcwf020) AND sfbcwf020 = ' '))",
                     "   AND (inag006 = sfbcwf029 OR (NOT(inag006 = sfbcwf029) AND sfbcwf029 = ' ')) AND (inag003 = sfbcwf030 OR (NOT(inag003 = sfbcwf030) AND sfbcwf030 = ' '))"               
         PREPARE ins_convert_tmp1 FROM l_sql
         EXECUTE ins_convert_tmp1 
         
         DECLARE sel_convert_tmp CURSOR FOR 
          SELECT imaa001,from_unit,to_unit FROM convert_tmp WHERE from_unit <> to_unit  
         FOREACH sel_convert_tmp INTO l_imaa001,l_from_unit,l_to_unit
            IF NOT cl_null(l_from_unit) AND NOT cl_null(l_to_unit) THEN
               CALL s_aooi250_convert_qty1(l_imaa001,l_from_unit,l_to_unit,1)
                  RETURNING l_success,l_qty
               IF l_success THEN
?                UPDATE convert_tmp
                     SET qty = l_qty
                   WHERE imaa001 = l_imaa001
                     AND from_unit = l_from_unit
                     AND to_unit = l_to_unit
               END IF
            END IF
         END FOREACH
         #241120-00001#1 add--e
         #end add-point
         
         #?????
               CALL g_sfakwf2_d.clear()
 
         
         LET g_sql = cl_sql_add_mask(g_sql)              #??????
         PREPARE bsft001_wf_pb3 FROM g_sql
         DECLARE b_fill_curs3 CURSOR FOR bsft001_wf_pb3
         
      #  OPEN b_fill_curs3 USING g_enterprise, g_site,g_sfajwf_m.sfajwfdocno,g_sfakwf_d[g_detail_idx].sfakwfseq   #(ver:78)
         LET l_ac = 1
         FOREACH b_fill_curs3 USING g_enterprise, g_site,g_sfajwf_m.sfajwfdocno,g_sfakwf_d[g_detail_idx].sfakwfseq INTO g_sfakwf2_d[l_ac].sfbcwfseq1,g_sfakwf2_d[l_ac].sfbcwfseq2,g_sfakwf2_d[l_ac].sfbcwf002,g_sfakwf2_d[l_ac].sfbcwf003,g_sfakwf2_d[l_ac].sfbcwf004,g_sfakwf2_d[l_ac].sfbcwf005,g_sfakwf2_d[l_ac].sfbcwf022, 
             g_sfakwf2_d[l_ac].sfbcwf006,g_sfakwf2_d[l_ac].sfbcwf033,g_sfakwf2_d[l_ac].sfbcwf021,g_sfakwf2_d[l_ac].sfbcwf007,g_sfakwf2_d[l_ac].sfbcwf008,g_sfakwf2_d[l_ac].sfbcwf009,g_sfakwf2_d[l_ac].sfbcwf010,g_sfakwf2_d[l_ac].sfbcwf011,g_sfakwf2_d[l_ac].sfbcwf012,g_sfakwf2_d[l_ac].sfbcwf023,g_sfakwf2_d[l_ac].sfbcwf024, 
             g_sfakwf2_d[l_ac].sfbcwf013,g_sfakwf2_d[l_ac].sfbcwf047,g_sfakwf2_d[l_ac].sfbcwf048,g_sfakwf2_d[l_ac].sfbcwf014,g_sfakwf2_d[l_ac].sfbcwf015,g_sfakwf2_d[l_ac].sfbcwf016,g_sfakwf2_d[l_ac].sfbcwf025,g_sfakwf2_d[l_ac].sfbcwf017,g_sfakwf2_d[l_ac].sfbcwf018,g_sfakwf2_d[l_ac].sfbcwf019,g_sfakwf2_d[l_ac].sfbcwf020, 
             g_sfakwf2_d[l_ac].sfbcwf029,g_sfakwf2_d[l_ac].sfbcwf039,g_sfakwf2_d[l_ac].sfbcwf030,g_sfakwf2_d[l_ac].sfbcwf040,g_sfakwf2_d[l_ac].sfbcwf041,g_sfakwf2_d[l_ac].sfbcwf042,g_sfakwf2_d[l_ac].sfbcwf028,g_sfakwf2_d[l_ac].sfbcwf001,g_sfakwf2_d[l_ac].sfbcwf026,g_sfakwf2_d[l_ac].sfbcwf027,g_sfakwf2_d[l_ac].sfbcwf034, 
             g_sfakwf2_d[l_ac].sfbcwf035,g_sfakwf2_d[l_ac].sfbcwf043,g_sfakwf2_d[l_ac].sfbcwf049,g_sfakwf2_d[l_ac].sfbcwf002_desc,g_sfakwf2_d[l_ac].sfbcwf003_desc,g_sfakwf2_d[l_ac].sfbcwf005_desc,g_sfakwf2_d[l_ac].sfbcwf006_desc,g_sfakwf2_d[l_ac].sfbcwf021_desc,g_sfakwf2_d[l_ac].sfbcwf014_desc,g_sfakwf2_d[l_ac].sfbcwf019_desc, 
             g_sfakwf2_d[l_ac].sfbcwf020_desc,g_sfakwf2_d[l_ac].sfbcwf001_desc   #(ver:78)
            IF SQLCA.SQLCODE THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "FOREACH:",SQLERRMESSAGE 
               LET g_errparam.code = SQLCA.SQLCODE 
               LET g_errparam.popup = TRUE 
               CALL cl_err()
               EXIT FOREACH
            END IF
            
            #add-point:b_fill????? name="b_fill2.fill3"
            #240423-00009#2 --s
            #??????
            IF NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf041) THEN
               SELECT wfagwfl003 INTO g_sfakwf2_d[l_ac].sfbcwf041_desc FROM wfagwfl_t
                 WHERE wfagwflent = g_enterprise AND wfagwfl001 = g_sfakwf2_d[l_ac].sfbcwf041 AND wfagwfl002 = g_dlang
            END IF
            #??????
            IF NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf042) THEN
               SELECT wfaiwfl003 INTO g_sfakwf2_d[l_ac].sfbcwf042_desc FROM wfaiwfl_t
                 WHERE wfaiwflent = g_enterprise AND wfaiwfl001 = g_sfakwf2_d[l_ac].sfbcwf042 AND wfaiwfl002 = g_dlang
            END IF 
            #????
            IF cl_null(g_sfakwf2_d[l_ac].sfbcwf019_desc) THEN
               LET g_sfakwf2_d[l_ac].sfbcwf019_desc = s_desc_get_stock_desc(g_site,g_sfakwf2_d[l_ac].sfbcwf019)
            END IF
            #240423-00009#2 --e
            #250220-00015# add ---s
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_sfakwf2_d[l_ac].sfbcwf005
            CALL ap_ref_array2(g_ref_fields,"SELECT imaal003,imaal004 FROM imaal_t WHERE imaalent='"||g_enterprise||"' AND imaal001=? AND imaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_sfakwf2_d[l_ac].sfbcwf005_desc = '', g_rtn_fields[1] , ''
            LET g_sfakwf2_d[l_ac].sfbcwf005_desc_1 = '', g_rtn_fields[2] , '' 
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_sfakwf2_d[l_ac].sfbcwf006
            CALL ap_ref_array2(g_ref_fields,"SELECT imaal003,imaal004 FROM imaal_t WHERE imaalent='"||g_enterprise||"' AND imaal001=? AND imaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_sfakwf2_d[l_ac].sfbcwf006_desc = '', g_rtn_fields[1] , ''
            LET g_sfakwf2_d[l_ac].sfbcwf006_desc_1 = '', g_rtn_fields[2] , ''             
            #250220-00015# add ---e                
            #241120-00001#1 add--s
            SELECT DISTINCT (CASE WHEN ca.ooca004 = '1'  THEN ROUND( ROUND( COALESCE(t51.inag008,0),6),ca.ooca002)  
                        WHEN ca.ooca004 = '2'  THEN (CASE WHEN MOD( ROUND(round( COALESCE(t51.inag008,0),6),ca.ooca002),(2 / POWER(10,ca.ooca002)))=0 THEN ROUND( ROUND( COALESCE(t51.inag008,0),6),ca.ooca002) 
                                                          ELSE ROUND( ROUND( COALESCE(t51.inag008,0),6),ca.ooca002)-(1 / POWER(10,ca.ooca002)) 
                                                       END )
                        WHEN ca.ooca004 = '3'  THEN trunc( ROUND( COALESCE(t51.inag008,0),6),ca.ooca002)
                        WHEN ca.ooca004 = '4'  THEN ceil( ROUND( COALESCE(t51.inag008,0),6) * POWER(10,ca.ooca002)) / POWER(10,ca.ooca002) 
                                                                      END )
              INTO g_sfakwf2_d[l_ac].number5
              FROM (
            SELECT SUM(inag008 * qty) inag008 FROM inag_t,convert_tmp a, sfbcwf_t WHERE inagent = sfbcwfent AND inagsite = sfbcwfsite AND inag001 = sfbcwf006 AND inag002 = COALESCE(sfbcwf021,' ')
              AND sfbcwfent= g_enterprise AND sfbcwfsite= g_site AND sfbcwfdocno=g_sfajwf_m.sfajwfdocno AND sfbcwfseq=g_sfakwf_d[g_detail_idx].sfakwfseq
              AND sfbcwfseq1=g_sfakwf2_d[l_ac].sfbcwfseq1 AND sfbcwfseq2=g_sfakwf2_d[l_ac].sfbcwfseq2
              AND (inag004 = sfbcwf019 OR (NOT(inag004 = sfbcwf019) AND sfbcwf019 = ' ')) AND (inag005 = sfbcwf020 OR (NOT(inag005 = sfbcwf020) AND sfbcwf020 = ' '))
              AND (inag006 = sfbcwf029 OR (NOT(inag006 = sfbcwf029) AND sfbcwf029 = ' ')) AND (inag003 = sfbcwf030 OR (NOT(inag003 = sfbcwf030) AND sfbcwf030 = ' '))
              AND a.imaa001=inag001 AND NVL(a.from_unit,' ') = NVL(inag007,' ') AND NVL(a.to_unit,' ') = NVL(sfbcwf014,' '))  t51,sfbcwf_t
              LEFT JOIN ooca_t ca ON ca.oocaent = sfbcwfent AND ca.ooca001 = sfbcwf014
              WHERE sfbcwfent= g_enterprise AND sfbcwfsite= g_site AND sfbcwfdocno=g_sfajwf_m.sfajwfdocno AND sfbcwfseq=g_sfakwf_d[g_detail_idx].sfakwfseq
              AND sfbcwfseq1=g_sfakwf2_d[l_ac].sfbcwfseq1 AND sfbcwfseq2=g_sfakwf2_d[l_ac].sfbcwfseq2              
            SELECT DISTINCT (CASE WHEN ca.ooca004 = '1'  THEN ROUND( ROUND( COALESCE(t52.inan010,0),6),ca.ooca002)  
                        WHEN ca.ooca004 = '2'  THEN (CASE WHEN MOD( ROUND(round( COALESCE(t52.inan010,0),6),ca.ooca002),(2 / POWER(10,ca.ooca002)))=0 THEN ROUND( ROUND( COALESCE(t52.inan010,0),6),ca.ooca002) 
                                                          ELSE ROUND( ROUND( COALESCE(t52.inan010,0),6),ca.ooca002)-(1 / POWER(10,ca.ooca002)) 
                                                       END )
                        WHEN ca.ooca004 = '3'  THEN trunc( ROUND( COALESCE(t52.inan010,0),6),ca.ooca002)
                        WHEN ca.ooca004 = '4'  THEN ceil( ROUND( COALESCE(t52.inan010,0),6) * POWER(10,ca.ooca002)) / POWER(10,ca.ooca002)   
                                                                      END )
              INTO g_sfakwf2_d[l_ac].number6
              FROM (
            SELECT SUM(inan010 * qty) inan010 FROM inan_t,convert_tmp a,sfbcwf_t WHERE inanent = sfbcwfent AND inansite = sfbcwfsite AND inan000 = '1' AND inan001 = sfbcwf006 AND inan002 = COALESCE(sfbcwf021,' ')
              AND sfbcwfent= g_enterprise AND sfbcwfsite= g_site AND sfbcwfdocno=g_sfajwf_m.sfajwfdocno AND sfbcwfseq=g_sfakwf_d[g_detail_idx].sfakwfseq
              AND sfbcwfseq1=g_sfakwf2_d[l_ac].sfbcwfseq1 AND sfbcwfseq2=g_sfakwf2_d[l_ac].sfbcwfseq2              
              AND inan004 = sfbcwf019 AND inan005 = sfbcwf020 AND inan006 = sfbcwf029 AND inan003 = sfbcwf030
              AND a.imaa001 = sfbcwf006 AND NVL(a.from_unit,' ') = NVL(inan007,' ') AND NVL(a.to_unit,' ') = NVL(sfbcwf014,' '))  t52,sfbcwf_t
              LEFT JOIN ooca_t ca ON ca.oocaent = sfbcwfent AND ca.ooca001 = sfbcwf014
              WHERE sfbcwfent= g_enterprise AND sfbcwfsite= g_site AND sfbcwfdocno=g_sfajwf_m.sfajwfdocno AND sfbcwfseq=g_sfakwf_d[g_detail_idx].sfakwfseq
              AND sfbcwfseq1=g_sfakwf2_d[l_ac].sfbcwfseq1 AND sfbcwfseq2=g_sfakwf2_d[l_ac].sfbcwfseq2              
            #241120-00001#1 add--e
            #end add-point
           
            IF l_ac > g_max_rec THEN
               #????????????????????????????
               IF cl_null(g_action_choice) OR g_action_choice <> "ui_change" THEN   #190108-00038
                  INITIALIZE g_errparam TO NULL 
                  LET g_errparam.extend = l_ac
                  LET g_errparam.code = 9035 
                  LET g_errparam.popup = TRUE 
                  CALL cl_err()
               END IF   #190108-00038
               EXIT FOREACH
            END IF
            
            LET l_ac = l_ac + 1
            
         END FOREACH
               CALL g_sfakwf2_d.deleteElement(g_sfakwf2_d.getLength())
 
      END IF
   END IF
 
   IF bsft001_wf_fill_chk(4) THEN
      IF (pi_idx = 4 OR pi_idx = 0 ) AND g_sfakwf_d.getLength() > 0 THEN
               CALL g_sfakwf3_d.clear()
 
         
         #??????????idx
         LET g_detail_idx = g_detail_idx_list[1]
         
         LET g_sql = "SELECT  DISTINCT wfapwfseq1,wfapwf001,wfapwf002,wfapwf003,wfapwf004,wfapwf005,wfapwf006,wfapwf007,wfapwf008,wfapwf009,wfapwf010,wfapwf011,wfapwf012,wfapwf013,wfapwf014,wfapwf015,wfapwf016,wfapwf017,wfapwf018,wfapwf022,wfapwf019,wfapwf021,wfapwf020,wfapwf023,wfapwf024,wfapwf025, 
             wfapwf026 ,t17.imaal003 ,t18.wfajwfl003 FROM wfapwf_t",    
                     "",
                                    " LEFT JOIN imaal_t t17 ON t17.imaalent="||g_enterprise||" AND t17.imaal001=wfapwf001 AND t17.imaal002='"||g_dlang||"' ",
               " LEFT JOIN wfajwfl_t t18 ON t18.wfajwflent="||g_enterprise||" AND t18.wfajwfl001=wfapwf020 AND t18.wfajwfl002='"||g_dlang||"' ",
 
                     " WHERE wfapwfent=? AND wfapwfsite=? AND wfapwfdocno=? AND wfapwfseq=?"
         
         IF NOT cl_null(g_wc2_table4) THEN
            LET g_sql = g_sql CLIPPED," AND ",g_wc2_table4 CLIPPED
         END IF
         
         LET g_sql = g_sql, " ORDER BY  wfapwf_t.wfapwfseq1" 
                            
         #add-point:????? name="b_fill2.before_fill4"

         #end add-point
         
         #?????
               CALL g_sfakwf3_d.clear()
 
         
         LET g_sql = cl_sql_add_mask(g_sql)              #??????
         PREPARE bsft001_wf_pb4 FROM g_sql
         DECLARE b_fill_curs4 CURSOR FOR bsft001_wf_pb4
         
      #  OPEN b_fill_curs4 USING g_enterprise, g_site,g_sfajwf_m.sfajwfdocno,g_sfakwf_d[g_detail_idx].sfakwfseq   #(ver:78)
         LET l_ac = 1
         FOREACH b_fill_curs4 USING g_enterprise, g_site,g_sfajwf_m.sfajwfdocno,g_sfakwf_d[g_detail_idx].sfakwfseq INTO g_sfakwf3_d[l_ac].wfapwfseq1,g_sfakwf3_d[l_ac].wfapwf001,g_sfakwf3_d[l_ac].wfapwf002,g_sfakwf3_d[l_ac].wfapwf003,g_sfakwf3_d[l_ac].wfapwf004,g_sfakwf3_d[l_ac].wfapwf005,g_sfakwf3_d[l_ac].wfapwf006, 
             g_sfakwf3_d[l_ac].wfapwf007,g_sfakwf3_d[l_ac].wfapwf008,g_sfakwf3_d[l_ac].wfapwf009,g_sfakwf3_d[l_ac].wfapwf010,g_sfakwf3_d[l_ac].wfapwf011,g_sfakwf3_d[l_ac].wfapwf012,g_sfakwf3_d[l_ac].wfapwf013,g_sfakwf3_d[l_ac].wfapwf014,g_sfakwf3_d[l_ac].wfapwf015,g_sfakwf3_d[l_ac].wfapwf016,g_sfakwf3_d[l_ac].wfapwf017, 
             g_sfakwf3_d[l_ac].wfapwf018,g_sfakwf3_d[l_ac].wfapwf022,g_sfakwf3_d[l_ac].wfapwf019,g_sfakwf3_d[l_ac].wfapwf021,g_sfakwf3_d[l_ac].wfapwf020,g_sfakwf3_d[l_ac].wfapwf023,g_sfakwf3_d[l_ac].wfapwf024,g_sfakwf3_d[l_ac].wfapwf025,g_sfakwf3_d[l_ac].wfapwf026,g_sfakwf3_d[l_ac].wfapwf001_desc,g_sfakwf3_d[l_ac].wfapwf020_desc  
               #(ver:78)
            IF SQLCA.SQLCODE THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "FOREACH:",SQLERRMESSAGE 
               LET g_errparam.code = SQLCA.SQLCODE 
               LET g_errparam.popup = TRUE 
               CALL cl_err()
               EXIT FOREACH
            END IF
            
            #add-point:b_fill????? name="b_fill2.fill4"
            #??
            SELECT wfagwf003,wfagwf004,wfagwf006,wfagwf007
              INTO g_sfakwf3_d[l_ac].sfakwf012,g_sfakwf3_d[l_ac].sfakwf013,g_sfakwf3_d[l_ac].sfakwf014,g_sfakwf3_d[l_ac].sfakwf015
              FROM wfagwf_t
             WHERE wfagwfent=g_enterprise AND wfagwfsite=g_site AND wfagwf001=g_sfakwf3_d[l_ac].wfapwf019
            
            #??
            SELECT wfahwf005,wfahwf006,wfahwf010,wfahwf008,wfahwf009
              INTO g_sfakwf3_d[l_ac].sfakwf017,g_sfakwf3_d[l_ac].sfakwf018,g_sfakwf3_d[l_ac].sfakwf019,g_sfakwf3_d[l_ac].sfakwf020,g_sfakwf3_d[l_ac].sfakwf021
              FROM wfahwf_t
             WHERE wfahwfent=g_enterprise AND wfahwfsite=g_site AND wfahwf001 =g_sfakwf3_d[l_ac].wfapwf021
            
            #?? 
            SELECT wfajwf004,wfajwfl003
             INTO g_sfakwf3_d[l_ac].sfakwf023,g_sfakwf3_d[l_ac].wfapwf020_desc
             FROM wfajwf_t LEFT OUTER JOIN wfajwfl_t ON wfajwflent = wfajwfent AND wfajwfl001= wfajwf004 AND wfajwfl002=g_dlang
            WHERE wfajwfent=g_enterprise AND wfajwfsite=g_site AND wfajwf001=g_sfakwf3_d[l_ac].wfapwf020

            #?? 
            SELECT wfalwf005,wfalwf006,wfalwf007,wfalwf008
             INTO g_sfakwf3_d[l_ac].sfakwf025,g_sfakwf3_d[l_ac].sfakwf026,g_sfakwf3_d[l_ac].sfakwf027,g_sfakwf3_d[l_ac].sfakwf028
             FROM wfalwf_t
            WHERE wfalwfent=g_enterprise AND wfalwfsite=g_site AND wfalwf001=g_sfakwf3_d[l_ac].wfapwf023
            #end add-point
           
            IF l_ac > g_max_rec THEN
               #????????????????????????????
               IF cl_null(g_action_choice) OR g_action_choice <> "ui_change" THEN   #190108-00038
                  INITIALIZE g_errparam TO NULL 
                  LET g_errparam.extend = l_ac
                  LET g_errparam.code = 9035 
                  LET g_errparam.popup = TRUE 
                  CALL cl_err()
               END IF   #190108-00038
               EXIT FOREACH
            END IF
            
            LET l_ac = l_ac + 1
            
         END FOREACH
               CALL g_sfakwf3_d.deleteElement(g_sfakwf3_d.getLength())
 
      END IF
   END IF
 
   IF bsft001_wf_fill_chk(5) THEN
      IF (pi_idx = 5 OR pi_idx = 0 ) AND g_sfakwf_d.getLength() > 0 THEN
               CALL g_sfakwf5_d.clear()
 
         
         #??????????idx
         LET g_detail_idx = g_detail_idx_list[1]
         
         LET g_sql = "SELECT  DISTINCT sfanwfseq,sfanwf002,sfanwf001,sfanwf006,sfanwf003,sfanwf004,sfanwf005 ,t19.imaal003 ,t20.imecl005 ,t21.oocal003 FROM sfanwf_t",    
                     "",
                                    " LEFT JOIN imaal_t t19 ON t19.imaalent="||g_enterprise||" AND t19.imaal001=sfanwf001 AND t19.imaal002='"||g_dlang||"' ",
               " LEFT JOIN imecl_t t20 ON t20.imeclent="||g_enterprise||" AND t20.imecl003=sfanwf006 AND t20.imecl004='"||g_dlang||"' ",
               " LEFT JOIN oocal_t t21 ON t21.oocalent="||g_enterprise||" AND t21.oocal001=sfanwf004 AND t21.oocal002='"||g_dlang||"' ",
 
                     " WHERE sfanwfent=? AND sfanwfsite=? AND sfanwfdocno=? AND sfanwfseq1=?"
         
         IF NOT cl_null(g_wc2_table5) THEN
            LET g_sql = g_sql CLIPPED," AND ",g_wc2_table5 CLIPPED
         END IF
         
         LET g_sql = g_sql, " ORDER BY  sfanwf_t.sfanwfseq" 
                            
         #add-point:????? name="b_fill2.before_fill5"

         #end add-point
         
         #?????
               CALL g_sfakwf5_d.clear()
 
         
         LET g_sql = cl_sql_add_mask(g_sql)              #??????
         PREPARE bsft001_wf_pb5 FROM g_sql
         DECLARE b_fill_curs5 CURSOR FOR bsft001_wf_pb5
         
      #  OPEN b_fill_curs5 USING g_enterprise, g_site,g_sfajwf_m.sfajwfdocno,g_sfakwf_d[g_detail_idx].sfakwfseq   #(ver:78)
         LET l_ac = 1
         FOREACH b_fill_curs5 USING g_enterprise, g_site,g_sfajwf_m.sfajwfdocno,g_sfakwf_d[g_detail_idx].sfakwfseq INTO g_sfakwf5_d[l_ac].sfanwfseq,g_sfakwf5_d[l_ac].sfanwf002,g_sfakwf5_d[l_ac].sfanwf001,g_sfakwf5_d[l_ac].sfanwf006,g_sfakwf5_d[l_ac].sfanwf003,g_sfakwf5_d[l_ac].sfanwf004,g_sfakwf5_d[l_ac].sfanwf005, 
             g_sfakwf5_d[l_ac].sfanwf001_desc,g_sfakwf5_d[l_ac].sfanwf006_desc,g_sfakwf5_d[l_ac].sfanwf004_desc   #(ver:78)
            IF SQLCA.SQLCODE THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "FOREACH:",SQLERRMESSAGE 
               LET g_errparam.code = SQLCA.SQLCODE 
               LET g_errparam.popup = TRUE 
               CALL cl_err()
               EXIT FOREACH
            END IF
            
            #add-point:b_fill????? name="b_fill2.fill5"
            LET g_sfakwf5_d[l_ac].l_sfanwfseq1 = g_sfakwf_d[g_detail_idx].sfakwfseq
            #end add-point
           
            IF l_ac > g_max_rec THEN
               #????????????????????????????
               IF cl_null(g_action_choice) OR g_action_choice <> "ui_change" THEN   #190108-00038
                  INITIALIZE g_errparam TO NULL 
                  LET g_errparam.extend = l_ac
                  LET g_errparam.code = 9035 
                  LET g_errparam.popup = TRUE 
                  CALL cl_err()
               END IF   #190108-00038
               EXIT FOREACH
            END IF
            
            LET l_ac = l_ac + 1
            
         END FOREACH
               CALL g_sfakwf5_d.deleteElement(g_sfakwf5_d.getLength())
 
      END IF
   END IF
 
 
      
   LET g_sfakwf2_d_mask_o.* =  g_sfakwf2_d.*
   FOR l_ac = 1 TO g_sfakwf2_d.getLength()
      LET g_sfakwf2_d_mask_o[l_ac].* =  g_sfakwf2_d[l_ac].*
      CALL bsft001_wf_sfbcwf_t_mask()
      LET g_sfakwf2_d_mask_n[l_ac].* =  g_sfakwf2_d[l_ac].*
   END FOR
   LET g_sfakwf3_d_mask_o.* =  g_sfakwf3_d.*
   FOR l_ac = 1 TO g_sfakwf3_d.getLength()
      LET g_sfakwf3_d_mask_o[l_ac].* =  g_sfakwf3_d[l_ac].*
      CALL bsft001_wf_wfapwf_t_mask()
      LET g_sfakwf3_d_mask_n[l_ac].* =  g_sfakwf3_d[l_ac].*
   END FOR
   LET g_sfakwf5_d_mask_o.* =  g_sfakwf5_d.*
   FOR l_ac = 1 TO g_sfakwf5_d.getLength()
      LET g_sfakwf5_d_mask_o[l_ac].* =  g_sfakwf5_d[l_ac].*
      CALL bsft001_wf_sfanwf_t_mask()
      LET g_sfakwf5_d_mask_n[l_ac].* =  g_sfakwf5_d[l_ac].*
   END FOR
 
      
   #add-point:????? name="b_fill2.after_fill"

   #end add-point
    
   LET l_ac = li_ac
   
   CALL bsft001_wf_detail_show()
   
   LET g_detail_idx = li_detail_idx_tmp
   
END FUNCTION

{</section>}

{<section id="bsft001_wf.fill_chk" type="s" >}
#+ ??????
PRIVATE FUNCTION bsft001_wf_fill_chk(ps_idx) RETURNS (INT)   #200213-00032
   #add-point:fill_chk?define(???) name="fill_chk.define_customerization"

   #end add-point
   DEFINE ps_idx        LIKE type_t.chr10
   #add-point:fill_chk?define (?????????????????, ?????patch????????) name="fill_chk.define"

   #end add-point
   
   #add-point:Function???? name="fill_chk.before_chk"

   #end add-point
   
   #?funtion??????(2015/1/12)
   #??????????true(????????)
 
   #???1=1 or null???true
   IF (cl_null(g_wc2_table1) OR g_wc2_table1.trim() = '1=1')  AND 
      (cl_null(g_wc2_table2) OR g_wc2_table2.trim() = '1=1')  AND 
      (cl_null(g_wc2_table3) OR g_wc2_table3.trim() = '1=1')  AND 
      (cl_null(g_wc2_table4) OR g_wc2_table4.trim() = '1=1')  AND 
      (cl_null(g_wc2_table5) OR g_wc2_table5.trim() = '1=1') THEN
      #add-point:fill_chk?other_chk name="fill_chk.other_chk"

      #end add-point
      RETURN TRUE
   END IF
   
   #add-point:fill_chk?after_chk name="fill_chk.after_chk"

   #end add-point
   
   RETURN TRUE
 
END FUNCTION

{</section>}

{<section id="bsft001_wf.status_show" type="s" >}
PRIVATE FUNCTION bsft001_wf_status_show() RETURNS ()   #200213-00032
   #add-point:status_show?define(???) name="status_show.define_customerization"

   #end add-point
   #add-point:status_show?define (?????????????????, ?????patch????????) name="status_show.define"

   #end add-point
   
   #add-point:status_show?status_show name="status_show.status_show"

   #end add-point
END FUNCTION

{</section>}

{<section id="bsft001_wf.mask_functions" type="s" >}
&include "erp/csf/bsft001_wf_mask.4gl"

{</section>}

{<section id="bsft001_wf.signature" type="s" >}
   #?? a39 ??????(Version:13)
#+ BPM??
PRIVATE FUNCTION bsft001_wf_send() RETURNS (INT)   #200213-00032
   #add-point:send?define(???) name="send.define_customerization"

   #end add-point 
   #add-point:send?define(?????????????????, ?????patch????????) name="send.define"

   #end add-point 
   
   #add-point:Function????  name="send.pre_function"

   #end add-point
   
   #??????????????????" 1=1"  (??????????)
   LET g_wc2_table1 = " 1=1"
   LET g_wc2_table2 = " 1=1"
 
 
   CALL bsft001_wf_show()
   CALL bsft001_wf_set_pk_array()
   
   #add-point: ????ADP name="send.before_send"

   #end add-point
   
   #???????
   CALL cl_bpm_data_init()
                  
   #????/?????? CALL cl_bpm_set_master_data() / cl_bpm_set_detail_data() 
   #????? CALL cl_bpm_set_master_data(util.JSONObject.fromFGL(xxxx)) ????: (1)????  ; ???: ?
   CALL cl_bpm_set_master_data(util.JSONObject.fromFGL(g_sfajwf_m))
                              
   #????? CALL cl_bpm_set_detail_data(s_detailX, util.JSONArray.fromFGL(xxxx)) ????: (1)??SR??  (2)????  ; ???: ?
   CALL cl_bpm_set_detail_data("s_detail1", util.JSONArray.fromFGL(g_sfakwf_d))
   CALL cl_bpm_set_detail_data("s_detail2", util.JSONArray.fromFGL(g_sfakwf2_d))
   CALL cl_bpm_set_detail_data("s_detail3", util.JSONArray.fromFGL(g_sfakwf3_d))
   CALL cl_bpm_set_detail_data("s_detail4", util.JSONArray.fromFGL(g_sfakwf4_d))
   CALL cl_bpm_set_detail_data("s_detail5", util.JSONArray.fromFGL(g_sfakwf5_d))
 
 
   # cl_bpm_cli() ???????aws_condition()=>???????????????'W'
   # cl_bpm_cli() ????:?  ;  ???: 0 ????; 1 ????
 
   #add-point: ????ADP name="send.before_cli"
   CALL cl_bpm_set_detail_data("s_detail1_s_icd_wf_s01", util.JSONArray.fromFGL(g_icbawf_d)) #17538 add
   #end add-point
 
   #????
   IF NOT cl_bpm_cli() THEN 
      RETURN FALSE
   END IF
 
   #add-point: ????ADP name="send.after_send"

   #end add-point
 
   #??????????,?????refresh???????
   #CALL bsft001_wf_ui_browser_refresh()
 
   #??????????????=>???
   LET g_browser[g_current_idx].b_statepic = "stus/16/signing.png"
 
   #??????/????,DISPLAY????
   CALL bsft001_wf_ui_headershow()
   CALL bsft001_wf_ui_detailshow()
 
 
 
   RETURN TRUE
   
END FUNCTION
 
 
 
#?? a40 ??????(Version:11)
#+ BPM??
PRIVATE FUNCTION bsft001_wf_draw_out() RETURNS (INT)   #200213-00032
   #add-point:draw?define name="draw.define_customerization"

   #end add-point
   #add-point:draw?define(?????????????????, ?????patch????????) name="draw.define"

   #end add-point
   
   #add-point:Function????  name="draw.pre_function"

   #end add-point
   
   #????
   IF NOT cl_bpm_draw_out() THEN 
      RETURN FALSE
   END IF    
          
   #??????????????=>??
   LET g_browser[g_current_idx].b_statepic = "stus/16/draw_out.png"
 
   #??????/????,DISPLAY????
   CALL bsft001_wf_ui_headershow()  
   CALL bsft001_wf_ui_detailshow()
 
 
 
   #add-point:Function????  name="draw.after_function"

   #end add-point
 
   RETURN TRUE
   
END FUNCTION
 
 
 
 

{</section>}

{<section id="bsft001_wf.set_pk_array" type="s" >}
   #?? a51 ??????(Version:11)
#+ ??pk_array??
PRIVATE FUNCTION bsft001_wf_set_pk_array() RETURNS ()   #200213-00032
   #add-point:set_pk_array?define name="set_pk_array.define_customerization"

   #end add-point
   #add-point:set_pk_array?define(?????????????????, ?????patch????????) name="set_pk_array.define"

   #end add-point
   
   #add-point:Function???? name="set_pk_array.before"

   #end add-point  
 
 
   #181105-00036 ---modify start---  
   #210120-00006 ---modify start---
   CALL g_pk_array.clear()
 
   #??????????
   IF cl_null(g_sfajwf_m.sfajwfdocno) THEN
      RETURN
   END IF
   #210120-00006 --- modify end ---
   #181105-00036 --- modify end ---
   
   LET g_pk_array[1].values = g_sfajwf_m.sfajwfdocno
   LET g_pk_array[1].column = 'sfajwfdocno'
 
   
   #add-point:set_pk_array??? name="set_pk_array.after"

   #end add-point  
   
END FUNCTION
 
 
 

{</section>}

{<section id="bsft001_wf.other_dialog" readonly="Y" type="s" >}
   

{</section>}

{<section id="bsft001_wf.msgcentre_notify" type="s" >}
#?? a66 ??????(Version:7)
PRIVATE FUNCTION bsft001_wf_msgcentre_notify(lc_state) RETURNS ()   #200213-00032
   #add-point:msgcentre_notify?define name="msgcentre_notify.define_customerization"

   #end add-point   
   DEFINE lc_state LIKE type_t.chr80
   #add-point:msgcentre_notify?define(?????????????????, ?????patch????????) name="msgcentre_notify.define"

   #end add-point
   
   #add-point:Function????  name="msgcentre_notify.pre_function"

   #end add-point
   
   INITIALIZE g_msgparam TO NULL
 
   #action-id?????
   LET g_msgparam.state = lc_state
 
   #PK????
   CALL bsft001_wf_set_pk_array()
   #??????
   LET g_msgparam.data[1] = util.JSON.stringify(g_sfajwf_m)
 
   #add-point:msgcentre???? name="msgcentre_notify.process"

   #end add-point
 
   #??????????????
   CALL cl_msgcentre_notify()
 
END FUNCTION
 
 
 

{</section>}

{<section id="bsft001_wf.action_chk" type="s" >}
#+ ??/???????(????????), ????????????????
PRIVATE FUNCTION bsft001_wf_action_chk() RETURNS (INT)   #200213-00032
   #add-point:action_chk?define(???) name="action_chk.define_customerization"

   #end add-point
   #add-point:action_chk?define (?????????????????, ?????patch????????) name="action_chk.define"

   #end add-point
   
   #add-point:action_chk?action_chk name="action_chk.action_chk"

   #end add-point
      
   RETURN TRUE
   
END FUNCTION

{</section>}

{<section id="bsft001_wf.other_function" readonly="Y" type="s" >}

################################################################################
# Descriptions...: ????
# Memo...........:
# Usage..........: CALL s_aooi150_ins (????)
#                  RETURNING ????
# Input parameter: ??????1   ????????1
#                : ??????2   ????????2
# Return code....: ??????1   ????????1
#                : ??????2   ????????2
# Date & Author..: ?? By ??
# Modify.........:
################################################################################
PRIVATE FUNCTION bsft001_wf_set_no_require()
   CALL cl_set_comp_required("sfakwf010,sfakwf011,sfakwf016,sfbcwf040,sfbcwf041,sfbcwf042", FALSE)   #240709-00009#1 add
END FUNCTION

################################################################################
# Descriptions...: ????
# Memo...........:
# Usage..........: CALL s_aooi150_ins (????)
#                  RETURNING ????
# Input parameter: ??????1   ????????1
#                : ??????2   ????????2
# Return code....: ??????1   ????????1
#                : ??????2   ????????2
# Date & Author..: ?? By ??
# Modify.........:
################################################################################
PRIVATE FUNCTION bsft001_wf_set_require()
#230818-00019#5 add--s
DEFINE  l_imafwf210  LIKE imaf_t.imafwf210 
DEFINE  l_imafwf209  LIKE imaf_t.imafwf209 
DEFINE  l_imafwf207  LIKE imaf_t.imafwf207 
DEFINE  l_imafwf208  LIKE imaf_t.imafwf208 
#230818-00019#5 add--e

   CALL cl_set_comp_required("sfajwfdocno,sfajwf001,sfajwf002,sfajwf003,sfajwf004,sfajwf005,sfajwf006,sfajwf007,sfajwf012,sfajwf013",TRUE)
   #240423-00004#1-24042401-16508 add by lijlg -----start ?????=1.??,???????????
   IF g_sfajwf_m.sfajwf005 = '1' THEN 
      CALL cl_set_comp_required("sfajwf006,sfajwf007",FALSE)
   END IF 
   #240423-00004#1-24042401-16508 add by lijlg -----end
   
   #240709-00009#1 add--s
   IF l_ac > 0 THEN 
      SELECT imafwf210,imafwf209,imafwf207,imafwf208 INTO l_imafwf210,l_imafwf209,l_imafwf207,l_imafwf208
        FROM imaf_t
       WHERE imafent = g_enterprise
         AND imafsite = g_site
         AND imaf001 = g_sfakwf_d[l_ac].sfakwf001
      #250114-00001#1 mark--s
      IF l_imafwf209 = 'Y' THEN
         CALL cl_set_comp_required("sfakwf010", TRUE) 
      END IF  
      #250114-00001#1 mark--e
      IF l_imafwf210 = 'N' THEN 
         #250114-00001#1 mark--s
#         IF l_imafwf209 = 'Y' THEN
#            CALL cl_set_comp_required("sfakwf010", TRUE) 
#         END IF  
         #250114-00001#1 mark--e
         IF l_imafwf207 = 'Y' THEN
            CALL cl_set_comp_required("sfakwf011", TRUE)
         END IF 
         IF l_imafwf208 = 'Y' THEN
            CALL cl_set_comp_required("sfakwf016", TRUE)
         END IF
         DISPLAY BY NAME g_sfakwf_d[l_ac].sfakwf010,g_sfakwf_d[l_ac].sfakwf011,g_sfakwf_d[l_ac].sfakwf016       
      END IF
      SELECT imafwf210,imafwf209,imafwf207,imafwf208 INTO l_imafwf210,l_imafwf209,l_imafwf207,l_imafwf208
        FROM imaf_t
       WHERE imafent = g_enterprise
         AND imafsite = g_site
         AND imaf001 = g_sfakwf2_d[l_ac].sfbcwf006
      #250114-00001#1 add--s
      IF l_imafwf209 = 'Y' THEN
         CALL cl_set_comp_required("sfbcwf040", TRUE) 
      END IF 
      #250114-00001#1 add--e     
      IF l_imafwf210 = 'N' THEN 
         #250114-00001#1 mark--s
#         IF l_imafwf209 = 'Y' THEN
#            CALL cl_set_comp_required("sfbcwf040", TRUE) 
#         END IF 
         #250114-00001#1 mark--e      
         IF l_imafwf207 = 'Y' THEN
            CALL cl_set_comp_required("sfbcwf041", TRUE)
         END IF 
         IF l_imafwf208 = 'Y' THEN
            CALL cl_set_comp_required("sfbcwf042", TRUE)
         END IF
         DISPLAY BY NAME g_sfakwf2_d[l_ac].sfbcwf040,g_sfakwf2_d[l_ac].sfbcwf041,g_sfakwf2_d[l_ac].sfbcwf042      
      END IF  
   END IF  
   #240709-00009#1 add--e
END FUNCTION

################################################################################
# Descriptions...: ????
# Memo...........: ??asft300?asft300_sfaadocno_chk
# Usage..........: CALL bsft001_wf_sfajwfdocno_chk()
#                  RETURNING TRUE OR FALSE
# Input parameter: 
# Return code....: 
# Date & Author..: 
# Modify.........:
################################################################################
PRIVATE FUNCTION bsft001_wf_sfajwfdocno_chk()
DEFINE l_success    LIKE type_t.num5
DEFINE l_flag       LIKE type_t.num5

#170515-00008#1 remark(s)
   IF NOT ap_chk_notDup("","SELECT COUNT(1) FROM sfajwf_t WHERE "||"sfajwfent = " ||g_enterprise|| " AND sfajwfsite = '" ||g_site|| "' AND "||"sfajwfdocno = '"||g_sfajwf_m.sfajwfdocno ||"'",'std-00004',0) THEN 
      RETURN FALSE
   END IF
#170515-00008#1 remark(e)
   IF NOT s_aooi200_chk_slip(g_site,'',g_sfajwf_m.sfajwfdocno,g_prog) THEN
      RETURN FALSE
   END IF

   #150909 earl add s
   #???????????
   IF NOT cl_null(g_sfajwf_m.sfajwf018) THEN
     #IF NOT s_aooi210_check_doc(g_site,'',g_sfaa_m.sfaa006,g_sfajwf_m.sfajwfdocno,'3','') THEN   #180509-00055#1 mark
      IF NOT s_aooi210_check_doc(g_site,'',g_sfajwf_m.sfajwf018,g_sfajwf_m.sfajwfdocno,'1',g_prog) THEN   #180509-00055#1 add
         RETURN FALSE
      END IF
   END IF
   #150909 earl add e

   #?????????????key??????????,'6' ????????
   CALL s_control_chk_doc('1',g_sfajwf_m.sfajwfdocno,'6',g_user,g_dept,'','') RETURNING l_success,l_flag
   IF l_success THEN
      IF NOT l_flag THEN
         RETURN FALSE
      END IF
   END IF

   RETURN TRUE
END FUNCTION

################################################################################
# Descriptions...: ????
# Memo...........: ??asft300?asft300_sfaadocno_default
#                  (?????????????aooi200?????????????aooi200????)
# Usage..........: CALL bsft001_wf_sfajwfdocno_default()
# Input parameter: 
# Return code....: r_success ??????????????? 
# Date & Author..: 
# Modify.........:
################################################################################
PRIVATE FUNCTION bsft001_wf_sfajwfdocno_default()
DEFINE l_imae032    LIKE imae_t.imae032
DEFINE r_success    LIKE type_t.num5    #161116-00048#1 add
DEFINE l_slip       LIKE ooba_t.ooba002  #170602-00016#1
DEFINE l_success    LIKE type_t.num5     #170602-00016#1
DEFINE l_sfajwf018_str  STRING

   CALL s_aooi200_get_slip(g_sfajwf_m.sfajwfdocno) RETURNING l_success,l_slip  #170602-00016#1
   #240530-00021#1 add---s
   IF cl_get_doc_para(g_enterprise,g_site,g_sfajwf_m.sfajwfdocno,'D-BWF-0004') = 'Y' THEN
         LET g_sfajwf_m.sfajwf005 = '2'
   ELSE
         IF cl_get_para(g_enterprise,g_site,"S-BWF-0001") = 'Y' THEN 
            LET g_sfajwf_m.sfajwf005 = '1'
         ELSE 
            LET g_sfajwf_m.sfajwf005 = '2'            
         END IF 
   END IF    
   DISPLAY BY NAME g_sfajwf_m.sfajwf005
   #240530-00021#1 add---e
   #240530-00021#1 mark-s
#   IF cl_get_para(g_enterprise,g_site,"S-BWF-0001") = 'Y' THEN 
#      LET g_sfajwf_m.sfajwf005 = '1'
#   ELSE 
#      LET g_sfajwf_m.sfajwf005 = '2'            
#   END IF
   #240530-00021#1 mark-e
   #???????????
   #170602-00016#1-s g_sfajwf_m.sfajwfdocno???l_slip
   LET g_sfajwf_m.sfajwf006 = s_aooi200_get_doc_default(g_site,'1',l_slip,'sfajwf006',g_sfajwf_m.sfajwf006)
   LET g_sfajwf_m.sfajwf008 = s_aooi200_get_doc_default(g_site,'1',l_slip,'sfajwf008',g_sfajwf_m.sfajwf008)
   LET g_sfajwf_m.sfajwf010 = s_aooi200_get_doc_default(g_site,'1',l_slip,'sfajwf010',g_sfajwf_m.sfajwf010)
   LET g_sfajwf_m.sfajwf012 = s_aooi200_get_doc_default(g_site,'1',l_slip,'sfajwf012',g_sfajwf_m.sfajwf012)
   LET g_sfajwf_m.sfajwf013 = s_aooi200_get_doc_default(g_site,'1',l_slip,'sfajwf013',g_sfajwf_m.sfajwf013)
   LET g_sfajwf_m.sfajwf001 = s_aooi200_get_doc_default(g_site,'1',l_slip,'sfajwf001',g_sfajwf_m.sfajwf001)
   LET g_sfajwf_m.sfajwf002 = s_aooi200_get_doc_default(g_site,'1',l_slip,'sfajwf002',g_sfajwf_m.sfajwf002)
   LET g_sfajwf_m.sfajwf007 = s_aooi200_get_doc_default(g_site,'1',l_slip,'sfajwf007',g_sfajwf_m.sfajwf007)
   LET g_sfajwf_m.sfajwf009 = s_aooi200_get_doc_default(g_site,'1',l_slip,'sfajwf009',g_sfajwf_m.sfajwf009)
   LET g_sfajwf_m.sfajwf011 = s_aooi200_get_doc_default(g_site,'1',l_slip,'sfajwf011',g_sfajwf_m.sfajwf011)
   LET g_sfajwf_m.sfajwf014 = s_aooi200_get_doc_default(g_site,'1',l_slip,'sfajwf014',g_sfajwf_m.sfajwf014)
   LET g_sfajwf_m.sfajwf003 = s_aooi200_get_doc_default(g_site,'1',l_slip,'sfajwf003',g_sfajwf_m.sfajwf003)
   LET g_sfajwf_m.sfajwf005 = s_aooi200_get_doc_default(g_site,'1',l_slip,'sfajwf005',g_sfajwf_m.sfajwf005)
   LET g_sfajwf_m.sfajwf004 = s_aooi200_get_doc_default(g_site,'1',l_slip,'sfajwf004',g_sfajwf_m.sfajwf004)
   LET g_sfajwf_m.sfajwf015 = s_aooi200_get_doc_default(g_site,'1',l_slip,'sfajwf015',g_sfajwf_m.sfajwf015)
   LET g_sfajwf_m.sfajwf016 = s_aooi200_get_doc_default(g_site,'1',l_slip,'sfajwf016',g_sfajwf_m.sfajwf016)
   LET g_sfajwf_m.sfajwf017 = s_aooi200_get_doc_default(g_site,'1',l_slip,'sfajwf017',g_sfajwf_m.sfajwf017)
   LET g_sfajwf_m.sfajwf018 = s_aooi200_get_doc_default(g_site,'1',l_slip,'sfajwf018',g_sfajwf_m.sfajwf018)
   LET g_sfajwf_m.sfajwf025 = s_aooi200_get_doc_default(g_site,'1',l_slip,'sfajwf025',g_sfajwf_m.sfajwf025) #250328-00010#1 add

   
   IF NOT cl_null(g_sfajwf_m.sfajwf019) AND g_sfajwf_m.sfajwf017 = '1' THEN
      LET l_sfajwf018_str = g_sfajwf_m.sfajwf019 CLIPPED,"-",g_sfajwf_m.sfajwf020 CLIPPED,"-",g_sfajwf_m.sfajwf021 CLIPPED
      CALL cl_replace_str(l_sfajwf018_str, " ", "") RETURNING g_sfajwf_m.l_sfajwf018
   END IF
   
   DISPLAY BY NAME g_sfajwf_m.sfajwf006,g_sfajwf_m.sfajwf008,g_sfajwf_m.sfajwf010,g_sfajwf_m.sfajwf012,g_sfajwf_m.sfajwf013,
                   g_sfajwf_m.sfajwf001,g_sfajwf_m.sfajwf002,g_sfajwf_m.sfajwf007,g_sfajwf_m.sfajwf009,g_sfajwf_m.sfajwf011,
                   g_sfajwf_m.sfajwf014,g_sfajwf_m.sfajwf003,g_sfajwf_m.sfajwf005,g_sfajwf_m.sfajwf004,g_sfajwf_m.sfajwf015,
                   g_sfajwf_m.sfajwf016  

   LET g_sfajwf_m.sfajwf002_desc = s_desc_get_department_desc(g_sfajwf_m.sfajwf002)
   DISPLAY BY NAME g_sfajwf_m.sfajwf002_desc
   
   LET g_sfajwf_m.sfajwf006_desc = s_desc_get_trading_partner_abbr_desc(g_sfajwf_m.sfajwf006)   
   DISPLAY BY NAME g_sfajwf_m.sfajwf006_desc
   
   LET g_sfajwf_m.sfajwf008_desc = s_desc_get_stock_desc(g_site,g_sfajwf_m.sfajwf008)   
   DISPLAY BY NAME g_sfajwf_m.sfajwf008_desc
   
   LET g_sfajwf_m.sfajwf010_desc = s_desc_get_stock_desc(g_site,g_sfajwf_m.sfajwf010)   
   DISPLAY BY NAME g_sfajwf_m.sfajwf010_desc
    
   LET g_sfajwf_m.sfajwf012_desc = bsft001_wf_sfajwf012_desc(g_sfajwf_m.sfajwf012)   
   DISPLAY BY NAME g_sfajwf_m.sfajwf012_desc
   
   LET g_sfajwf_m.sfajwf001_desc = s_desc_get_person_desc(g_sfajwf_m.sfajwf001)   
   DISPLAY BY NAME g_sfajwf_m.sfajwf001_desc
   
   LET g_sfajwf_m.sfajwf007_desc = s_desc_get_ooib002_desc(g_sfajwf_m.sfajwf007)   
   DISPLAY BY NAME g_sfajwf_m.sfajwf007_desc
   
   LET g_sfajwf_m.sfajwf009_desc = s_desc_get_locator_desc(g_site,g_sfajwf_m.sfajwf008,g_sfajwf_m.sfajwf009)   
   DISPLAY BY NAME g_sfajwf_m.sfajwf009_desc
   
   LET g_sfajwf_m.sfajwf011_desc = s_desc_get_locator_desc(g_site,g_sfajwf_m.sfajwf008,g_sfajwf_m.sfajwf011)   
   DISPLAY BY NAME g_sfajwf_m.sfajwf011_desc
   
   LET g_sfajwf_m.sfajwf023_desc = s_desc_get_icaa001_desc(g_sfajwf_m.sfajwf023)  
   DISPLAY BY NAME g_sfajwf_m.sfajwf023_desc
   
   #250328-00010#1 add--s
   LET g_sfajwf_m.sfajwf025_desc = s_desc_get_department_desc(g_sfajwf_m.sfajwf025)
   DISPLAY BY NAME g_sfajwf_m.sfajwf025_desc 
   #250328-00010#1 add--e
   
   LET g_sfajwf_m_o.* = g_sfajwf_m.*
   
   LET r_success = TRUE
   RETURN r_success

END FUNCTION

################################################################################
# Descriptions...: ???????
# Memo...........:
# Usage..........: CALL bsft001_wf_sfajwf012_desc(p_wfakwfl001)
#                  RETURNING r_wfakwfl003
# Input parameter: p_wfakwfl001 ??????
# Return code....: r_wfakwfl003 ??????
# Date & Author..: ?? By ??
# Modify.........:
################################################################################
PRIVATE FUNCTION bsft001_wf_sfajwf012_desc(p_wfakwfl001)
DEFINE p_wfakwfl001  LIKE wfakwfl_t.wfakwfl001
DEFINE r_wfakwfl003  LIKE wfakwfl_t.wfakwfl003
   WHENEVER ERROR CONTINUE

   LET r_wfakwfl003   = NULL
   SELECT wfakwfl003 INTO r_wfakwfl003 FROM wfakwfl_t
    WHERE wfakwfl001 = p_wfakwfl001
      AND wfakwfl002 = g_dlang
      AND wfakwflent = g_enterprise
                                     
   RETURN r_wfakwfl003
END FUNCTION

################################################################################
# Descriptions...: ??????sfajwf008?????sfajwf009????
# Memo...........: ??asft300?asft300_chk_warehouses
# Usage..........: CALL bsft001_wf_chk_warehouses()
#                  RETURNING r_success
# Input parameter: 
# Return code....: r_success false ?? true??
# Date & Author..: ?? By ??
# Modify.........:
################################################################################
PRIVATE FUNCTION bsft001_wf_chk_warehouses()
DEFINE r_success      LIKE type_t.num5
DEFINE l_inaa007      LIKE inaa_t.inaa007   

   LET r_success = FALSE

   #1.???????
   IF NOT cl_null(g_sfajwf_m.sfajwf008) THEN
      INITIALIZE g_chkparam.* TO NULL
      LET g_chkparam.arg1 = g_sfajwf_m.sfajwf008
      #160318-00025#4--add--str
      LET g_errshow = TRUE 
      LET g_chkparam.err_str[1] = "aim-00065:sub-01302|aini001|",cl_get_progname("aini001",g_lang,"2"),"|:EXEPROGaini001"
      #160318-00025#4--add--end
      IF NOT cl_chk_exist("v_inaa001_2") THEN
         RETURN r_success
      END IF
   END IF

   #2.????
   IF NOT cl_null(g_sfajwf_m.sfajwf008) AND g_sfajwf_m.sfajwf009 IS NOT NULL THEN
      #170605-00020#11-s add                    
      SELECT inaa007 INTO l_inaa007 FROM inaa_t 
       WHERE inaaent = g_enterprise 
         AND inaasite = g_site 
         AND inaa001 = g_sfajwf_m.sfajwf008                    
      #?[T:?????].[C:????]='1'(??????-????)??????????????
      IF l_inaa007 = '1' THEN   
      #170605-00020#11-s add   
         INITIALIZE g_chkparam.* TO NULL
         LET g_chkparam.arg1 = g_site
         LET g_chkparam.arg2 = g_sfajwf_m.sfajwf008
         LET g_chkparam.arg3 = g_sfajwf_m.sfajwf009
         #160318-00025#4--add--str
         LET g_errshow = TRUE 
         LET g_chkparam.err_str[1] = "aim-00063:sub-01302|aini002|",cl_get_progname("aini002",g_lang,"2"),"|:EXEPROGaini002"
         #160318-00025#4--add--end
         IF NOT cl_chk_exist("v_inab002") THEN
            RETURN r_success
         END IF
      END IF   #170605-00020#11 add
      END IF
   
   LET r_success = TRUE
   RETURN r_success
END FUNCTION

################################################################################
# Descriptions...: ???????????
# Memo...........:  asft300?asft300_sfaa010_chk
# Usage..........: CALL bsft001_wf_sfakwf001_chk()
#                  RETURNING TRUE OR FALSE
# Input parameter: 
# Return code....: 
# Date & Author..: 
# Modify.........:
################################################################################
PRIVATE FUNCTION bsft001_wf_sfakwf001_chk()
DEFINE l_success    LIKE type_t.num5
DEFINE l_flag       LIKE type_t.num5
DEFINE l_ooba002    LIKE ooba_t.ooba002
DEFINE l_sql        STRING
DEFINE l_n          LIKE type_t.num5
DEFINE l_imaf012    LIKE imaf_t.imaf012
DEFINE l_imaf013    LIKE imaf_t.imaf013  #160720-00016#1
DEFINE l_imaf016    LIKE imaf_t.imaf016  #160706-00034#1
DEFINE l_oocq005    LIKE oocq_t.oocq005
DEFINE l_oocq006    LIKE oocq_t.oocq006
   
      INITIALIZE g_chkparam.* TO NULL
   LET g_chkparam.arg1 = g_sfakwf_d[l_ac].sfakwf001 
   IF NOT cl_chk_exist("v_imaa001") THEN
      RETURN FALSE
   END IF
   IF NOT cl_chk_exist("v_imaf001_1") THEN     
      RETURN FALSE
   END IF
   #220105-00035#1 add---start---
   IF g_sfajwf_m.sfajwf003 = '2' THEN
      IF NOT cl_chk_exist("v_imaa001_17") THEN
         RETURN FALSE
      END IF
   ELSE
   #220105-00035#1 add---end---
      #210330-00042#1 add---s
       IF NOT cl_chk_exist("v_imaa001_16") THEN     
         RETURN FALSE
      END IF
      #210330-00042#1 add---e
   END IF             #220105-00035#1 add
   
   #??????????????????????????????????????
   CALL s_control_chk_group('3','6',g_user,g_dept,g_sfakwf_d[l_ac].sfakwf001,'','','','') RETURNING l_success,l_flag
   IF NOT l_success THEN   #????
      RETURN FALSE
   END IF
   IF NOT l_flag THEN      #????
      RETURN FALSE
   END IF
   
   #??????????????????????????????????????
   CALL s_control_chk_doc('4',g_sfajwf_m.sfajwfdocno,g_sfakwf_d[l_ac].sfakwf001,'','','','') RETURNING l_success,l_flag
   IF NOT l_success THEN   #????
      RETURN FALSE
   END IF
   IF NOT l_flag THEN      #????
      RETURN FALSE
   END IF
   
   #??????????????????????????????????????
   CALL s_control_chk_doc('5',g_sfajwf_m.sfajwfdocno,g_sfakwf_d[l_ac].sfakwf001,'','','','') RETURNING l_success,l_flag
   IF NOT l_success THEN   #????
      RETURN FALSE
   END IF
   IF NOT l_flag THEN      #????
      RETURN FALSE
   END IF
   
  #160727-00025#1-s
   CALL s_aooi200_get_slip(g_sfajwf_m.sfajwfdocno) RETURNING l_success,l_ooba002
  #IF g_sfajwf_m.sfajwf003 MATCHES '[145]' THEN
   IF g_sfajwf_m.sfajwf003 MATCHES '[14]' OR
     (g_sfajwf_m.sfajwf003 ='5' AND cl_get_doc_para(g_enterprise,g_site,l_ooba002,'D-MFG-0024') <> '2') THEN
  #160727-00025#1-e
      LET l_sql = " SELECT COUNT(bmaa001) FROM bmaa_t ",
                  "  WHERE bmaaent = ",g_enterprise," AND bmaasite = '",g_site,"' ",
                  "    AND bmaa001 = '",g_sfakwf_d[l_ac].sfakwf001,"' AND bmaastus='Y' "
      PREPARE sel_bmaa_pre FROM l_sql
      LET l_n = 0
      EXECUTE sel_bmaa_pre INTO l_n
      IF l_n = 0 THEN
         LET g_sfakwf_d[l_ac].sfakwf049 = g_sfakwf_d_o.sfakwf049  #250328-00010#1 add         LET g_sfakwf_d[l_ac].sfakwf049 = g_sfajwf_m_o.sfakwf049  #250328-00010#1 add
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = 'asf-00045'
         LET g_errparam.extend = g_sfakwf_d[l_ac].sfakwf001
         LET g_errparam.popup = TRUE
         CALL cl_err()
         RETURN FALSE
      END IF
   END IF
   
   #170817-00039#1--add--start--
   #???????????2.??? ???????
   LET l_n = 0
   SELECT COUNT(1) INTO l_n
     FROM imaa_t
    WHERE imaaent = g_enterprise
      AND imaa001 = g_sfakwf_d[l_ac].sfakwf001
      AND imaa004 = 'X'
      #AND imaa011 <> 2   #PGS(D)-00544 mark
      AND imaa011 <> '2'  #PGS(D)-00544 add
      
   IF l_n>0 THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = 'asf-00891'
      LET g_errparam.extend = g_sfakwf_d[l_ac].sfakwf001
      LET g_errparam.popup = TRUE
      CALL cl_err()
      RETURN FALSE
   END IF
   #170817-00039#1--add--end----
   
   #160706-00034#1-s
   #imaa010->imaf016
   LET l_imaf012 = ''
   LET l_imaf013 = ''
   LET l_imaf016 = ''
   SELECT imaf012,imaf013,imaf016 INTO l_imaf012,l_imaf013,l_imaf016
     FROM imaf_t
    WHERE imafent = g_enterprise
      AND imafsite = g_site
      AND imaf001 = g_sfakwf_d[l_ac].sfakwf001

   #???????????????
   # IF NOT asft300_life_cycle_chk(g_sfajwf_m.sfajwf003,g_sfakwf_d[l_ac].sfakwf001) THEN
   #    RETURN FALSE
   # END IF

   #?????????????
   INITIALIZE g_chkparam.* TO NULL
   LET g_chkparam.err_str[1] = "abm-00250|",l_imaf016,"|",g_sfakwf_d[l_ac].sfakwf001
   LET g_chkparam.arg1 = l_imaf016
   IF NOT cl_chk_exist("v_oocq002_210_1") THEN
      RETURN FALSE
   END IF 
   
   IF g_sfajwf_m.sfajwf017 = '1' THEN #??
      IF l_imaf013 NOT MATCHES '[23]' THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = 'asf-00802'
         LET g_errparam.extend = g_sfakwf_d[l_ac].sfakwf001
         LET g_errparam.popup = TRUE
         CALL cl_err()
         RETURN FALSE
      END IF
   END IF
   
   IF g_sfajwf_m.sfajwf003 = '1' AND cl_get_doc_para(g_enterprise,g_site,g_sfajwf_m.sfajwfdocno,'D-MFG-0065') = 'Y' THEN
      CASE 
         WHEN l_imaf012 = '2' 
            IF g_sfajwf_m.sfajwf017 NOT MATCHES '[367]' THEN   #151207-00017#2
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code = 'asf-00055'  #??????[??????imaf012]?[2.????]?????????????????????
               LET g_errparam.extend = g_sfakwf_d[l_ac].sfakwf001
               LET g_errparam.popup = TRUE
               CALL cl_err()
               RETURN FALSE
            END IF
         WHEN l_imaf012 = '3' OR l_imaf012 = '4' 
            IF g_sfajwf_m.sfajwf017 = '1' THEN
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code = 'asf-00056'  #??????[??????imaf012]?[3.????]?[4.????]???????????
               LET g_errparam.extend = g_sfakwf_d[l_ac].sfakwf001
               LET g_errparam.popup = TRUE
               CALL cl_err()
               RETURN FALSE
            END IF
         OTHERWISE EXIT CASE
      END CASE
   END IF
   
   #????
#   IF NOT asft300_sfakwf001_feature() THEN
#      RETURN FALSE
#   END IF
#
   RETURN TRUE
END FUNCTION

################################################################################
# Descriptions...: ????
# Memo...........:
# Usage..........: CALL bsft001_wf_chk_sfakwf007(p_sfakwf007)
# Input parameter: 
# Return code....: 
# Date & Author..: ?? By ??
# Modify.........:
################################################################################
PRIVATE FUNCTION bsft001_wf_chk_sfakwf007(p_sfakwf007)
DEFINE p_sfakwf007  LIKE sfakwf_t.sfakwf007
DEFINE l_imaa006    LIKE imaa_t.imaa006
DEFINE l_success    LIKE type_t.num5
DEFINE l_rate       LIKE inaj_t.inaj014

   #1.???????
   INITIALIZE g_chkparam.* TO NULL
   LET g_chkparam.arg1 = p_sfakwf007
   #160318-00025#4-s
   LET g_errshow = TRUE 
   LET g_chkparam.err_str[1] = "aim-00005:sub-01302|aooi250|",cl_get_progname("aooi250",g_lang,"2"),"|:EXEPROGaooi250"
   #160318-00025#4-e
   IF NOT cl_chk_exist("v_ooca001") THEN
      RETURN FALSE
   END IF
   
   #2.?????????????
   SELECT imaa006 INTO l_imaa006 FROM imaa_t
    WHERE imaaent = g_enterprise AND imaa001 = g_sfakwf_d[l_ac].sfakwf001
   CALL s_aimi190_get_convert(g_sfakwf_d[l_ac].sfakwf001,p_sfakwf007,l_imaa006) RETURNING l_success,l_rate
   IF NOT l_success THEN
      RETURN FALSE
   END IF
   
   #3.?????????????????
   INITIALIZE g_chkparam.* TO NULL
   LET g_chkparam.arg1 = g_sfakwf_d[l_ac].sfakwf001
   LET g_chkparam.arg2 = p_sfakwf007
   IF NOT cl_chk_exist("v_imao002") THEN
      RETURN FALSE
   END IF
   
   RETURN TRUE
END FUNCTION

################################################################################
# Descriptions...: 
# Memo...........:
# Usage..........: CALL bsft001_wf_get_work_date(p_cmd)
# Input parameter: 
# Return code....: 
# Date & Author..: ?? By ??
# Modify.........:
################################################################################
PRIVATE FUNCTION bsft001_wf_get_work_date(p_cmd)
DEFINE p_cmd        LIKE type_t.chr1
DEFINE l_success    LIKE type_t.num5
DEFINE l_days       LIKE type_t.num5
DEFINE l_pmdn013     LIKE pmdn_t.pmdn013
DEFINE l_imaf173     LIKE imaf_t.imaf173
DEFINE l_imaf174     LIKE imaf_t.imaf174
DEFINE l_imaf153     LIKE imaf_t.imaf153
   
   IF NOT cl_null(g_sfakwf_d[l_ac].sfakwf001) AND NOT cl_null(g_sfakwf_d[l_ac].sfakwf006) AND
     (NOT cl_null(g_sfakwf_d[l_ac].sfakwf032) OR NOT cl_null(g_sfakwf_d[l_ac].sfakwf033)) THEN
      IF p_cmd = 'u' THEN
         IF NOT cl_ask_confirm('asf-00192') THEN
            RETURN
         END IF
      END IF
      IF cl_null(g_sfakwf_d[l_ac].sfakwf033) THEN
         IF NOT cl_null(g_sfakwf_d[l_ac].sfakwf032) THEN
            CALL s_asft300_06('1',g_sfakwf_d[l_ac].sfakwf001,g_sfakwf_d[l_ac].sfakwf006,g_sfakwf_d[l_ac].sfakwf032) RETURNING l_success,g_sfakwf_d[l_ac].sfakwf033
         END IF
      ELSE
         CALL s_asft300_06('2',g_sfakwf_d[l_ac].sfakwf001,g_sfakwf_d[l_ac].sfakwf006,g_sfakwf_d[l_ac].sfakwf033) RETURNING l_success,g_sfakwf_d[l_ac].sfakwf032
         IF g_sfakwf_d[l_ac].sfakwf032 < g_sfajwf_m.sfajwfdocdt THEN
           #LET l_days = g_sfajwf_m.sfajwfdocdt - g_sfakwf_d[l_ac].sfakwf032  #210824-00033#1 mark
            LET g_sfakwf_d[l_ac].sfakwf032 = g_sfajwf_m.sfajwfdocdt
            CALL s_asft300_06('1',g_sfakwf_d[l_ac].sfakwf001,g_sfakwf_d[l_ac].sfakwf006,g_sfakwf_d[l_ac].sfakwf032) RETURNING l_success,g_sfakwf_d[l_ac].sfakwf033  #210824-00033#1
           #CALL s_date_get_work_date(g_site,g_ooef008,'2',g_sfakwf_d[l_ac].sfakwf033,0,l_days) RETURNING g_sfakwf_d[l_ac].sfakwf033  #210824-00033#1 mark
         END IF
      END IF
      LET g_sfakwf_d[l_ac].sfakwf040   = g_sfakwf_d[l_ac].sfakwf032   #?????  #241030-00021#5 add
      #?????
      #??"????"?"????"
      LET l_imaf173 = 0
      LET l_imaf174 = 0
      SELECT imaf173,imaf174,imaf153 INTO l_imaf173,l_imaf174,l_imaf153  
        FROM imaf_t
       WHERE imafent = g_enterprise AND imafsite = g_site AND imaf001 = g_sfakwf_d[l_ac].sfakwf001
#      IF cl_null(l_imaf153) THEN
#         INITIALIZE g_errparam TO NULL
#         LET g_errparam.code = 'axm-00553'
#         LET g_errparam.extend = g_sfajwf_m.sfajwfdocno
#         LET g_errparam.replace[1] = g_sfakwf_d[l_ac].sfakwf001
#         LET g_errparam.popup = TRUE
#         CALL cl_err()       
#      END IF
      #????,?????????????,????????????
      #1.???? = ???? - [T:????????].[C:??????]      
      LET l_imaf173 = l_imaf173 * -1
      LET l_imaf174 = l_imaf174 * -1
      IF NOT cl_null(l_imaf174) AND l_imaf174 <> 0 THEN
         CALL s_date_get_work_date(g_site,g_ooef008,g_ooef009,g_sfakwf_d[l_ac].sfakwf040,0,l_imaf174) RETURNING l_pmdn013
      ELSE
         LET l_pmdn013 = g_sfakwf_d[l_ac].sfakwf040
      END IF
      #2.????= ???? - [T:????????].[C:??????]                              
      IF NOT cl_null(l_imaf173) AND l_imaf173 <> 0 THEN
         CALL s_date_get_work_date(g_site,g_ooef008,g_ooef009,l_pmdn013,0,l_imaf173) RETURNING g_sfakwf_d[l_ac].sfakwf040
      ELSE
         LET g_sfakwf_d[l_ac].sfakwf040 = l_pmdn013
      END IF
       
      IF g_sfakwf_d[l_ac].sfakwf040 < g_sfajwf_m.sfajwfdocdt THEN
         LET g_sfakwf_d[l_ac].sfakwf040 = g_sfajwf_m.sfajwfdocdt
      END IF 
      DISPLAY BY NAME g_sfakwf_d[l_ac].sfakwf032,g_sfakwf_d[l_ac].sfakwf033,g_sfakwf_d[l_ac].sfakwf040
   END IF
END FUNCTION

################################################################################
# Descriptions...: ??WAFER??,????????????????????????????
# Memo...........:
# Usage..........: CALL bsft001_wf_sfakwf001_ref(p_cmd)
#                  RETURNING ????
# Input parameter: ??????1   ????????1
#                : ??????2   ????????2
# Return code....: ??????1   ????????1
#                : ??????2   ????????2
# Date & Author..: ?? By ??
# Modify.........:
################################################################################
PRIVATE FUNCTION bsft001_wf_sfakwf001_ref(p_cmd)
DEFINE p_cmd          LIKE type_t.chr1
DEFINE l_controlno    LIKE ooha_t.ooha001
DEFINE l_imaf153      LIKE imaf_t.imaf153
DEFINE l_sfakwf037    LIKE sfakwf_t.sfakwf037
DEFINE l_sfakwf038    LIKE sfakwf_t.sfakwf038
DEFINE l_success      LIKE type_t.num5
DEFINE l_n            LIKE type_t.num5
DEFINE l_oodbl004     LIKE oodbl_t.oodbl004  #????
DEFINE l_oodb005      LIKE oodb_t.oodb005    #???
DEFINE l_oodb006      LIKE oodb_t.oodb006    #?? 
DEFINE l_oodb011      LIKE oodb_t.oodb011    #??????1:????2:????? 
DEFINE l_pmdl009      LIKE pmdl_t.pmdl009
DEFINE l_pmdl010      LIKE pmdl_t.pmdl010
DEFINE l_pmdl024      LIKE pmdl_t.pmdl024
DEFINE l_pmdl015      LIKE pmdl_t.pmdl015
DEFINE l_pmdl017      LIKE pmdl_t.pmdl017
DEFINE l_pmdl023      LIKE pmdl_t.pmdl023
DEFINE l_pmdl054      LIKE pmdl_t.pmdl054
DEFINE l_pmdn040      LIKE pmdn_t.pmdn040
DEFINE l_pmdn043      LIKE pmdn_t.pmdn043
DEFINE l_pmdn041      LIKE pmdn_t.pmdn041
DEFINE l_pmdn042      LIKE pmdn_t.pmdn042
#250328-00010#1 add--s
DEFINE l_imae032    LIKE imae_t.imae032
DEFINE l_imae033    LIKE imae_t.imae033
DEFINE l_imae034    LIKE imae_t.imae034   
DEFINE l_imae035    LIKE imae_t.imae035   
DEFINE l_imae037    LIKE imae_t.imae037   
DEFINE l_imae012    LIKE imae_t.imae012   
DEFINE l_slip       LIKE ooba_t.ooba002
DEFINE l_count      LIKE type_t.num5
#250328-00010#1 add--e

   #250328-00010#1 add--s
   SELECT imae032,imae033,imae034,imae035,imae037,imae012  
     INTO l_imae032,l_imae033,l_imae034,l_imae035,l_imae037,l_imae012    
     FROM imae_t
    WHERE imaeent = g_enterprise AND imaesite = g_site AND imae001 = g_sfakwf_d[l_ac].sfakwf001
   IF NOT cl_null(l_imae035) THEN    
      LET g_sfakwf_d[l_ac].sfakwf049 =l_imae035
   END IF  
   IF NOT cl_null(g_sfakwf_d[l_ac].sfakwf049) THEN
      LET l_count = 0
      SELECT COUNT(1) INTO l_count
        FROM ooeg_t
       WHERE ooegent = g_enterprise
         AND ooeg001 = g_sfakwf_d[l_ac].sfakwf049
         AND ooegstus='Y'
      IF l_count = 0 THEN
         LET g_sfakwf_d[l_ac].sfakwf049 = ''
      END IF
   END IF
   #???????
   LET g_sfakwf_d[l_ac].sfakwf049_desc = s_desc_get_department_desc(g_sfakwf_d[l_ac].sfakwf049)
   DISPLAY BY NAME g_sfakwf_d[l_ac].sfakwf049,g_sfajwf_m.sfajwf004,g_sfakwf_d[l_ac].sfakwf049_desc
   #250328-00010#1 add--e

   #WAFER??,????
   SELECT imafwf200,imafwf201 
     INTO g_sfakwf_d[l_ac].sfakwf004,g_sfakwf_d[l_ac].sfakwf005
     FROM imaf_t  
    WHERE 1=1
      AND imafent = g_enterprise AND imafsite = g_site
      AND imaf001 = g_sfakwf_d[l_ac].sfakwf001
    
    CALL s_desc_get_item_desc(g_sfakwf_d[l_ac].sfakwf001) RETURNING g_sfakwf_d[l_ac].sfakwf001_desc,g_sfakwf_d[l_ac].sfakwf001_desc_1
    DISPLAY BY NAME g_sfakwf_d[l_ac].sfakwf001_desc,g_sfakwf_d[l_ac].sfakwf001_desc_1
    
    #???????????
    CALL bsft001_wf_get_work_date(p_cmd) 
    
    #????????????????
   #??????????????????????????????????????user ????????????
   LET l_controlno = ''
   SELECT imaf153 INTO l_imaf153   
     FROM imaf_t
    WHERE imafent = g_enterprise
      AND imafsite = g_site
      AND imaf001 = g_sfakwf_d[l_ac].sfakwf001
   
   CALL s_control_get_group1('4',g_user,g_dept,l_imaf153) RETURNING l_success,l_controlno   #211014-00034#5 add
   
   IF NOT cl_null(l_controlno) THEN
      #??????????????????????(apmi110)?????????????default?????
      SELECT COUNT(1) INTO l_n FROM pmal_t 
       WHERE pmalent = g_enterprise 
         AND pmal001 = g_sfajwf_m.sfajwf006 
         AND pmal002 = l_controlno 
         AND pmalstus = 'Y'
      IF l_n > 0 THEN
         SELECT pmal006,pmal020,pmal004,pmal009,pmal003,pmal021,
                pmal008,pmal023
           INTO l_pmdl009,l_pmdl010,l_sfakwf037,l_pmdl024,l_pmdl015,l_pmdl017,
                l_pmdl023,l_pmdl054
           FROM pmal_t 
          WHERE pmalent = g_enterprise 
            AND pmal001 = g_sfajwf_m.sfajwf006 
            AND pmal002 = l_controlno 
            AND pmalstus = 'Y'
      END IF
   END IF     
   #???????????????????????????????(apmm202)??  
   IF cl_null(l_controlno) OR l_n = 0 THEN
      SELECT pmab037,pmab053,pmab034,pmab039,pmab033,pmab054,
             pmab038,pmab057
        INTO l_pmdl009,l_pmdl010,l_sfakwf037,l_pmdl024,l_pmdl015,l_pmdl017,
             l_pmdl023,l_pmdl054
        FROM pmab_t 
       WHERE pmabent = g_enterprise 
         AND pmabsite = g_site 
         AND pmab001 = g_sfajwf_m.sfajwf006          
   END IF


   LET g_sfakwf_d[l_ac].sfakwf037   = l_sfakwf037    #?? 
   LET g_sfakwf_d[l_ac].sfakwf038   = l_sfakwf038    #?? 
   
   #??????
   CALL s_tax_chk(g_site,l_sfakwf037)
     RETURNING l_success,l_oodbl004,l_oodb005,l_oodb006,l_oodb011
   LET g_sfakwf_d[l_ac].sfakwf039 = l_oodb005  #?????
   IF l_oodb011 = '2' AND NOT cl_null(g_sfakwf_d[l_ac].sfakwf001) AND NOT cl_null(l_pmdl024) THEN
      #?????
      CALL s_tax_chktype(g_site,g_sfajwf_m.sfajwf006,g_sfakwf_d[l_ac].sfakwf001,'2',l_pmdl024)
           RETURNING l_success,g_sfakwf_d[l_ac].sfakwf037,g_sfakwf_d[l_ac].sfakwf038
      IF NOT l_success THEN
         #???????????????
         LET g_sfakwf_d[l_ac].sfakwf037 = ''
         LET g_sfakwf_d[l_ac].sfakwf038 = ''
      END IF                   
   END IF
   IF cl_null(g_sfakwf_d[l_ac].sfakwf037) OR cl_null(g_sfakwf_d[l_ac].sfakwf038) THEN
      #?????
      LET g_sfakwf_d[l_ac].sfakwf037 = l_sfakwf037
      LET g_sfakwf_d[l_ac].sfakwf038 = l_oodb006
   END IF 
   
   #????
   IF cl_null(g_sfakwf_d[l_ac].sfakwf007) THEN
      SELECT imae016 INTO g_sfakwf_d[l_ac].sfakwf007 FROM imae_t
       WHERE imaeent = g_enterprise AND imaesite = g_site AND imae001 = g_sfakwf_d[l_ac].sfakwf001
   END IF
   
   #????
   SELECT imaf144 INTO g_sfakwf_d[l_ac].sfakwf035 FROM imaf_t
    WHERE imafent = g_enterprise AND imafsite = g_site AND imaf001 = g_sfakwf_d[l_ac].sfakwf001
   
   IF cl_null(l_imaf153) THEN
      LET l_imaf153 = g_sfajwf_m.sfajwf006
   END IF
   #????
   #240430-00007#2 --s
#   CALL s_apmt500_get_price(l_pmdl017,l_imaf153,g_sfakwf_d[l_ac].sfakwf001,g_sfakwf_d[l_ac].sfakwf003,l_pmdl015,					
#       g_sfakwf_d[l_ac].sfakwf037,l_pmdl009,l_pmdl010,l_pmdl023,g_sfajwf_m.sfajwfdocno,					
#       g_sfajwf_m.sfajwfdocdt,g_sfakwf_d[l_ac].sfakwf035,g_sfakwf_d[l_ac].sfakwf034,g_site,l_pmdl054,'2',' ',' ')	
    #240523-00030#1 -mark -s
    
#    CALL s_apmt500_get_price_wf(l_pmdl017,l_imaf153,g_sfakwf_d[l_ac].sfakwf001,g_sfakwf_d[l_ac].sfakwf003,l_pmdl015,					
#       g_sfakwf_d[l_ac].sfakwf037,l_pmdl009,l_pmdl010,l_pmdl023,g_sfajwf_m.sfajwfdocno,					
#       g_sfajwf_m.sfajwfdocdt,g_sfakwf_d[l_ac].sfakwf035,g_sfakwf_d[l_ac].sfakwf034,g_site,l_pmdl054,'2',' ',' ',
#       g_sfakwf_d[l_ac].sfakwf011,g_sfakwf_d[l_ac].sfakwf012,g_sfakwf_d[l_ac].sfakwf016,g_sfakwf_d[l_ac].sfakwf017,
#       '3','')	#???????????bincode??????????'3'?'',?????????
   #240523-00030#1 -mark -e
   #240523-00030#1 add -s
    CALL s_apmt500_get_price_wf(l_pmdl017,l_imaf153,g_sfakwf_d[l_ac].sfakwf001,g_sfakwf_d[l_ac].sfakwf003,l_pmdl015,					
       g_sfakwf_d[l_ac].sfakwf037,l_pmdl009,l_pmdl010,l_pmdl023,g_sfajwf_m.sfajwfdocno,					
       g_sfajwf_m.sfajwfdocdt,g_sfakwf_d[l_ac].sfakwf035,g_sfakwf_d[l_ac].sfakwf034,g_site,l_pmdl054,'2',' ',' ',
       g_sfakwf_d[l_ac].sfakwf011,g_sfakwf_d[l_ac].sfakwf012,g_sfakwf_d[l_ac].sfakwf016,g_sfakwf_d[l_ac].sfakwf017,
       '3',g_sfajwf_m.sfajwf012)	
   #240523-00030#1 add -e
   #240430-00007#2 --e      
      
     RETURNING l_pmdn040,l_pmdn043,l_pmdn041,l_pmdn042					
   LET  g_sfakwf_d[l_ac].sfakwf036 = l_pmdn043
   IF cl_null(g_sfakwf_d[l_ac].sfakwf036) THEN LET g_sfakwf_d[l_ac].sfakwf036 = 0 END IF   
   
   #250328-00010#1 add--s
   IF cl_null(g_sfakwf_d[l_ac].sfakwf049) THEN 
      SELECT imae035 INTO g_sfakwf_d[l_ac].sfakwf049 
        FROM imae_t WHERE imaeent=g_enterprise AND imaesite=g_site AND imae001=g_sfakwf_d[l_ac].sfakwf001 
      LET g_sfakwf_d[l_ac].sfakwf049_desc = s_desc_get_department_desc(g_sfakwf_d[l_ac].sfakwf049)
      DISPLAY BY NAME g_sfakwf_d[l_ac].sfakwf049,g_sfakwf_d[l_ac].sfakwf049_desc 
   END IF 
   #250328-00010#1 add--e 
    
END FUNCTION

################################################################################
# Descriptions...: BOM???????
# Memo...........:
# Usage..........: CALL bsft001_wf_chk_sfakwf042()
#                  RETURNING ????
# Input parameter: ??????1   ????????1
#                : ??????2   ????????2
# Return code....: ??????1   ????????1
#                : ??????2   ????????2
# Date & Author..: ?? By ??
# Modify.........:
################################################################################
PRIVATE FUNCTION bsft001_wf_chk_sfakwf042()
DEFINE r_success         LIKE type_t.num5
DEFINE l_n               LIKE type_t.num5
DEFINE l_bmfa005         DATETIME YEAR TO SECOND

   LET r_success = FALSE
   IF cl_null(g_sfakwf_d[l_ac].sfakwf042) THEN
      LET r_success = TRUE
      RETURN r_success
   END IF
   #170213-00064#1-----add----s
   IF cl_null(g_sfakwf_d[l_ac].sfakwf002) THEN
      LET g_sfakwf_d[l_ac].sfakwf002 = ' '
   END IF
   #170213-00064#1-----add----e
   #BOM?????????bmfa012?bmfp007
   SELECT COUNT(1) INTO l_n FROM bmfa_t WHERE bmfaent=g_enterprise AND (bmfasite='ALL' OR bmfasite=g_site)
      AND bmfa003=g_sfakwf_d[l_ac].sfakwf001 AND bmfa004=g_sfakwf_d[l_ac].sfakwf002 AND bmfa012=g_sfakwf_d[l_ac].sfakwf042
   IF l_n = 0 THEN
      SELECT COUNT(1) INTO l_n FROM bmfp_t WHERE bmfpent=g_enterprise AND (bmfpsite='ALL' OR bmfpsite=g_site)
         AND bmfp002=g_sfakwf_d[l_ac].sfakwf001 AND bmfp003=g_sfakwf_d[l_ac].sfakwf002 AND bmfp007=g_sfakwf_d[l_ac].sfakwf042
      IF l_n = 0 THEN
      
         #170215-00015#1---add--end
         SELECT COUNT(*) INTO l_n FROM bmfa_t WHERE bmfaent=g_enterprise AND (bmfasite='ALL' OR bmfasite=g_site)
         AND bmfa003=g_sfakwf_d[l_ac].sfakwf001 AND bmfa004=g_sfakwf_d[l_ac].sfakwf002 AND bmfa011=g_sfakwf_d[l_ac].sfakwf042
         IF l_n = 0 THEN
         #170215-00015#1---add-----end
            INITIALIZE g_errparam TO NULL
            LET g_errparam.code = 'asf-00323'
            LET g_errparam.extend = g_sfakwf_d[l_ac].sfakwf042
            LET g_errparam.popup = TRUE
            CALL cl_err()
   
            RETURN r_success
         #170215-00015#1---add--str
          ELSE
           #SELECT MAX(bmfa005)-(1/24/3600) INTO l_bmfa005 FROM bmfa_t WHERE bmfaent=g_enterprise AND (bmfasite='ALL' OR bmfasite=g_site)  #170317-00049#2 mark
            SELECT MAX(bmfa005)-(1/24/3600) INTO l_bmfa005 FROM bmfa_t WHERE bmfaent=g_enterprise AND bmfasite=g_site                      #170317-00049#2 add
            AND bmfa003=g_sfakwf_d[l_ac].sfakwf001 AND bmfa004=g_sfakwf_d[l_ac].sfakwf002 AND bmfa011=g_sfakwf_d[l_ac].sfakwf042
            #170317-00049#2 add --(S)--
            IF cl_null(l_bmfa005) THEN
               SELECT MAX(bmfa005)-(1/24/3600) INTO l_bmfa005 FROM bmfa_t WHERE bmfaent=g_enterprise AND bmfasite='ALL'                      
                  AND bmfa003=g_sfakwf_d[l_ac].sfakwf001 AND bmfa004=g_sfakwf_d[l_ac].sfakwf002 AND bmfa011=g_sfakwf_d[l_ac].sfakwf042
            END IF            
            #170317-00049#2 add --(E)--
          END IF
          #170215-00015#1---add-----end 
      ELSE
         SELECT MAX(bmfa005) INTO l_bmfa005 FROM bmfa_t,bmfp_t WHERE bmfaent=bmfpent AND bmfasite=bmfpsite
           #AND bmfadocno=bmfpdocno AND bmfa003=bmfp002 AND bmfa004=bmfp003                                               #180725-00014#1 mark
            AND bmfadocno=bmfpdocno                                                                                       #180725-00014#1 add
           #AND bmfaent=g_enterprise AND (bmfasite='ALL' OR bmfasite=g_site)                                              #170317-00049#2 mark
            AND bmfaent=g_enterprise AND bmfasite=g_site                                                                  #170317-00049#2 add
           #AND bmfa003=g_sfakwf_d[l_ac].sfakwf001 AND bmfa004=g_sfakwf_d[l_ac].sfakwf002 AND bmfp007=g_sfakwf_d[l_ac].sfakwf042                        #180725-00014#1 mark
            AND bmfp002=g_sfakwf_d[l_ac].sfakwf001 AND bmfp003=g_sfakwf_d[l_ac].sfakwf002 AND bmfp007=g_sfakwf_d[l_ac].sfakwf042                        #180725-00014#1 add
         #170317-00049#2 add --(S)--
         IF cl_null(l_bmfa005) THEN
            SELECT MAX(bmfa005) INTO l_bmfa005 FROM bmfa_t,bmfp_t WHERE bmfaent=bmfpent AND bmfasite=bmfpsite
           #AND bmfadocno=bmfpdocno AND bmfa003=bmfp002 AND bmfa004=bmfp003                                               #180725-00014#1 mark 
            AND bmfadocno=bmfpdocno                                                                                       #180725-00014#1 add 
            AND bmfaent=g_enterprise AND bmfasite='ALL'                                                                 
           #AND bmfa003=g_sfakwf_d[l_ac].sfakwf001 AND bmfa004=g_sfakwf_d[l_ac].sfakwf002 AND bmfp007=g_sfakwf_d[l_ac].sfakwf042                        #180725-00014#1 mark
            AND bmfp002=g_sfakwf_d[l_ac].sfakwf001 AND bmfp003=g_sfakwf_d[l_ac].sfakwf002 AND bmfp007=g_sfakwf_d[l_ac].sfakwf042                        #180725-00014#1 add      
         END IF
         #170317-00049#2 add --(E)--            
      END IF
   ELSE
      #BOM???????ECN????????ECN
     #SELECT MAX(bmfa005) INTO l_bmfa005 FROM bmfa_t WHERE bmfaent=g_enterprise AND (bmfasite='ALL' OR bmfasite=g_site)   #170317-00049#2 mark
      SELECT MAX(bmfa005) INTO l_bmfa005 FROM bmfa_t WHERE bmfaent=g_enterprise AND bmfasite=g_site                       #170317-00049#2 add 
         AND bmfa003=g_sfakwf_d[l_ac].sfakwf001 AND bmfa004=g_sfakwf_d[l_ac].sfakwf002 AND bmfa012=g_sfakwf_d[l_ac].sfakwf042
      #170317-00049#2 add --(S)--
      IF cl_null(l_bmfa005) THEN
         SELECT MAX(bmfa005) INTO l_bmfa005 FROM bmfa_t WHERE bmfaent=g_enterprise AND bmfasite='ALL'                       
            AND bmfa003=g_sfakwf_d[l_ac].sfakwf001 AND bmfa004=g_sfakwf_d[l_ac].sfakwf002 AND bmfa012=g_sfakwf_d[l_ac].sfakwf042
      END IF      
      #170317-00049#2 add --(E)--      
   END IF
   LET g_sfakwf_d[l_ac].sfakwf043 = l_bmfa005 
   DISPLAY BY NAME g_sfakwf_d[l_ac].sfakwf043
   LET r_success = TRUE
   RETURN r_success
END FUNCTION

################################################################################
# Descriptions...: ??????+????+???+BOM?????,?????????????+????+???+BOM??
# Memo...........:
# Usage..........: CALL bsft001_wf_sfbcwfseq1(p_cmd,p_dzebl001)
#                  RETURNING r_success
# Input parameter: p_cmd       ??
# Return code....: r_success   TRUE/FALSE
# Date & Author..: 
# Modify.........: #170428-00012#1 ??????p_dzebl001
################################################################################
PRIVATE FUNCTION bsft001_wf_sfbcwfseq1(p_cmd,p_dzebl001)
DEFINE p_cmd       LIKE type_t.chr1
DEFINE p_dzebl001  LIKE dzebl_t.dzebl001  #170428-00012#1
DEFINE l_dzebl003  LIKE dzebl_t.dzebl003  #170428-00012#1
DEFINE l_n         LIKE type_t.num5
DEFINE l_n1        LIKE type_t.num5

  IF cl_null(g_sfakwf2_d[g_detail_idx].sfbcwfseq1) THEN
     RETURN TRUE
  END IF 
  IF g_sfakwf2_d[g_detail_idx].sfbcwf002 IS NULL THEN
     RETURN TRUE
  END IF 
  IF g_sfakwf2_d[g_detail_idx].sfbcwf003 IS NULL THEN
     RETURN TRUE
  END IF
  IF g_sfakwf2_d[g_detail_idx].sfbcwf004 IS NULL THEN
     RETURN TRUE
  END IF
  IF g_sfakwf2_d[g_detail_idx].sfbcwf005 IS NULL THEN
     RETURN TRUE
  END IF
  SELECT COUNT(1) INTO l_n FROM sfbcwf_t WHERE sfbcwfent = g_enterprise AND sfbcwfsite = g_site AND sfbcwfdocno = g_sfajwf_m.sfajwfdocno
     AND sfbcwfseq1 = g_sfakwf2_d[g_detail_idx].sfbcwfseq1
  IF (l_n > 1 AND p_cmd = 'u') OR (l_n > 0 AND p_cmd = 'a') THEN
     SELECT COUNT(1) INTO l_n1 FROM sfbcwf_t WHERE sfbcwfent = g_enterprise AND sfbcwfsite = g_site AND sfbcwfdocno = g_sfajwf_m.sfajwfdocno
        AND sfbcwfseq1 = g_sfakwf2_d[g_detail_idx].sfbcwfseq1 AND sfbcwf002 = g_sfakwf2_d[g_detail_idx].sfbcwf002 AND sfbcwf003 = g_sfakwf2_d[g_detail_idx].sfbcwf003
        AND sfbcwf004 = g_sfakwf2_d[g_detail_idx].sfbcwf004 AND sfbcwf005 = g_sfakwf2_d[g_detail_idx].sfbcwf005
     IF l_n1 = 0 THEN
        #170428-00012#1-s
        IF NOT cl_null(p_dzebl001) THEN
           SELECT dzebl003 INTO l_dzebl003
             FROM dzebl_t
            WHERE dzebl001 = p_dzebl001
              AND dzebl002 = g_lang
           IF cl_ask_confirm_parm('asf-00862',l_dzebl003) THEN
              CASE p_dzebl001
                 WHEN 'sfbcwf002'
                    UPDATE sfbcwf_t
                       SET sfbcwf002 = g_sfakwf2_d[g_detail_idx].sfbcwf002
                     WHERE sfbcwfent = g_enterprise AND sfbcwfsite = g_site
                       AND sfbcwfdocno = g_sfajwf_m.sfajwfdocno AND sfbcwfseq1 = g_sfakwf2_d[g_detail_idx].sfbcwfseq1 
                 WHEN 'sfbcwf003'
                    UPDATE sfbcwf_t
                       SET sfbcwf003 = g_sfakwf2_d[g_detail_idx].sfbcwf003
                     WHERE sfbcwfent = g_enterprise AND sfbcwfsite = g_site
                       AND sfbcwfdocno = g_sfajwf_m.sfajwfdocno AND sfbcwfseq1 = g_sfakwf2_d[g_detail_idx].sfbcwfseq1 
                 WHEN 'sfbcwf004'
                    UPDATE sfbcwf_t
                       SET sfbcwf004 = g_sfakwf2_d[g_detail_idx].sfbcwf004
                     WHERE sfbcwfent = g_enterprise AND sfbcwfsite = g_site
                       AND sfbcwfdocno = g_sfajwf_m.sfajwfdocno AND sfbcwfseq1 = g_sfakwf2_d[g_detail_idx].sfbcwfseq1 
              END CASE
              RETURN TRUE
           END IF
        END IF
        #170428-00012#1-e
        INITIALIZE g_errparam TO NULL
        LET g_errparam.code = 'asf-00070'
        LET g_errparam.extend = ''
        LET g_errparam.popup = TRUE
        CALL cl_err()
        RETURN FALSE
     END IF
  ELSE
     SELECT COUNT(1) INTO l_n1 FROM sfbcwf_t WHERE sfbcwfent = g_enterprise AND sfbcwfsite = g_site AND sfbcwfdocno = g_sfajwf_m.sfajwfdocno
        AND sfbcwf002 = g_sfakwf2_d[g_detail_idx].sfbcwf002 AND sfbcwf003 = g_sfakwf2_d[g_detail_idx].sfbcwf003
        AND sfbcwf004 = g_sfakwf2_d[g_detail_idx].sfbcwf004 AND sfbcwf005 = g_sfakwf2_d[g_detail_idx].sfbcwf005
     IF l_n1 > 0 THEN
        INITIALIZE g_errparam TO NULL
        LET g_errparam.code = 'asf-00070'
        LET g_errparam.extend = ''
        LET g_errparam.popup = TRUE
        CALL cl_err()
        RETURN FALSE
     END IF
  END IF
  RETURN TRUE 
END FUNCTION

################################################################################
# Descriptions...: ??????+??+????+???????????????????????
# Memo...........:
# Usage..........: CALL bsft001_wf_sfbcwfseq1_2(p_cmd)
#                  RETURNING r_success
# Input parameter: p_cmd       ??
# Return code....: r_success   TRUE/FALSE
# Date & Author..: 2017/01/16 By shiun   #160908-00025#1
# Modify.........: #170428-00012#1 ????
################################################################################
PRIVATE FUNCTION bsft001_wf_sfbcwfseq1_2(p_cmd)
DEFINE p_cmd     LIKE type_t.chr1
DEFINE l_n       LIKE type_t.num5

  IF cl_null(g_sfakwf2_d[g_detail_idx2].sfbcwfseq1) THEN
     RETURN TRUE
  END IF
  IF cl_null(g_sfakwf2_d[g_detail_idx2].sfbcwf006) THEN
     RETURN TRUE
  END IF
  IF g_sfakwf2_d[g_detail_idx2].sfbcwf021 IS NULL THEN
     LET g_sfakwf2_d[g_detail_idx2].sfbcwf021 = ' '
  END IF
  IF g_sfakwf2_d[g_detail_idx2].sfbcwf002 IS NULL THEN
     LET g_sfakwf2_d[g_detail_idx2].sfbcwf002 = ' '
  END IF
  IF g_sfakwf2_d[g_detail_idx2].sfbcwf003 IS NULL THEN
     LET g_sfakwf2_d[g_detail_idx2].sfbcwf003 = ' '
  END IF
  IF g_sfakwf2_d[g_detail_idx2].sfbcwf004 IS NULL THEN
     LET g_sfakwf2_d[g_detail_idx2].sfbcwf004 = ' '
  END IF
  
  SELECT COUNT(1) INTO l_n FROM sfbcwf_t
   WHERE sfbcwfent = g_enterprise AND sfbcwfsite = g_site AND sfbcwfdocno = g_sfajwf_m.sfajwfdocno
     AND sfbcwf002 = g_sfakwf2_d[g_detail_idx2].sfbcwf002 AND sfbcwf003 = g_sfakwf2_d[g_detail_idx2].sfbcwf003 AND sfbcwf004 = g_sfakwf2_d[g_detail_idx2].sfbcwf004
     AND sfbcwf006 = g_sfakwf2_d[g_detail_idx2].sfbcwf006 AND sfbcwf021 = g_sfakwf2_d[g_detail_idx2].sfbcwf021
     AND NOT (sfbcwfseq1 = g_sfakwf2_d_t.sfbcwfseq1 AND sfbcwfseq2 = g_sfakwf2_d_t.sfbcwfseq2)  #????

   RETURN TRUE
END FUNCTION

################################################################################
# Descriptions...: sfbcwf006??
# Memo...........:
# Usage..........: CALL bsft001_wf_sfbcwf006_desc()
# Input parameter: ??????1   ????????1
#                : ??????2   ????????2
# Return code....: ??????1   ????????1
#                : ??????2   ????????2
# Date & Author..: ?? By ??
# Modify.........:
################################################################################
PRIVATE FUNCTION bsft001_wf_sfbcwf006_desc()
DEFINE l_imaa004    LIKE imaa_t.imaa004      #220510-00026#1 add
DEFINE l_imafwf200_1    LIKE imaf_t.imafwf200
DEFINE l_imafwf200_0    LIKE imaf_t.imafwf200
DEFINE l_bmbawf039      LIKE bmba_t.bmbawf039

   INITIALIZE g_ref_fields TO NULL
   LET g_ref_fields[1] = g_sfakwf2_d[l_ac].sfbcwf006
   CALL ap_ref_array2(g_ref_fields,"SELECT imaal003,imaal004 FROM imaal_t WHERE imaalent='"||g_enterprise||"' AND imaal001=? AND imaal002='"||g_dlang||"'","") RETURNING g_rtn_fields
   LET g_sfakwf2_d[l_ac].sfbcwf006_desc = '', g_rtn_fields[1] , ''
   LET g_sfakwf2_d[l_ac].sfbcwf006_desc_1 = '', g_rtn_fields[2] , ''
   DISPLAY BY NAME g_sfakwf2_d[l_ac].sfbcwf006_desc
   DISPLAY BY NAME g_sfakwf2_d[l_ac].sfbcwf006_desc_1
   IF NOT cl_null(g_sfakwf2_d[g_detail_idx2].sfbcwf006) THEN
      SELECT imaf013,imaf034  #160509-00009#4 add imaf034
        INTO g_sfakwf2_d[g_detail_idx2].imaf013,g_sfakwf2_d[g_detail_idx2].sfbcwf033  #160509-00009#4 add sfbcwf033
        FROM imaf_t
       WHERE imafent = g_enterprise
         AND imafsite = g_site
         AND imaf001 = g_sfakwf2_d[g_detail_idx2].sfbcwf006
       #170322-00078#1 add --(S)--
       IF cl_null(g_sfakwf2_d[g_detail_idx2].sfbcwf033) THEN
          LET g_sfakwf2_d[g_detail_idx2].sfbcwf033 = 'N'
       END IF
       #170322-00078#1 add --(E)--     
       DISPLAY BY NAME g_sfakwf2_d[g_detail_idx2].imaf013
      SELECT imae023,imae081,imae091 INTO g_sfakwf2_d[g_detail_idx2].sfbcwf008,g_sfakwf2_d[g_detail_idx2].sfbcwf014  #160106-00010#1 add imae023   #190628-00025#1 by 02159 add imae091
                                         ,g_sfakwf2_d[g_detail_idx2].sfbcwf009   #190628-00025#1 by 02159 add    
        FROM imae_t
       WHERE imaeent = g_enterprise
         AND imaesite = g_site
         AND imae001 = g_sfakwf2_d[g_detail_idx2].sfbcwf006
      #210617-00015#1 add---start---
      IF NOT cl_null(g_sfakwf2_d[g_detail_idx2].sfbcwf014) THEN
         SELECT oocal003 INTO g_sfakwf2_d[g_detail_idx2].sfbcwf014_desc
           FROM oocal_t
          WHERE oocalent = g_enterprise
            AND oocal001 = g_sfakwf2_d[g_detail_idx2].sfbcwf014
            AND oocal002 = g_dlang
         DISPLAY BY NAME g_sfakwf2_d[g_detail_idx2].sfbcwf014_desc
      END IF
      #210617-00015#1 add---end---
      DISPLAY BY NAME g_sfakwf2_d[g_detail_idx2].sfbcwf014     
      #220510-00026#1 add -S-
      SELECT imaa004 INTO l_imaa004
        FROM imaa_t
       WHERE imaaent = g_enterprise
         AND imaa001 = g_sfakwf2_d[g_detail_idx2].sfbcwf006
      IF l_imaa004 = 'E' AND g_sfakwf2_d[g_detail_idx2].sfbcwf008 <> '3' AND g_sfakwf2_d[g_detail_idx2].sfbcwf008 <> '4' THEN
         LET g_sfakwf2_d[g_detail_idx2].sfbcwf008 = '4'
      END IF
      #220510-00026#1 add -E-
      #??????????WAFER??imafwf200??aimm201_wf???ALL??????bmaa001?????,????N??????
      #?????WAFER??
      SELECT imafwf200 INTO l_imafwf200_1
      FROM imaf_t
      WHERE imafent = g_enterprise AND imafsite = g_site AND imaf001 = g_sfakwf_d[g_detail_idx2].sfakwf001
      #?????WAFER??
      SELECT imafwf200 INTO l_imafwf200_0
      FROM imaf_t
      WHERE imafent = g_enterprise AND imafsite = g_site AND imaf001 = g_sfakwf2_d[g_detail_idx2].sfbcwf006
#      IF l_imafwf200_1 = l_imafwf200_0 THEN
#         LET g_sfakwf2_d[g_detail_idx].sfbcwf043 = 'Y'
#      ELSE
#         LET g_sfakwf2_d[g_detail_idx].sfbcwf043 = 'N'
#      END IF
      SELECT bmbawf039 INTO l_bmbawf039 FROM bmba_t
       WHERE bmbaent = g_enterprise AND bmbasite = g_site AND bmba001 = g_sfakwf_d[g_detail_idx].sfakwf001  AND bmba002 = g_sfakwf_d[g_detail_idx].sfakwf002
         AND bmba003 = g_sfakwf2_d[g_detail_idx2].sfbcwf006 AND bmba004 = g_sfakwf2_d[g_detail_idx2].sfbcwf002
         #AND bmba007 = g_sfakwf2_d[g_detail_idx2].sfbcwf003 AND bmba008 = g_sfakwf2_d[g_detail_idx2].sfbcwf004 AND bmba005 <= g_sfajwf_m.sfajwfdocdt  #241030-00001#1 mark
         AND bmba007 = g_sfakwf2_d[g_detail_idx2].sfbcwf003 AND bmba008 = g_sfakwf2_d[g_detail_idx2].sfbcwf004 AND bmba005 <= g_sfajwf_m.sfajwfmoddt  #241030-00001#1 add
      LET g_sfakwf2_d[g_detail_idx2].sfbcwf043 = l_bmbawf039
   END IF 
END FUNCTION

################################################################################
# Descriptions...: ??BOM????????
# Memo...........:
# Usage..........: bsft001_wf_get_sfbcwf001()
#                  RETURNING ?
# Input parameter: ??????1   ????????1
#                : ??????2   ????????2
# Return code....: ??????1   ????????1
#                : ??????2   ????????2
# Date & Author..: 2020/04/30 By 11892
# Modify.........: #190603-00034#1
################################################################################
PRIVATE FUNCTION bsft001_wf_get_sfbcwf001()
DEFINE l_sql      STRING
DEFINE l_cnt      LIKE type_t.num5
DEFINE l_sfakwf043  DATETIME YEAR TO SECOND  #BOM????

   IF NOT cl_null(g_sfakwf_d[g_detail_idx].sfakwf043) THEN 
      LET l_sfakwf043 = g_sfakwf_d[g_detail_idx].sfakwf043
   ELSE   
      LET l_sfakwf043 = cl_get_current()
   END IF

   LET l_cnt = 0
   
   #210617-00015#1 add---start---
   LET g_sfakwf2_d[l_ac].sfbcwf001 = ''
   LET l_sql = "SELECT bmba001 FROM bmba_t  ",
               " WHERE bmbaent = ",g_enterprise ,
               "   AND bmbasite = '",g_site,"' ",
               "   AND (bmba019 = '1' OR bmba019 ='3') ",
               "   AND bmba003 = '",g_sfakwf2_d[l_ac].sfbcwf005,"'",
               "   AND EXISTS(SELECT 1 FROM bmaa_t WHERE bmaaent = bmbaent AND bmaasite = bmbasite AND bmaa001 = bmba001 AND bmaa002 = bmba002 AND bmaastus = 'Y') ",
               "   AND ROWNUM = 1 ",
               " START WITH bmba001 = '",g_sfakwf_d[g_detail_idx].sfakwf001,"' ",
               "   AND bmba002 = '",g_sfakwf_d[g_detail_idx].sfakwf002,"' ",
               "   AND bmba005 <= ? AND (bmba006 IS NULL OR bmba006> ? ) ",
               " CONNECT BY PRIOR bmba003 = bmba001 AND PRIOR bmba002 = bmba002 AND PRIOR bmbasite = bmbasite AND PRIOR bmbaent = bmbaent",
               "   AND bmba005 <= ? AND (bmba006 IS NULL OR bmba006> ? ) "
   PREPARE asft300_bmba_ln FROM l_sql
   EXECUTE asft300_bmba_ln USING l_sfakwf043,l_sfakwf043,l_sfakwf043,l_sfakwf043 INTO g_sfakwf2_d[l_ac].sfbcwf001 
   IF cl_null(g_sfakwf2_d[l_ac].sfbcwf001) THEN 
      LET g_sfakwf2_d[l_ac].sfbcwf001 = g_sfakwf_d[g_detail_idx].sfakwf001
   END IF
END FUNCTION

################################################################################
# Descriptions...: ????(imaa004)???X:???
# Memo...........:
# Usage..........: CALL bsft001_wf_sfbcwf005_chk(p_sfbcwf005)
#                  RETURNING r_success
# Input parameter: p_sfbcwf005      ??
# Return code....: r_success      TRUE/FALSE
# Date & Author..: 2016/06/27 By dorislai(#160623-00009#1)
# Modify.........:
################################################################################
PRIVATE FUNCTION bsft001_wf_sfbcwf005_chk(p_sfbcwf005)
DEFINE p_sfbcwf005 LIKE sfbcwf_t.sfbcwf005
   DEFINE r_success LIKE type_t.num5
   DEFINE l_imaa004 LIKE imaa_t.imaa004
   
   LET r_success = TRUE
   
   SELECT imaa004 INTO l_imaa004
     FROM imaa_t
    WHERE imaaent = g_enterprise
      AND imaa001 = p_sfbcwf005

   IF l_imaa004 = 'X'  THEN
      LET r_success = FALSE
   END IF
   
   RETURN r_success
END FUNCTION

################################################################################
# Descriptions...: ??????????
# Memo...........:
# Usage..........: CALL bsft001_wf_b_desc()
# Input parameter: 
# Return code....: 
# Date & Author..: ?? By ??
# Modify.........: 
################################################################################
PRIVATE FUNCTION bsft001_wf_b_desc()
DEFINE  l_success        LIKE type_t.num5
#?????
   CALL cl_err_collect_init()     #210429-00006#1---add
   LET g_sfakwf2_d[l_ac].replace = s_abmm201_get_proposal(g_site,g_sfakwf2_d[l_ac].sfbcwf001,g_sfakwf_d[g_detail_idx].sfakwf002,g_sfakwf2_d[l_ac].sfbcwf005,
                                                       g_sfakwf2_d[l_ac].sfbcwf002,g_sfakwf2_d[l_ac].sfbcwf003,g_sfakwf2_d[l_ac].sfbcwf004,
                                                       g_sfajwf_m.sfajwfdocno)    #170106-00025#2 add
   
   CALL cl_err_collect_show()     #210429-00006#1---add
   IF NOT cl_null(g_sfajwf_m.sfajwfdocno) AND NOT cl_null(g_sfakwf2_d[l_ac].sfbcwfseq2) AND NOT cl_null(g_sfakwf2_d[l_ac].sfbcwfseq2) THEN
      #CALL s_aooi360_sel('7',g_sfajwf_m.sfajwfdocno,g_sfakwf2_d[l_ac].sfbcwfseq2,g_sfakwf2_d[l_ac].sfbcwfseq2,'','','','','','','','2')
           #RETURNING l_success,g_sfakwf2_d[l_ac].sfbcwf_ooff013  
      CALL s_aooi360_sel('7',g_prog,g_sfajwf_m.sfajwfdocno,g_sfakwf2_d[l_ac].sfbcwfseq2,g_sfakwf2_d[l_ac].sfbcwfseq2,'','','','','','','1')
           RETURNING l_success,g_sfakwf2_d[l_ac].ooff013           
#      CALL s_asft300_07(g_sfajwf_m.sfajwfdocno,g_sfakwf2_d[l_ac].sfbcwfseq2,g_sfakwf2_d[l_ac].sfbcwfseq2) RETURNING l_success,g_sfakwf2_d[l_ac].number2
   END IF 
   #IF cl_null(g_sfakwf2_d[l_ac].number2) THEN LET g_sfakwf2_d[l_ac].number2 = 0 END IF
   IF cl_null(g_sfakwf2_d[l_ac].sfbcwf013) THEN LET g_sfakwf2_d[l_ac].sfbcwf013 = 0 END IF
   IF cl_null(g_sfakwf2_d[l_ac].sfbcwf016) THEN LET g_sfakwf2_d[l_ac].sfbcwf016 = 0 END IF
   LET g_sfakwf2_d[l_ac].number1 = g_sfakwf2_d[l_ac].sfbcwf013 - g_sfakwf2_d[l_ac].sfbcwf015 - g_sfakwf2_d[l_ac].sfbcwf016
   IF g_sfakwf2_d[l_ac].number1 < 0 THEN LET g_sfakwf2_d[l_ac].number1 = 0 END IF
   
END FUNCTION

################################################################################
# Descriptions...: ??????????QPA
# Memo...........:
# Usage..........: CALL bsft001_wf_sfbcwf023_qpa(p_sfbcwf023)
#                  RETURNING ????
# Input parameter: ??????1   ????????1
#                : ??????2   ????????2
# Return code....: ??????1   ????????1
#                : ??????2   ????????2
# Date & Author..: ?? By ??
# Modify.........:
################################################################################
PRIVATE FUNCTION bsft001_wf_sfbcwf023_qpa(p_sfbcwf023)
DEFINE p_sfbcwf023         LIKE sfbcwf_t.sfbcwf023
DEFINE r_sfbcwf010         LIKE sfbcwf_t.sfbcwf010
DEFINE r_sfbcwf011         LIKE sfbcwf_t.sfbcwf011
DEFINE l_num1            LIKE sfaa_t.sfaa012
DEFINE l_num2            LIKE sfaa_t.sfaa012
DEFINE l_num1_t          LIKE type_t.num20
DEFINE l_num2_t          LIKE type_t.num20
DEFINE l_j               LIKE type_t.num10
DEFINE l_k               LIKE type_t.num10

   LET l_num1 = g_sfakwf_d[g_detail_idx].sfakwf006  #sfaa012
   LET l_num2 = p_sfbcwf023
   LET l_num1_t = l_num1
   LET l_num2_t = l_num2
  #WHILE TRUE           #mark 150723
     #??????           
     IF l_num1 = l_num1_t AND l_num2 = l_num2_t THEN
       #150723
       #EXIT WHILE
        #QPA????????
        IF l_num1 < l_num2 THEN
           LET l_j = l_num1_t
        ELSE
           LET l_j = l_num2_t
        END IF
        FOR l_k = l_j TO 1 STEP -1
           IF (l_num1_t MOD l_k = 0) AND (l_num2_t MOD l_k = 0) THEN
              EXIT FOR
           END IF
        END FOR
        
        LET r_sfbcwf010 = l_num2_t / l_k
        LET r_sfbcwf011 = l_num1_t / l_k
       #150723
     ELSE
        LET r_sfbcwf010 = l_num2
        LET r_sfbcwf011 = l_num1
       #150723
     END IF
  #END WHILE     #mark 150723

   RETURN r_sfbcwf010,r_sfbcwf011
END FUNCTION

################################################################################
# Descriptions...: copy s_feature_chk()
# Memo...........:
# Usage..........: CALL bsft001_wf_sfbcwf021_chk()
#                  RETURNING TRUE/FALSE
# Input parameter: 
# Return code....: 
# Date & Author..: #161209-00038#3 By 04441
# Modify.........:
################################################################################
PRIVATE FUNCTION bsft001_wf_sfbcwf021_chk()
DEFINE l_imeb001    LIKE imeb_t.imeb001
DEFINE l_sfakwf043    DATETIME YEAR TO SECOND
DEFINE l_sql        STRING
DEFINE l_cnt        LIKE type_t.num5
DEFINE l_cnt1       LIKE type_t.num5
DEFINE l_cnt2       LIKE type_t.num5
DEFINE tok          base.StringTokenizer
DEFINE l_imak003    LIKE imak_t.imak003
DEFINE l_success    LIKE type_t.num5
DEFINE l_errno      LIKE gzze_t.gzze001
DEFINE l_value      LIKE type_t.chr30
DEFINE l_imeb  DYNAMIC ARRAY OF RECORD
    imeb003    LIKE imeb_t.imeb003,
    imeb004    LIKE imeb_t.imeb004,
    bmce010    LIKE bmce_t.bmce010
           END RECORD
DEFINE l_bmce  RECORD
    bmce009    LIKE bmce_t.bmce009,
    bmce010    LIKE bmce_t.bmce010
           END RECORD

   WHENEVER ERROR CONTINUE

   IF cl_null(g_sfakwf2_d[l_ac].sfbcwf006) THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = 'sub-00152'
      LET g_errparam.popup = TRUE
      CALL cl_err()
      RETURN FALSE
   END IF
   
   LET l_imeb001 = ''
   SELECT imaa005 INTO l_imeb001 FROM imaa_t
    WHERE imaaent = g_enterprise
      AND imaa001 = g_sfakwf2_d[l_ac].sfbcwf006
   IF cl_null(l_imeb001) AND NOT cl_null(g_sfakwf2_d[l_ac].sfbcwf021) THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = 'sub-01366'
      LET g_errparam.extend = g_sfakwf2_d[l_ac].sfbcwf006
      LET g_errparam.popup = TRUE
      CALL cl_err()
      RETURN FALSE
   END IF
   IF cl_null(g_sfakwf2_d[l_ac].sfbcwf021) AND NOT cl_null(l_imeb001) THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = 'sub-01367'
      LET g_errparam.extend = g_sfakwf2_d[l_ac].sfbcwf006
      LET g_errparam.popup = TRUE
      CALL cl_err()
      RETURN FALSE
   END IF
   
   IF cl_null(g_sfakwf_d[g_detail_idx].sfakwf043) THEN
      LET l_sfakwf043 = cl_get_current()
   ELSE
      LET l_sfakwf043 = g_sfakwf_d[g_detail_idx].sfakwf043
   END IF
   
   DELETE FROM asft300_bmce_tmp
   LET l_sql = " SELECT bmce009,bmce010 FROM bmce_t ",
               "        ,bmba_t ", #200120-00019#1 add
               "  WHERE bmceent = ",g_enterprise,
               "    AND bmcesite = '",g_site,"'",
               "    AND bmce001 = '",g_sfakwf_d[g_detail_idx].sfakwf001,"'",
               "    AND bmce002 = '",g_sfakwf_d[g_detail_idx].sfakwf002,"'",
               "    AND bmce003 = '",g_sfakwf2_d[l_ac].sfbcwf006,"'",
               "    AND bmce004 = '",g_sfakwf2_d[l_ac].sfbcwf002,"'",
               "    AND bmce007 = '",g_sfakwf2_d[l_ac].sfbcwf003,"'",
               "    AND bmce008 = '",g_sfakwf2_d[l_ac].sfbcwf004,"'",
               #"    AND to_char(bmce005,'YYYY-MM-DD hh24:mi:ss') <= '",l_sfakwf043,"'"   #180731-00017#9 Mark By 06137  180809 
              #"    AND bmce005 <= ? "   #180731-00017#9 Add By 06137  180809               #200120-00019#1 mark
              #200120-00019#1---add----str---
               "    AND bmba005 <= ? ",
               "    AND (bmba006 > ? OR bmba006 IS NULL )",
               "    AND bmceent = bmbaent ",
               "    AND bmcesite = bmbasite ",
               "    AND bmce001 = bmba001 ",
               "    AND bmce002 = bmba002 ",
               "    AND bmce003 = bmba003 ",
               "    AND bmce004 = bmba004 ",
               "    AND bmce005 = bmba005 ",
               "    AND bmce007 = bmba007 ",
               "    AND bmce008 = bmba008 ",
               "    AND (bmba019 = '1' OR bmba019 ='3') "  #1.??????,2.????????,3.??????
              #200120-00019#1---add----end---               
   PREPARE asft300_bmce_tmp_p FROM l_sql
   DECLARE asft300_bmce_tmp_c CURSOR FOR asft300_bmce_tmp_p
   #FOREACH asft300_bmce_tmp_c INTO l_bmce.bmce009,l_bmce.bmce010   #180731-00017#9 Mark By 06137  180809
  #FOREACH asft300_bmce_tmp_c USING l_sfakwf043 INTO l_bmce.bmce009,l_bmce.bmce010   #180731-00017#9 Add By 06137  180809  #200120-00019#1 mark 
   FOREACH asft300_bmce_tmp_c USING l_sfakwf043,l_sfakwf043                                                                  #200120-00019#1 add
                               INTO l_bmce.bmce009,l_bmce.bmce010   #180731-00017#9 Add By 06137  180809                 #200120-00019#1 add   
      INSERT INTO asft300_bmce_tmp(bmce009,bmce010)
           VALUES (l_bmce.bmce009,l_bmce.bmce010)
   END FOREACH
   
   LET l_sql = "SELECT imeb003,imeb004,bmce010 FROM imeb_t",
               "  LEFT JOIN asft300_bmce_tmp ON bmce009 = imeb004",
               " WHERE imebent = ",g_enterprise,
               "   AND imeb001 = '",l_imeb001,"'",
               " ORDER BY imeb002"
   PREPARE s_feature_imeb_p FROM l_sql
   DECLARE s_feature_imeb_c CURSOR FOR s_feature_imeb_p
   LET l_cnt1 = 1
   FOREACH s_feature_imeb_c INTO l_imeb[l_cnt1].imeb003,l_imeb[l_cnt1].imeb004,l_imeb[l_cnt1].bmce010
      LET l_cnt1 = l_cnt1 + 1
   END FOREACH
   LET l_cnt1 = l_cnt1 - 1
   
   LET l_cnt2 = 1
   LET tok = base.StringTokenizer.createExt(g_sfakwf2_d[l_ac].sfbcwf021,'_','',TRUE)
   WHILE tok.hasMoreTokens()
      LET l_imak003 = tok.nextToken()
      IF l_cnt2 > l_cnt1 THEN 
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = 'sub-00600'
         LET g_errparam.extend = g_sfakwf2_d[l_ac].sfbcwf021
         LET g_errparam.popup = TRUE
         CALL cl_err()
         RETURN FALSE      
      END IF
      
      IF l_imeb[l_cnt2].imeb003 = '1' THEN 
         LET l_cnt = 0
         SELECT COUNT(1) INTO l_cnt
           FROM imak_t
          WHERE imakent = g_enterprise
            AND imak001 = g_sfakwf2_d[l_ac].sfbcwf006
            AND imak002 = l_imeb[l_cnt2].imeb004
            AND imak003 = l_imak003
         IF l_cnt = 0 THEN
            INITIALIZE g_errparam TO NULL
            LET g_errparam.code = 'aim-00258'
            LET g_errparam.extend = l_imeb[l_cnt2].imeb004
            LET g_errparam.popup = TRUE
            CALL cl_err()
            RETURN FALSE
         END IF
      ELSE
         CALL s_aimi092_chk_eigenvalue(l_imeb001,l_imeb[l_cnt2].imeb004,l_imak003,g_sfakwf2_d[l_ac].sfbcwf006,'2')
              RETURNING l_success,l_errno,l_value
         IF NOT l_success THEN 
            INITIALIZE g_errparam TO NULL
            LET g_errparam.code = l_errno
            LET g_errparam.extend = l_imeb[l_cnt2].imeb004
            LET g_errparam.popup = TRUE
            CALL cl_err()
            RETURN FALSE
         END IF
      END IF
      
      IF NOT cl_null(l_imeb[l_cnt2].bmce010) THEN
         IF l_imak003 <> l_imeb[l_cnt2].bmce010 THEN
            INITIALIZE g_errparam TO NULL
            LET g_errparam.code = 'asf-00822'
            LET g_errparam.replace[1] = l_imak003
            LET g_errparam.replace[2] = l_imeb[l_cnt2].bmce010
            LET g_errparam.extend = g_sfakwf2_d[l_ac].sfbcwf006
            LET g_errparam.popup = TRUE
            CALL cl_err()
            RETURN FALSE
         END IF
      END IF
      
      LET l_cnt2 = l_cnt2 + 1
   END WHILE
   
   LET l_cnt2 = l_cnt2 - 1
   IF l_cnt1 > l_cnt2 THEN 
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = 'sub-00601'
      LET g_errparam.extend = g_sfakwf2_d[l_ac].sfbcwf021
      LET g_errparam.popup = TRUE
      CALL cl_err()
      RETURN FALSE
   END IF
   
   RETURN TRUE
END FUNCTION

################################################################################
# Descriptions...: ??????????????????
# Memo...........:
# Usage..........: CALL bsft001_wf_ins_sfbcwf()
#                  RETURNING ????
# Input parameter: ??????1   ????????1
#                : ??????2   ????????2
# Return code....: ??????1   ????????1
#                : ??????2   ????????2
# Date & Author..: ?? By ??
# Modify.........:
################################################################################
PRIVATE FUNCTION bsft001_wf_ins_sfbcwf()
DEFINE l_sql        STRING
DEFINE l_success     LIKE type_t.num5
DEFINE l_num         LIKE type_t.num5
DEFINE l_cnt         LIKE type_t.num5
DEFINE l_sfakwf     RECORD LIKE sfakwf_t.*
DEFINE r_success     LIKE type_t.num5  #241104-00004#1 add
   LET l_success = 'N'
            
   LET l_sql = "SELECT * FROM sfakwf_t WHERE 1=1 ",  
               "  AND sfakwfent = ? AND sfakwfsite = ? ",
               "  AND sfakwfdocno = ?  " 
   PREPARE bsft001_wf_pre2 FROM l_sql
   DECLARE bsft001_wf_curs2 CURSOR WITH HOLD FOR bsft001_wf_pre2    
   FOREACH bsft001_wf_curs2 USING g_enterprise,g_site,g_sfajwf_m.sfajwfdocno INTO l_sfakwf.*
      SELECT COUNT(1) INTO l_cnt FROM sfbcwf_t 
       WHERE sfbcwfent = g_enterprise
         AND sfbcwfsite = g_site
         AND sfbcwfdocno = g_sfajwf_m.sfajwfdocno
         AND sfbcwfseq = l_sfakwf.sfakwfseq
      
      IF l_cnt = 0 THEN     
         CALL s_bsft001_wf_02(g_sfajwf_m.sfajwfdocno,l_sfakwf.sfakwfseq,g_sfajwf_m.sfajwf003,l_sfakwf.sfakwf001,
                                          #??                #????     #????               #????               
            
                                 l_sfakwf.sfakwf043,'N','','','','') 
                                     #BOM????    #?????Y/N)      #??????             #??DATECODE                  #??????             #??????

                 RETURNING l_success,l_num
         IF l_success = 'N' THEN
            RETURN l_success
         END IF 
      END IF      
      INITIALIZE l_sfakwf.* TO NULL
   END FOREACH
   #241104-00004#1 add--s
   IF g_sfajwf_m.sfajwf013 =  '2' THEN
      CALL bsft001_wf_up_fc() RETURNING r_success 
      IF NOT r_success THEN
         LET l_success = 'N'
         RETURN l_success
      END IF 
   END IF 
   #241104-00004#1 add--e
   RETURN l_success
   
END FUNCTION

################################################################################
# Descriptions...: ?????????????
# Memo...........:
# Usage..........: CALL bsft001_wf_chk_sfbcwf013()
#                  RETURNING ????
# Input parameter: ??????1   ????????1
#                : ??????2   ????????2
# Return code....: ??????1   ????????1
#                : ??????2   ????????2
# Date & Author..: ?? By ??
# Modify.........:
################################################################################
PRIVATE FUNCTION bsft001_wf_chk_sfbcwf013()
DEFINE r_success    LIKE type_t.num5
DEFINE l_sql        STRING
DEFINE l_sfbcwf     RECORD LIKE sfbcwf_t.*
DEFINE l_amount      LIKE inbb_t.inbb011
DEFINE l_amount_die  LIKE icbawf_t.icbawf011 
DEFINE l_imaa006     LIKE imaa_t.imaa006 
DEFINE l_imaf053     LIKE imaf_t.imaf053
DEFINE l_imafwf210   LIKE imaf_t.imafwf210

   INITIALIZE g_errparam TO NULL
   LET r_success = TRUE
   LET l_sql = " SELECT * ", 
               "   FROM sfbcwf_t ",                                                                                        
               "  WHERE 1=1 ",
               "    AND sfbcwfent = ? AND sfbcwfsite = ? ",  
               "    AND sfbcwfdocno = ? " #??
   PREPARE bsft001_wf_pre1 FROM l_sql
   DECLARE bsft001_wf_curs1 CURSOR FOR bsft001_wf_pre1
   FOREACH bsft001_wf_curs1 USING g_enterprise,g_site,g_sfajwf_m.sfajwfdocno INTO l_sfbcwf.*
 
      SELECT imaa006,imaf053,imafwf210 INTO l_imaa006,l_imaf053,l_imafwf210 FROM imaf_t 
       LEFT OUTER JOIN imaa_t ON imaaent = g_enterprise AND imaa001 = imaf001
      WHERE imafent = g_enterprise AND imafsite = g_site
        AND imaf001 = l_sfbcwf.sfbcwf006
      IF l_imafwf210 <> 'Y' THEN
         CONTINUE FOREACH       
      END IF
      SELECT NVL(SUM(icbawf011),0),NVL(SUM(icbawf022),0) INTO l_amount_die,l_amount FROM icbawf_t
      WHERE icbawfent = g_enterprise AND icbawfsite = g_site
        AND icbawfdocno = g_sfajwf_m.sfajwfdocno
        AND icbawfseq  = l_sfbcwf.sfbcwfseq1 #??
        AND icbawfseq1 = l_sfbcwf.sfbcwfseq2 #??
        AND icbawf032 = l_sfbcwf.sfbcwfseq  #???? 
           
      LET g_errparam.replace[1] = l_sfbcwf.sfbcwfseq
      LET g_errparam.replace[2] = l_sfbcwf.sfbcwfseq1
      LET g_errparam.replace[3] = l_sfbcwf.sfbcwfseq2 
      LET g_errparam.replace[4] = l_sfbcwf.sfbcwf013     
      IF s_aint302_wf_oocawf008(l_sfbcwf.sfbcwf006) THEN
         IF l_sfbcwf.sfbcwf014 = l_imaf053  THEN  #????=????
            IF l_sfbcwf.sfbcwf013 <> l_amount_die THEN #?????
               LET g_errparam.replace[5] = l_amount_die
               LET r_success = FALSE
               EXIT FOREACH
            END IF 
         ELSE  
            IF l_sfbcwf.sfbcwf013 <> l_amount THEN #?????
               LET g_errparam.replace[5] = l_amount
               LET r_success = FALSE
               EXIT FOREACH
            END IF              
         END IF                              
      ELSE
         IF l_sfbcwf.sfbcwf014 = l_imaf053  THEN 
            IF l_sfbcwf.sfbcwf013 <> l_amount THEN #?????
               LET g_errparam.replace[5] = l_amount
               LET r_success = FALSE
               EXIT FOREACH
            END IF 
         ELSE                              
            IF l_sfbcwf.sfbcwf013 <> l_amount_die THEN #?????
               LET g_errparam.replace[5] = l_amount_die
               LET r_success = FALSE
               EXIT FOREACH
            END IF            
         END IF 
      END IF 
      INITIALIZE l_sfbcwf.* TO NULL       
   END FOREACH
   IF NOT r_success THEN
      LET g_errparam.code = 'wf-00058'  #????%1???%2???%3?????%4???bin?????%5????????
      LET g_errparam.extend = '' 
      LET g_errparam.popup = TRUE
      CALL cl_err() 
      RETURN r_success
   END IF 
   RETURN r_success
                
END FUNCTION

################################################################################
# Descriptions...: ?????????????
# Memo...........:
# Usage..........: CALL bsft001_wf_get_incgwf_inan_qty(p_sfbcwf006,p_sfbcwf021,p_sfbcwf014,p_sfbcwf019,p_sfbcwf020,p_sfbcwf029,p_sfbcwf030)
#                  RETURNING r_inag008,r_inan010
# Input parameter: p_sfbcwf006      ????
#                : p_sfbcwf021      ????
#                : p_sfbcwf014      ??
#                : p_sfbcwf019      ????
#                : p_sfbcwf020      ????
#                : p_sfbcwf029      ????
#                : p_sfbcwf030      ??????
# Return code....: r_inag008      ?????
#                : r_inan010      ?????
# Date & Author..: 18/03/20 By 07423 (#180130-00007#1 add)
# Modify.........:
################################################################################
PRIVATE FUNCTION bsft001_wf_get_incgwf_inan_qty(p_sfbcwf006,p_sfbcwf021,p_sfbcwf014,p_sfbcwf019,p_sfbcwf020,p_sfbcwf029,p_sfbcwf030)
DEFINE p_sfbcwf006        LIKE sfbcwf_t.sfbcwf006   #????
DEFINE p_sfbcwf021        LIKE sfbcwf_t.sfbcwf021   #????
DEFINE p_sfbcwf014        LIKE sfbcwf_t.sfbcwf014   #??
DEFINE p_sfbcwf019        LIKE sfbcwf_t.sfbcwf019   #????
DEFINE p_sfbcwf020        LIKE sfbcwf_t.sfbcwf020   #????
DEFINE p_sfbcwf029        LIKE sfbcwf_t.sfbcwf029   #????
DEFINE p_sfbcwf030        LIKE sfbcwf_t.sfbcwf030   #??????
DEFINE r_incgwf008        LIKE incgwf_t.incgwf008   #?????
DEFINE r_inan010        LIKE inan_t.inan010   #?????
DEFINE l_sql            STRING
DEFINE l_incgwf008_tot    LIKE incgwf_t.incgwf008   #???
DEFINE l_incgwf008        LIKE incgwf_t.incgwf008   #???
DEFINE l_incgwf007        LIKE incgwf_t.incgwf007   #????
DEFINE l_inan010_tot    LIKE inan_t.inan010   #???
DEFINE l_inan010        LIKE inan_t.inan010   #???
DEFINE l_inan007        LIKE inan_t.inan007   #????
DEFINE l_qty            LIKE incgwf_t.incgwf008  
DEFINE l_success        LIKE type_t.num5

   LET r_incgwf008 = 0
   LET r_inan010 = 0
   
#   IF g_prog[1,6] <> 'asft31' OR cl_null(p_sfbcwf006) OR cl_null(p_sfbcwf014) THEN 
   IF cl_null(p_sfbcwf006) OR cl_null(p_sfbcwf014) THEN 
      RETURN r_incgwf008,r_inan010 
   END IF
   
   IF cl_null(p_sfbcwf021) THEN LET p_sfbcwf021 = ' ' END IF
   
   #?????
   #??????????????
   LET l_sql = "SELECT SUM(incgwf008) ",
               "  FROM incgwf_t ",
               " WHERE incgwfent = ",g_enterprise,
               "   AND incgwfsite = '",g_site,"' ",
               "   AND incgwf001 = '",p_sfbcwf006,"' ",
               "   AND incgwf002 = '",p_sfbcwf021,"' ",
               "   AND incgwf007 = '",p_sfbcwf014,"' "
   IF NOT cl_null(p_sfbcwf019) THEN 
      LET l_sql = l_sql , "   AND incgwf004 = '",p_sfbcwf019,"' "
   END IF
   IF NOT cl_null(p_sfbcwf020) THEN 
      LET l_sql = l_sql , "   AND incgwf005 = '",p_sfbcwf020,"' "
   END IF
   IF NOT cl_null(p_sfbcwf029) THEN 
      LET l_sql = l_sql , "   AND incgwf006 = '",p_sfbcwf029,"' "
   END IF
   IF NOT cl_null(p_sfbcwf030) THEN 
      LET l_sql = l_sql , "   AND incgwf003 = '",p_sfbcwf030,"' "
   END IF
   
   PREPARE asft310_get_incgwf_pre1 FROM l_sql
   EXECUTE asft310_get_incgwf_pre1 INTO l_incgwf008_tot
   
   IF cl_null(l_incgwf008_tot) THEN LET l_incgwf008_tot = 0 END IF
   
   #?????????????
   LET l_sql = "SELECT incgwf007,SUM(incgwf008) ",
               "  FROM incgwf_t ",
               " WHERE incgwfent = ",g_enterprise,
               "   AND incgwfsite = '",g_site,"' ",
               "   AND incgwf001 = '",p_sfbcwf006,"' ",
               "   AND incgwf002 = '",p_sfbcwf021,"' ",
               "   AND incgwf007 <> '",p_sfbcwf014,"' "
   IF NOT cl_null(p_sfbcwf019) THEN 
      LET l_sql = l_sql , "   AND incgwf004 = '",p_sfbcwf019,"' "
   END IF
   IF NOT cl_null(p_sfbcwf020) THEN 
      LET l_sql = l_sql , "   AND incgwf005 = '",p_sfbcwf020,"' "
   END IF
   IF NOT cl_null(p_sfbcwf029) THEN 
      LET l_sql = l_sql , "   AND incgwf006 = '",p_sfbcwf029,"' "
   END IF
   IF NOT cl_null(p_sfbcwf030) THEN 
      LET l_sql = l_sql , "   AND incgwf003 = '",p_sfbcwf030,"' "
   END IF
   
   LET l_sql = l_sql , " GROUP BY incgwf007 "
   
   PREPARE asft310_get_incgwf_pre2 FROM l_sql
   DECLARE asft310_get_incgwf_cur2 CURSOR FOR asft310_get_incgwf_pre2
   
   OPEN asft310_get_incgwf_cur2
   FOREACH asft310_get_incgwf_cur2 INTO l_incgwf007,l_incgwf008
      CALL s_aooi250_convert_qty(p_sfbcwf006,l_incgwf007,p_sfbcwf014,l_incgwf008)
           RETURNING l_success,l_qty
      LET l_incgwf008_tot = l_incgwf008_tot + l_qty     
   END FOREACH
   
   #?????     
   #??????????????   
   LET l_sql = "SELECT SUM(inan010) ",
               "  FROM inan_t ",
               " WHERE inanent = ",g_enterprise,
               "   AND inansite = '",g_site,"' ",
               "   AND inan000 = '1' ",
               "   AND inan001 = '",p_sfbcwf006,"' ",
               "   AND inan002 = '",p_sfbcwf021,"' ",
               "   AND inan007 = '",p_sfbcwf014,"' "
   IF NOT cl_null(p_sfbcwf019) THEN 
      LET l_sql = l_sql , "   AND inan004 = '",p_sfbcwf019,"' "
   END IF
   IF NOT cl_null(p_sfbcwf020) THEN 
      LET l_sql = l_sql , "   AND inan005 = '",p_sfbcwf020,"' "
   END IF
   IF NOT cl_null(p_sfbcwf029) THEN 
      LET l_sql = l_sql , "   AND inan006 = '",p_sfbcwf029,"' "
   END IF
   IF NOT cl_null(p_sfbcwf030) THEN 
      LET l_sql = l_sql , "   AND inan003 = '",p_sfbcwf030,"' "
   END IF           
   
   PREPARE asft310_get_inan_pre1 FROM l_sql
   EXECUTE asft310_get_inan_pre1 INTO l_inan010_tot   
   
   IF cl_null(l_inan010_tot) THEN LET l_inan010_tot = 0 END IF
   
   #?????????????
   LET l_sql = "SELECT inan007,SUM(inan010) ",
               "  FROM inan_t ",
               " WHERE inanent = ",g_enterprise,
               "   AND inansite = '",g_site,"' ",
               "   AND inan000 = '1' ",
               "   AND inan001 = '",p_sfbcwf006,"' ",
               "   AND inan002 = '",p_sfbcwf021,"' ",
               "   AND inan007 <> '",p_sfbcwf014,"' "
   IF NOT cl_null(p_sfbcwf019) THEN 
      LET l_sql = l_sql , "   AND inan004 = '",p_sfbcwf019,"' "
   END IF
   IF NOT cl_null(p_sfbcwf020) THEN 
      LET l_sql = l_sql , "   AND inan005 = '",p_sfbcwf020,"' "
   END IF
   IF NOT cl_null(p_sfbcwf029) THEN 
      LET l_sql = l_sql , "   AND inan006 = '",p_sfbcwf029,"' "
   END IF
   IF NOT cl_null(p_sfbcwf030) THEN 
      LET l_sql = l_sql , "   AND inan003 = '",p_sfbcwf030,"' "
   END IF           
   
   LET l_sql = l_sql , " GROUP BY inan007 "
   
   PREPARE asft310_get_inan_pre2 FROM l_sql
   DECLARE asft310_get_inan_cur2 CURSOR FOR asft310_get_inan_pre2
   
   OPEN asft310_get_inan_cur2
   FOREACH asft310_get_inan_cur2 INTO l_inan007,l_inan010
      CALL s_aooi250_convert_qty(p_sfbcwf006,l_inan007,p_sfbcwf014,l_inan010)
           RETURNING l_success,l_qty
      LET l_inan010_tot = l_inan010_tot + l_qty     
   END FOREACH
   
   LET r_incgwf008 = l_incgwf008_tot
   LET r_inan010 = l_inan010_tot
   
   RETURN r_incgwf008,r_inan010
END FUNCTION

################################################################################
# Descriptions...: ??????????QPA
# Memo...........:
# Usage..........: CALL bsft001_wf_sfbcwf023_qpa_02(p_sfbcwf023,p_sfakwf006)
#                  RETURNING ????
# Input parameter: ??????1   ????????1
#                : ??????2   ????????2
# Return code....: ??????1   ????????1
#                : ??????2   ????????2
# Date & Author..: ?? By ??
# Modify.........:
################################################################################
PRIVATE FUNCTION bsft001_wf_sfbcwf023_qpa_02(p_sfbcwf023,p_sfakwf006)
DEFINE p_sfbcwf023         LIKE sfbcwf_t.sfbcwf023
DEFINE p_sfakwf006         LIKE sfakwf_t.sfakwf006
DEFINE r_sfbcwf010         LIKE sfbcwf_t.sfbcwf010
DEFINE r_sfbcwf011         LIKE sfbcwf_t.sfbcwf011
DEFINE l_num1            LIKE sfaa_t.sfaa012
DEFINE l_num2            LIKE sfaa_t.sfaa012
#250220-00015#1 mark ---s
#DEFINE l_num1_t          LIKE type_t.num20
#DEFINE l_num2_t          LIKE type_t.num20
#DEFINE l_j               LIKE type_t.num10
#DEFINE l_k               LIKE type_t.num10
#250220-00015#1 mark ---e
#250220-00015#1 add ---s
DEFINE l_num1_t          LIKE sfaa_t.sfaa012
DEFINE l_num2_t          LIKE sfaa_t.sfaa012
DEFINE l_j               LIKE sfaa_t.sfaa012
DEFINE l_k               LIKE sfaa_t.sfaa012
DEFINE l_ys1             LIKE type_t.num20
DEFINE l_ys2             LIKE type_t.num20
#250220-00015#1 add ---e          LIKE type_t.num10

   LET l_num1 = p_sfakwf006  #sfaa012
   LET l_num2 = p_sfbcwf023
   LET l_num1_t = l_num1
   LET l_num2_t = l_num2
  #WHILE TRUE           #mark 150723
     #??????           
     IF l_num1 = l_num1_t AND l_num2 = l_num2_t THEN
       #150723
       #EXIT WHILE
        #QPA????????
        IF l_num1 < l_num2 THEN
           LET l_j = l_num1_t
        ELSE
           LET l_j = l_num2_t
        END IF
        #250220-00015#1mark ---s
#        FOR l_k = l_j TO 1 STEP -1
#           IF (l_num1_t MOD l_k = 0) AND (l_num2_t MOD l_k = 0) THEN
#              EXIT FOR
#           END IF
#        END FOR
#        LET r_sfbcwf010 = l_num2_t / l_k
#        LET r_sfbcwf011 = l_num1_t / l_k
        #250220-00015#1 mark ---e
        #250220-00015#1 add ---s
        LET l_k = l_j
        LET l_ys1 = 0
        LET l_ys2 = 0
        SELECT MOD(l_num1_t, l_k) INTO l_ys1 FROM dual
        SELECT MOD(l_num2_t, l_k) INTO l_ys2 FROM dual
        IF l_ys1 = 0 AND l_ys2 = 0 THEN
           LET r_sfbcwf010 = l_num2_t / l_k
           LET r_sfbcwf011 = l_num1_t / l_k        
        ELSE
           LET r_sfbcwf010 = l_num2
           LET r_sfbcwf011 = l_num1        
        END IF
        #250220-00015#1 add ---e 
       #150723
     ELSE
        LET r_sfbcwf010 = l_num2
        LET r_sfbcwf011 = l_num1
       #150723
     END IF
  #END WHILE     #mark 150723

   RETURN r_sfbcwf010,r_sfbcwf011
END FUNCTION

################################################################################
# Descriptions...: ???????????
# Memo...........:  asft300?asft300_sfaa010_chk
# Usage..........: CALL bsft001_wf_wfapwf001_chk()
#                  RETURNING TRUE OR FALSE
# Input parameter: 
# Return code....: 
# Date & Author..: 
# Modify.........:
################################################################################
PRIVATE FUNCTION bsft001_wf_wfapwf001_chk()
DEFINE l_success    LIKE type_t.num5
DEFINE l_flag       LIKE type_t.num5
DEFINE l_ooba002    LIKE ooba_t.ooba002
DEFINE l_sql        STRING
DEFINE l_n          LIKE type_t.num5
DEFINE l_imaf012    LIKE imaf_t.imaf012
DEFINE l_imaf013    LIKE imaf_t.imaf013  #160720-00016#1
DEFINE l_imaf016    LIKE imaf_t.imaf016  #160706-00034#1
DEFINE l_oocq005    LIKE oocq_t.oocq005
DEFINE l_oocq006    LIKE oocq_t.oocq006
   
      INITIALIZE g_chkparam.* TO NULL
   LET g_chkparam.arg1 = g_sfakwf3_d[l_ac].wfapwf001 
   IF NOT cl_chk_exist("v_imaa001") THEN
      RETURN FALSE
   END IF
   IF NOT cl_chk_exist("v_imaf001_1") THEN     
      RETURN FALSE
   END IF
   #220105-00035#1 add---start---
   IF g_sfajwf_m.sfajwf003 = '2' THEN
      IF NOT cl_chk_exist("v_imaa001_17") THEN
         RETURN FALSE
      END IF
   ELSE
   #220105-00035#1 add---end---
      #210330-00042#1 add---s
       IF NOT cl_chk_exist("v_imaa001_16") THEN     
         RETURN FALSE
      END IF
      #210330-00042#1 add---e
   END IF             #220105-00035#1 add
   
   #??????????????????????????????????????
   CALL s_control_chk_group('3','6',g_user,g_dept,g_sfakwf3_d[l_ac].wfapwf001,'','','','') RETURNING l_success,l_flag
   IF NOT l_success THEN   #????
      RETURN FALSE
   END IF
   IF NOT l_flag THEN      #????
      RETURN FALSE
   END IF
   
   #??????????????????????????????????????
   CALL s_control_chk_doc('4',g_sfajwf_m.sfajwfdocno,g_sfakwf3_d[l_ac].wfapwf001,'','','','') RETURNING l_success,l_flag
   IF NOT l_success THEN   #????
      RETURN FALSE
   END IF
   IF NOT l_flag THEN      #????
      RETURN FALSE
   END IF
   
   #??????????????????????????????????????
   CALL s_control_chk_doc('5',g_sfajwf_m.sfajwfdocno,g_sfakwf3_d[l_ac].wfapwf001,'','','','') RETURNING l_success,l_flag
   IF NOT l_success THEN   #????
      RETURN FALSE
   END IF
   IF NOT l_flag THEN      #????
      RETURN FALSE
   END IF
   
  #160727-00025#1-s
   CALL s_aooi200_get_slip(g_sfajwf_m.sfajwfdocno) RETURNING l_success,l_ooba002
  #IF g_sfajwf_m.sfajwf003 MATCHES '[145]' THEN
   IF g_sfajwf_m.sfajwf003 MATCHES '[14]' OR
     (g_sfajwf_m.sfajwf003 ='5' AND cl_get_doc_para(g_enterprise,g_site,l_ooba002,'D-MFG-0024') <> '2') THEN
  #160727-00025#1-e
      LET l_sql = " SELECT COUNT(bmaa001) FROM bmaa_t ",
                  "  WHERE bmaaent = ",g_enterprise," AND bmaasite = '",g_site,"' ",
                  "    AND bmaa001 = '",g_sfakwf3_d[l_ac].wfapwf001,"' AND bmaastus='Y' "
      PREPARE sel_bmaa_pre FROM l_sql
      LET l_n = 0
      EXECUTE sel_bmaa_pre INTO l_n
      IF l_n = 0 THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = 'asf-00045'
         LET g_errparam.extend = g_sfakwf3_d[l_ac].wfapwf001
         LET g_errparam.popup = TRUE
         CALL cl_err()
         RETURN FALSE
      END IF
   END IF
   
   #170817-00039#1--add--start--
   #???????????2.??? ???????
   LET l_n = 0
   SELECT COUNT(1) INTO l_n
     FROM imaa_t
    WHERE imaaent = g_enterprise
      AND imaa001 = g_sfakwf3_d[l_ac].wfapwf001
      AND imaa004 = 'X'
      #AND imaa011 <> 2   #PGS(D)-00544 mark
      AND imaa011 <> '2'  #PGS(D)-00544 add
      
   IF l_n>0 THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = 'asf-00891'
      LET g_errparam.extend = g_sfakwf3_d[l_ac].wfapwf001
      LET g_errparam.popup = TRUE
      CALL cl_err()
      RETURN FALSE
   END IF
   #170817-00039#1--add--end----
   
   #160706-00034#1-s
   #imaa010->imaf016
   LET l_imaf012 = ''
   LET l_imaf013 = ''
   LET l_imaf016 = ''
   SELECT imaf012,imaf013,imaf016 INTO l_imaf012,l_imaf013,l_imaf016
     FROM imaf_t
    WHERE imafent = g_enterprise
      AND imafsite = g_site
      AND imaf001 = g_sfakwf3_d[l_ac].wfapwf001

   #???????????????
   # IF NOT asft300_life_cycle_chk(g_sfajwf_m.sfajwf003,g_sfakwf3_d[l_ac].wfapwf001) THEN
   #    RETURN FALSE
   # END IF

   #?????????????
   INITIALIZE g_chkparam.* TO NULL
   LET g_chkparam.err_str[1] = "abm-00250|",l_imaf016,"|",g_sfakwf3_d[l_ac].wfapwf001
   LET g_chkparam.arg1 = l_imaf016
   IF NOT cl_chk_exist("v_oocq002_210_1") THEN
      RETURN FALSE
   END IF 
   
   #????
#   IF NOT asft300_sfakwf001_feature() THEN
#      RETURN FALSE
#   END IF
#
   RETURN TRUE
END FUNCTION

################################################################################
# Descriptions...: ????
# Memo...........:
# Usage..........: CALL s_aooi150_ins (????)
#                  RETURNING ????
# Input parameter: ??????1   ????????1
#                : ??????2   ????????2
# Return code....: ??????1   ????????1
#                : ??????2   ????????2
# Date & Author..: ?? By ??
# Modify.........:
################################################################################
PRIVATE FUNCTION bsft001_wf_upd_wfapwf(p_cmd)
DEFINE  l_n                   LIKE type_t.num10                #?????  
DEFINE  l_lock_sw             LIKE type_t.chr1                #?????  
DEFINE  p_cmd                 LIKE type_t.chr1 
DEFINE  l_ac_t                LIKE type_t.num10
DEFINE  l_cmd                 LIKE type_t.chr1
DEFINE  l_qwhere     STRING

   LET g_sfajwfdocno_t = g_sfajwf_m.sfajwfdocno
   LET g_forupd_sql = "SELECT sfakwfseq,sfakwf001,sfakwf002,sfakwf003,sfakwf004,sfakwf005,sfakwf006,sfakwf007,sfakwf008,sfakwf009,sfakwf010,sfakwf011,sfakwf012,sfakwf013,sfakwf014,sfakwf015,sfakwf016,sfakwf017,sfakwf018,sfakwf019,sfakwf020,sfakwf021,sfakwf022,sfakwf023,sfakwf024,sfakwf025,sfakwf026, 
       sfakwf027,sfakwf028,sfakwf029,sfakwf030,sfakwf031,sfakwf032,sfakwf033,sfakwf034,sfakwf035,sfakwf036,sfakwf037,sfakwf038,sfakwf039,sfakwf040,sfakwf041,sfakwf042,sfakwf043 FROM sfakwf_t WHERE sfakwfent=? AND sfakwfsite=? AND sfakwfdocno=? AND sfakwfseq=? FOR UPDATE"
   LET g_forupd_sql = cl_sql_forupd(g_forupd_sql)
   LET g_forupd_sql = cl_sql_add_mask(g_forupd_sql)              #??????
   DECLARE bsft001_wf_bcl11 CURSOR FROM g_forupd_sql
 

   LET g_forupd_sql = "SELECT wfapwfseq1,wfapwf001,wfapwf002,wfapwf003,wfapwf004,wfapwf005,wfapwf006,wfapwf007,wfapwf008,wfapwf009,wfapwf010,wfapwf011,wfapwf012,wfapwf013,wfapwf014,wfapwf015,wfapwf016,wfapwf017,wfapwf018,wfapwf022,wfapwf019,wfapwf021,wfapwf020,wfapwf023,wfapwf024,wfapwf025,wfapwf026  
       FROM wfapwf_t WHERE wfapwfent=? AND wfapwfsite=? AND wfapwfdocno=? AND wfapwfseq=? AND wfapwfseq1=? FOR UPDATE"
   LET g_forupd_sql = cl_sql_forupd(g_forupd_sql)
   LET g_forupd_sql = cl_sql_add_mask(g_forupd_sql)              #??????
   DECLARE bsft001_wf_bcl31 CURSOR FROM g_forupd_sql
   
   #??key??????
   CALL bsft001_wf_set_entry(p_cmd)
   CALL bsft001_wf_set_no_entry(p_cmd)
   LET l_ac_t = 1
   CALL cl_mask_set_no_entry()
    
   CALL cl_set_comp_entry("wfapwf019,wfapwf020,wfapwf021,wfapwf022,wfapwf023",TRUE)
   INPUT ARRAY g_sfakwf3_d FROM s_detail3.*
         ATTRIBUTE(COUNT = g_rec_b,WITHOUT DEFAULTS, #MAXCOUNT = g_max_rec,
                 INSERT ROW = FALSE, 
                 DELETE ROW = FALSE,
                 APPEND ROW = FALSE)

      BEFORE INPUT
            #???????idx??g_detail_idx
            LET g_detail_idx_tmp = g_detail_idx
            LET g_detail_idx = g_detail_idx_list[1]
            #??????????
            IF g_detail_idx = 0 OR g_sfakwf_d.getLength() = 0 THEN
               NEXT FIELD sfakwfseq
            END IF
            #???????????
            IF cl_null(g_sfakwf_d[g_detail_idx].sfakwfseq) THEN
               NEXT FIELD sfakwfseq
            END IF

            IF g_insert = 'Y' AND NOT cl_null(g_insert) THEN 
              CALL FGL_SET_ARR_CURR(g_sfakwf3_d.getLength()+1) 
              LET g_insert = 'N' 
           END IF 
 
            #????????2???????
            IF g_loc = 'd' AND g_rec_b != 0 THEN
               CALL FGL_SET_ARR_CURR(g_idx_group.getValue("'3',"))
            END IF
            LET g_loc = 'd'
            LET g_rec_b = g_sfakwf3_d.getLength()
            
         BEFORE ROW
            #add-point:modify?before row2 name="input.body3.before_row2"
            SELECT COUNT(1) INTO l_n FROM wfapwf_t 
             WHERE wfapwfent = g_enterprise AND wfapwfsite = g_site AND wfapwfdocno = g_sfajwf_m.sfajwfdocno
               AND (wfapwf024 IS NOT NULL OR wfapwf025 IS NOT NULL OR  wfapwf026 IS NOT NULL)            
            IF l_n > 0 THEN
               INITIALIZE g_errparam TO NULL
               LET g_errparam.code = 'wf-00094'  #?????????????/??????/?????????????
               LET g_errparam.extend = '' 
               LET g_errparam.popup = TRUE
               CALL cl_err() 
               RETURN
            END IF
            IF g_sfajwf_m.sfajwfstus <> 'Y' THEN
               RETURN
            END IF 
            #end add-point  
            LET l_cmd = ''
            LET l_ac_t = l_ac 
            LET l_ac = ARR_CURR()
            LET g_detail_idx2 = l_ac
            LET g_detail_idx_list[3] = l_ac
            LET g_current_page = 3
            
            LET l_lock_sw = 'N'            #DEFAULT
            LET l_n = ARR_COUNT()
            DISPLAY l_ac TO FORMONLY.idx
         
            CALL s_transaction_begin()
            OPEN bsft001_wf_cl USING g_enterprise, g_site,g_sfajwf_m.sfajwfdocno
            #(ver:78) ---start---
            IF SQLCA.SQLCODE THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "OPEN bsft001_wf_cl:",SQLERRMESSAGE 
               LET g_errparam.code = SQLCA.SQLCODE
               LET g_errparam.popup = TRUE 
               CLOSE bsft001_wf_cl
               CALL s_transaction_end('N','0')
               CALL cl_err()
               RETURN
            END IF
            #(ver:78) --- end ---
            
            #200804-00006 ---start---
            FETCH bsft001_wf_cl
            IF SQLCA.SQLCODE AND SQLCA.SQLCODE <> 100 THEN
               INITIALIZE g_errparam TO NULL
               LET g_errparam.extend = "FETCH bsft001_wf_cl:",SQLERRMESSAGE
               LET g_errparam.code = SQLCA.SQLCODE
               LET g_errparam.popup = TRUE
               CLOSE bsft001_wf_cl
               #PostgreSQL???????, ????????????
               CALL s_transaction_end('N','0')
               CALL s_transaction_begin()
               CALL cl_err()
               RETURN
            END IF
            #200804-00006 --- end ---
            OPEN bsft001_wf_bcl11 USING g_enterprise, g_site,g_sfajwf_m.sfajwfdocno,g_sfakwf_d[g_detail_idx].sfakwfseq
            IF SQLCA.SQLCODE THEN   #(ver:78)
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = "OPEN bsft001_wf_bcl11:",SQLERRMESSAGE 
               LET g_errparam.code = SQLCA.SQLCODE   #(ver:78)
               LET g_errparam.popup = TRUE 
               CLOSE bsft001_wf_cl
               CLOSE bsft001_wf_bcl11
               CALL s_transaction_end('N','0')
               CALL cl_err()
               RETURN
            END IF
            #200804-00006 ---start---
            FETCH bsft001_wf_bcl11
            IF SQLCA.SQLCODE AND SQLCA.SQLCODE <> 100 THEN
               INITIALIZE g_errparam TO NULL
               LET g_errparam.extend = "FETCH bsft001_wf_bcl11:",SQLERRMESSAGE
               LET g_errparam.code = SQLCA.SQLCODE
               LET g_errparam.popup = TRUE
               CLOSE bsft001_wf_cl
               CLOSE bsft001_wf_bcl11
               #PostgreSQL???????, ????????????
               CALL s_transaction_end('N','0')
               CALL s_transaction_begin()
               CALL cl_err()
               RETURN
            END IF
            #200804-00006 --- end ---
            
            LET g_rec_b = g_sfakwf3_d.getLength()
            
            IF g_rec_b >= l_ac 
               AND g_sfakwf3_d[l_ac].wfapwfseq1 IS NOT NULL
            THEN 
               LET l_cmd='u'
               LET g_sfakwf3_d_t.* = g_sfakwf3_d[l_ac].*  #BACKUP
               LET g_sfakwf3_d_o.* = g_sfakwf3_d[l_ac].*  #BACKUP
               CALL bsft001_wf_set_entry_b(l_cmd)
               #add-point:modify?after_set_entry_b name="input.body3.after_set_entry_b"

               #end add-point  
               CALL bsft001_wf_set_no_entry_b(l_cmd)
               IF NOT bsft001_wf_lock_b_wfapwf("wfapwf_t","'3'") THEN
                  LET l_lock_sw='Y'
               ELSE
                  FETCH bsft001_wf_bcl31 INTO g_sfakwf3_d[l_ac].wfapwfseq1,g_sfakwf3_d[l_ac].wfapwf001,g_sfakwf3_d[l_ac].wfapwf002,g_sfakwf3_d[l_ac].wfapwf003,g_sfakwf3_d[l_ac].wfapwf004,g_sfakwf3_d[l_ac].wfapwf005,g_sfakwf3_d[l_ac].wfapwf006,g_sfakwf3_d[l_ac].wfapwf007,g_sfakwf3_d[l_ac].wfapwf008,g_sfakwf3_d[l_ac].wfapwf009, 
                      g_sfakwf3_d[l_ac].wfapwf010,g_sfakwf3_d[l_ac].wfapwf011,g_sfakwf3_d[l_ac].wfapwf012,g_sfakwf3_d[l_ac].wfapwf013,g_sfakwf3_d[l_ac].wfapwf014,g_sfakwf3_d[l_ac].wfapwf015,g_sfakwf3_d[l_ac].wfapwf016,g_sfakwf3_d[l_ac].wfapwf017,g_sfakwf3_d[l_ac].wfapwf018,g_sfakwf3_d[l_ac].wfapwf022, 
                      g_sfakwf3_d[l_ac].wfapwf019,g_sfakwf3_d[l_ac].wfapwf021,g_sfakwf3_d[l_ac].wfapwf020,g_sfakwf3_d[l_ac].wfapwf023,g_sfakwf3_d[l_ac].wfapwf024,g_sfakwf3_d[l_ac].wfapwf025,g_sfakwf3_d[l_ac].wfapwf026
                  IF SQLCA.SQLCODE THEN
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = SQLERRMESSAGE 
                     LET g_errparam.code = SQLCA.SQLCODE 
                     LET g_errparam.popup = TRUE 
                     CALL cl_err()
                     LET l_lock_sw = "Y"
                  END IF
                  
                  #??????
                  LET g_sfakwf3_d_mask_o[l_ac].* =  g_sfakwf3_d[l_ac].*
                  CALL bsft001_wf_wfapwf_t_mask()
                  LET g_sfakwf3_d_mask_n[l_ac].* =  g_sfakwf3_d[l_ac].*
                  
                  LET g_bfill = "N"
                  CALL bsft001_wf_show()
                  LET g_bfill = "Y"
                  
                  CALL cl_show_fld_cont()
               END IF
            ELSE
               LET l_cmd='a'
            END IF
 
            CALL bsft001_wf_idx_chk()   #(ver:83)

      AFTER FIELD wfapwf019
            
            #add-point:AFTER FIELD wfapwf019 name="input.a.page3.wfapwf019"
            IF NOT cl_null(g_sfakwf3_d[l_ac].wfapwf019) THEN 
               #??g_chkparam.*?????????????????????????????
               INITIALIZE g_chkparam.* TO NULL
 
               #??g_chkparam.*???
               LET g_chkparam.arg1 = g_sfakwf3_d[l_ac].wfapwf019
               #LET g_chkparam.arg2 = g_sfajwf_m.sfajwf006 #??
               LET g_chkparam.arg3 = g_sfakwf3_d[l_ac].wfapwf001 #??
               LET g_chkparam.arg4 = g_sfajwf_m.sfajwf016  #??/??
               #240423-00009#2 --s
               #IC?????????=??,????????=2.???3.????
               IF g_sfajwf_m.sfajwf005 = '1' THEN
                  LET g_chkparam.arg5 = "'2','3'"
               ELSE
               #????=??????????????=1.????3.????
                  LET l_qwhere = ''
                  LET g_chkparam.arg5 = "'1','3'"
                  LET l_qwhere = l_qwhere," wfagwf009='",g_sfajwf_m.sfajwf006,"'"
                  LET g_chkparam.where = l_qwhere
               END IF
               #240423-00009#2 --e
               #??????????library
               IF cl_chk_exist("v_sfakwf011_01_wf") THEN
                  #?????????
               ELSE
                  #?????????
                  NEXT FIELD CURRENT
               END IF
            END IF 
      AFTER FIELD wfapwf021
            
            #add-point:AFTER FIELD wfapwf021 name="input.a.page3.wfapwf021"
            IF NOT cl_null(g_sfakwf3_d[l_ac].wfapwf021) THEN 
               #??g_chkparam.*?????????????????????????????
               INITIALIZE g_chkparam.* TO NULL
 
               #??g_chkparam.*??? 
               LET g_chkparam.arg1 = g_sfakwf3_d[l_ac].wfapwf021 
               #LET g_chkparam.arg2 = g_sfajwf_m.sfajwf006 #??
               LET g_chkparam.arg3 = g_sfakwf3_d[l_ac].wfapwf001 #??
               #240423-00009#2 --s
               #IC?????????=??,????????=2.???3.????
               IF g_sfajwf_m.sfajwf005 = '1' THEN
                  LET g_chkparam.arg4 = "'2','3'"
               ELSE
               #????=??????????????=1.????3.????
                  LET l_qwhere = ''
                  LET g_chkparam.arg4 = "'1','3'"
                  LET l_qwhere = l_qwhere," wfahwf004='",g_sfajwf_m.sfajwf006,"'"
                  LET g_chkparam.where = l_qwhere
               END IF
               #240423-00009#2 --e   
               #??????????library
               IF cl_chk_exist("v_sfakwf016_01_wf") THEN
                  #?????????
               ELSE
                  #?????????
                  NEXT FIELD CURRENT
               END IF
            END IF
      AFTER FIELD wfapwf020
            
            #add-point:AFTER FIELD wfapwf020 name="input.a.page3.wfapwf020"
            INITIALIZE g_ref_fields TO NULL
            LET g_ref_fields[1] = g_sfakwf3_d[l_ac].wfapwf020
            CALL ap_ref_array2(g_ref_fields,"SELECT wfajwfl003 FROM wfajwfl_t WHERE wfajwflent="||g_enterprise||" AND wfajwfl001=? AND wfajwfl002='"||g_dlang||"'","") RETURNING g_rtn_fields
            LET g_sfakwf3_d[l_ac].wfapwf020_desc = '', g_rtn_fields[1] , ''
            DISPLAY BY NAME g_sfakwf3_d[l_ac].wfapwf020_desc
            
            IF NOT cl_null(g_sfakwf3_d[l_ac].wfapwf020) THEN 
               #??g_chkparam.*?????????????????????????????
               INITIALIZE g_chkparam.* TO NULL
 
               #??g_chkparam.*???
               LET g_chkparam.arg1 = g_sfakwf3_d[l_ac].wfapwf020
               LET g_chkparam.arg2 = g_sfajwf_m.sfajwf006 #??
               LET g_chkparam.arg3 = g_sfakwf3_d[l_ac].wfapwf001 #??
               LET g_chkparam.arg4 = g_sfajwf_m.sfajwf016  #??/??
                  
               #??????????library
               IF cl_chk_exist("v_wfajwf001_wf") THEN
                  #?????????
               ELSE
                  #?????????
                  NEXT FIELD CURRENT
               END IF
            END IF  
      AFTER FIELD wfapwf023
            
            #add-point:AFTER FIELD wfapwf023 name="input.a.page3.wfapwf023"
            IF NOT cl_null(g_sfakwf3_d[l_ac].wfapwf023) THEN 
               #??g_chkparam.*?????????????????????????????
               INITIALIZE g_chkparam.* TO NULL
 
               #??g_chkparam.*???
               LET g_chkparam.arg1 = g_sfakwf3_d[l_ac].wfapwf023 
               LET g_chkparam.arg2 = g_sfakwf3_d[l_ac].wfapwf001 #??
                  
               #??????????library
               IF cl_chk_exist("v_wfalwf001_wf") THEN
                  #?????????
               ELSE
                  #?????????
                  NEXT FIELD CURRENT
               END IF
            END IF             
         
     
      ON ACTION controlp INFIELD wfapwf019
            #add-point:ON ACTION controlp INFIELD wfapwf019 name="input.c.page3.wfapwf019"
            #?? a07 ??????(Version:3)   
            #??i?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
 
            LET g_qryparam.default1 = g_sfakwf3_d[l_ac].wfapwf019             #??default?
            LET g_qryparam.default2 = "" #g_sfakwf3_d[l_ac].wfagwf003 #????
            LET g_qryparam.default3 = "" #g_sfakwf3_d[l_ac].wfagwf004 #??????
            LET g_qryparam.default4 = "" #g_sfakwf3_d[l_ac].wfagwf006 #????
            LET g_qryparam.default5 = "" #g_sfakwf3_d[l_ac].wfagwf007 #????
            #??arg
            #LET g_qryparam.arg1 = g_sfajwf_m.sfajwf006 #??
            LET g_qryparam.arg2 = g_sfakwf3_d[l_ac].wfapwf001 #??
            LET g_qryparam.arg3 = g_sfajwf_m.sfajwf016  #??/??
            #240423-00009#2 --s
            #IC?????????=??,????????=2.???3.????
            IF g_sfajwf_m.sfajwf005 = '1' THEN
               LET g_qryparam.arg4 = "'2','3'"
            ELSE
            #????=??????????????=1.????3.????
               LET l_qwhere = ''
               LET g_qryparam.arg4 = "'1','3'"
               LET l_qwhere = l_qwhere," wfagwf009='",g_sfajwf_m.sfajwf006,"'"
               LET g_qryparam.where = l_qwhere
            END IF
            #240423-00009#2 --e
            CALL q_wfagwf001_wf()                                #????
 
            LET g_sfakwf3_d[l_ac].wfapwf019 = g_qryparam.return1              
            LET g_sfakwf3_d[l_ac].sfakwf012 = g_qryparam.return2 
            LET g_sfakwf3_d[l_ac].sfakwf013 = g_qryparam.return3 
            LET g_sfakwf3_d[l_ac].sfakwf014 = g_qryparam.return4 
            LET g_sfakwf3_d[l_ac].sfakwf015 = g_qryparam.return5 
            
            DISPLAY g_sfakwf3_d[l_ac].wfapwf019 TO wfapwf019              #
            DISPLAY g_sfakwf3_d[l_ac].sfakwf012 TO sfakwf012 #????
            DISPLAY g_sfakwf3_d[l_ac].sfakwf013 TO sfakwf013 #??????
            DISPLAY g_sfakwf3_d[l_ac].sfakwf014 TO sfakwf014 #????
            DISPLAY g_sfakwf3_d[l_ac].sfakwf015 TO sfakwf015 #????
            NEXT FIELD wfapwf019                          #?????
      ON ACTION controlp INFIELD wfapwf021
            #add-point:ON ACTION controlp INFIELD wfapwf021 name="input.c.page3.wfapwf021"
            #?? a07 ??????(Version:3)   
            #??i?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
 
            LET g_qryparam.default1 = g_sfakwf3_d[l_ac].wfapwf021             #??default?
            LET g_qryparam.default2 = "" #g_sfakwf3_d[l_ac].wfahwf005 #????
            LET g_qryparam.default3 = "" #g_sfakwf3_d[l_ac].wfahwf006 #????
            LET g_qryparam.default4 = "" #g_sfakwf3_d[l_ac].wfahwf010 #????
            LET g_qryparam.default5 = "" #g_sfakwf3_d[l_ac].wfahwf008 #???
            LET g_qryparam.default6 = "" #g_sfakwf3_d[l_ac].wfahwf009 #?????
            #??arg
            #LET g_qryparam.arg1 = g_sfajwf_m.sfajwf006 #??   #240423-00009#2 mark
            LET g_qryparam.arg2 = g_sfakwf3_d[l_ac].wfapwf001 #??
            #240423-00009#2 --s
            #IC?????????=??,????????=2.???3.????
            IF g_sfajwf_m.sfajwf005 = '1' THEN
               LET g_qryparam.arg3 = "'2','3'"
            ELSE
            #????=??????????????=1.????3.????
               LET l_qwhere = ''
               LET g_qryparam.arg3 = "'1','3'"
               LET l_qwhere = l_qwhere," wfahwf004='",g_sfajwf_m.sfajwf006,"'"
               LET g_qryparam.where = l_qwhere
            END IF
            #240423-00009#2 --e
            CALL q_sfakwf016_01_wf()                                #????
 
            LET g_sfakwf3_d[l_ac].wfapwf021 = g_qryparam.return1              
            LET g_sfakwf3_d[l_ac].sfakwf017 = g_qryparam.return2 
            LET g_sfakwf3_d[l_ac].sfakwf018 = g_qryparam.return3 
            LET g_sfakwf3_d[l_ac].sfakwf019 = g_qryparam.return4 
            LET g_sfakwf3_d[l_ac].sfakwf020 = g_qryparam.return5 
            LET g_sfakwf3_d[l_ac].sfakwf021 = g_qryparam.return6 
            
            DISPLAY g_sfakwf3_d[l_ac].wfapwf021 TO wfapwf021              #
            DISPLAY g_sfakwf3_d[l_ac].sfakwf017 TO sfakwf017 #????
            DISPLAY g_sfakwf3_d[l_ac].sfakwf018 TO sfakwf018 #????
            DISPLAY g_sfakwf3_d[l_ac].sfakwf019 TO sfakwf019 #????
            DISPLAY g_sfakwf3_d[l_ac].sfakwf020 TO sfakwf020 #???
            DISPLAY g_sfakwf3_d[l_ac].sfakwf021 TO sfakwf021 #?????
            NEXT FIELD wfapwf021                          #?????
 
 
         #Ctrlp:input.c.page3.wfapwf020
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD wfapwf020
            #add-point:ON ACTION controlp INFIELD wfapwf020 name="input.c.page3.wfapwf020"
            #?? a07 ??????(Version:3)   
            #??i?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
 
            LET g_qryparam.default1 = g_sfakwf3_d[l_ac].wfapwf020             #??default?
            LET g_qryparam.default2 = "" #g_sfakwf3_d[l_ac].wfajwf004 #????
            LET g_qryparam.default3 = "" #g_sfakwf3_d[l_ac].wfajwfl003 #??????
            #??arg
            LET g_qryparam.arg1 = g_sfajwf_m.sfajwf006 #??
            LET g_qryparam.arg2 = g_sfakwf3_d[l_ac].wfapwf001 #??
            LET g_qryparam.arg3 = g_sfajwf_m.sfajwf016  #??/??
 
            CALL q_wfajwf001_wf()                                #????
 
            LET g_sfakwf3_d[l_ac].wfapwf020 = g_qryparam.return1              
            LET g_sfakwf3_d[l_ac].sfakwf023 = g_qryparam.return2 
            LET g_sfakwf3_d[l_ac].wfapwf020_desc = g_qryparam.return3 
            DISPLAY g_sfakwf3_d[l_ac].wfapwf020 TO wfapwf020              #
            DISPLAY g_sfakwf3_d[l_ac].sfakwf023 TO sfakwf023 #????
            DISPLAY g_sfakwf3_d[l_ac].wfapwf020_desc TO wfapwf020_desc #??????
            NEXT FIELD wfapwf020                          #?????
            #END add-point
 
 
 
         #Ctrlp:input.c.page3.wfapwf023
         #?? a03 ??????(Version:3)
         ON ACTION controlp INFIELD wfapwf023
            #add-point:ON ACTION controlp INFIELD wfapwf023 name="input.c.page3.wfapwf023"
            #?? a07 ??????(Version:3)   
            #??i?
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
            LET g_qryparam.reqry = FALSE
 
            LET g_qryparam.default1 = g_sfakwf3_d[l_ac].wfapwf023             #??default?
            LET g_qryparam.default2 = "" #g_sfakwf3_d[l_ac].wfalwf005 #??????
            LET g_qryparam.default3 = "" #g_sfakwf3_d[l_ac].wfalwf006 #??????
            LET g_qryparam.default4 = "" #g_sfakwf3_d[l_ac].wfalwf007 #????
            LET g_qryparam.default5 = "" #g_sfakwf3_d[l_ac].wfalwf008 #??????
            #??arg
            LET g_qryparam.arg1 = g_sfakwf3_d[l_ac].wfapwf001 #??

 
            CALL q_wfalwf001_wf()                                #????
 
            LET g_sfakwf3_d[l_ac].wfapwf023 = g_qryparam.return1              
            LET g_sfakwf3_d[l_ac].sfakwf025 = g_qryparam.return2 
            LET g_sfakwf3_d[l_ac].sfakwf026 = g_qryparam.return3 
            LET g_sfakwf3_d[l_ac].sfakwf027 = g_qryparam.return4 
            LET g_sfakwf3_d[l_ac].sfakwf028 = g_qryparam.return5 
            DISPLAY g_sfakwf3_d[l_ac].wfapwf023 TO wfapwf023              #
            DISPLAY g_sfakwf3_d[l_ac].sfakwf025 TO sfakwf025 #??????
            DISPLAY g_sfakwf3_d[l_ac].sfakwf026 TO sfakwf026 #??????
            DISPLAY g_sfakwf3_d[l_ac].sfakwf027 TO sfakwf027 #????
            DISPLAY g_sfakwf3_d[l_ac].sfakwf028 TO sfakwf028 #??????
            NEXT FIELD wfapwf023                          #?????

      ON ROW CHANGE 
            IF INT_FLAG THEN
               LET INT_FLAG = 0
               LET g_sfakwf3_d[l_ac].* = g_sfakwf3_d_t.*
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code = 9001 
               LET g_errparam.popup = FALSE 
               CLOSE bsft001_wf_bcl31
               CALL s_transaction_end('N','0')
               CALL cl_err()
               EXIT INPUT 
            END IF
            
            IF l_lock_sw = 'Y' THEN
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code = -263 
               LET g_errparam.popup = TRUE 
               CALL cl_err()
               LET g_sfakwf3_d[l_ac].* = g_sfakwf3_d_t.*
               EXIT INPUT   #210416-00007
            ELSE

               #???????
               CALL bsft001_wf_wfapwf_t_mask_restore('restore_mask_o')
               
               UPDATE wfapwf_t SET (wfapwfdocno,wfapwfseq,wfapwfseq1,wfapwf001,wfapwf002,wfapwf003,wfapwf004,wfapwf005,wfapwf006,wfapwf007,wfapwf008,wfapwf009,wfapwf010,wfapwf011,wfapwf012,wfapwf013,wfapwf014,wfapwf015,wfapwf016,wfapwf017,wfapwf018,wfapwf022,wfapwf019,wfapwf021,wfapwf020,wfapwf023,wfapwf024, 
                   wfapwf025,wfapwf026) = (g_sfajwf_m.sfajwfdocno,g_sfakwf_d[g_detail_idx].sfakwfseq,g_sfakwf3_d[l_ac].wfapwfseq1,g_sfakwf3_d[l_ac].wfapwf001,g_sfakwf3_d[l_ac].wfapwf002,g_sfakwf3_d[l_ac].wfapwf003,g_sfakwf3_d[l_ac].wfapwf004,g_sfakwf3_d[l_ac].wfapwf005,g_sfakwf3_d[l_ac].wfapwf006,g_sfakwf3_d[l_ac].wfapwf007, 
                   g_sfakwf3_d[l_ac].wfapwf008,g_sfakwf3_d[l_ac].wfapwf009,g_sfakwf3_d[l_ac].wfapwf010,g_sfakwf3_d[l_ac].wfapwf011,g_sfakwf3_d[l_ac].wfapwf012,g_sfakwf3_d[l_ac].wfapwf013,g_sfakwf3_d[l_ac].wfapwf014,g_sfakwf3_d[l_ac].wfapwf015,g_sfakwf3_d[l_ac].wfapwf016,g_sfakwf3_d[l_ac].wfapwf017,g_sfakwf3_d[l_ac].wfapwf018, 
                   g_sfakwf3_d[l_ac].wfapwf022,g_sfakwf3_d[l_ac].wfapwf019,g_sfakwf3_d[l_ac].wfapwf021,g_sfakwf3_d[l_ac].wfapwf020,g_sfakwf3_d[l_ac].wfapwf023,g_sfakwf3_d[l_ac].wfapwf024,g_sfakwf3_d[l_ac].wfapwf025,g_sfakwf3_d[l_ac].wfapwf026) #??????
                WHERE wfapwfent = g_enterprise AND wfapwfsite = g_site AND wfapwfdocno = g_sfajwfdocno_t AND wfapwfseq = g_sfakwf_d[g_detail_idx].sfakwfseq AND wfapwfseq1 = g_sfakwf3_d_t.wfapwfseq1
                  
               CASE
                  WHEN SQLCA.sqlerrd[3] = 0  #???????
                     LET g_sfakwf3_d[l_ac].* = g_sfakwf3_d_t.*
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = "wfapwf_t" 
                     LET g_errparam.code = "std-00009" 
                     LET g_errparam.popup = TRUE 
                     CALL s_transaction_end('N','0')
                     CALL cl_err()
                     EXIT INPUT   #210416-00007
                     
                  WHEN SQLCA.SQLCODE #????
                     LET g_sfakwf3_d[l_ac].* = g_sfakwf3_d_t.*
                     INITIALIZE g_errparam TO NULL 
                     LET g_errparam.extend = "wfapwf_t:",SQLERRMESSAGE 
                     LET g_errparam.code = SQLCA.SQLCODE 
                     LET g_errparam.popup = TRUE 
                     CALL s_transaction_end('N','0')
                     CALL cl_err()
                     EXIT INPUT   #210416-00007
                     
                  OTHERWISE
                     #??????-?/?
                     
                        #161130-00056 add
                                    INITIALIZE gs_keys TO NULL 
               LET gs_keys[1] = g_sfajwf_m.sfajwfdocno
               LET gs_keys_bak[1] = g_sfajwfdocno_t
               LET gs_keys[2] = g_sfakwf_d[g_detail_idx].sfakwfseq
               LET gs_keys_bak[2] = g_sfakwf_d[g_detail_idx].sfakwfseq
               LET gs_keys[3] = g_sfakwf3_d[g_detail_idx2].wfapwfseq1
               LET gs_keys_bak[3] = g_sfakwf3_d_t.wfapwfseq1
               CALL bsft001_wf_update_b('wfapwf_t',gs_keys,gs_keys_bak,"'3'")
               END CASE

               #?????????
               CALL bsft001_wf_wfapwf_t_mask_restore('restore_mask_n')
               
               #??????(????)
               LET g_log1 = util.JSON.stringify(g_sfajwf_m),util.JSON.stringify(g_sfakwf3_d_t)
               LET g_log2 = util.JSON.stringify(g_sfajwf_m),util.JSON.stringify(g_sfakwf3_d[l_ac])
               IF NOT cl_log_modified_record_d(g_log1,g_log2) THEN 
                  CALL s_transaction_end('N','0')
                  EXIT INPUT   #210416-00007
               END IF

            END IF
         AFTER ROW

            LET l_ac = ARR_CURR()
            IF INT_FLAG THEN
               LET INT_FLAG = 0
               IF l_cmd = 'u' THEN
                  LET g_sfakwf3_d[l_ac].* = g_sfakwf3_d_t.*
               END IF
               INITIALIZE g_errparam TO NULL 
               LET g_errparam.extend = '' 
               LET g_errparam.code = 9001 
               LET g_errparam.popup = FALSE 
               CLOSE bsft001_wf_bcl31
               CLOSE bsft001_wf_bcl11
               CALL s_transaction_end('N','0')
               CALL cl_err()
               EXIT INPUT 
            END IF
            
            #??table??unlock
            
            CALL bsft001_wf_unlock_b("wfapwf_t","'3'")
            CALL s_transaction_end('Y','0')
           
   END INPUT
   CALL cl_set_comp_entry("wfapwf019,wfapwf020,wfapwf021,wfapwf022,wfapwf023",FALSE)

END FUNCTION

################################################################################
# Descriptions...: ????
# Memo...........:
# Usage..........: CALL s_aooi150_ins (????)
#                  RETURNING ????
# Input parameter: ??????1   ????????1
#                : ??????2   ????????2
# Return code....: ??????1   ????????1
#                : ??????2   ????????2
# Date & Author..: ?? By ??
# Modify.........:
################################################################################
PRIVATE FUNCTION bsft001_wf_lock_b_wfapwf(ps_table,ps_page)
DEFINE ps_page     STRING
   DEFINE ps_table    STRING
   DEFINE ls_group    STRING

   #?????table
   LET ls_group = "sfakwf_t"
   
   IF ls_group.getIndexOf(ps_table,1) THEN
      OPEN bsft001_wf_bcl11 USING g_enterprise, g_site,
                                       g_sfajwf_m.sfajwfdocno,g_sfakwf_d[g_detail_idx].sfakwfseq     
      IF SQLCA.SQLCODE THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "bsft001_wf_bcl11:",SQLERRMESSAGE 
         LET g_errparam.code = SQLCA.SQLCODE 
         LET g_errparam.popup = TRUE 
         CALL cl_err()
         RETURN FALSE
      END IF
   END IF

 
   #????table
   #LET ls_group = "'3',"
   #?????table
   LET ls_group = "wfapwf_t"
   IF ls_group.getIndexOf(ps_table,1) THEN
   
      OPEN bsft001_wf_bcl31 USING g_enterprise, g_site,
                                             g_sfajwf_m.sfajwfdocno,g_sfakwf_d[g_detail_idx].sfakwfseq,
                                             g_sfakwf3_d[g_detail_idx2].wfapwfseq1
      IF SQLCA.SQLCODE THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "bsft001_wf_bcl31:",SQLERRMESSAGE 
         LET g_errparam.code = SQLCA.SQLCODE 
         LET g_errparam.popup = TRUE 
         CALL cl_err()
         RETURN FALSE
      END IF
   END IF

   
   RETURN TRUE
END FUNCTION

################################################################################
# Descriptions...: ????
# Memo...........:
# Usage..........: CALL bswf001_wf_sfajwf018_chk1()
#                  RETURNING ????
# Input parameter: ??????1   ????????1
#                : ??????2   ????????2
# Return code....: ??????1   ????????1
#                : ??????2   ????????2
# Date & Author..: ?? By ??
# Modify.........:
################################################################################
PRIVATE FUNCTION bswf001_wf_sfajwf018_chk1()
DEFINE l_sql         STRING
DEFINE l_sql1        STRING
DEFINE l_sql2        STRING
DEFINE l_n           LIKE type_t.num5
DEFINE l_xmdd RECORD  #???????
       xmddent LIKE xmdd_t.xmddent, #????
       xmddsite LIKE xmdd_t.xmddsite, #????
       xmdddocno LIKE xmdd_t.xmdddocno, #????
       xmddseq LIKE xmdd_t.xmddseq, #??
       xmddseq1 LIKE xmdd_t.xmddseq1, #??
       xmddseq2 LIKE xmdd_t.xmddseq2, #???
       xmdd001 LIKE xmdd_t.xmdd001, #????
       xmdd002 LIKE xmdd_t.xmdd002, #????
       xmdd003 LIKE xmdd_t.xmdd003, #????
       xmdd004 LIKE xmdd_t.xmdd004, #????
       xmdd005 LIKE xmdd_t.xmdd005, #?????
       xmdd006 LIKE xmdd_t.xmdd006, #??????
       xmdd007 LIKE xmdd_t.xmdd007, #??????
       xmdd008 LIKE xmdd_t.xmdd008, #QPA
       xmdd009 LIKE xmdd_t.xmdd009, #????
       xmdd010 LIKE xmdd_t.xmdd010, #????
       xmdd011 LIKE xmdd_t.xmdd011, #??????
       xmdd012 LIKE xmdd_t.xmdd012, #??????
       xmdd013 LIKE xmdd_t.xmdd013, #MRP????
       xmdd014 LIKE xmdd_t.xmdd014, #????
       xmdd015 LIKE xmdd_t.xmdd015, #????
       xmdd016 LIKE xmdd_t.xmdd016, #??????
       xmdd017 LIKE xmdd_t.xmdd017, #????
       xmdd018 LIKE xmdd_t.xmdd018, #????
       xmdd019 LIKE xmdd_t.xmdd019, #??
       xmdd020 LIKE xmdd_t.xmdd020, #??
       xmdd021 LIKE xmdd_t.xmdd021, #??????
       xmdd022 LIKE xmdd_t.xmdd022, #??????
       xmdd023 LIKE xmdd_t.xmdd023, #??????
       xmdd024 LIKE xmdd_t.xmdd024, #??????
       xmdd025 LIKE xmdd_t.xmdd025, #??????
       xmdd026 LIKE xmdd_t.xmdd026, #??????
       xmdd027 LIKE xmdd_t.xmdd027, #??????
       xmdd028 LIKE xmdd_t.xmdd028, #??????
       xmdd029 LIKE xmdd_t.xmdd029, #??????
       xmdd030 LIKE xmdd_t.xmdd030, #????
       xmdd031 LIKE xmdd_t.xmdd031, #??????
       xmdd032 LIKE xmdd_t.xmdd032, #???
       xmdd033 LIKE xmdd_t.xmdd033, #????
       xmdd034 LIKE xmdd_t.xmdd034, #????
       xmdd035 LIKE xmdd_t.xmdd035, #????
       xmdd200 LIKE xmdd_t.xmdd200, #????
       xmdd201 LIKE xmdd_t.xmdd201, #??????
       xmdd202 LIKE xmdd_t.xmdd202, #??????
       xmdd203 LIKE xmdd_t.xmdd203, #???
       xmdd204 LIKE xmdd_t.xmdd204, #???
       xmdd205 LIKE xmdd_t.xmdd205, #???
       xmdd206 LIKE xmdd_t.xmdd206, #????
       xmddunit LIKE xmdd_t.xmddunit, #????
       xmdd207 LIKE xmdd_t.xmdd207, #????
       xmdd208 LIKE xmdd_t.xmdd208, #?????
       xmdd209 LIKE xmdd_t.xmdd209, #????
       xmdd210 LIKE xmdd_t.xmdd210, #????
       xmdd211 LIKE xmdd_t.xmdd211, #????
       xmdd212 LIKE xmdd_t.xmdd212, #MRP??
       xmdd213 LIKE xmdd_t.xmdd213, #??/??
       xmdd214 LIKE xmdd_t.xmdd214, #??
       xmdd215 LIKE xmdd_t.xmdd215, #??
       xmdd216 LIKE xmdd_t.xmdd216, #??????
       xmdd217 LIKE xmdd_t.xmdd217, #????
       xmdd218 LIKE xmdd_t.xmdd218, #????
       xmdd219 LIKE xmdd_t.xmdd219, #?????
       xmdd220 LIKE xmdd_t.xmdd220, #??????
       xmdd221 LIKE xmdd_t.xmdd221, #??
       xmdd222 LIKE xmdd_t.xmdd222, #???
       xmdd223 LIKE xmdd_t.xmdd223, #????
       xmdd224 LIKE xmdd_t.xmdd224, #????
       xmdd225 LIKE xmdd_t.xmdd225, #?????
       xmdd226 LIKE xmdd_t.xmdd226, #????
       xmdd227 LIKE xmdd_t.xmdd227, #????
       xmdd228 LIKE xmdd_t.xmdd228, #????
       xmddorga LIKE xmdd_t.xmddorga, #????
       xmdd229 LIKE xmdd_t.xmdd229, #????
       xmdd230 LIKE xmdd_t.xmdd230, #??????????
       #161109-00085#66 --s add
       xmddud001 LIKE xmdd_t.xmddud001, #?????(??)001
       xmddud002 LIKE xmdd_t.xmddud002, #?????(??)002
       xmddud003 LIKE xmdd_t.xmddud003, #?????(??)003
       xmddud004 LIKE xmdd_t.xmddud004, #?????(??)004
       xmddud005 LIKE xmdd_t.xmddud005, #?????(??)005
       xmddud006 LIKE xmdd_t.xmddud006, #?????(??)006
       xmddud007 LIKE xmdd_t.xmddud007, #?????(??)007
       xmddud008 LIKE xmdd_t.xmddud008, #?????(??)008
       xmddud009 LIKE xmdd_t.xmddud009, #?????(??)009
       xmddud010 LIKE xmdd_t.xmddud010, #?????(??)010
       xmddud011 LIKE xmdd_t.xmddud011, #?????(??)011
       xmddud012 LIKE xmdd_t.xmddud012, #?????(??)012
       xmddud013 LIKE xmdd_t.xmddud013, #?????(??)013
       xmddud014 LIKE xmdd_t.xmddud014, #?????(??)014
       xmddud015 LIKE xmdd_t.xmddud015, #?????(??)015
       xmddud016 LIKE xmdd_t.xmddud016, #?????(??)016
       xmddud017 LIKE xmdd_t.xmddud017, #?????(??)017
       xmddud018 LIKE xmdd_t.xmddud018, #?????(??)018
       xmddud019 LIKE xmdd_t.xmddud019, #?????(??)019
       xmddud020 LIKE xmdd_t.xmddud020, #?????(??)020
       xmddud021 LIKE xmdd_t.xmddud021, #?????(????)021
       xmddud022 LIKE xmdd_t.xmddud022, #?????(????)022
       xmddud023 LIKE xmdd_t.xmddud023, #?????(????)023
       xmddud024 LIKE xmdd_t.xmddud024, #?????(????)024
       xmddud025 LIKE xmdd_t.xmddud025, #?????(????)025
       xmddud026 LIKE xmdd_t.xmddud026, #?????(????)026
       xmddud027 LIKE xmdd_t.xmddud027, #?????(????)027
       xmddud028 LIKE xmdd_t.xmddud028, #?????(????)028
       xmddud029 LIKE xmdd_t.xmddud029, #?????(????)029
       xmddud030 LIKE xmdd_t.xmddud030, #?????(????)030
       #161109-00085#66 --e add
       xmdd036 LIKE xmdd_t.xmdd036, #????
       xmdd037 LIKE xmdd_t.xmdd037, #??????
       xmdd038 LIKE xmdd_t.xmdd038, #????
       xmdd039 LIKE xmdd_t.xmdd039, #??????
       xmdd231 LIKE xmdd_t.xmdd231, #??????
       xmdd040 LIKE xmdd_t.xmdd040  #BOM??
END RECORD
DEFINE l_sfajwf019      STRING
DEFINE l_sfajwf020      STRING
DEFINE l_sfajwf021      STRING
DEFINE l_sfajwf018_str  STRING
#250328-00010#1 add--s
DEFINE l_slip         LIKE type_t.chr20
DEFINE l_success        LIKE type_t.num5
#250328-00010#1 add--e

   #?????????????????????
   IF NOT cl_null(g_sfajwf_m.sfajwf018) THEN
      #??
      IF g_sfajwf_m.sfajwf017 = '1' THEN
       
         #170830-00031#1-s
         LET l_n = 0
         #170302-00045#6-s-mark
         #LET l_sql = " SELECT COUNT(1) FROM xmdd_t,imaf_t ",
         #            "  WHERE xmddent=",g_enterprise," AND xmddsite='",g_site,"' AND xmdddocno='",g_sfajwf_m.sfajwf018,"' ",
         #            "    AND (COALESCE(xmdd006,0)+COALESCE(xmdd016,0)+COALESCE(xmdd034,0)-COALESCE(xmdd014,0)) <= 0 ",  #???????
         #            "    AND imafent=xmddent AND imafsite=xmddsite AND imaf001=xmdd001 AND imaf012<>'1' "
         #170302-00045#6-e-mark
         #170302-00045#6-s-add
         LET l_sql = " SELECT COUNT(1) FROM xmdc_t,xmdd_t,imaf_t ",
                     "  WHERE xmddent=",g_enterprise," AND xmdcunit='",g_site,"' AND xmdddocno='",g_sfajwf_m.sfajwf018,"' ",
                     "    AND xmdcent=xmddent AND xmdcdocno=xmdddocno AND xmdcseq=xmddseq ",
                     "    AND (COALESCE(xmdd006,0)+COALESCE(xmdd016,0)+COALESCE(xmdd034,0)-COALESCE(xmdd014,0)) <= 0 ",  #???????
                     "    AND imafent=xmddent AND imafsite=xmdcunit AND imaf001=xmdd001 AND imaf012<>'1' "
         #170302-00045#6-e-add
         IF NOT cl_null(g_sfajwf_m.sfajwf019) THEN
            LET l_sql = l_sql," AND xmddseq=", g_sfajwf_m.sfajwf019
         END IF
         IF NOT cl_null(g_sfajwf_m.sfajwf020) THEN
            LET l_sql = l_sql," AND xmddseq1=", g_sfajwf_m.sfajwf020
         END IF
         IF NOT cl_null(g_sfajwf_m.sfajwf021) THEN
            LET l_sql = l_sql," AND xmddseq2=", g_sfajwf_m.sfajwf021
         END IF
         PREPARE asft300_sfajwf018_chk_pre3 FROM l_sql
         EXECUTE asft300_sfajwf018_chk_pre3 INTO l_n
         IF l_n > 0 THEN
            INITIALIZE g_errparam TO NULL
            LET g_errparam.code = 'asf-00897'
            LET g_errparam.extend = g_sfajwf_m.sfajwf018
            LET g_errparam.popup = TRUE
            CALL cl_err()
            RETURN FALSE
         END IF
         #170830-00031#1-e
       
         LET l_sql1 = "SELECT COUNT(1) "
         LET l_sql2 = "SELECT xmddseq,xmddseq1,xmddseq2 "
         #170302-00045#6-s-mark
         #LET l_sql = " FROM xmda_t,xmdd_t WHERE xmdaent=xmddent AND xmdadocno=xmdddocno ",
         #            "   AND xmddent='",g_enterprise,"' AND xmddsite='",g_site,"'",
         #170302-00045#6-e-mark
         #170302-00045#6-s-add
         LET l_sql = " FROM xmda_t,xmdc_t,xmdd_t ",
                     " WHERE xmdaent=xmddent AND xmdadocno=xmdddocno ",
                     "   AND xmdcent=xmddent AND xmdcdocno=xmdddocno ",
                     "   AND xmddent='",g_enterprise,"' AND xmdcunit='",g_site,"'",
         #170302-00045#6-e-add
                     #161128-00045-s-mod
#                     "   AND xmdddocno='",g_sfajwf_m.sfajwf018,"' AND xmdastus='Y'"
                     "   AND xmdddocno='",g_sfajwf_m.sfajwf018,"' AND xmdastus IN ('Y','H') "
                     #161128-00045-e-mod
         IF NOT cl_null(g_sfajwf_m.sfajwf019) THEN
            LET l_sql = l_sql," AND xmddseq=", g_sfajwf_m.sfajwf019
         END IF
         IF NOT cl_null(g_sfajwf_m.sfajwf020) THEN
            LET l_sql = l_sql," AND xmddseq1=", g_sfajwf_m.sfajwf020
         END IF
         IF NOT cl_null(g_sfajwf_m.sfajwf021) THEN
            LET l_sql = l_sql," AND xmddseq2=", g_sfajwf_m.sfajwf021
         END IF
         LET l_sql1 = l_sql1,l_sql        
         PREPARE asft300_sfajwf018_chk_pre1 FROM l_sql1
         EXECUTE asft300_sfajwf018_chk_pre1 INTO l_n
         
         IF l_n = 0 THEN
#            INITIALIZE g_errparam TO NULL
#            LET g_errparam.code = 'asf-00154'
#            LET g_errparam.extend = g_sfajwf_m.sfajwf018
#            LET g_errparam.popup = TRUE
#            CALL cl_err()
   
            RETURN FALSE
         END IF
         
         IF l_n = 1 THEN
            LET l_sql2 = l_sql2,l_sql
            PREPARE asft300_sfajwf018_chk_pre2 FROM l_sql2
            EXECUTE asft300_sfajwf018_chk_pre2 INTO g_sfajwf_m.sfajwf019,g_sfajwf_m.sfajwf020,g_sfajwf_m.sfajwf021
         ELSE
            #????
            INITIALIZE g_qryparam.* TO NULL
            LET g_qryparam.state = 'i'
	 		  LET g_qryparam.reqry = FALSE
            LET g_qryparam.where = " xmdddocno = '",g_sfajwf_m.sfajwf018,"'"
            IF NOT cl_null(g_sfajwf_m.sfajwf019) THEN
               LET g_qryparam.where = g_qryparam.where," AND xmddseq = ",g_sfajwf_m.sfajwf019
            END IF
            IF NOT cl_null(g_sfajwf_m.sfajwf020) THEN
               LET g_qryparam.where = g_qryparam.where," AND xmddseq1 = ",g_sfajwf_m.sfajwf020
            END IF
            IF NOT cl_null(g_sfajwf_m.sfajwf021) THEN
               LET g_qryparam.where = g_qryparam.where," AND xmddseq2 = ",g_sfajwf_m.sfajwf021
            END IF
            #170830-00031#1-s
            LET g_qryparam.where = g_qryparam.where,
            " AND NOT (((COALESCE(xmdd006,0)+COALESCE(xmdd016,0)+COALESCE(xmdd034,0)-COALESCE(xmdd014,0)) <= 0) ",  #???????
           #" AND EXISTS (SELECT 1 FROM imaf_t WHERE imafent=xmddent AND imafsite=xmddsite AND imaf001=xmdd001 AND imaf012<>'1'))"  #170302-00045#6-mark
            " AND EXISTS (SELECT 1 FROM imaf_t WHERE imafent=xmdcunit AND imafsite=xmddsite AND imaf001=xmdd001 AND imaf012<>'1'))" #170302-00045#6-add
            #170830-00031#1-e
            #180208-00020#1 2019/08/08  By 12133 add ---(S)
            ," AND NOT EXISTS (SELECT 1 FROM xmdc_t WHERE xmdcent = xmddent AND xmdcdocno = xmdddocno AND xmdcseq = xmddseq AND xmdc045 IN('2','3','4') )",
            " AND NOT EXISTS (SELECT 1 FROM sfajwf_t WHERE xmdaent=sfajwfent AND sfajwfstus<>'X' AND sfajwf017 = '2' AND sfajwf018 = xmda008)"
            ," AND NOT EXISTS (SELECT 1 FROM sfajwf_t WHERE xmdaent = sfajwfent AND sfajwfstus <> 'X' AND sfajwf017 = '1' AND sfajwf018 = xmdc055 AND xmda007 = '2') "
            #180208-00020#1 2019/08/08  By 12133 add ---(E)
            CALL q_xmdddocno_01_wf()                                #????        
            LET g_sfajwf_m.sfajwf018 = g_qryparam.return1              #????????????
            LET g_sfajwf_m.sfajwf019 = g_qryparam.return2
            LET g_sfajwf_m.sfajwf020 = g_qryparam.return3
            LET g_sfajwf_m.sfajwf021 = g_qryparam.return4
         END IF   
         LET l_sfajwf019 = g_sfajwf_m.sfajwf019
         LET l_sfajwf020 = g_sfajwf_m.sfajwf020
         LET l_sfajwf021 = g_sfajwf_m.sfajwf021
         LET l_sfajwf018_str = l_sfajwf019 CLIPPED,"-",l_sfajwf020 CLIPPED,"-",l_sfajwf021 CLIPPED
         CALL cl_replace_str(l_sfajwf018_str, " ", "") RETURNING g_sfajwf_m.l_sfajwf018
         DISPLAY BY NAME g_sfajwf_m.sfajwf019,g_sfajwf_m.sfajwf020,g_sfajwf_m.sfajwf021,g_sfajwf_m.l_sfajwf018
         #250328-00010#1 add--s
         IF cl_null(g_sfajwf_m.sfajwf025)THEN
            CALL s_aooi200_get_slip(g_sfajwf_m.sfajwfdocno)RETURNING l_success,l_slip 
            LET g_sfajwf_m.sfajwf025 = s_aooi200_get_doc_default(g_site,'1',l_slip,'sfajwf025',g_sfajwf_m.sfajwf025)
         END IF
#         IF cl_null(g_sfajwf_m.sfajwf025)THEN
#            SELECT imae035
#            INTO g_sfajwf_m.sfajwf025
#            FROM imae_t WHERE imaeent=g_enterprise AND imaesite=g_site AND imae001=g_sfakwf_d[l_ac].sfakwf001
#         END IF
         #???????
         LET g_sfajwf_m.sfajwf025_desc = s_desc_get_department_desc(g_sfajwf_m.sfajwf025)
         DISPLAY BY NAME g_sfajwf_m.sfajwf025,g_sfajwf_m.sfajwf004,g_sfajwf_m.sfajwf025_desc
         #250328-00010#1 add--e       
      END IF
   ELSE
      RETURN FALSE
   END IF
   
   RETURN TRUE
END FUNCTION

################################################################################
# Descriptions...: ?????
# Memo...........:
# Usage..........: CALL bsft001_wf_gen_sfamwf()
#                  RETURNING TURE/FALSE
# Input parameter: 
# Return code....: 
# Date & Author..: #240201-00005#1
# Modify.........:
################################################################################
PRIVATE FUNCTION bsft001_wf_gen_sfamwf()
DEFINE l_sfamwf RECORD
   sfamwfent    LIKE sfamwf_t.sfamwfent,     #????
   sfamwfsite   LIKE sfamwf_t.sfamwfsite,    #????
   sfamwfdocno  LIKE sfamwf_t.sfamwfdocno,   #??
   sfamwfseq    LIKE sfamwf_t.sfamwfseq,     #??
   sfamwf001    LIKE sfamwf_t.sfamwf001,     #??
   sfamwf002    LIKE sfamwf_t.sfamwf002,     #????
   sfamwf003    LIKE sfamwf_t.sfamwf003,     #????
   sfamwf004    LIKE sfamwf_t.sfamwf004,     #????
   sfamwf005    LIKE sfamwf_t.sfamwf005,     #???
   sfamwf006    LIKE sfamwf_t.sfamwf006,     #?????
   sfamwf007    LIKE sfamwf_t.sfamwf007,     #???????
   sfamwf008    LIKE sfamwf_t.sfamwf008,     #??
   sfamwf009    LIKE sfamwf_t.sfamwf009      #AMRP????
          END RECORD
DEFINE r_success  LIKE type_t.num5

   LET r_success = TRUE
   IF g_sfajwf_m.sfajwf017 IS NULL THEN
      LET r_success = TRUE
      RETURN r_success 
   END IF

   DELETE FROM sfamwf_t WHERE sfamwfent = g_enterprise AND sfamwfdocno = g_sfajwf_m.sfajwfdocno
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "del sfamwf_t",SQLERRMESSAGE
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF
   
   
   INITIALIZE l_sfamwf TO NULL
   LET l_sfamwf.sfamwfent   = g_enterprise
   LET l_sfamwf.sfamwfsite  = g_site
   LET l_sfamwf.sfamwfdocno = g_sfajwf_m.sfajwfdocno
   LET l_sfamwf.sfamwfseq   = 1
   LET l_sfamwf.sfamwf001   = g_sfajwf_m.sfajwf017
   LET l_sfamwf.sfamwf002   = g_sfajwf_m.sfajwf018
   LET l_sfamwf.sfamwf003   = g_sfajwf_m.sfajwf019
   LET l_sfamwf.sfamwf004   = g_sfajwf_m.sfajwf020
   LET l_sfamwf.sfamwf005   = g_sfajwf_m.sfajwf021
   LET l_sfamwf.sfamwf006   = 10
   
   SELECT xmdc050 INTO l_sfamwf.sfamwf008 FROM xmdc_t
    WHERE xmdcent = g_enterprise AND xmdcdocno = g_sfajwf_m.sfajwf018 AND xmdcseq = g_sfajwf_m.sfajwf019
   IF g_sfajwf_m.sfajwf013 = '2' THEN
      LET l_sfamwf.sfamwf007   = g_sfakwf_d[g_detail_idx].sfakwf008
   ELSE
      LET l_sfamwf.sfamwf007   = g_sfakwf_d[g_detail_idx].sfakwf006
   END IF
   
   
   INSERT INTO sfamwf_t(sfamwfent,sfamwfsite,sfamwfdocno,sfamwfseq,sfamwf001,sfamwf002,sfamwf003,sfamwf004,sfamwf005,
                        sfamwf006,sfamwf007,sfamwf008,sfamwf009)
        VALUES (l_sfamwf.sfamwfent,l_sfamwf.sfamwfsite,l_sfamwf.sfamwfdocno,l_sfamwf.sfamwfseq,
                l_sfamwf.sfamwf001,l_sfamwf.sfamwf002,l_sfamwf.sfamwf003,l_sfamwf.sfamwf004,l_sfamwf.sfamwf005,
                l_sfamwf.sfamwf006,l_sfamwf.sfamwf007,l_sfamwf.sfamwf008,l_sfamwf.sfamwf009)
   IF SQLCA.sqlcode THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = SQLCA.sqlcode
      LET g_errparam.extend = "ins sfamwf_t",SQLERRMESSAGE
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET r_success = FALSE
      RETURN r_success
   END IF

   RETURN r_success
END FUNCTION

################################################################################
# Descriptions...: ??bsft001_wf_sfakwf001_ref(p_cmd)?????????
# Memo...........:
# Usage..........: CALL s_aooi150_ins (????)
#                  RETURNING ????
# Input parameter: ??????1   ????????1
#                : ??????2   ????????2
# Return code....: ??????1   ????????1
#                : ??????2   ????????2
# Date & Author..: ?? By ??
# Modify.........:
################################################################################
PRIVATE FUNCTION bsft001_wf_sfakwf001_ref_2(p_cmd)
DEFINE p_cmd          LIKE type_t.chr1
DEFINE l_controlno    LIKE ooha_t.ooha001
DEFINE l_imaf153      LIKE imaf_t.imaf153
DEFINE l_sfakwf037    LIKE sfakwf_t.sfakwf037
DEFINE l_sfakwf038    LIKE sfakwf_t.sfakwf038
DEFINE l_success      LIKE type_t.num5
DEFINE l_n            LIKE type_t.num5
DEFINE l_oodbl004     LIKE oodbl_t.oodbl004  #????
DEFINE l_oodb005      LIKE oodb_t.oodb005    #???
DEFINE l_oodb006      LIKE oodb_t.oodb006    #?? 
DEFINE l_oodb011      LIKE oodb_t.oodb011    #??????1:????2:????? 
DEFINE l_pmdl009      LIKE pmdl_t.pmdl009
DEFINE l_pmdl010      LIKE pmdl_t.pmdl010
DEFINE l_pmdl024      LIKE pmdl_t.pmdl024
DEFINE l_pmdl015      LIKE pmdl_t.pmdl015
DEFINE l_pmdl017      LIKE pmdl_t.pmdl017
DEFINE l_pmdl023      LIKE pmdl_t.pmdl023
DEFINE l_pmdl054      LIKE pmdl_t.pmdl054
DEFINE l_pmdn040      LIKE pmdn_t.pmdn040
DEFINE l_pmdn043      LIKE pmdn_t.pmdn043
DEFINE l_pmdn041      LIKE pmdn_t.pmdn041
DEFINE l_pmdn042      LIKE pmdn_t.pmdn042

   #WAFER??,????
   SELECT imafwf200,imafwf201 
     INTO g_sfakwf_d[l_ac].sfakwf004,g_sfakwf_d[l_ac].sfakwf005
     FROM imaf_t  
    WHERE 1=1
      AND imafent = g_enterprise AND imafsite = g_site
      AND imaf001 = g_sfakwf_d[l_ac].sfakwf001
    
    CALL s_desc_get_item_desc(g_sfakwf_d[l_ac].sfakwf001) RETURNING g_sfakwf_d[l_ac].sfakwf001_desc,g_sfakwf_d[l_ac].sfakwf001_desc_1
    DISPLAY BY NAME g_sfakwf_d[l_ac].sfakwf001_desc,g_sfakwf_d[l_ac].sfakwf001_desc_1

    
    #????????????????
   #??????????????????????????????????????user ????????????
   LET l_controlno = ''
   SELECT imaf153 INTO l_imaf153   
     FROM imaf_t
    WHERE imafent = g_enterprise
      AND imafsite = g_site
      AND imaf001 = g_sfakwf_d[l_ac].sfakwf001
   
   CALL s_control_get_group1('4',g_user,g_dept,l_imaf153) RETURNING l_success,l_controlno   #211014-00034#5 add
   
   IF NOT cl_null(l_controlno) THEN
      #??????????????????????(apmi110)?????????????default?????
      SELECT COUNT(1) INTO l_n FROM pmal_t 
       WHERE pmalent = g_enterprise 
         AND pmal001 = g_sfajwf_m.sfajwf006 
         AND pmal002 = l_controlno 
         AND pmalstus = 'Y'
      IF l_n > 0 THEN
         SELECT pmal006,pmal020,pmal004,pmal009,pmal003,pmal021,
                pmal008,pmal023
           INTO l_pmdl009,l_pmdl010,l_sfakwf037,l_pmdl024,l_pmdl015,l_pmdl017,
                l_pmdl023,l_pmdl054
           FROM pmal_t 
          WHERE pmalent = g_enterprise 
            AND pmal001 = g_sfajwf_m.sfajwf006 
            AND pmal002 = l_controlno 
            AND pmalstus = 'Y'
      END IF
   END IF     
   #???????????????????????????????(apmm202)??  
   IF cl_null(l_controlno) OR l_n = 0 THEN
      SELECT pmab037,pmab053,pmab034,pmab039,pmab033,pmab054,
             pmab038,pmab057
        INTO l_pmdl009,l_pmdl010,l_sfakwf037,l_pmdl024,l_pmdl015,l_pmdl017,
             l_pmdl023,l_pmdl054
        FROM pmab_t 
       WHERE pmabent = g_enterprise 
         AND pmabsite = g_site 
         AND pmab001 = g_sfajwf_m.sfajwf006          
   END IF

#   CASE
#      WHEN INFIELD(sfakwf001)
#         LET g_sfakwf_d[l_ac].sfakwf037   = l_sfakwf037    #?? 
#         LET g_sfakwf_d[l_ac].sfakwf038   = l_sfakwf038    #?? 
#   END CASE
   
   #??????
   CALL s_tax_chk(g_site,l_sfakwf037)
     RETURNING l_success,l_oodbl004,l_oodb005,l_oodb006,l_oodb011
   LET g_sfakwf_d[l_ac].sfakwf039 = l_oodb005  #?????
#   IF l_oodb011 = '2' AND NOT cl_null(g_sfakwf_d[l_ac].sfakwf001) AND NOT cl_null(l_pmdl024) THEN
#      #?????
#      CALL s_tax_chktype(g_site,g_sfajwf_m.sfajwf006,g_sfakwf_d[l_ac].sfakwf001,'2',l_pmdl024)
#           RETURNING l_success,g_sfakwf_d[l_ac].sfakwf037,g_sfakwf_d[l_ac].sfakwf038
#      IF NOT l_success THEN
#         #???????????????
#         LET g_sfakwf_d[l_ac].sfakwf037 = ''
#         LET g_sfakwf_d[l_ac].sfakwf038 = ''
#      END IF                   
#   END IF
#   IF cl_null(g_sfakwf_d[l_ac].sfakwf037) OR cl_null(g_sfakwf_d[l_ac].sfakwf038) THEN
#      #?????
#      LET g_sfakwf_d[l_ac].sfakwf037 = l_sfakwf037
#      LET g_sfakwf_d[l_ac].sfakwf038 = l_oodb006
#   END IF 
   
   #????
   IF cl_null(g_sfakwf_d[l_ac].sfakwf007) THEN
      SELECT imae016 INTO g_sfakwf_d[l_ac].sfakwf007 FROM imae_t
       WHERE imaeent = g_enterprise AND imaesite = g_site AND imae001 = g_sfakwf_d[l_ac].sfakwf001
   END IF
   
   #????
   SELECT imaf144 INTO g_sfakwf_d[l_ac].sfakwf035 FROM imaf_t
    WHERE imafent = g_enterprise AND imafsite = g_site AND imaf001 = g_sfakwf_d[l_ac].sfakwf001
   
   IF cl_null(l_imaf153) THEN
      LET l_imaf153 = g_sfajwf_m.sfajwf006
   END IF
   #????
   #240430-00007#2 --s
#   CALL s_apmt500_get_price(l_pmdl017,l_imaf153,g_sfakwf_d[l_ac].sfakwf001,g_sfakwf_d[l_ac].sfakwf003,l_pmdl015,					
#       g_sfakwf_d[l_ac].sfakwf037,l_pmdl009,l_pmdl010,l_pmdl023,g_sfajwf_m.sfajwfdocno,					
#       g_sfajwf_m.sfajwfdocdt,g_sfakwf_d[l_ac].sfakwf035,g_sfakwf_d[l_ac].sfakwf034,g_site,l_pmdl054,'2',' ',' ')	
    CALL s_apmt500_get_price_wf(l_pmdl017,l_imaf153,g_sfakwf_d[l_ac].sfakwf001,g_sfakwf_d[l_ac].sfakwf003,l_pmdl015,					
       g_sfakwf_d[l_ac].sfakwf037,l_pmdl009,l_pmdl010,l_pmdl023,g_sfajwf_m.sfajwfdocno,					
       g_sfajwf_m.sfajwfdocdt,g_sfakwf_d[l_ac].sfakwf035,g_sfakwf_d[l_ac].sfakwf034,g_site,l_pmdl054,'2',' ',' ',
       g_sfakwf_d[l_ac].sfakwf011,g_sfakwf_d[l_ac].sfakwf012,g_sfakwf_d[l_ac].sfakwf016,g_sfakwf_d[l_ac].sfakwf017,
       '3',g_sfajwf_m.sfajwf012)	#???????????bincode??????????'3'?'',?????????
   #240430-00007#2 --e       
     RETURNING l_pmdn040,l_pmdn043,l_pmdn041,l_pmdn042					
   LET  g_sfakwf_d[l_ac].sfakwf036 = l_pmdn043
   IF cl_null(g_sfakwf_d[l_ac].sfakwf036) THEN LET g_sfakwf_d[l_ac].sfakwf036 = 0 END IF   
   
   DISPLAY BY NAME g_sfakwf_d[l_ac].sfakwf036
END FUNCTION

################################################################################
# Descriptions...: ????
# Memo...........:
# Usage..........: CALL s_aooi150_ins (????)
#                  RETURNING ????
# Input parameter: ??????1   ????????1
#                : ??????2   ????????2
# Return code....: ??????1   ????????1
#                : ??????2   ????????2
# Date & Author..: ?? By ??
# Modify.........:
################################################################################
PRIVATE FUNCTION bsft001_wf_detail_abg(p_type)
   DEFINE p_type             LIKE type_t.chr10
   DEFINE r_success          LIKE type_t.num5            #true/false  
   DEFINE r_errno            LIKE gzze_t.gzze001         #????  
   DEFINE r_bgaf016          LIKE bgaf_t.bgaf016         #??????  
   DEFINE r_bgae001          LIKE bgae_t.bgae001         #????  
   DEFINE r_bgae001_desc     LIKE type_t.chr80           #??  
   DEFINE r_bgae001_desc_sql STRING
   DEFINE l_success          LIKE type_t.num5
   DEFINE l_slip             LIKE pmda_t.pmdadocno
   DEFINE l_imaa009          LIKE imaa_t.imaa009
   DEFINE l_tran             RECORD
                                act              LIKE type_t.chr10,   #[1].chr ??
                                site             LIKE ooef_t.ooef001, #[2].chr ????
                                dat              LIKE type_t.dat,     #[3].dat ??
                                bgae001          LIKE bgae_t.bgae001, #[4].chr ????
                                bgbd013          LIKE bgbd_t.bgbd013, #[5].chr ??
                                bgbd014          LIKE bgbd_t.bgbd014, #[6].chr ??????
                                bgbd015          LIKE bgbd_t.bgbd015, #[7].chr ??
                                bgbd016          LIKE bgbd_t.bgbd016, #[8].chr ????
                                bgbd017          LIKE bgbd_t.bgbd017, #[9].chr ????
                                bgbd018          LIKE bgbd_t.bgbd018, #[10].chr ??
                                bgbd019          LIKE bgbd_t.bgbd019, #[11].chr ????
                                bgbd020          LIKE bgbd_t.bgbd020, #[12].chr ??
                                bgbd021          LIKE bgbd_t.bgbd021, #[13].chr ??
                                bgbd022          LIKE bgbd_t.bgbd022, #[14].chr WBS
                                bgbd023          LIKE bgbd_t.bgbd023, #[15].chr ????
                                bgbd024          LIKE bgbd_t.bgbd024, #[16].chr ??????
                                bgbd025          LIKE bgbd_t.bgbd025, #[17].chr ??????
                                bgbd026          LIKE bgbd_t.bgbd026, #[18].chr ?????? 
                                bgbd027          LIKE bgbd_t.bgbd027, #[19].chr ??????
                                bgbd028          LIKE bgbd_t.bgbd028, #[20].chr ??????
                                bgbd029          LIKE bgbd_t.bgbd029, #[21].chr ??????
                                bgbd030          LIKE bgbd_t.bgbd030, #[22].chr ??????
                                bgbd031          LIKE bgbd_t.bgbd031, #[23].chr ??????
                                bgbd032          LIKE bgbd_t.bgbd032, #[24].chr ??????
                                bgbd033          LIKE bgbd_t.bgbd033, #[25].chr ?????? 
                                bgbd042          LIKE bgbd_t.bgbd042, #[26].chr ??
                                bgbd043          LIKE bgbd_t.bgbd043, #[27].chr ??
                                used036          LIKE bgbd_t.bgbd036, #[28].chr ????
                                used037          LIKE bgbd_t.bgbd037, #[29].chr ???? 
                                used038          LIKE bgbd_t.bgbd038, #[30].chr ????
                                sour036          LIKE bgbd_t.bgbd036, #[31].chr ????
                                sour037          LIKE bgbd_t.bgbd037, #[32].chr ????
                                sour038          LIKE bgbd_t.bgbd038, #[33].chr ????
                                curr             LIKE ooai_t.ooai001, #[34].chr ??
                                account          LIKE type_t.num20_6 #[35].chr ??
                             END RECORD
   DEFINE ls_js              STRING
   DEFINE l_count            LIKE type_t.num5    #200805-00030#1 add
   DEFINE l_controlno       LIKE ooha_t.ooha001
   DEFINE l_imaf153         LIKE imaf_t.imaf153

   LET r_success          = TRUE
   LET r_errno            = ''
   LET r_bgaf016          = ''
   LET r_bgae001          = ''
   LET r_bgae001_desc     = '' 
   LET r_bgae001_desc_sql = ''

   CALL s_aooi200_get_slip(g_sfajwf_m.sfajwfdocno)
        RETURNING l_success,l_slip

   IF cl_get_doc_para(g_enterprise,g_site,l_slip,'D-FIN-5002') = 'N' THEN
      RETURN r_success,r_errno,r_bgaf016,
             r_bgae001,r_bgae001_desc,r_bgae001_desc_sql
   END IF
   
   #add by lixiang 2015/12/17---begin---
   #????????????????????????????????????????????????????????????
 #  IF p_type = '4' AND cl_null(g_pmdn2_d[l_ac].pmdn058) THEN    #210326-00020#1--mark
    IF cl_null(g_sfakwf_d[l_ac].sfakwf048) THEN  #210326-00020#1--add
       RETURN r_success,r_errno,r_bgaf016,
             r_bgae001,r_bgae001_desc,r_bgae001_desc_sql
   END IF
   #add by lixiang 2015/12/17---end-----

   LET l_imaa009 = ''
   SELECT imaa009 INTO l_imaa009
     FROM imaa_t
    WHERE imaaent = g_enterprise
      AND imaa001 = g_sfakwf_d[l_ac].sfakwf001

   INITIALIZE l_tran.* TO NULL
   LET l_tran.site = g_site
   LET l_tran.dat  = g_sfajwf_m.sfajwfdocdt

   LET l_tran.bgae001 = g_sfakwf_d[l_ac].sfakwf048
   LET l_tran.bgbd013 = g_sfajwf_m.sfajwf002
 
   LET l_tran.bgbd017 = g_sfajwf_m.sfajwf006  #210302-00036#1 add

   LET l_tran.bgbd019 = l_imaa009
   LET l_tran.bgbd020 = g_sfajwf_m.sfajwf001
   LET l_tran.bgbd021 = g_sfakwf_d[l_ac].sfakwf045
   LET l_tran.bgbd022 = g_sfakwf_d[l_ac].sfakwf046
   LET l_tran.used036 = 'apmt500'
   LET l_tran.used037 = g_sfajwf_m.sfajwfdocno 
   LET l_tran.used038 = g_sfakwf_d[l_ac].sfakwfseq
   LET l_imaf153 = ''
   SELECT imaf153 INTO l_imaf153 FROM imaf_t
   WHERE imafent = g_enterprise AND imafsite = g_site AND imaf001 = g_sfakwf_d[l_ac].sfakwf001

   LET l_controlno = ''        
   CALL s_control_get_group1('4',g_user,g_dept,l_imaf153) RETURNING r_success,l_controlno 
   LET l_count = 0
   IF NOT cl_null(l_controlno) THEN
      #??????????????????????(apmi110)?????????????default?????
      SELECT COUNT(1) INTO l_count FROM pmal_t 
       WHERE pmalent = g_enterprise 
         AND pmal001 = g_sfajwf_m.sfajwf006 
         AND pmal002 = l_controlno 
         AND pmalstus = 'Y'
      IF l_count > 0 THEN
         SELECT pmal003
           INTO l_tran.curr
           FROM pmal_t 
          WHERE pmalent = g_enterprise 
            AND pmal001 = g_sfajwf_m.sfajwf006 
            AND pmal002 = l_controlno 
            AND pmalstus = 'Y'
      END IF
   END IF     
   #???????????????????????????????(apmm202)??  
   IF cl_null(l_controlno) OR l_count = 0 THEN
      SELECT pmab033
        INTO l_tran.curr
        FROM pmab_t 
       WHERE pmabent = g_enterprise 
         AND pmabsite = g_site 
         AND pmab001 = g_sfajwf_m.sfajwf006          
   END IF

   #LET l_tran.curr    = g_pmdl_m.pmdl015
   LET l_tran.account = 0

   #LET l_tran.account = l_tran.account * g_pmdl_m.pmdl016

   #CALL s_curr_round(g_site,g_ooef016,l_tran.account,'2') RETURNING l_tran.account 

   LET ls_js = util.JSON.stringify(l_tran)
   
   CALL s_abg_get_bgbd013(ls_js) RETURNING l_tran.bgbd013 #191226-00008#13 add
   LET ls_js = util.JSON.stringify(l_tran) #191226-00008#13 add

   CASE p_type
      WHEN '1'
         CALL s_abg_bgae001_query2(ls_js)
              RETURNING r_bgae001

         LET l_tran.bgae001 = r_bgae001
         LET ls_js = util.JSON.stringify(l_tran)
         CALL s_abg_bgae001_desc2(ls_js)
              RETURNING r_bgae001_desc
      WHEN '2'
         CALL s_abg_bgae001_chk2(ls_js)
              RETURNING r_success,r_errno                                 
         IF r_success THEN         
            CALL s_abg_bgae001_desc2(ls_js)
                 RETURNING r_bgae001_desc
         END IF
      WHEN '3' 
         CALL s_abg_bgae001_desc2(ls_js)
              RETURNING r_bgae001_desc
      WHEN '4'
         CALL s_abg_bg_used_chk(ls_js)
              RETURNING r_success,r_errno,r_bgaf016 
         IF NOT cl_null(r_errno) THEN LET r_success = FALSE END IF #200205-00013#1 add
      WHEN '5'
         CALL s_abg_bgae001_desc2_sql(ls_js)
              RETURNING r_bgae001_desc_sql
      WHEN '6'
         CALL s_abg_bgbd_count(ls_js) RETURNING r_success,r_errno #190829-00036#4 add
      
   END CASE

   RETURN r_success,r_errno,r_bgaf016,r_bgae001,r_bgae001_desc,r_bgae001_desc_sql
END FUNCTION

################################################################################
# Descriptions...: ????????sfac006 ????????
# Memo...........:
# Usage..........: CALL bsft001_wf_set_entry_sfanwf()
# Input parameter: 
# Return code....: 
# Date & Author..: ?? By ??
# Modify.........:
################################################################################
PRIVATE FUNCTION bsft001_wf_set_entry_sfanwf()
DEFINE l_n        LIKE type_t.num5
DEFINE l_imaa005  LIKE imaa_t.imaa005     #181214-00006# add
DEFINE l_imaa011  LIKE imaa_t.imaa011     #220511-00019#1 add

   #160503-00004#1-s
   CALL cl_set_comp_entry("sfanwf002",TRUE)
   CALL cl_set_comp_entry("sfanwf001",TRUE)   #170113-00037#1 add
   CALL cl_set_comp_entry("sfanwf003",TRUE)   #190807-00046#2 add
   #220511-00019#1 add--s
   SELECT imaa011 INTO l_imaa011
     FROM imaa_t
    WHERE imaaent = g_enterprise
      AND imaa001 = g_sfakwf_d[g_detail_idx].sfakwf001
   IF l_imaa011 = '1' THEN
      IF g_sfakwf5_d[l_ac].sfanwf002 = '1' THEN
         CALL cl_set_comp_entry("sfanwf002",FALSE)
         CALL cl_set_comp_entry("sfanwf001",FALSE)
      END IF
   ELSE
   #220511-00019#1 add--e
      IF g_sfakwf5_d[l_ac].sfanwf002 = '1' THEN
         CALL cl_set_comp_entry("sfanwf002",FALSE)
         CALL cl_set_comp_entry("sfanwf001",FALSE)   #170113-00037#1 add
         CALL cl_set_comp_entry("sfanwf003",FALSE)   #190807-00046#2 add
      END IF
   END IF   #220511-00019#1 add
   #160503-00004#1-e
   #220628-00044#1-s
   CALL cl_set_comp_entry("sfanwf006",FALSE)
   LET l_imaa005 = ''
   SELECT imaa005 INTO l_imaa005 FROM imaa_t
    WHERE imaaent = g_enterprise AND imaa001 = g_sfakwf5_d[l_ac].sfanwf001   
   IF cl_null(g_sfakwf5_d[l_ac].sfanwf006) THEN
      LET g_sfakwf5_d[l_ac].sfanwf006 = ' '
   END IF
   IF NOT cl_null(l_imaa005) THEN
      CALL cl_set_comp_entry("sfanwf006",TRUE)
      CALL cl_set_comp_entry("sfanwf003",TRUE)
   END IF
END FUNCTION

################################################################################
# Descriptions...: ?[?????]page?????????sfac002???
# Memo...........:
# Usage..........: CALL asft300_get_sfac002()
#                  ?????g_sfac_d[l_ac].sfac002
# Date & Author..: 20/12/09 By 00272 #201111-00004#1 add
################################################################################
PRIVATE FUNCTION bsft001_wf_get_sfanwf002()
DEFINE l_n_2        LIKE type_t.num10
DEFINE l_n_3        LIKE type_t.num10
DEFINE l_n_5        LIKE type_t.num10
DEFINE l_imaa005    LIKE imaa_t.imaa005  #220628-00044#1
   
   #220628-00044#1-s
   LET l_imaa005 = ''
   SELECT imaa005 INTO l_imaa005 FROM imaa_t
    WHERE imaaent = g_enterprise AND imaa001 = g_sfakwf_d[g_detail_idx].sfakwf001
   IF NOT cl_null(l_imaa005) THEN
      LET g_sfakwf5_d[l_ac].sfanwf002 = '2'
   END IF
   #220628-00044#1-e
   #??1:??????????,??????1:??
   IF g_sfajwf_m.sfajwf003 = '3' THEN #3:?????
      LET g_sfakwf5_d[l_ac].sfanwf002 = '4' #4:?????
   ELSE
      #2:???
      LET l_n_2 = 0
      SELECT COUNT(1) INTO l_n_2 FROM bmab_t
       WHERE bmabent = g_enterprise
         AND bmabsite = g_site
         AND bmab001 = g_sfakwf_d[g_detail_idx].sfakwf001
         AND bmab002 = g_sfakwf_d[g_detail_idx].sfakwf002
         AND bmab003 = g_sfakwf5_d[l_ac].sfanwf001
      IF l_n_2 > 0 THEN
         LET g_sfakwf5_d[l_ac].sfanwf002 = '2'
      END IF
      #3:?????
      LET l_n_3 = 0
      SELECT COUNT(1) INTO l_n_3 FROM bmad_t
       WHERE bmadent = g_enterprise
         AND bmadsite = g_site
         AND bmad001 = g_sfakwf_d[g_detail_idx].sfakwf001
         AND bmad002 = g_sfakwf_d[g_detail_idx].sfakwf002
         AND bmad003 = g_sfakwf5_d[l_ac].sfanwf001
      IF l_n_3 > 0 THEN
         LET g_sfakwf5_d[l_ac].sfanwf002 = '3'
      END IF
      #5:???/???
      LET l_n_5 = 0
      SELECT COUNT(1) INTO l_n_5 FROM bmac_t
       WHERE bmacent = g_enterprise
         AND bmacsite = g_site
         AND bmac001 = g_sfakwf_d[g_detail_idx].sfakwf001
         AND bmac002 = g_sfakwf_d[g_detail_idx].sfakwf002
         AND bmac003 = g_sfakwf5_d[l_ac].sfanwf001
      IF l_n_5 > 0 THEN
         LET g_sfakwf5_d[l_ac].sfanwf002 = '5'
      END IF
   END IF
END FUNCTION

################################################################################
# Descriptions...: ??????
# Memo...........:
# Usage..........: CALL asft300_sfac001_chk()
#                  RETURNING r_success,r_imaa005
# Input parameter: 
# Return code....: 
# Date & Author..: #170225-00003#1 By 04441
# Modify.........:
################################################################################
PRIVATE FUNCTION bsft001_wf_sfanwf001_chk()
DEFINE r_success    LIKE type_t.num5
DEFINE r_imaa005    LIKE imaa_t.imaa005
DEFINE l_success    LIKE type_t.num5
DEFINE l_flag       LIKE type_t.chr1
DEFINE l_ooba002    LIKE ooba_t.ooba002
DEFINE l_n          LIKE type_t.num5
DEFINE l_imaa005    LIKE imaa_t.imaa005
DEFINE l_imaa004    LIKE imaa_t.imaa004      #170618-00283#1
DEFINE l_imaf016    LIKE imaf_t.imaf016      #170618-00477#4-add

   LET r_success = FALSE
   LET r_imaa005 = ''
   
   #????
   SELECT imaa005 INTO r_imaa005 FROM imaa_t WHERE imaaent = g_enterprise AND imaa001 = g_sfakwf5_d[l_ac].sfanwf001
   IF g_sfakwf5_d[l_ac].sfanwf002 = '2' THEN
      SELECT imaa005 INTO l_imaa005 FROM imaa_t WHERE imaaent = g_enterprise AND imaa001 = g_sfakwf_d[g_detail_idx].sfakwf001             
      IF NOT cl_null(l_imaa005) THEN
         IF cl_null(r_imaa005) OR l_imaa005 != r_imaa005 THEN
            INITIALIZE g_errparam TO NULL
            LET g_errparam.code = 'abm-00114'
            LET g_errparam.extend = g_sfakwf5_d[l_ac].sfanwf001
            LET g_errparam.popup = TRUE
            CALL cl_err()
            LET g_sfakwf5_d[l_ac].sfanwf001 = g_sfakwf5_d_t.sfanwf001
            RETURN r_success,r_imaa005
         END IF
      END IF
   END IF
   
   CALL s_aooi200_get_slip(g_sfajwf_m.sfajwfdocno) RETURNING l_success,l_ooba002
   LET l_flag = cl_get_doc_para(g_enterprise,g_site,l_ooba002,'D-MFG-0024')
   #170320-00031#1-s
   #IF l_flag <> '2' AND g_sfaa_m.sfaa003 MATCHES '[145]' AND g_sfakwf5_d[l_ac].sfanwf002 MATCHES '[235]' THEN
   IF l_flag <> '2' AND g_sfakwf5_d[l_ac].sfanwf002 MATCHES '[235]' THEN
   #170320-00031#1-e
      LET l_n = 0
      CASE g_sfakwf5_d[l_ac].sfanwf002
         WHEN '2'
            SELECT COUNT(1) INTO l_n FROM bmab_t
             WHERE bmabent = g_enterprise AND bmabsite = g_site 
               AND bmab001 = g_sfakwf_d[g_detail_idx].sfakwf001 AND bmab002 = g_sfakwf_d[g_detail_idx].sfakwf002 AND bmab003 = g_sfakwf5_d[l_ac].sfanwf001
         WHEN '3'
            SELECT COUNT(1) INTO l_n FROM bmad_t
             WHERE bmadent = g_enterprise AND bmadsite = g_site 
               AND bmad001 = g_sfakwf_d[g_detail_idx].sfakwf001 AND bmad002 = g_sfakwf_d[g_detail_idx].sfakwf002 AND bmad003 = g_sfakwf5_d[l_ac].sfanwf001
         WHEN '5'
            SELECT COUNT(1) INTO l_n FROM bmac_t
             WHERE bmacent = g_enterprise AND bmacsite = g_site 
               AND bmac001 = g_sfakwf_d[g_detail_idx].sfakwf001 AND bmac002 = g_sfakwf_d[g_detail_idx].sfakwf002 AND bmac003 = g_sfakwf5_d[l_ac].sfanwf001
      END CASE
      IF l_n = 0 THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.code = 'asf-00050'
         LET g_errparam.extend = g_sfakwf5_d[l_ac].sfanwf001
         LET g_errparam.popup = TRUE
         CALL cl_err()
         IF l_flag = '1' THEN
            RETURN r_success,r_imaa005
         END IF
      END IF
   END IF
   
   INITIALIZE g_chkparam.* TO NULL
   LET g_chkparam.arg1 = g_sfakwf5_d[l_ac].sfanwf001
   IF NOT cl_chk_exist("v_imaa001") THEN
      RETURN r_success,r_imaa005
   END IF
   IF NOT cl_chk_exist("v_imaf001_1") THEN
      RETURN r_success,r_imaa005
   END IF
   #170618-00477#4-s-add
   #??????
   LET l_imaf016 = ''
   SELECT imaf016 INTO l_imaf016
     FROM imaf_t 
    WHERE imafent = g_enterprise
      AND imafsite = g_site
      AND imaf001 = g_sfakwf5_d[l_ac].sfanwf001
   #?????????????
   INITIALIZE g_chkparam.* TO NULL
   LET g_chkparam.err_str[1] = "abm-00250|",l_imaf016,"|",g_sfakwf5_d[l_ac].sfanwf001
   LET g_chkparam.arg1 = l_imaf016
   IF NOT cl_chk_exist("v_oocq002_210_1") THEN
      RETURN r_success,r_imaa005
   END IF 
   #170618-00477#4-e-add
   #170618-00283#1 add-S ???????????????
   SELECT imaa004 INTO l_imaa004 FROM imaa_t WHERE imaa001 = g_sfakwf5_d[l_ac].sfanwf001 AND imaaent = g_enterprise
   IF l_imaa004 = 'X' OR l_imaa004 = 'F' THEN
      INITIALIZE g_errparam TO NULL
      LET g_errparam.code = 'ain-00909'   #???????'X???'/'F????'?
      LET g_errparam.extend = g_sfakwf5_d[l_ac].sfanwf001
      LET g_errparam.popup = TRUE
      CALL cl_err()
      LET g_sfakwf5_d[l_ac].sfanwf001 = g_sfakwf5_d_t.sfanwf001
      RETURN r_success,r_imaa005
   END IF
   #170618-00283#1 add-E
   
   LET r_success = TRUE
   RETURN r_success,r_imaa005
END FUNCTION

################################################################################
# Descriptions...: ????
# Memo...........:
# Usage..........: CALL s_aooi150_ins (????)
#                  RETURNING ????
# Input parameter: ??????1   ????????1
#                : ??????2   ????????2
# Return code....: ??????1   ????????1
#                : ??????2   ????????2
# Date & Author..: ?? By ??
# Modify.........:
################################################################################
PRIVATE FUNCTION bsft001_wf_show_sfanwf_desc(p_ac)
DEFINE p_ac        LIKE type_t.num5
DEFINE l_success   LIKE type_t.num5

  SELECT imaal003,imaal004 INTO g_sfakwf5_d[p_ac].sfanwf001_desc,g_sfakwf5_d[p_ac].sfanwf001_desc_1 FROM imaal_t
   WHERE imaalent = g_enterprise AND imaal001 = g_sfakwf5_d[p_ac].sfanwf001 AND imaal002 = g_lang

  SELECT oocal003 INTO g_sfakwf5_d[p_ac].sfanwf004_desc FROM oocal_t
   WHERE oocalent=g_enterprise AND oocal001=g_sfakwf5_d[p_ac].sfanwf004 AND oocal002=g_lang

  CALL s_feature_description(g_sfakwf5_d[p_ac].sfanwf001,g_sfakwf5_d[p_ac].sfanwf006)
     RETURNING l_success,g_sfakwf5_d[p_ac].sfanwf006_desc
  IF NOT l_success THEN
     LET g_sfakwf5_d[p_ac].sfanwf006_desc = ''
  END IF

  DISPLAY BY NAME g_sfakwf5_d[p_ac].sfanwf001_desc,g_sfakwf5_d[p_ac].sfanwf001_desc_1,g_sfakwf5_d[p_ac].sfanwf004_desc

END FUNCTION

################################################################################
# Descriptions...: ????
# Memo...........:
# Usage..........: CALL asft300_ins_sfac()
#                  RETURNING ????
# Input parameter: ??????1   ????????1
#                : ??????2   ????????2
# Return code....: ??????1   ????????1
#                : ??????2   ????????2
# Date & Author..: ?? By ??
# Modify.........:
################################################################################
PRIVATE FUNCTION bsft001_wf_ins_sfanwf()
DEFINE l_sql1            STRING
DEFINE l_sql2            STRING
DEFINE l_sql3            STRING
DEFINE l_n               LIKE type_t.num5
DEFINE l_j               LIKE type_t.num5
DEFINE l_sfanwf001       LIKE sfanwf_t.sfanwf001
DEFINE l_sfanwf003       LIKE sfanwf_t.sfanwf003
DEFINE l_sfanwf004       LIKE sfanwf_t.sfanwf004
DEFINE l_sfakwf043       DATETIME YEAR TO SECOND          #161219-00007#1 add
DEFINE l_sfakwf043_1     LIKE type_t.chr20    #BOM???? #161219-00007#1 add
DEFINE l_sfanwf003_2     LIKE sfanwf_t.sfanwf003                 #170618-00170#1 add
DEFINE l_success         LIKE type_t.num5                      #170618-00170#1 add
DEFINE l_sfanwf007       LIKE sfanwf_t.sfanwf007
DEFINE l_ac1             LIKE type_t.num10 

     #161219-00007#1 ---add (s)---
     #?p_date?null??bom?????????
      IF cl_null(g_sfakwf_d[g_detail_idx].sfakwf043) THEN
         LET l_sfakwf043 = cl_get_current()
         LET l_sfakwf043_1 = l_sfakwf043
      ELSE
         LET l_sfakwf043 = g_sfakwf_d[g_detail_idx].sfakwf043
         LET l_sfakwf043_1 = l_sfakwf043
      END IF
     #161219-00007#1 ---add (e)---

      LET l_sql1 = "SELECT UNIQUE '','2',bmab003,'','',' ','',bmab004*",g_sfakwf_d[g_detail_idx].sfakwf006/100,",'','',0 FROM bmab_t WHERE bmabent = '",g_enterprise,"'",
                   "   AND bmabsite = '",g_site,"' AND bmab001 = '",g_sfakwf_d[g_detail_idx].sfakwf001,"' AND bmab002 = '",g_sfakwf_d[g_detail_idx].sfakwf002,"'"
                   #180731-00017#9 Mark By 06137  180809(S)
                   #,"   AND to_char(bmab005,'YYYY-MM-DD hh24:mi:ss')<= '",l_sfakwf043_1,"'",                    #161219-00007#1 add
                   #"   AND (bmab006 IS NULL OR to_char(bmab006,'YYYY-MM-DD hh24:mi:ss')> '",l_sfakwf043_1,"') " #161219-00007#1 add
                   #180731-00017#9 Mark By 06137  180809(E)
                   #180731-00017#9 Add By 06137  180809(S)
                   ,"   AND bmab005<= ? ",                    
                   "   AND (bmab006 IS NULL OR bmab006> ? ) "
                   #180731-00017#9 Add By 06137  180809(E)                   
      LET l_sql2 = "SELECT UNIQUE '','3',bmad003,'','',' ','',bmad004*",g_sfakwf_d[g_detail_idx].sfakwf006,",bmad005,'',0 FROM bmad_t WHERE bmadent='",g_enterprise,"'",
                   "   AND bmadsite='",g_site,"' AND bmad001='",g_sfakwf_d[g_detail_idx].sfakwf001,"' AND bmad002 = '",g_sfakwf_d[g_detail_idx].sfakwf002,"'"
                   #180731-00017#9 Mark By 06137  180809(S)
                   #,"   AND to_char(bmad006,'YYYY-MM-DD hh24:mi:ss')<= '",l_sfakwf043_1,"' ",                   #161219-00007#1 add
                   #"   AND (bmad007 IS NULL OR to_char(bmad007,'YYYY-MM-DD hh24:mi:ss')> '",l_sfakwf043_1,"') " #161219-00007#1 add
                   #180731-00017#9 Mark By 06137  180809(E)
                   #180731-00017#9 Add By 06137  180809(S)
                   ,"   AND bmad006 <= ? ",   
                   "   AND (bmad007 IS NULL OR bmad007 > ? ) " 
                   #180731-00017#9 Add By 06137  180809(E)                   
      LET l_sql3 = "SELECT UNIQUE '','5',bmac003,'','',' ','',bmac005/bmac006*",g_sfakwf_d[g_detail_idx].sfakwf006,",bmac004,'',0 FROM bmac_t WHERE bmacent='",g_enterprise,"'",
                   "   AND bmacsite='",g_site,"' AND bmac001='",g_sfakwf_d[g_detail_idx].sfakwf001,"' AND bmac002 = '",g_sfakwf_d[g_detail_idx].sfakwf002,"'" 
                   #180731-00017#9 Mark By 06137  180809(S)
                   #,"   AND to_char(bmac007,'YYYY-MM-DD hh24:mi:ss')<= '",l_sfakwf043_1,"' ",                   #161219-00007#1 add
                   #"   AND (bmac008 IS NULL OR to_char(bmac008,'YYYY-MM-DD hh24:mi:ss')> '",l_sfakwf043_1,"') " #161219-00007#1 add
                   #180731-00017#9 Mark By 06137  180809(E)
                   #180731-00017#9 Add By 06137  180809(S)
                   ,"   AND bmac007 <= ? ",                   
                   "   AND (bmac008 IS NULL OR bmac008 > ? ) " 
                   #180731-00017#9 Add By 06137  180809(E)                   
   IF g_sfajwf_m.sfajwf003 = '2' THEN  #180612-00043#1
      LET g_sql = l_sql1," UNION ",l_sql2
   ELSE
      LET g_sql = l_sql1," UNION ",l_sql2," UNION ",l_sql3
   END IF  #180612-00043#1
      PREPARE asft300_sfanwf_pb1 FROM g_sql
      DECLARE b_fill_sfanwf_cs1 CURSOR FOR asft300_sfanwf_pb1
      LET l_ac1 = 1
      CALL g_sfakwf5_d.clear()
      SELECT COUNT(1) INTO l_n FROM bmad_t WHERE bmadent=g_enterprise AND bmadsite=g_site AND bmad001=g_sfakwf_d[g_detail_idx].sfakwf001 AND bmad002=g_sfakwf_d[g_detail_idx].sfakwf002
    # IF l_n = 0 THEN 
    # IF l_n = 0 OR g_sfajwf_m.sfajwf003 = '3' THEN    #???????????????????????????????
      IF l_n = 0 THEN       #????????????????
         SELECT MAX(sfanwfseq)+1 INTO g_sfakwf5_d[l_ac1].sfanwfseq FROM sfanwf_t WHERE sfanwfent = g_enterprise AND sfanwfsite = g_site AND sfanwfdocno= g_sfajwf_m.sfajwfdocno AND sfanwfseq1 = g_sfakwf_d[g_detail_idx].sfakwfseq
         IF cl_null(g_sfakwf5_d[l_ac1].sfanwfseq) THEN
            LET g_sfakwf5_d[l_ac1].sfanwfseq = 1
         END IF 
         LET g_sfakwf5_d[l_ac1].sfanwf002 = '1' 
         LET g_sfakwf5_d[l_ac1].sfanwf001 = g_sfakwf_d[g_detail_idx].sfakwf001         
         LET g_sfakwf5_d[l_ac1].sfanwf003 = g_sfakwf_d[g_detail_idx].sfakwf006         
         LET g_sfakwf5_d[l_ac1].sfanwf004 = g_sfakwf_d[g_detail_idx].sfakwf007
         LET g_sfakwf5_d[l_ac1].sfanwf005 = 0
         LET g_sfakwf5_d[l_ac1].sfanwf006 = ' '  
         LET l_sfanwf007 = 'N'   
         LET g_sfakwf5_d[l_ac1].l_sfanwfseq1 = g_sfakwf_d[g_detail_idx].sfakwfseq      
         
         #160512-00016#14 20160526 modify by ming -----(S) 
         INSERT INTO sfanwf_t(sfanwfent,sfanwfsite,sfanwfdocno,sfanwfseq,sfanwfseq1,sfanwf001,sfanwf002,sfanwf003,sfanwf004,sfanwf005,sfanwf006,
                            sfanwf007)
                     VALUES(g_enterprise,g_site,g_sfajwf_m.sfajwfdocno,g_sfakwf5_d[l_ac1].sfanwfseq,g_sfakwf5_d[l_ac1].l_sfanwfseq1,g_sfakwf5_d[l_ac1].sfanwf001,
                            g_sfakwf5_d[l_ac1].sfanwf002,g_sfakwf5_d[l_ac1].sfanwf003,g_sfakwf5_d[l_ac1].sfanwf004,g_sfakwf5_d[l_ac1].sfanwf005,g_sfakwf5_d[l_ac1].sfanwf006,
                            l_sfanwf007)
         #160512-00016#14 20160526 modify by ming -----(E) 
         LET l_ac1 = l_ac1 + 1

         #???????
         IF g_inam.getLength() > 0 AND g_inam004_sum > 0 THEN
            #170309-00002#1--add--start--
            LET g_sfakwf5_d[1].sfanwf003=g_inam[1].inam004
            LET g_sfakwf5_d[1].sfanwf006=g_inam[1].inam002
            #170309-00002#1--add--end----
            UPDATE sfanwf_t SET sfanwf003 = g_inam[1].inam004,sfanwf006 = g_inam[1].inam002 
             WHERE sfanwfent = g_enterprise AND sfanwfsite = g_site AND sfanwfdocno= g_sfajwf_m.sfajwfdocno AND sfanwf002 = '1'
            FOR l_j = 2 TO g_inam.getLength()
               IF cl_null(g_inam[l_j].inam001) THEN
                  EXIT FOR
               END IF
               SELECT MAX(sfanwfseq)+1 INTO g_sfakwf5_d[l_ac1].sfanwfseq FROM sfanwf_t WHERE sfanwfent = g_enterprise AND sfanwfsite = g_site AND sfanwfdocno= g_sfajwf_m.sfajwfdocno AND sfanwfseq1 = g_sfakwf_d[g_detail_idx].sfakwfseq
               IF cl_null(g_sfakwf5_d[l_ac1].sfanwfseq) THEN
                  LET g_sfakwf5_d[l_ac1].sfanwfseq = 1
               END IF 
              #LET g_sfakwf5_d[l_ac1].sfanwf002 = '1'  #220628-00044#1 mark
               LET g_sfakwf5_d[l_ac1].sfanwf002 = '2'  #220628-00044#1
               LET g_sfakwf5_d[l_ac1].sfanwf001 = g_sfakwf_d[g_detail_idx].sfakwf001
               LET g_sfakwf5_d[l_ac1].sfanwf004 = g_sfakwf_d[g_detail_idx].sfakwf007
               LET g_sfakwf5_d[l_ac1].sfanwf005 = 0
               LET g_sfakwf5_d[l_ac1].sfanwf003 = g_inam[l_j].inam004
               LET g_sfakwf5_d[l_ac1].sfanwf006 = g_inam[l_j].inam002
               LET g_sfakwf5_d[l_ac1].l_sfanwfseq1 = g_sfakwf_d[g_detail_idx].sfakwfseq
               #191108-00005#1 add(s)
               LET l_n = 0 
               SELECT COUNT(1) INTO l_n FROM sfanwf_t
                WHERE sfanwfent = g_enterprise
                  AND sfanwfdocno = g_sfajwf_m.sfajwfdocno AND sfanwfseq1 = g_sfakwf_d[g_detail_idx].sfakwfseq
                  AND sfanwf001 = g_sfakwf_d[g_detail_idx].sfakwf001
                  AND sfanwf002 = g_sfakwf5_d[l_ac1].sfanwf002
                  AND sfanwf004 = g_sfakwf_d[g_detail_idx].sfakwf007
                  AND sfanwf006 = g_sfakwf5_d[l_ac1].sfanwf006
               IF l_n = 0 THEN
               #191108-00005#1 add(e)               
                  #160512-00016#14 20160526 modify by ming -----(S) 
                  INSERT INTO sfanwf_t(sfanwfent,sfanwfsite,sfanwfdocno,sfanwfseq,sfanwfseq1,sfanwf001,sfanwf002,sfanwf003,sfanwf004,sfanwf005,sfanwf006,
                                     sfanwf007)
                              VALUES(g_enterprise,g_site,g_sfajwf_m.sfajwfdocno,g_sfakwf5_d[l_ac1].sfanwfseq,g_sfakwf5_d[l_ac1].l_sfanwfseq1,g_sfakwf5_d[l_ac1].sfanwf001,
                                     g_sfakwf5_d[l_ac1].sfanwf002,g_sfakwf5_d[l_ac1].sfanwf003,g_sfakwf5_d[l_ac1].sfanwf004,g_sfakwf5_d[l_ac1].sfanwf005,g_sfakwf5_d[l_ac1].sfanwf006, 
                                     l_sfanwf007)
                  #160512-00016#14 20160526 modify by ming -----(E)
               #191108-00005#1 add(s)
               ELSE
                   UPDATE sfanwf_t SET sfanwf003 = sfanwf003 + g_sfakwf5_d[l_ac1].sfanwf003
                               WHERE sfanwfent = g_enterprise
                                 AND sfanwfdocno = g_sfajwf_m.sfajwfdocno
                                 AND sfanwf001 = g_sfakwf_d[g_detail_idx].sfakwf001
                                 AND sfanwf002 = g_sfakwf5_d[l_ac1].sfanwf002
                                 AND sfanwf004 = g_sfakwf_d[g_detail_idx].sfakwf007
                                 AND sfanwf006 = g_sfakwf5_d[l_ac1].sfanwf006
                   IF SQLCA.sqlcode THEN
                      INITIALIZE g_errparam TO NULL
                      LET g_errparam.code = SQLCA.sqlcode
                      LET g_errparam.extend = 'update sfanwf_t'
                      LET g_errparam.popup = TRUE
                      CALL cl_err()
                   END IF                  
               END IF
               #191108-00005#1 add(e)               
               LET l_ac1 = l_ac1 + 1               
            END FOR
         END IF

      END IF      
      
     #IF g_sfajwf_m.sfajwf003 != '3' THEN   #???????????????????????????????
      #FOREACH b_fill_sfanwf_cs1 INTO g_sfakwf5_d[l_ac1].*   #170808-00060#1 mark
      #180731-00017#9 Add By 06137  180809(S)
      IF g_sfajwf_m.sfajwf003 = '2' THEN
         OPEN b_fill_sfanwf_cs1 USING l_sfakwf043,l_sfakwf043,l_sfakwf043,l_sfakwf043
      ELSE
         OPEN b_fill_sfanwf_cs1 USING l_sfakwf043,l_sfakwf043,l_sfakwf043,l_sfakwf043,l_sfakwf043,l_sfakwf043
      END IF  
      #180731-00017#9 Add By 06137  180809(E)        
      #170808-00060#1-s add
      FOREACH b_fill_sfanwf_cs1 INTO g_sfakwf5_d[l_ac1].sfanwfseq,g_sfakwf5_d[l_ac1].sfanwf002,g_sfakwf5_d[l_ac1].sfanwf001,g_sfakwf5_d[l_ac1].sfanwf001_desc,g_sfakwf5_d[l_ac1].sfanwf001_desc_1,
                                   g_sfakwf5_d[l_ac1].sfanwf006,g_sfakwf5_d[l_ac1].sfanwf006_desc,g_sfakwf5_d[l_ac1].sfanwf003,g_sfakwf5_d[l_ac1].sfanwf004,g_sfakwf5_d[l_ac1].sfanwf004_desc,
                                   g_sfakwf5_d[l_ac1].sfanwf005
      #170808-00060#1-e add                                   
         IF SQLCA.sqlcode THEN
            INITIALIZE g_errparam TO NULL
            LET g_errparam.code = SQLCA.sqlcode
            LET g_errparam.extend = "FOREACH:"
            LET g_errparam.popup = TRUE
            CALL cl_err()

            EXIT FOREACH
         END IF
         IF cl_null(g_sfakwf5_d[l_ac1].sfanwf001) THEN
            CONTINUE FOREACH
         END IF
         SELECT MAX(sfanwfseq)+1 INTO g_sfakwf5_d[l_ac1].sfanwfseq FROM sfanwf_t WHERE sfanwfent = g_enterprise AND sfanwfsite = g_site AND sfanwfdocno= g_sfajwf_m.sfajwfdocno
            AND sfanwfseq1 = g_sfakwf_d[g_detail_idx].sfakwfseq
         IF cl_null(g_sfakwf5_d[l_ac1].sfanwfseq) THEN
            LET g_sfakwf5_d[l_ac1].sfanwfseq = 1
         END IF 
         IF cl_null(g_sfakwf5_d[l_ac1].sfanwf004) THEN
            SELECT bmaa004 INTO g_sfakwf5_d[l_ac1].sfanwf004 FROM bmaa_t WHERE bmaaent = g_enterprise AND bmaasite = g_site AND bmaa001 = g_sfakwf_d[g_detail_idx].sfakwf001 AND bmaa002=g_sfakwf_d[g_detail_idx].sfakwf002
            #170814-00030#1 add --(S)--
            #???????????,????????????
            IF g_sfakwf5_d[l_ac1].sfanwf002 = '2' THEN
               LET g_sfakwf5_d[l_ac1].sfanwf004 = g_sfakwf_d[g_detail_idx].sfakwf007
            END IF
            #170814-00030#1 add --(E)--
         END IF 
         LET g_sfakwf5_d[l_ac1].l_sfanwfseq1 = g_sfakwf_d[g_detail_idx].sfakwfseq       
         
         #160512-00016#14 20160526 modify by ming -----(S) 
         INSERT INTO sfanwf_t(sfanwfent,sfanwfsite,sfanwfdocno,sfanwfseq,sfanwfseq1,sfanwf001,sfanwf002,sfanwf003,sfanwf004,sfanwf005,sfanwf006,
                            sfanwf007)
                     VALUES(g_enterprise,g_site,g_sfajwf_m.sfajwfdocno,g_sfakwf5_d[l_ac1].sfanwfseq,g_sfakwf5_d[l_ac1].l_sfanwfseq1,g_sfakwf5_d[l_ac1].sfanwf001,
                            g_sfakwf5_d[l_ac1].sfanwf002,g_sfakwf5_d[l_ac1].sfanwf003,g_sfakwf5_d[l_ac1].sfanwf004,g_sfakwf5_d[l_ac1].sfanwf005,g_sfakwf5_d[l_ac1].sfanwf006,
                            'N')
         #160512-00016#14 20160526 modify by ming -----(E) 
         
         IF g_sfakwf5_d[l_ac1].sfanwf002 = '2' THEN
            #?????
            IF g_inam.getLength() > 0 AND g_inam004_sum > 0 THEN
               LET l_sfanwf001 = g_sfakwf5_d[l_ac1].sfanwf001
               LET l_sfanwf004 = g_sfakwf5_d[l_ac1].sfanwf004
               LET l_sfanwf003 = g_sfakwf5_d[l_ac1].sfanwf003
               LET l_sfanwf003_2 = g_sfakwf5_d[l_ac1].sfanwf003 * g_inam[1].inam004 / g_sfakwf_d[g_detail_idx].sfakwf006   #170618-00170#1 add
               CALL s_aooi250_take_decimals(g_sfakwf5_d[l_ac1].sfanwf004,l_sfanwf003_2) RETURNING l_success,l_sfanwf003_2    #170618-00170#1 add
               #UPDATE sfanwf_t SET sfanwf003 = sfanwf003 * g_inam[1].inam004 / g_sfakwf_d[g_detail_idx].sfakwf006,sfanwf006 = g_inam[1].inam002                   #170618-00170#1 mark
               UPDATE sfanwf_t SET sfanwf003 = l_sfanwf003_2,sfanwf006 = g_inam[1].inam002                                                       #170618-00170#1 add
                WHERE sfanwfent = g_enterprise AND sfanwfsite = g_site AND sfanwfdocno= g_sfajwf_m.sfajwfdocno AND sfanwf002 = '2'
                  AND sfanwfseq = g_sfakwf5_d[l_ac1].sfanwfseq
               UPDATE sfanwf_t SET sfanwf003=sfanwf003 - l_sfanwf003 * g_inam[1].inam004 / g_sfakwf_d[g_detail_idx].sfakwf006 WHERE sfanwfent = g_enterprise
                  AND sfanwfsite = g_site AND sfanwfdocno= g_sfajwf_m.sfajwfdocno AND sfanwf002='1'
                  AND sfanwf006 = g_inam[1].inam002
               FOR l_j = 2 TO g_inam.getLength()
                  IF cl_null(g_inam[l_j].inam001) THEN
                     EXIT FOR
                  END IF
                  LET l_ac1 = l_ac1 + 1
                  SELECT MAX(sfanwfseq)+1 INTO g_sfakwf5_d[l_ac1].sfanwfseq FROM sfanwf_t 
                   WHERE sfanwfent = g_enterprise AND sfanwfsite = g_site AND sfanwfdocno= g_sfajwf_m.sfajwfdocno
                     AND sfanwfseq1 = g_sfakwf_d[g_detail_idx].sfakwfseq
                  
                  LET g_sfakwf5_d[l_ac1].sfanwf002 = '2' 
                  LET g_sfakwf5_d[l_ac1].sfanwf001 = l_sfanwf001
                  LET g_sfakwf5_d[l_ac1].sfanwf004 = l_sfanwf004
                  LET g_sfakwf5_d[l_ac1].sfanwf005 = 0
                  LET g_sfakwf5_d[l_ac1].sfanwf003 = g_inam[l_j].inam004 / g_sfakwf_d[g_detail_idx].sfakwf006 * l_sfanwf003
                  LET g_sfakwf5_d[l_ac1].sfanwf006 = g_inam[l_j].inam002
                  LET g_sfakwf5_d[l_ac1].l_sfanwfseq1 = g_sfakwf_d[g_detail_idx].sfakwfseq
                  
                  #160512-00016#14 20160526 modify by ming -----(S) 
                  INSERT INTO sfanwf_t(sfanwfent,sfanwfsite,sfanwfdocno,sfanwfseq,sfanwfseq1,sfanwf001,sfanwf002,sfanwf003,sfanwf004,sfanwf005,sfanwf006,
                                     sfanwf007)
                              VALUES(g_enterprise,g_site,g_sfajwf_m.sfajwfdocno,g_sfakwf5_d[l_ac1].sfanwfseq,g_sfakwf5_d[l_ac1].l_sfanwfseq1,g_sfakwf5_d[l_ac1].sfanwf001,
                                     g_sfakwf5_d[l_ac1].sfanwf002,g_sfakwf5_d[l_ac1].sfanwf003,g_sfakwf5_d[l_ac1].sfanwf004,g_sfakwf5_d[l_ac1].sfanwf005,g_sfakwf5_d[l_ac1].sfanwf006,
                                     'N')
                  #160512-00016#14 20160526 modify by ming -----(E) 
                  UPDATE sfanwf_t SET sfanwf003=sfanwf003-g_sfakwf5_d[l_ac1].sfanwf003 WHERE sfanwfent = g_enterprise
                     AND sfanwfsite = g_site AND sfanwfdocno= g_sfajwf_m.sfajwfdocno AND sfanwf002='1'
                     AND sfanwf006 = g_inam[l_j].inam002
               END FOR
            ELSE
               UPDATE sfanwf_t SET sfanwf003=sfanwf003-g_sfakwf5_d[l_ac1].sfanwf003 WHERE sfanwfent = g_enterprise
                  AND sfanwfsite = g_site AND sfanwfdocno= g_sfajwf_m.sfajwfdocno AND sfanwf002='1'
            END IF                     
         END IF 
         LET l_ac1 = l_ac1 + 1
         
         IF l_ac1 > g_max_rec THEN
            INITIALIZE g_errparam TO NULL
            LET g_errparam.code =  9035
            LET g_errparam.extend =  ''
            LET g_errparam.popup = FALSE
            CALL cl_err()

            EXIT FOREACH
         END IF
      END FOREACH
     #END IF
     CALL bsft001_wf_b_fill_sfanwf()  #191108-00005#1 add 
END FUNCTION

################################################################################
# Descriptions...: ??????????
# Memo...........:
# Usage..........: CALL asft300_b_fill_sfac()
# Input parameter: 
# Return code....: 
# Date & Author..: ?? By ??
# Modify.........:
################################################################################
PRIVATE FUNCTION bsft001_wf_b_fill_sfanwf()

   CALL g_sfakwf5_d.clear()

   IF g_action_choice <> 'fetch' OR cl_null(g_action_choice) THEN
      LET g_sql = " SELECT UNIQUE sfanwfseq,sfanwfseq1,sfanwf002,sfanwf001,imaal003,imaal004,sfanwf006,inaml004,sfanwf003,sfanwf004,oocal003,sfanwf005 ",
                  "   FROM sfanwf_t ",
                  "   LEFT JOIN imaal_t ON imaalent=sfanwfent AND imaal001=sfanwf001 AND imaal002='"||g_dlang||"' ",
                  "   LEFT JOIN inaml_t ON inamlent=sfanwfent AND inaml001=sfanwf001 AND inaml002=sfanwf006 AND inaml003='"||g_dlang||"' ",
                  "   LEFT JOIN oocal_t ON oocalent=sfanwfent AND oocal001=sfanwf004 AND oocal002='"||g_dlang||"' ",
                  "  WHERE sfanwfent=? AND sfanwfsite=? AND sfanwfdocno=?  AND sfanwfseq1=? "
      IF NOT cl_null(g_wc2_table3) THEN
         LET g_sql = g_sql CLIPPED," AND ",g_wc2_table3 CLIPPED
      END IF

      LET g_sql = g_sql CLIPPED," ORDER BY sfanwf_t.sfanwfseq,sfanwf_t.sfanwf002,sfanwf_t.sfanwf001 " #ODI-ORA#
      PREPARE asft300_sfanwf_pb FROM g_sql
      DECLARE b_fill_sfanwf_cs CURSOR FOR asft300_sfanwf_pb
   END IF
   
   LET g_cnt = l_ac
   LET l_ac = 1
   
   OPEN b_fill_sfanwf_cs USING g_enterprise,g_site,g_sfajwf_m.sfajwfdocno,g_sfakwf_d[g_detail_idx].sfakwfseq
   
   FOREACH b_fill_sfanwf_cs INTO g_sfakwf5_d[l_ac].sfanwfseq,g_sfakwf5_d[l_ac].l_sfanwfseq1,g_sfakwf5_d[l_ac].sfanwf002,g_sfakwf5_d[l_ac].sfanwf001,g_sfakwf5_d[l_ac].sfanwf001_desc,g_sfakwf5_d[l_ac].sfanwf001_desc_1,
                               g_sfakwf5_d[l_ac].sfanwf006,g_sfakwf5_d[l_ac].sfanwf006_desc,g_sfakwf5_d[l_ac].sfanwf003,g_sfakwf5_d[l_ac].sfanwf004,g_sfakwf5_d[l_ac].sfanwf004_desc,
                               g_sfakwf5_d[l_ac].sfanwf005
      IF SQLCA.sqlcode THEN
         INITIALIZE g_errparam TO NULL
         LET g_errparam.extend = "FOREACH:",SQLERRMESSAGE
         LET g_errparam.code   = SQLCA.sqlcode
         LET g_errparam.popup  = TRUE
         CALL cl_err()
         EXIT FOREACH
      END IF
      
      
      ##200323-00022#1 add -s ??????????????
      IF NOT cl_null(g_sfakwf5_d[l_ac].sfanwf006) THEN
       #201014-00057#1 -mark -s
#       SELECT inaml004 INTO g_sfakwf5_d[l_ac].sfanwf006_desc 
#       FROM inaml_t WHERE inamlent = g_enterprise AND inaml002 = g_sfakwf5_d[l_ac].sfanwf006 AND inaml003 = g_lang  
       #201014-00057#1 -mark -e
       #201014-00057#1 -add -s
       SELECT inaml004 INTO g_sfakwf5_d[l_ac].sfanwf006_desc 
       FROM inaml_t WHERE inamlent = g_enterprise AND inaml002 = g_sfakwf5_d[l_ac].sfanwf006 AND inaml003 = g_lang  AND ROWNUM =1  
       #201014-00057#1 -add -e
        
       
       
         
      END IF
      ##200323-00022#1 add -e
      
      
      IF l_ac > g_max_rec THEN
         IF cl_null(g_action_choice) OR g_action_choice <> "ui_change" THEN   #190121-00046#10 add
            IF g_error_show = 1 THEN
               INITIALIZE g_errparam TO NULL
               LET g_errparam.extend = l_ac
               LET g_errparam.code   = 9035
               LET g_errparam.popup  = TRUE
               CALL cl_err()
            END IF
         END IF   #190121-00046#10 add   
         EXIT FOREACH
      END IF
      LET l_ac = l_ac + 1
   END FOREACH

   CALL g_sfakwf5_d.deleteElement(g_sfakwf5_d.getLength())

   LET l_ac = g_cnt
   LET g_cnt = 0

   FREE asft300_sfanwf_pb
END FUNCTION

################################################################################
# Descriptions...: ????????????
# Memo...........:
# Usage..........: CALL s_aooi150_ins (????)
#                  RETURNING ????
# Input parameter: ??????1   ????????1
#                : ??????2   ????????2
# Return code....: ??????1   ????????1
#                : ??????2   ????????2
# Date & Author..: 2024/10/30  By 17539
# Modify.........: #241030-00001#1
################################################################################
PRIVATE FUNCTION bsft001_wf_upd_sfakwf(p_ac,p_ac1)
DEFINE p_ac LIKE type_t.num5
DEFINE p_ac1 LIKE type_t.num5  #241212-00001#1 add
DEFINE l_sql STRING 
DEFINE l_sfbcwf  DYNAMIC ARRAY OF RECORD
   sfbcwfseq1  LIKE sfbcwf_t.sfbcwfseq1,
   sfbcwfseq2  LIKE sfbcwf_t.sfbcwfseq2,
   sfbcwf002   LIKE sfbcwf_t.sfbcwf002,
   sfbcwf003   LIKE sfbcwf_t.sfbcwf003,
   sfbcwf004   LIKE sfbcwf_t.sfbcwf004,  
   sfbcwf006   LIKE sfbcwf_t.sfbcwf006,  
   sfbcwf014   LIKE sfbcwf_t.sfbcwf014,  
   sfbcwf023   LIKE sfbcwf_t.sfbcwf023,
   sfbcwf049   LIKE sfbcwf_t.sfbcwf049,
   sfbcwf010   LIKE sfbcwf_t.sfbcwf010,
   sfbcwf011   LIKE sfbcwf_t.sfbcwf011
END RECORD
DEFINE l_index,l_cnt LIKE type_t.num5
DEFINE l_sfakwf002 LIKE sfakwf_t.sfakwf002
DEFINE l_bmba012 LIKE bmba_t.bmba012
DEFINE l_bmba011 LIKE bmba_t.bmba011
DEFINE l_success,l_successret LIKE type_t.num5
DEFINE l_sfbcwf006 LIKE sfbcwf_t.sfbcwf006
DEFINE l_sfakwf006 LIKE sfakwf_t.sfakwf006
DEFINE l_sfakwf009 LIKE sfakwf_t.sfakwf009
DEFINE l_sfakwf010 LIKE sfakwf_t.sfakwf010
DEFINE l_imaa006 LIKE imaa_t.imaa006
DEFINE l_imaf053 LIKE imaf_t.imaf053
DEFINE l_amount_die LIKE icbawf_t.icbawf011
DEFINE l_amount LIKE icbawf_t.icbawf022
DEFINE l_sfakwf034 LIKE sfakwf_t.sfakwf034
DEFINE l_sfbcwf002 LIKE sfbcwf_t.sfbcwf002
DEFINE l_sfbcwf003 LIKE sfbcwf_t.sfbcwf003
DEFINE l_sfbcwf004 LIKE sfbcwf_t.sfbcwf004
DEFINE l_sfakwf010_t LIKE sfakwf_t.sfakwf010 #250220-00015#1 add
   LET l_successret = TRUE
   LET l_sfbcwf006 = ''
   LET l_sql = " SELECT sfbcwfseq1,sfbcwfseq2,sfbcwf002,sfbcwf003,sfbcwf004,sfbcwf006,sfbcwf014,sfbcwf023,sfbcwf049, ",
               " sfbcwf010,sfbcwf011 ",
               " FROM sfbcwf_t ",
               " WHERE sfbcwfent = ? AND sfbcwfsite = ? AND sfbcwfdocno = ? AND sfbcwfseq = ? AND sfbcwf043 = 'Y' "  #241104-00004#1 add AND sfbcwf043 = 'Y'
   PREPARE bsft001_wf_upd_sfakwf01 FROM l_sql
   DECLARE bsft001_wf_upd_sfakwf_cs01 CURSOR FOR bsft001_wf_upd_sfakwf01
   LET l_index = 1
   
   FOREACH bsft001_wf_upd_sfakwf_cs01 USING g_enterprise,g_site,g_sfajwf_m.sfajwfdocno,g_sfakwf_d[p_ac].sfakwfseq INTO l_sfbcwf[l_index].*
      
      IF cl_null(g_sfakwf_d[p_ac].sfakwf002) THEN
         LET l_sfakwf002 = ' '
      ELSE
         LET l_sfakwf002 = g_sfakwf_d[p_ac].sfakwf002
      END IF      
      LET l_cnt = 0 
      SELECT COUNT(1) INTO l_cnt FROM bmba_t 
       WHERE bmbaent = g_enterprise AND bmbasite = g_site AND bmba001 = g_sfakwf_d[p_ac].sfakwf001 AND bmba003 = l_sfbcwf[l_index].sfbcwf006
         AND bmba002 = l_sfakwf002  AND bmba004 = l_sfbcwf[l_index].sfbcwf002 AND bmbawf039 = 'Y'
         AND bmba007 =l_sfbcwf[l_index].sfbcwf003 AND bmba008 = l_sfbcwf[l_index].sfbcwf004
      IF cl_null(l_cnt) THEN LET l_cnt = 0 END IF  
         
      IF l_cnt > 0 THEN  #?????????BOM???????????,???????????
         SELECT bmba012,bmba011 INTO l_bmba012,l_bmba011 FROM bmba_t
          WHERE bmbaent = g_enterprise AND bmbasite = g_site AND bmba001 = g_sfakwf_d[g_detail_idx].sfakwf001  AND bmba002 = l_sfakwf002
            AND bmba003 = l_sfbcwf[l_index].sfbcwf006 AND bmba004 = l_sfbcwf[l_index].sfbcwf002
            AND bmba007 = l_sfbcwf[l_index].sfbcwf003 AND bmba008 = l_sfbcwf[l_index].sfbcwf004
         LET l_sfbcwf[l_index].sfbcwf049 = l_sfbcwf[l_index].sfbcwf023 * l_bmba012 / l_bmba011  
         LET l_sfbcwf006 = l_sfbcwf[l_index].sfbcwf006          
      ELSE
         LET l_sfbcwf[l_index].sfbcwf049 = l_sfbcwf[l_index].sfbcwf023
      END IF              

      #??QPA????
      CALL bsft001_wf_sfbcwf023_qpa_02(l_sfbcwf[l_index].sfbcwf023,l_sfbcwf[l_index].sfbcwf049) RETURNING l_sfbcwf[l_index].sfbcwf010,l_sfbcwf[l_index].sfbcwf011
      #241016-00014#1 add--s
      CALL s_aooi250_convert_qty(l_sfbcwf[l_index].sfbcwf006,l_sfbcwf[l_index].sfbcwf014,g_sfakwf_d[p_ac].sfakwf007,l_sfbcwf[l_index].sfbcwf049) 
           RETURNING l_success,g_sfakwf2_d[l_ac].sfbcwf049
      #241016-00014#1 add--e
      UPDATE sfbcwf_t SET sfbcwf010 = l_sfbcwf[l_index].sfbcwf010, 
                          sfbcwf011 = l_sfbcwf[l_index].sfbcwf011,
                          sfbcwf049 = l_sfbcwf[l_index].sfbcwf049                                
       WHERE sfbcwfent = g_enterprise AND sfbcwfsite = g_site AND sfbcwfdocno = g_sfajwf_m.sfajwfdocno AND sfbcwfseq = g_sfakwf_d[p_ac].sfakwfseq 
         AND sfbcwfseq1 = l_sfbcwf[l_index].sfbcwfseq1 AND sfbcwfseq2 = l_sfbcwf[l_index].sfbcwfseq2
      CASE
         WHEN SQLCA.sqlerrd[3] = 0  #???????
         WHEN SQLCA.SQLCODE #????
            LET l_successret = FALSE
            INITIALIZE g_errparam TO NULL 
            LET g_errparam.extend = "upd sfbcwf_t:",SQLERRMESSAGE 
            LET g_errparam.code = SQLCA.SQLCODE 
            LET g_errparam.popup = TRUE 
            #CALL s_transaction_end('N','0')
            CALL cl_err()
      END CASE 

      LET l_index = l_index + 1
   END FOREACH

   LET l_sfakwf006 = 0
   IF g_sfajwf_m.sfajwf003 <> '2' THEN
      SELECT SUM(sfbcwf049) INTO l_sfakwf006 FROM sfbcwf_t 
       WHERE sfbcwfent = g_enterprise AND sfbcwfsite = g_site AND sfbcwfdocno = g_sfajwf_m.sfajwfdocno AND sfbcwfseq = g_sfakwf_d[p_ac].sfakwfseq
         AND sfbcwf043 = 'Y'  
   ELSE
      SELECT SUM(sfbcwf049) INTO l_sfakwf006 FROM sfbcwf_t 
       WHERE sfbcwfent = g_enterprise AND sfbcwfsite = g_site AND sfbcwfdocno = g_sfajwf_m.sfajwfdocno AND sfbcwfseq = g_sfakwf_d[p_ac].sfakwfseq
   END IF
   IF cl_null(l_sfakwf006) THEN LET l_sfakwf006 = 0 END IF

   #??aimm215??????????????
   CALL s_asft300_02_get_sfaa012(g_sfakwf_d[p_ac].sfakwf001,l_sfakwf006,g_sfakwf_d[p_ac].sfakwf007,'N','N') 
            RETURNING l_sfakwf006,l_success     
   #????U1?????DATECODE??,U1????????????U1????
   SELECT sfbcwf029,sfbcwf040 INTO l_sfakwf009,l_sfakwf010 FROM sfbcwf_t 
    WHERE sfbcwfent = g_enterprise AND sfbcwfsite = g_site AND sfbcwfdocno = g_sfajwf_m.sfajwfdocno 
      AND sfbcwfseq = g_sfakwf_d[p_ac].sfakwfseq AND sfbcwf043 = 'Y' 
      AND ROWNUM = 1  
   #250220-00015#1 add ---s
   LET l_sfakwf010_t = ''
   SELECT sfakwf010 INTO l_sfakwf010_t FROM sfakwf_t 
    WHERE sfakwfent = g_enterprise AND sfakwfsite = g_site AND sfakwfdocno = g_sfajwf_m.sfajwfdocno 
      AND sfakwfseq = g_sfakwf_d[p_ac].sfakwfseq 
   IF NOT cl_null(l_sfakwf010_t) THEN
      LET l_sfakwf010 = l_sfakwf010_t   
   END IF   
   #250220-00015#1 add ---e
   #?????? 
   
   #250220-00015# add ---s
   LET l_sfbcwf002 = ''
   LET l_sfbcwf003 = ''
   LET l_sfbcwf004 = ''
   LET l_sfbcwf006 = ''
   LET l_bmba012 = 0
   LET l_bmba011 = 0
   SELECT DISTINCT sfbcwf002,sfbcwf003,sfbcwf004,sfbcwf006 INTO l_sfbcwf002,l_sfbcwf003,l_sfbcwf004,l_sfbcwf006
    FROM sfbcwf_t 
    WHERE sfbcwfent = g_enterprise AND sfbcwfsite = g_site AND sfbcwfdocno = g_sfajwf_m.sfajwfdocno 
    AND sfbcwfseq = g_sfakwf_d[p_ac].sfakwfseq AND sfbcwf043 = 'Y'   
   SELECT imaa006,imaf053 INTO l_imaa006,l_imaf053 FROM imaf_t 
     LEFT OUTER JOIN imaa_t ON imaaent = g_enterprise AND imaa001 = imaf001
    WHERE imafent = g_enterprise AND imafsite = g_site
      AND imaf001 = l_sfbcwf006

   SELECT NVL(SUM(icbawf011),0),NVL(SUM(icbawf022),0) INTO l_amount_die,l_amount FROM icbawf_t
    LEFT JOIN sfbcwf_t ON sfbcwfent = icbawfent AND sfbcwfsite =icbawfsite AND sfbcwfdocno = icbawfdocno 
                    AND sfbcwfseq = icbawf032 AND sfbcwfseq1 = icbawfseq AND sfbcwfseq2 = icbawfseq1
    WHERE icbawfent = g_enterprise AND icbawfsite = g_site
      AND icbawfdocno = g_sfajwf_m.sfajwfdocno 
      AND icbawf032 = g_sfakwf_d[p_ac].sfakwfseq  #????
      AND sfbcwf043 = 'Y'  
   SELECT bmba012,bmba011 INTO l_bmba012,l_bmba011 FROM bmba_t
    WHERE bmbaent = g_enterprise AND bmbasite = g_site AND bmba001 = g_sfakwf_d[p_ac].sfakwf001  AND bmba002 = l_sfakwf002
      AND bmba003 = l_sfbcwf006 AND bmba004 = l_sfbcwf002
      AND bmba007 = l_sfbcwf003 AND bmba008 = l_sfbcwf004
   IF g_sfajwf_m.sfajwf003 = '2' THEN
      LET l_bmba012 = 1 
      LET l_bmba011 = 1
   ELSE
          #241202-add -s ????
#         IF g_sfajwf_m.sfajwf003 = '1' THEN
#            LET l_sql =" SELECT bmba011,bmba012 ",
#                       "  FROM (WITH bom_tree(bmba001, bmba003, bmba011,bmba012, le) AS ",
#                       "        (SELECT b.bmba001, b.bmba003, bmba011,bmba012,1 le ",
#                       "         FROM bmba_t b WHERE b.bmba001 = '",g_sfakwf_d[g_detail_idx_list[1]].sfakwf001,"'  AND b.bmbaent = ",g_enterprise," AND b.bmbasite = '",g_site,"'",
#                        "           AND (bmba006 > to_date('",g_sfajwf_m.sfajwfdocdt,"','yyyy/mm/dd HH24:MI:SS') OR bmba006 IS NULL) ",
#                       "            AND (bmba005 < to_date('",g_sfajwf_m.sfajwfdocdt,"','yyyy/mm/dd HH24:MI:SS') )",
#                       "         UNION ALL ",
#                       "         SELECT t.bmba001, b.bmba003,b.bmba011,b.bmba012*t.bmba012,  t.le + 1 ",
#                       "         FROM bom_tree t ",
#                       "                  LEFT JOIN bmba_t b ON t.bmba003 = b.bmba001  AND b.bmbaent = ",g_enterprise," AND b.bmbasite = '",g_site,"'",
#                       "         WHERE b.bmba001 is NOT NULL ",
#                       "           AND (bmba006 > to_date('",g_sfajwf_m.sfajwfdocdt,"','yyyy/mm/dd HH24:MI:SS') OR bmba006 IS NULL) ",
#                       "           AND (bmba005 < to_date('",g_sfajwf_m.sfajwfdocdt,"','yyyy/mm/dd HH24:MI:SS') )",
#                       "        ) ",
#                       " SELECT bmba001, bmba003,  bmba011,bmba012, le ",
#                       " FROM bom_tree) WHERE bmba001 = '",g_sfakwf_d[g_detail_idx_list[1]].sfakwf001,"' AND bmba003 = '",l_sfbcwf[l_index].sfbcwf006,"'"
#            PREPARE bsft001_QPA FROM  l_sql
#            EXECUTE bsft001_QPA INTO l_bmba011,l_bmba012 
#            LET l_sfbcwf[l_index].sfbcwf010 = l_bmba011  
#            LET l_sfbcwf[l_index].sfbcwf011 = l_bmba012 
#            LET l_sfbcwf[l_index].sfbcwf049 = l_sfbcwf[l_index] * l_bmba012 / l_bmba011                      
#         END IF
         #241202-add -e
   END IF
   LET l_cnt = 0
   SELECT COUNT(*) INTO l_cnt FROM icbawf_t
    LEFT JOIN sfbcwf_t ON sfbcwfent = icbawfent AND sfbcwfsite =icbawfsite AND sfbcwfdocno = icbawfdocno 
                    AND sfbcwfseq = icbawf032 AND sfbcwfseq1 = icbawfseq AND sfbcwfseq2 = icbawfseq1
    WHERE icbawfent = g_enterprise AND icbawfsite = g_site
      AND icbawfdocno = g_sfajwf_m.sfajwfdocno 
      AND icbawf032 = g_sfakwf_d[p_ac].sfakwfseq  #????
      AND sfbcwf043 = 'Y'  
   IF cl_null(l_cnt) THEN
      LET l_cnt = 0
   END IF   
   IF l_cnt > 0 THEN      
      IF s_aint302_wf_oocawf008(l_sfbcwf006) THEN
         IF g_sfakwf_d[p_ac].sfakwf035 = l_imaf053 THEN   
            LET l_sfakwf034 = l_amount_die * l_bmba012 / l_bmba011 
         ELSE
            LET l_sfakwf034 = l_amount * l_bmba012 / l_bmba011                 
         END IF                               
      ELSE
         IF g_sfakwf_d[p_ac].sfakwf035 = l_imaf053 THEN   
            LET l_sfakwf034 =  l_amount * l_bmba012 / l_bmba011  
         ELSE
            LET l_sfakwf034 =  l_amount_die * l_bmba012 / l_bmba011                
         END IF  
      END IF   
   ELSE
      IF g_sfakwf_d[p_ac].sfakwf035 = g_sfakwf_d[p_ac].sfakwf007 THEN
         LET l_sfakwf034 = l_sfakwf006
      ELSE
         CALL s_aooi250_convert_qty(l_sfbcwf006,g_sfakwf_d[p_ac].sfakwf007,g_sfakwf_d[p_ac].sfakwf035,l_sfakwf006) 
            RETURNING l_success,l_sfakwf034 #????         
      END IF
      
   END IF   
   #250220-00015# add ---e

              
#   IF s_aint302_wf_oocawf008(l_sfbcwf006) THEN
#      IF g_sfakwf_d[p_ac].sfakwf035 = l_imaf053 THEN   
#         LET l_sfakwf034 = l_amount_die
#      ELSE
#         LET l_sfakwf034 = l_amount                
#      END IF                               
#   ELSE
#      IF g_sfakwf_d[p_ac].sfakwf035 = l_imaf053 THEN   
#         LET l_sfakwf034 =  l_amount  
#      ELSE
#         LET l_sfakwf034 =  l_amount_die                
#      END IF  
#   END IF     

   UPDATE sfakwf_t SET sfakwf006 = l_sfakwf006, #????
                       sfakwf034 = l_sfakwf034,	#?????? 
                       sfakwf009 = l_sfakwf009,	#????
                       sfakwf010 = l_sfakwf010	#DATECODE          
    WHERE sfakwfent = g_enterprise AND sfakwfsite = g_site AND sfakwfdocno = g_sfajwf_m.sfajwfdocno   
      AND sfakwfseq = g_sfakwf_d[p_ac].sfakwfseq
   CASE
      WHEN SQLCA.sqlerrd[3] = 0  #???????
      
      WHEN SQLCA.SQLCODE #????
         LET l_successret = FALSE
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "sfakwf_t:",SQLERRMESSAGE 
         LET g_errparam.code = SQLCA.SQLCODE 
         LET g_errparam.popup = TRUE 
         #CALL s_transaction_end('N','0')
         CALL cl_err()
   END CASE
   CALL bsft001_wf_b_fill()
   DELETE FROM sfanwf_t
    WHERE sfanwfent = g_enterprise
      AND sfanwfdocno = g_sfajwf_m.sfajwfdocno
      AND sfanwfseq1 =  g_sfakwf_d[p_ac].sfakwfseq
   CALL bsft001_wf_ins_sfanwf()

   FREE bsft001_wf_upd_sfakwf01
   CALL bsft001_wf_b_fill()
   
   #241212-00001#1--s
   IF NOT cl_null(p_ac1) THEN
      
      SELECT COUNT(1) INTO l_cnt FROM sfbcwf_t 
       WHERE sfbcwfent = g_enterprise AND sfbcwfsite = g_site AND sfbcwfdocno = g_sfajwf_m.sfajwfdocno AND sfbcwfseq = g_sfakwf_d[p_ac].sfakwfseq  AND sfbcwfseq1 = g_sfakwf2_d[p_ac1].sfbcwfseq1 AND sfbcwfseq2 = g_sfakwf2_d[p_ac1].sfbcwfseq2
      CALL s_transaction_begin()             
      #?????, ??????
      IF l_cnt = 0 THEN 
         INSERT INTO sfbcwf_t
                  (sfbcwfent, sfbcwfsite,
                   sfbcwfdocno,sfbcwfseq,
                   sfbcwfseq1,sfbcwfseq2
                   ,sfbcwf006,sfbcwf005,sfbcwf002,sfbcwf003,sfbcwf043,sfbcwf023,sfbcwf024,sfbcwf013,sfbcwf014,sfbcwf004,sfbcwf022,sfbcwf033,sfbcwf021,sfbcwf007,sfbcwf010,sfbcwf011,sfbcwf012,sfbcwf047,sfbcwf048,sfbcwf015,sfbcwf016,sfbcwf025,sfbcwf017,sfbcwf018,sfbcwf019,sfbcwf020,sfbcwf029,sfbcwf008,sfbcwf009,sfbcwf039,sfbcwf030,sfbcwf040,sfbcwf041,sfbcwf042,sfbcwf028,sfbcwf001,sfbcwf026,sfbcwf027,sfbcwf034,sfbcwf035,sfbcwf049) 
            VALUES(g_enterprise, g_site,
                   g_sfajwf_m.sfajwfdocno,g_sfakwf_d[p_ac].sfakwfseq,g_sfakwf2_d[p_ac1].sfbcwfseq1,g_sfakwf2_d[p_ac1].sfbcwfseq2
                   ,g_sfakwf2_d[p_ac1].sfbcwf006,g_sfakwf2_d[p_ac1].sfbcwf005,g_sfakwf2_d[p_ac1].sfbcwf002,g_sfakwf2_d[p_ac1].sfbcwf003,g_sfakwf2_d[p_ac1].sfbcwf043,g_sfakwf2_d[p_ac1].sfbcwf023,g_sfakwf2_d[p_ac1].sfbcwf024, 
                       g_sfakwf2_d[p_ac1].sfbcwf013,g_sfakwf2_d[p_ac1].sfbcwf014,g_sfakwf2_d[p_ac1].sfbcwf004,g_sfakwf2_d[p_ac1].sfbcwf022, 
                       g_sfakwf2_d[p_ac1].sfbcwf033,g_sfakwf2_d[p_ac1].sfbcwf021,g_sfakwf2_d[p_ac1].sfbcwf007,g_sfakwf2_d[p_ac1].sfbcwf010,g_sfakwf2_d[p_ac1].sfbcwf011,g_sfakwf2_d[p_ac1].sfbcwf012,g_sfakwf2_d[p_ac1].sfbcwf047,g_sfakwf2_d[p_ac1].sfbcwf048, 
                       g_sfakwf2_d[p_ac1].sfbcwf015,g_sfakwf2_d[p_ac1].sfbcwf016,g_sfakwf2_d[p_ac1].sfbcwf025,g_sfakwf2_d[p_ac1].sfbcwf017,g_sfakwf2_d[p_ac1].sfbcwf018,g_sfakwf2_d[p_ac1].sfbcwf019,g_sfakwf2_d[p_ac1].sfbcwf020,g_sfakwf2_d[p_ac1].sfbcwf029, 
                       g_sfakwf2_d[p_ac1].sfbcwf008,g_sfakwf2_d[p_ac1].sfbcwf009,g_sfakwf2_d[p_ac1].sfbcwf039,g_sfakwf2_d[p_ac1].sfbcwf030,g_sfakwf2_d[p_ac1].sfbcwf040,g_sfakwf2_d[p_ac1].sfbcwf041,g_sfakwf2_d[p_ac1].sfbcwf042,g_sfakwf2_d[p_ac1].sfbcwf028, 
                       g_sfakwf2_d[p_ac1].sfbcwf001,g_sfakwf2_d[p_ac1].sfbcwf026,g_sfakwf2_d[p_ac1].sfbcwf027,g_sfakwf2_d[p_ac1].sfbcwf034,g_sfakwf2_d[p_ac1].sfbcwf035,g_sfakwf2_d[p_ac1].sfbcwf049)
                     
         #add-point:?????2 name="input.body2.a_insert"
         IF NOT cl_null(g_sfakwf2_d[p_ac1].ooff013) THEN
            CALL s_aooi360_gen('7',g_prog,g_sfajwf_m.sfajwfdocno,g_sfakwf2_d[p_ac1].sfbcwfseq1,g_sfakwf2_d[p_ac1].sfbcwfseq2,'','','','','','','1',g_sfakwf2_d[p_ac1].ooff013) RETURNING l_success
         END IF
      END IF    
      IF SQLCA.SQLCODE THEN
         INITIALIZE g_errparam TO NULL 
         LET g_errparam.extend = "sfbcwf_t:",SQLERRMESSAGE 
         LET g_errparam.code = SQLCA.SQLCODE 
         LET g_errparam.popup = TRUE 
         CALL s_transaction_end('N','0')
         CALL cl_err()
      ELSE
         LET g_sfakwf2_d_t.* = g_sfakwf2_d[p_ac1].*     #?????
         LET g_sfakwf2_d_o.* = g_sfakwf2_d[p_ac1].*     #?????
         CALL s_transaction_end('Y','0')
         CALL s_transaction_begin()  
      END IF
   END IF
   #241212-00001#1 add--e
   
   CALL bsft001_wf_b_fill2('3')  #241104-00004#1 add
   RETURN l_successret
END FUNCTION

################################################################################
# Descriptions...: ??????????
# Memo...........:
# Usage..........: CALL bsft001_wf_up_fc()
#                  RETURNING ????
# Input parameter: ??????1   ????????1
#                : ??????2   ????????2
# Return code....: ??????1   ????????1
#                : ??????2   ????????2
# Date & Author..: ?? By ??
# Modify.........: #241104-00004#1
################################################################################
PRIVATE FUNCTION bsft001_wf_up_fc()
DEFINE l_sql            STRING
DEFINE l_success        LIKE type_t.num5
DEFINE l_sfakwf006      LIKE sfakwf_t.sfakwf006
DEFINE l_sfbcwf         RECORD LIKE sfbcwf_t.*
DEFINE l_bmba012        LIKE bmba_t.bmba012
DEFINE l_bmba011        LIKE bmba_t.bmba011
DEFINE l_imaa006        LIKE imaa_t.imaa006
DEFINE l_imaf053        LIKE imaf_t.imaf053
DEFINE l_sfajwf010      LIKE sfajwf_t.sfajwf010
DEFINE l_sfajwf011      LIKE sfajwf_t.sfajwf011
DEFINE l_sfbcwf021      LIKE sfbcwf_t.sfbcwf021
DEFINE l_sfbcwf040      LIKE sfbcwf_t.sfbcwf040
DEFINE l_sfbcwf041      LIKE sfbcwf_t.sfbcwf041
DEFINE l_sfbcwf042      LIKE sfbcwf_t.sfbcwf042
DEFINE l_bmbawf040      LIKE bmba_t.bmbawf040
DEFINE l_imaf059        LIKE imaf_t.imaf059
DEFINE l_incgwf008      LIKE incgwf_t.incgwf008
DEFINE l_incgwf004      LIKE incgwf_t.incgwf004
DEFINE l_incgwf005      LIKE incgwf_t.incgwf005
DEFINE l_incgwf006      LIKE incgwf_t.incgwf006
DEFINE l_incgwf007      LIKE incgwf_t.incgwf007
DEFINE l_qty            LIKE sfbcwf_t.sfbcwf013
DEFINE l_dies           LIKE icbawf_t.icbawf022
DEFINE l_imafwf201      LIKE imaf_t.imafwf201
DEFINE l_para_data_2    LIKE type_t.chr80   #VMI????Tag #241120-00001#1 add
DEFINE l_where      STRING                                 #241120-00001#1 add

   LET l_success = TRUE
   #????/??
   LET l_sql = "SELECT * FROM sfbcwf_t WHERE 1=1 ",  
               "  AND sfbcwfent = ? AND sfbcwfsite = ? ",
               "  AND sfbcwfdocno = ?  AND sfbcwfseq = ? AND (sfbcwf043 = 'N' OR sfbcwf043 IS NULL)  " 
   PREPARE bsft001_wf_pre31 FROM l_sql
   DECLARE bsft001_wf_curs31 CURSOR WITH HOLD FOR bsft001_wf_pre31  
   FOREACH bsft001_wf_curs31 USING g_enterprise,g_site,g_sfajwf_m.sfajwfdocno,g_sfakwf_d[g_detail_idx].sfakwfseq  INTO l_sfbcwf.*   
           
      SELECT imaa006,imaf053,imafwf201 INTO l_imaa006,l_imaf053,l_imafwf201 FROM imaf_t 
        LEFT OUTER JOIN imaa_t ON imaaent = g_enterprise AND imaa001 = imaf001
       WHERE imafent = g_enterprise AND imafsite = g_site
         AND imaf001 = l_sfbcwf.sfbcwf006 
      SELECT bmba012,bmba011,bmbawf040 INTO l_bmba012,l_bmba011,l_bmbawf040 FROM bmba_t
       WHERE bmbaent = g_enterprise AND bmbasite = g_site AND bmba001 = g_sfakwf_d[g_detail_idx].sfakwf001  AND bmba002 = g_sfakwf_d[g_detail_idx].sfakwf002
         AND bmba003 = l_sfbcwf.sfbcwf006 AND bmba004 = l_sfbcwf.sfbcwf002
         AND bmba007 = l_sfbcwf.sfbcwf003 AND bmba008 = l_sfbcwf.sfbcwf004
      SELECT SUM(sfbcwf049) INTO l_sfakwf006 FROM sfbcwf_t 
       WHERE sfbcwfent = g_enterprise AND sfbcwfsite = g_site AND sfbcwfdocno = l_sfbcwf.sfbcwfdocno AND sfbcwfseq = g_sfakwf_d[g_detail_idx].sfakwfseq
         AND sfbcwf043 = 'Y' 
      #????*????/??
      LET l_sfbcwf.sfbcwf023 = l_sfakwf006 * l_bmba011 / l_bmba012 
      IF l_imafwf201 MATCHES '[01234]' THEN  #??
         IF s_icd_wf_icdbin_chk(l_sfbcwf.sfbcwf006) THEN 
            
                                              #????           #??               #??               #????           #??                #??             #????
            CALL s_bsft001_wf_02_ins_icbawf(l_sfbcwf.sfbcwfdocno,l_sfbcwf.sfbcwfseq1,l_sfbcwf.sfbcwfseq2,l_sfbcwf.sfbcwfseq,g_sfajwf_m.sfajwfdocdt,l_sfbcwf.sfbcwf006,l_sfbcwf.sfbcwf021,
                                                #??????       #??????      #??????        #??????       #??             #?????          #?????
                                           l_sfbcwf.sfbcwf030,l_sfbcwf.sfbcwf019,l_sfbcwf.sfbcwf020,l_sfbcwf.sfbcwf029,l_sfbcwf.sfbcwf014,l_sfbcwf.sfbcwf023,l_bmbawf040)
                                               #DATECODE         #??????       #??????
            RETURNING l_success,l_qty,l_dies
            IF NOT l_success THEN
               RETURN l_success
            END IF
         END IF
      ELSE  
         
         #241208-00001#1 add--s
         LET l_sfbcwf.sfbcwf023 = g_sfakwf_d[g_detail_idx].sfakwf006
         LET l_sfbcwf.sfbcwf023 = l_sfbcwf.sfbcwf023 * l_bmba011 / l_bmba012 
         CALL s_bsft001_wf_02_fc(l_sfbcwf.sfbcwfdocno,l_sfbcwf.sfbcwfseq,l_sfbcwf.sfbcwfseq1,l_sfbcwf.sfbcwfseq2,l_sfbcwf.sfbcwf023,l_bmbawf040)
         RETURNING l_success
         IF NOT l_success THEN
            RETURN l_success
         END IF
         #241208-00001#1 add--e
         #241208-00001#1 mark--s
#         #241120-00001#1 add--s
#         LET l_where = NULL
#         LET l_para_data_2 = cl_get_para(g_enterprise,g_site,'S-BAS-0044')  
#         #?????
#         CALL s_control_get_doc_sql("incgwf004",g_sfajwf_m.sfajwfdocno,'6')
#              RETURNING l_success,l_where
#         #241120-00001#1 add--e
#         LET l_sql = " SELECT * FROM ( SELECT incgwf007,incgwf008,incgwf004,incgwf005,incgwf006 FROM incgwf_t ",
#                     "   LEFT JOIN inad_t ON inadent = incgwfent AND inad001 = incgwf001 AND inadsite = incgwfsite AND inad002 = incgwf002 AND inad003 = incgwf006 ",
#                     "  WHERE incgwfent = ? AND incgwfsite  = ? ",
#                     "    AND incgwf001   = ? ",    #????
#                     "    AND incgwf008-incgwf021 > 0 "     
#         #241120-00001#1 add--s
#         LET l_sql = l_sql CLIPPED ," AND ",l_where
#         #??VMI???
#         LET l_sql = l_sql,
#                     "  AND NOT EXISTS( SELECT 1 FROM inac_t WHERE inacent = incgwfent AND inac001 = incgwf004 ",
#                     "  AND inac003 ='",l_para_data_2,"' AND (inac002 IS NULL OR inac002 = ' '))"
#         #241120-00001#1 add--e   
#      
#         IF cl_null(l_sfbcwf021) THEN  #????
#            LET l_sql = l_sql CLIPPED," AND incgwf002  = ' ' "
#         ELSE
#            LET l_sql = l_sql CLIPPED," AND incgwf002 = '",l_sfbcwf021 ,"'"
#         END IF   
#         IF cl_null(l_sfbcwf040) AND cl_null(l_sfbcwf041) AND cl_null(l_sfbcwf042) THEN  #DATECODE+????+????
#         ELSE
#            IF NOT cl_null(l_sfbcwf040) THEN  
#               LET l_sql = l_sql CLIPPED," AND incgwf038 = '",l_sfbcwf040 ,"' "
#            END IF
#            IF NOT cl_null(l_sfbcwf041) THEN  
#               LET l_sql = l_sql CLIPPED," AND incgwf039 = '",l_sfbcwf041,"'  "
#            END IF
#            IF NOT cl_null(l_sfbcwf042) THEN  
#               LET l_sql = l_sql CLIPPED," AND incgwf040 = '",l_sfbcwf042,"' "
#            END IF
#         END IF 
#         IF NOT cl_null(l_bmbawf040) THEN  #?????
#            LET l_sql = l_sql CLIPPED," AND incgwf045 = '",l_bmbawf040 ,"'"
#         END IF
#         SELECT imaf059 INTO l_imaf059
#           FROM imaf_t
#          WHERE imafent = g_enterprise
#            AND imafsite = g_site
#            AND imaf001 = l_sfbcwf.sfbcwf006       
#         IF l_imaf059 = '2' THEN
#            LET l_sql = l_sql CLIPPED," ORDER BY inad011,incgwf004,incgwf005,incgwf006,incgwf036,incgwf037,incgwf008 ) WHERE ROWNUM = 1"  #?????
#         ELSE
#            LET l_sql = l_sql CLIPPED," ORDER BY inad014,incgwf004,incgwf005,incgwf006,incgwf036,incgwf037,incgwf008 ) WHERE ROWNUM = 1"  #?????
#         END IF               
#         PREPARE bsft001_wf_fc FROM l_sql
#         EXECUTE bsft001_wf_fc USING g_enterprise,g_site,l_sfbcwf.sfbcwf006 
#            INTO l_incgwf007,l_incgwf008,l_incgwf004,l_incgwf005,l_incgwf006
#         IF l_sfbcwf.sfbcwf014 <> l_incgwf007 THEN
#            CALL s_aooi250_convert_qty(l_sfbcwf.sfbcwf006,l_incgwf007,l_sfbcwf.sfbcwf014,l_incgwf008)
#                                    RETURNING l_success,l_incgwf008
#         END IF                                    
#         IF l_sfbcwf.sfbcwf023 > l_incgwf008 THEN
#            LET l_sfbcwf.sfbcwf023 = l_incgwf008
#         END IF
#         
#         #?????=????+??????
#         LET l_sfbcwf.sfbcwf013 = l_sfbcwf.sfbcwf024 + l_sfbcwf.sfbcwf023
#         #????
##         IF NOT cl_null(l_sfbcwf.sfbcwf014) THEN
##            CALL s_aooi250_take_decimals(l_sfbcwf.sfbcwf014,l_sfbcwf.sfbcwf023)
##                 RETURNING l_success,l_sfbcwf.sfbcwf023
##         END IF
##         IF NOT cl_null(l_sfbcwf.sfbcwf014) THEN
##            CALL s_aooi250_take_decimals(l_sfbcwf.sfbcwf014,l_sfbcwf.sfbcwf024)
##                 RETURNING l_success,l_sfbcwf.sfbcwf024
##         END IF
#         
#         CALL s_aooi250_convert_qty(l_sfbcwf.sfbcwf006,l_sfbcwf.sfbcwf014,l_imaf053,l_sfbcwf.sfbcwf013) 
#            RETURNING l_success,l_sfbcwf.sfbcwf047  #????
#         CALL s_aooi250_convert_qty(l_sfbcwf.sfbcwf006,l_sfbcwf.sfbcwf014,l_imaa006,l_sfbcwf.sfbcwf013) 
#            RETURNING l_success,l_sfbcwf.sfbcwf048  #??????
#         #??QPA????
#         LET l_sfbcwf.sfbcwf010  = l_bmba011
#         LET l_sfbcwf.sfbcwf011   = l_bmba012
##         CALL bsft001_wf_sfbcwf023_qpa_02(l_sfbcwf.sfbcwf023,l_sfakwf006) RETURNING l_sfbcwf.sfbcwf010,l_sfbcwf.sfbcwf011 
#         
#         SELECT sfajwf010,sfajwf011,sfbcwf021 INTO l_sfajwf010,l_sfajwf011,l_sfbcwf021 FROM sfajwf_t 
#          WHERE sfajwfdocno = g_sfajwf_m.sfajwfdocno AND sfajwfsite = g_site AND sfajwfent = g_enterprise
#         
#         UPDATE sfbcwf_t SET sfbcwf010 = l_sfbcwf.sfbcwf010, 
#                             sfbcwf011 = l_sfbcwf.sfbcwf011,                          
#                             sfbcwf023 = l_sfbcwf.sfbcwf023,
#                             sfbcwf024 = l_sfbcwf.sfbcwf024,
#                             sfbcwf013 = l_sfbcwf.sfbcwf013,
#                             sfbcwf047 = l_sfbcwf.sfbcwf047, 
#                             sfbcwf019 = l_incgwf004,
#                             sfbcwf020 = l_incgwf005,
#                             sfbcwf029 = l_incgwf006,
#                             sfbcwf048 = l_sfbcwf.sfbcwf048
#          WHERE sfbcwfent = g_enterprise AND sfbcwfsite = g_site AND sfbcwfdocno = l_sfbcwf.sfbcwfdocno AND sfbcwfseq = l_sfbcwf.sfbcwfseq
#            AND sfbcwfseq1 = l_sfbcwf.sfbcwfseq1 AND sfbcwfseq2 = l_sfbcwf.sfbcwfseq2 
#         IF SQLCA.SQLCODE THEN
#            INITIALIZE g_errparam TO NULL
#            LET g_errparam.code = SQLCA.sqlcode
#            LET g_errparam.extend = "UPDATE sfbcwf_t:"
#            LET g_errparam.popup = TRUE
#            CALL cl_err()
#            LET l_success = FALSE
#            RETURN l_success
##         END IF
         #241208-00001#1 mark--e
         INITIALIZE l_sfbcwf.* TO NULL
      END IF     
   END FOREACH
   
   RETURN l_success
END FUNCTION

################################################################################
# Descriptions...: ????
# Memo...........:
# Usage..........: CALL s_aooi150_ins (????)
#                  RETURNING ????
# Input parameter: ??????1   ????????1
#                : ??????2   ????????2
# Return code....: ??????1   ????????1
#                : ??????2   ????????2
# Date & Author..: #250117-00001#1
# Modify.........:
################################################################################
PRIVATE FUNCTION bsft001_wf_get_sfbcwf003()
DEFINE l_sql      STRING
DEFINE l_cnt      LIKE type_t.num5
DEFINE l_sfakwf043  DATETIME YEAR TO SECOND  #BOM????

   IF NOT cl_null(g_sfakwf_d[g_detail_idx].sfakwf043) THEN 
      LET l_sfakwf043 = g_sfakwf_d[g_detail_idx].sfakwf043
   ELSE   
      LET l_sfakwf043 = cl_get_current()
   END IF

   LET l_cnt = 0
   
   #210617-00015#1 add---start---
   LET g_sfakwf2_d[l_ac].sfbcwf001 = ''
#   LET l_sql = "SELECT bmba001 FROM bmba_t  ",  #241224-00001#1 mark
   LET l_sql = "SELECT bmba001,bmba011,bmba012 FROM bmba_t  ",  #241224-00001#1 add
               " WHERE bmbaent = ",g_enterprise ,
               "   AND bmbasite = '",g_site,"' ",
               "   AND (bmba019 = '1' OR bmba019 ='3') ",
               "   AND bmba003 = '",g_sfakwf2_d[l_ac].sfbcwf005,"'",
               "   AND bmba007 = '",g_sfakwf2_d[l_ac].sfbcwf003,"'",
               "   AND bmba008 = '",g_sfakwf2_d[l_ac].sfbcwf004,"'",
               "   AND EXISTS(SELECT 1 FROM bmaa_t WHERE bmaaent = bmbaent AND bmaasite = bmbasite AND bmaa001 = bmba001 AND bmaa002 = bmba002 AND bmaastus = 'Y') ",
               "   AND ROWNUM = 1 ",
               " START WITH bmba001 = '",g_sfakwf_d[g_detail_idx].sfakwf001,"' ",
               "   AND bmba002 = '",g_sfakwf_d[g_detail_idx].sfakwf002,"' ",
               "   AND bmba005 <= ? AND (bmba006 IS NULL OR bmba006> ? ) ",
               " CONNECT BY PRIOR bmba003 = bmba001 AND PRIOR bmba002 = bmba002 AND PRIOR bmbasite = bmbasite AND PRIOR bmbaent = bmbaent",
               "   AND bmba005 <= ? AND (bmba006 IS NULL OR bmba006> ? ) "
   PREPARE asft300_bmba_ln FROM l_sql
   EXECUTE asft300_bmba_ln USING l_sfakwf043,l_sfakwf043,l_sfakwf043,l_sfakwf043 INTO g_sfakwf2_d[l_ac].sfbcwf001 
                                ,g_sfakwf2_d[l_ac].sfbcwf010,g_sfakwf2_d[l_ac].sfbcwf011
   #241224-00001#1 add--s
   LET g_sfakwf2_d[l_ac].sfbcwf023 = g_sfakwf_d[g_detail_idx].sfakwf006 * g_sfakwf2_d[l_ac].sfbcwf010 / g_sfakwf2_d[l_ac].sfbcwf011
   #????
   LET g_sfakwf2_d[l_ac].sfbcwf013 = g_sfakwf2_d[l_ac].sfbcwf023 + g_sfakwf2_d[l_ac].sfbcwf024
   #????
   LET g_sfakwf2_d[l_ac].number1 = g_sfakwf2_d[l_ac].sfbcwf013 - g_sfakwf2_d[l_ac].sfbcwf015 - g_sfakwf2_d[l_ac].sfbcwf016 
   #241224-00001#1 add--e
END FUNCTION

{</section>}
